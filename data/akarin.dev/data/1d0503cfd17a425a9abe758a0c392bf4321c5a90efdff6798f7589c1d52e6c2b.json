{
  "Source": "akarin.dev",
  "Title": "用 Intersection Observer 来自己造个图片懒加载的轮子₍₍ (ง ˙ω˙)ว ⁾⁾",
  "Link": "https://akarin.dev/2020/03/26/intersection-observer/",
  "Content": "\u003carticle class=\"mdui-p-a-3 mdui-card-content mdui-typo\"\u003e\u003cblockquote\u003e\u003cp\u003e封面图：\u003ca href=\"https://www.pixiv.net/artworks/80105763\" target=\"_blank\" rel=\"noopener\"\u003ePixiv ID: 80105763 「アッカリーン」 by cedar\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\u003cp\u003eIntersection Observer 这东西之前我是一直没听说过的，至于为什么发现了它……这个过程就有点奇怪了(〃′▽`)\u003c/p\u003e\u003col\u003e\u003cli\u003e寒假的时候尝试着用 \u003ca href=\"https://cn.vuejs.org/\" target=\"_blank\" rel=\"noopener\"\u003eVue\u003c/a\u003e 和 \u003ca href=\"https://mdui.org/\" target=\"_blank\" rel=\"noopener\"\u003eMDUI\u003c/a\u003e 搞了点大新闻。\u003c/li\u003e\u003cli\u003e在搜索其他 Material Design 风格的界面框架时，发现了 \u003ca href=\"https://vuetifyjs.com/zh-Hans/\" target=\"_blank\" rel=\"noopener\"\u003eVuetify\u003c/a\u003e 这个 Vue 组件库。\u003c/li\u003e\u003cli\u003e翻了 Vuetify 的文档，它的功能比 MDUI 丰富了不少，居然还有个\u003ca href=\"https://vuetifyjs.com/zh-Hans/components/lazy/\" target=\"_blank\" rel=\"noopener\"\u003e懒加载\u003c/a\u003e功能！\u003c/li\u003e\u003cli\u003e懒加载的实现靠的是 \u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/Intersection_Observer_API\" target=\"_blank\" rel=\"noopener\"\u003eIntersection Observer\u003c/a\u003e，这是……哎？这么神奇的东西原来浏览器就自带啊！(｡•́ - •̀｡)\u003c/li\u003e\u003c/ol\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/407*270),270px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/5488809427a89f0731d38401e9258b65/d7GkPfHd.jpg\" data-src-webp=\"https://p.sda1.dev/12/2765f4225f2b684e7524ab25113b7928/Myt3lN8w.webp\" data-src-avif=\"https://p.sda1.dev/12/461d227259db82848c4e267714c44530/b7bOjWIV.jpg\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAVACADASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAABwAGAwT/xAAjEAACAQQBBQADAAAAAAAAAAABAgMABAUREgYTITEyUWGR/8QAFgEBAQEAAAAAAAAAAAAAAAAABQQG/8QAHxEBAAICAQUBAAAAAAAAAAAAAQIhAAMEBRESQXET/9oADAMBAAIRAxEAPwA56Zuo++sVzF3YnIH5NN2M6fwscsvJg4XX2h0PA1qibpqwtBeQiUxyMGGhGrmk26y9o11OrIxSKRDEAxX4Gt1NHd5yYw71huh1beVtYkjxD5npzWIxlyJwicFjQOZFGg361QVlBaLPII4jrdNWMvI3Z1aPuMxbk2+Tsg2VVvA9UW9S43tXrlFIQ+RvQP8APFM6eo7Di/lKJJGmV9sRV7gFBWafAR2ovYkig4CbiNluRUGt7NgkmkYyXDN6HytVVZ/i1GT7W8N6cAbpe2dudrXELbOhWc62NjiBusJ1zgoIViuY5GGk+KqqrjKQ04xptfmf/9k\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/5488809427a89f0731d38401e9258b65/d7GkPfHd.jpg\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003ch1 id=\"基本的食用方法\"\u003e\u003ca href=\"#基本的食用方法\" class=\"headerlink\" title=\"基本的食用方法\"\u003e\u003c/a\u003e基本的食用方法\u003c/h1\u003e\u003cp\u003eIntersection Observer 可以用于检测网页上两个元素的交集的变化，并且在这个“交集”改变到一定程度时自动调用一个函数。\u003c/p\u003e\u003cp\u003e下面是一个实例，虽然是一片空白，但是可以试着滑啊滑～当两个一组的色块组合开始显示/移出、显示/移出了一半、完全显示/移出时下面的输出都会更新。\u003c/p\u003e\u003cdiv style=\"max-height:200px;overflow-y:auto\" id=\"demo-1-main\"\u003e\u003cdiv\u003e\u003cdiv style=\"height:300px\"\u003e\u003c/div\u003e\u003cdiv id=\"demo-1-target-1\"\u003e\u003cdiv style=\"height:75px;background-color:red\"\u003e\u003c/div\u003e\u003cdiv style=\"height:75px;background-color:green\"\u003e\u003c/div\u003e\u003c/div\u003e\u003cdiv style=\"height:300px\"\u003e\u003c/div\u003e\u003cdiv id=\"demo-1-target-2\"\u003e\u003cdiv style=\"height:75px;background-color:#00f\"\u003e\u003c/div\u003e\u003cdiv style=\"height:75px;background-color:#ff0\"\u003e\u003c/div\u003e\u003c/div\u003e\u003cdiv style=\"height:300px\"\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003cpre id=\"demo-1-log\"\u003e\u003c/pre\u003e\u003cscript\u003e!function(e){var t=new IntersectionObserver((function(t){var n=\"\";t.forEach((function(e){for(var t in e)n+=t+\": \"+e[t]+\"\u003cbr\u003e\"})),e.getElementById(\"demo-1-log\").innerHTML=n}),{root:e.getElementById(\"demo-1-main\"),rootMargin:\"0px 0px 0px 0px\",threshold:[0,.5,1]});t.observe(e.getElementById(\"demo-1-target-1\")),t.observe(e.getElementById(\"demo-1-target-2\"))}(document)\u003c/script\u003e\u003cp\u003e首先要创建一个 Intersection Observer 对象，并设定好要自动调用的函数以及根元素：\u003c/p\u003e\u003cpre class=\"language-javascript line-numbers\" data-language=\"javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"token function function-variable\"\u003ecallback\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token parameter\"\u003eentries\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003econsole\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eentries\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e observer \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eIntersectionServer\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecallback\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property literal-property\"\u003eroot\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e document\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;root\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property literal-property\"\u003erootMargin\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;1px 2px 4px 8px\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property literal-property\"\u003ethreshold\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e.5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cul\u003e\u003cli\u003e\u003ccode\u003ecallback\u003c/code\u003e 是调用的函数，稍后再说明～\u003c/li\u003e\u003cli\u003e\u003ccode\u003eroot\u003c/code\u003e 是\u003cstrong\u003e根元素\u003c/strong\u003e的 DOM，不设定的话就是浏览器窗口。\u003c/li\u003e\u003cli\u003e\u003ccode\u003erootMargin\u003c/code\u003e 是根元素的\u003cstrong\u003e边距\u003c/strong\u003e（相当于将根元素的范围扩大了），写法和 CSS 的 \u003ccode\u003emargin\u003c/code\u003e 是一样的。\u003c/li\u003e\u003cli\u003e\u003ccode\u003ethreshold\u003c/code\u003e 是其他元素和根元素的\u003cstrong\u003e交集的阈值\u003c/strong\u003e，交集为 \u003ccode\u003e0\u003c/code\u003e 代表该元素在根元素之外，\u003ccode\u003e1\u003c/code\u003e 代表该元素完全与根元素完全重合。阈值可以设为一个或多个值（数组），不设定的话就是 \u003ccode\u003e0\u003c/code\u003e。\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e这样就相当于有了一个属于上面的“根元素”的“观察器”，接下来就可以设定它要观察哪些元素与根元素的交集变化了：\u003c/p\u003e\u003cpre class=\"language-javascript line-numbers\" data-language=\"javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token comment\"\u003e// 开始观察某个元素\u003c/span\u003e\nobserver\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eobserve\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edocument\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;target-1\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nobserver\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eobserve\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edocument\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;target-2\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// 还可以取消观察某个元素\u003c/span\u003e\nobserver\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eunobserve\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edocument\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;target-1\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// 或者取消观察所有元素\u003c/span\u003e\nobserver\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003edisconnect\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e使用 \u003ccode\u003eobserve\u003c/code\u003e \u003cstrong\u003e开始观察某个元素时\u003c/strong\u003e，或是某个被观察的元素（可能不唯一）与根元素的交集\u003cstrong\u003e增加或减少\u003c/strong\u003e并且\u003cstrong\u003e经过了上面设定的阈值\u003c/strong\u003e时，就会执行 \u003ccode\u003ecallback\u003c/code\u003e 函数。调用函数时使用的唯一的参数是由 \u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/IntersectionObserverEntry\" target=\"_blank\" rel=\"noopener\"\u003e\u003ccode\u003eIntersectionObserverEntry\u003c/code\u003e\u003c/a\u003e 对象组成的数组。\u003c/p\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/1516*373),373px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/e80c19e2d59403d7f43f0e7553b5a3f7/GMBKBE0V.png\" data-src-webp=\"https://p.sda1.dev/12/0a9d0922ada1c16b80968e4cf2912ebb/glnf0VDN.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAIACADASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAMEB//EABsQAQADAAMBAAAAAAAAAAAAAAEAAhFRYZGB/8QAFAEBAAAAAAAAAAAAAAAAAAAAAv/EABURAQEAAAAAAAAAAAAAAAAAAAEA/9oADAMBAAIRAxEAPwDcUs3cWWCtnNE+MRErECmynD4xp35EQyv/2Q\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/e80c19e2d59403d7f43f0e7553b5a3f7/GMBKBE0V.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003cp\u003e这个对象包含了和元素交叉的事件有关的一些信息，部分比较常用的属性：\u003c/p\u003e\u003cul\u003e\u003cli\u003e\u003ccode\u003etime\u003c/code\u003e 是从新建“观察器”到触发函数间隔的时间，单位是毫秒。\u003c/li\u003e\u003cli\u003e\u003ccode\u003eisIntersecting\u003c/code\u003e 和 \u003ccode\u003eintersectionRatio\u003c/code\u003e 分别表示被观察的元素和根元素是否有交集以及交集的大小，对应上面的 \u003ccode\u003ethreshold\u003c/code\u003e。\u003c/li\u003e\u003cli\u003e\u003ccode\u003etarget\u003c/code\u003e 是被观察的元素。\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e触发函数时，\u003ccode\u003eintersectionRatio\u003c/code\u003e 和设定的 \u003ccode\u003ethreshold\u003c/code\u003e 可能会有少量的误差～例如设定 \u003ccode\u003ethreshold\u003c/code\u003e 为 \u003ccode\u003e0.5\u003c/code\u003e，进入和离开根元素时 \u003ccode\u003eintersectionRatio\u003c/code\u003e 会略高于 / 略低于 \u003ccode\u003e0.5\u003c/code\u003e。另外\u003cstrong\u003e开始观察某个元素时会立即触发一次函数\u003c/strong\u003e，因此虽然设定了 \u003ccode\u003ethreshold\u003c/code\u003e 但是在这里仍然需要对 \u003ccode\u003eintersectionRatio\u003c/code\u003e 进行检查。\u003c/p\u003e\u003cp\u003e上面的演示的完整代码：\u003c/p\u003e\u003cpre class=\"line-numbers language-markup\" data-language=\"markup\"\u003e\u003ccode class=\"language-markup\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003ediv\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eid\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003edemo-1-main\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token special-attr\"\u003e\u003cspan class=\"token attr-name\"\u003estyle\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"token css language-css value\"\u003e\u003cspan class=\"token property\"\u003emax-height\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e 200px\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token property\"\u003eoverflow-y\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e auto\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003ediv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n        \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003ediv\u003c/span\u003e \u003cspan class=\"token special-attr\"\u003e\u003cspan class=\"token attr-name\"\u003estyle\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"token css language-css value\"\u003e\u003cspan class=\"token property\"\u003eheight\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e 300px\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ediv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n        \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003ediv\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eid\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003edemo-1-target-1\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n            \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003ediv\u003c/span\u003e \u003cspan class=\"token special-attr\"\u003e\u003cspan class=\"token attr-name\"\u003estyle\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"token css language-css value\"\u003e\u003cspan class=\"token property\"\u003eheight\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e 75px\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e red\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ediv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n            \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003ediv\u003c/span\u003e \u003cspan class=\"token special-attr\"\u003e\u003cspan class=\"token attr-name\"\u003estyle\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"token css language-css value\"\u003e\u003cspan class=\"token property\"\u003eheight\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e 75px\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e green\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ediv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n        \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ediv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n        \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003ediv\u003c/span\u003e \u003cspan class=\"token special-attr\"\u003e\u003cspan class=\"token attr-name\"\u003estyle\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"token css language-css value\"\u003e\u003cspan class=\"token property\"\u003eheight\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e 300px\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ediv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n        \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003ediv\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eid\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003edemo-1-target-2\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n            \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003ediv\u003c/span\u003e \u003cspan class=\"token special-attr\"\u003e\u003cspan class=\"token attr-name\"\u003estyle\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"token css language-css value\"\u003e\u003cspan class=\"token property\"\u003eheight\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e 75px\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e blue\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ediv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n            \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003ediv\u003c/span\u003e \u003cspan class=\"token special-attr\"\u003e\u003cspan class=\"token attr-name\"\u003estyle\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"token css language-css value\"\u003e\u003cspan class=\"token property\"\u003eheight\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e 75px\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e yellow\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ediv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n        \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ediv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n        \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003ediv\u003c/span\u003e \u003cspan class=\"token special-attr\"\u003e\u003cspan class=\"token attr-name\"\u003estyle\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"token css language-css value\"\u003e\u003cspan class=\"token property\"\u003eheight\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e 300px\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ediv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ediv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ediv\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003epre\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eid\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003edemo-1-log\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003epre\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003escript\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token script\"\u003e\u003cspan class=\"token language-javascript\"\u003e\n\u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e observer \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eIntersectionObserver\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eentries\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e text \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    entries\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eforEach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ee\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e key \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n            text \u003cspan class=\"token operator\"\u003e+=\u003c/span\u003e key \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;: \u0026#39;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ekey\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;\u0026lt;br\u0026gt;\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    document\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;demo-1-log\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einnerHTML \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e text\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property literal-property\"\u003eroot\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e document\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;demo-1-main\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property literal-property\"\u003erootMargin\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;0px 0px 0px 0px\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property literal-property\"\u003ethreshold\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e.5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nobserver\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eobserve\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edocument\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;demo-1-target-1\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nobserver\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eobserve\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edocument\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;demo-1-target-2\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003escript\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003ch1 id=\"实例：“懒加载”\"\u003e\u003ca href=\"#实例：“懒加载”\" class=\"headerlink\" title=\"实例：“懒加载”\"\u003e\u003c/a\u003e实例：“懒加载”\u003c/h1\u003e\u003cp\u003e如果一个网页上有很多图片的话，不是所有人都会一直滑到底的，那些没有显示出来的图片实际上也没有被加载的必要，所以就有了“懒加载”这种操作，当图片（的占位符）进入页面时再加载～\u003c/p\u003e\u003cp\u003e\u003cem\u003e实际上“图片”也可以替换成其他需要按需加载的东西，比如在用 Vue 折腾的单页应用上，不同页面的 JS 代码也可以懒加载了。\u003c/em\u003e\u003c/p\u003e\u003cp\u003e以前的各种懒加载实现，都需要自己\u003cstrong\u003e手动获取屏幕 / 图片的尺寸和位置\u003c/strong\u003e，然后来个 \u003ccode\u003esetInterval\u003c/code\u003e 定时进行比较或者写进 \u003ccode\u003eonscroll\u003c/code\u003e 事件，后者还得加个去抖（debounce）或节流（throttle）。\u003c/p\u003e\u003cp\u003e……但是手动计算不麻烦吗？这么多参数怎么可能记得住？真的不会弄混吗？(╯‵□′)╯︵┻━┻\u003c/p\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/1069*720),720px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/02b71d177caeb33c5451b81ec438ce1a/rUbmlKqT.png\" data-src-webp=\"https://p.sda1.dev/12/b131cb086e2cd17bceaae99c6fb43a71/uaLp47UN.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAWACADASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAQDBQf/xAAkEAACAQMDBAMBAAAAAAAAAAABAgADBBESITEFExRBIzJRYv/EABcBAAMBAAAAAAAAAAAAAAAAAAEDBAL/xAAdEQEAAgICAwAAAAAAAAAAAAABAAIDESFREjFB/9oADAMBAAIRAxEAPwD2VKakuGLHfPJlK07TVgq4GNzrMnTOamSOJZa0RUq5YrheRFgdkfbDiqO6MoTp9jWTbUyg/s1Tp1ohBVMYIMKqqMKAIm9HRJ2td8E51tTNdqnbp0xpO+S0rS0u13HZU59F4iVWpQXVT5D53fdmbDz/AH2OP6in5efkFIjb6kiIgamnggn/2Q\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/02b71d177caeb33c5451b81ec438ce1a/rUbmlKqT.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003cp\u003e也有用 jQuery 实现的例子，不过这种落后的东西就没有什么学习的必要了嘛……\u003c/p\u003e\u003cp\u003e但是 Intersection Observer 就很适合拿来实现懒加载哦੭ ᐕ)੭*⁾⁾ 只要以窗口为根元素，观察所有的 \u003ccode\u003e\u0026lt;img\u0026gt;\u003c/code\u003e，在回调函数里设定它们的 \u003ccode\u003esrc\u003c/code\u003e，就可以简单地实现懒加载了(⑉･̆-･̆⑉)\u003c/p\u003e\u003cpre class=\"language-javascript line-numbers\" data-language=\"javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token comment\"\u003e// 图片的URL不写在src而是写在别的属性里\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// 例如：\u0026lt;img data-src=\u0026#34;image.jpg\u0026#34;\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// 新建“观察器”\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e// 可以设定一些垂直方向的边距，提前一段时间加载图片\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e observer \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eIntersectionObserver\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003eentries\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    entries\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eforEach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ee\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token comment\"\u003e// 只有图片进入根元素时才执行\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003ee\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eisIntersecting\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n        \u003cspan class=\"token comment\"\u003e// 设定为src的值，图片加载过以后就可以取消观察了\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e t \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003etarget\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003et\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esrc\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e t\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esrc \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e t\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetAttribute\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;data-src\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n        observer\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eunobserve\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003et\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token property literal-property\"\u003erootMargin\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;64px 0px\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e// 观察所有图片的位置\u003c/span\u003e\ndocument\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003equerySelectorAll\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;img[data-src]\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eforEach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ee\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    observer\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eobserve\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ee\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e而且这个功能已经在本站实装了～用的就是上面的自己写的代码(*´∀`*)\u003c/p\u003e\u003cp\u003e\u003cdel\u003e其实现在用着的主题是自带懒加载功能的，不过用的是\u003ca href=\"https://github.com/jieyou/lazyload\" target=\"_blank\" rel=\"noopener\"\u003e一个 jQuery 插件\u003c/a\u003e，很久之前还被我砍掉了\u003c/del\u003e\u003c/p\u003e\u003cp\u003e\u003cdel\u003e然后我发现了另一个\u003ca href=\"https://github.com/tuupola/lazyload\" target=\"_blank\" rel=\"noopener\"\u003e原生 JS 实现的懒加载插件\u003c/a\u003e，也是用到了 Intersection Observer，所以我自己造了个轮子？！\u003c/del\u003e\u003c/p\u003e\u003ch1 id=\"实例：“无限滚动”\"\u003e\u003ca href=\"#实例：“无限滚动”\" class=\"headerlink\" title=\"实例：“无限滚动”\"\u003e\u003c/a\u003e实例：“无限滚动”\u003c/h1\u003e\u003cp\u003e很多“信息流”的网站，例如○乎和○浪微博，都实现了无限滚动功能，滑到页面底部就自动再加载一些东西放到时间线上。\u003cdel\u003e于是用户就这样不知不觉沉浸于由算法推荐的“信息饲料”中，出不去了\u003c/del\u003e\u003c/p\u003e\u003cp\u003e加载可以用 AJAX 实现，然后用 Intersection Observer 检查“信息流”的末尾是否出现，出现后就立即加载更多数据。下面的实例中，往下滑啊滑，出现“我们是有底线的”这行字就会自动加载下一个色块了～（为了展示效果，添加了少量的延迟）\u003c/p\u003e\u003cdiv style=\"max-height:200px;overflow-y:auto\" id=\"demo-2-main\"\u003e\u003cdiv id=\"demo-2-timeline\"\u003e\u003cdiv style=\"height:75px;background-color:red\"\u003e\u003c/div\u003e\u003cdiv style=\"height:75px;background-color:green\"\u003e\u003c/div\u003e\u003cdiv style=\"height:75px;background-color:#00f\"\u003e\u003c/div\u003e\u003cdiv style=\"height:75px;background-color:#ff0\"\u003e\u003c/div\u003e\u003c/div\u003e\u003cdiv style=\"text-align:center\" id=\"demo-2-end\"\u003e我们是有底线的\u003c/div\u003e\u003c/div\u003e\u003cscript\u003e!function(e){new IntersectionObserver((function(t){t[0].isIntersecting\u0026\u0026setTimeout((function(){var t=e.createElement(\"div\");t.style.cssText=\"height:75px;background-color:rgb(\"+[1,2,3].map((function(){return Math.floor(256*Math.random())})).join()+\")\",e.getElementById(\"demo-2-timeline\").appendChild(t)}),200)}),{root:e.getElementById(\"demo-2-main\")}).observe(e.getElementById(\"demo-2-end\"))}(document)\u003c/script\u003e\u003cpre class=\"language-javascript line-numbers\" data-language=\"javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e observer \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eIntersectionObserver\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ee\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003ee\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eisIntersecting\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003elet\u003c/span\u003e el \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e document\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecreateElement\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;div\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    el\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003estyle\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ecssText \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token string template-punctuation\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003eheight:75px;background-color:rgb(\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token punctuation interpolation-punctuation\"\u003e${\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u0026gt;\u003c/span\u003e Math\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003efloor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e256\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e Math\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003erandom\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ejoin\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation interpolation-punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e)\u003c/span\u003e\u003cspan class=\"token string template-punctuation\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    document\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;timeline\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eappendChild\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eel\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token property literal-property\"\u003eroot\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e document\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;main\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nobserver\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eobserve\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edocument\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egetElementById\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;end\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003ch1 id=\"实例：视频的“小窗播放”\"\u003e\u003ca href=\"#实例：视频的“小窗播放”\" class=\"headerlink\" title=\"实例：视频的“小窗播放”\"\u003e\u003c/a\u003e实例：视频的“小窗播放”\u003c/h1\u003e\u003cp\u003e这个例子是得到了 \u003ca href=\"https://css-tricks.com/a-few-functional-uses-for-intersection-observer-to-know-when-an-element-is-in-view/#article-header-id-2\" target=\"_blank\" rel=\"noopener\"\u003eCSS-Tricks 的一篇文章\u003c/a\u003e的启发，不过那里面提到的是检测到视频离开窗口就自动暂停播放，其实还可以有更多的功能嘛……(・▽・〃)\u003c/p\u003e\u003cp\u003e经常上睿站看视频的小伙伴应该比较熟悉这个“小窗播放”的功能，在查看评论区的时候视频会自动切换到右下角的一个小窗口继续播放～\u003c/p\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/2674*912),912px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/e7c6cef2e68b834582df38bcdf2d0b17/eKkYSkZQ.jpg\" data-src-webp=\"https://p.sda1.dev/12/732434afad7fd4338815e4627cf8e12a/hyI6CG8_.webp\" data-src-avif=\"https://p.sda1.dev/12/f833008de463a1bfff5e48023499081e/8gp89lQ-.jpg\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAALACADASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAABAUGA//EACYQAAICAQQBAgcAAAAAAAAAAAECAwQFABESIQYTMRQWIkFRYsH/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/EABgRAQEBAQEAAAAAAAAAAAAAAAEAMSFh/9oADAMBAAIRAxEAPwCzrZzP2myDwyY9EhvTwIhqySPxilKAkiVdOPG8rbyq3EurCJILLxc4EKKwTb7MW0Z8qePvYnmNBRJK7O7K7ryLncno63p46njbZipwiJCnIgEnckn86LnIHs64ASsoA9+vY/zSyZGizio049Nqi7Rnr6uZ7GjySJiB0NS9+R5PKKsTndPhIn2/ZZTsdNqX/9k\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/e7c6cef2e68b834582df38bcdf2d0b17/eKkYSkZQ.jpg\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003cp\u003e查看评论区的时候视频会出现在浏览器窗口外面，因此用 Intersection Observer 动态改变视频的位置就能实现上面的效果。我自己写了个简单的实例，点\u003ca href=\"https://jsbin.com/rakovoyexu/edit?html,output\" target=\"_blank\" rel=\"noopener\"\u003e这里\u003c/a\u003e就能查看效果了(´ﾟωﾟ｀)\u003c/p\u003e\u003chr/\u003e\u003cblockquote\u003e\u003cp\u003e \u003cbr/\u003eW3C 呢……\u003cruby\u003e\u003ca href=\"https://github.com/w3c/IntersectionObserver/blob/master/explainer.md\" target=\"_blank\" rel=\"noopener\"\u003e最近\u003c/a\u003e\u003crt\u003e2017 年\u003c/rt\u003e\u003c/ruby\u003e发表了一个报告说呢……浏览器会通过\u003cruby\u003e一些渠道\u003crt\u003eIntersection Observer\u003c/rt\u003e\u003c/ruby\u003e去影响、干预元素的交集，你对这个看法有什么回应呢？\u003c/p\u003e\u003c/blockquote\u003e\u003cp\u003eIntersection Observer 是个比较新的功能，如果问浏览器资词不资词，大多数都是资词的，除了\u003cdel\u003e思想江化的\u003c/del\u003e IE 和（旧版）Safari。\u003c/p\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/1740*767),767px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/a4c2325dd7b4cc912a383dc54983b209/6XyVJpV-.png\" data-src-webp=\"https://p.sda1.dev/12/c1d5f69e8bca28b7c0ddc730f38638fc/jV7c9NrU.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAOACADASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAwYAAQUH/8QAIxAAAQMEAgIDAQAAAAAAAAAAAQIDEQAEEiEFkRNSIzJBgf/EABcBAAMBAAAAAAAAAAAAAAAAAAECAwX/xAAdEQACAgIDAQAAAAAAAAAAAAABAgARAzEEEhMh/9oADAMBAAIRAxEAPwDrYyMxHVESXJCcwP5Stf2HKZl5xdunM4ENlQlO9HVCbt+VCEPh1j4obToSE619azvVgaKwvyMKOyHtY38jtkj2HdTJExmO6x/FzPkBxssPWVz3FW9bci6GiE26ClxKjC17A/NAU5yAShdAxW7I3Qn/2Q\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/a4c2325dd7b4cc912a383dc54983b209/6XyVJpV-.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003cp\u003e为了给这些\u003cdel\u003e思想江化的\u003c/del\u003e浏览器提高姿势水平，可以使用 W3C 钦定的一个 \u003ca href=\"https://github.com/w3c/IntersectionObserver/blob/master/polyfill/intersection-observer.js\" target=\"_blank\" rel=\"noopener\"\u003ePolyfill\u003c/a\u003e。\u003c/p\u003e\u003cpre class=\"language-javascript line-numbers\" data-language=\"javascript\"\u003e\u003ccode class=\"language-javascript\"\u003ewindow\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eIntersectionObserver\u003cspan class=\"token operator\"\u003e||\u003c/span\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ee\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token keyword\"\u003evar\u003c/span\u003e n\u003cspan class=\"token operator\"\u003e=\u003c/span\u003ee\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecreateElement\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#34;script\u0026#34;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003en\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esrc\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#34;https://cdn.jsdelivr.net/gh/w3c/IntersectionObserver/polyfill/intersection-observer.min.js\u0026#34;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003ee\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ebody\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eappendChild\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003en\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edocument\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cblockquote class=\"mdui-m-b-0 mdui-m-x-0 mdui-p-y-1\" style=\"border-left:4px solid rgba(0,0,0,.36)\"\u003e\u003cstrong\u003e本作品采用\u003ca href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh\" target=\"_blank\"\u003e知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议\u003c/a\u003e进行许可。不允许内容农场类网站、CSDN 用户和微信公众号转载。\u003c/strong\u003e\u003cbr/\u003e\u003cstrong\u003e本文作者：✨小透明・宸✨\u003c/strong\u003e\u003cbr/\u003e\u003cstrong\u003e本文链接：\u003ca href=\"https://akarin.dev/2020/03/26/intersection-observer/\"\u003ehttps://akarin.dev/2020/03/26/intersection-observer/\u003c/a\u003e\u003c/strong\u003e\u003c/blockquote\u003e\u003c/article\u003e",
  "Date": "2020-03-26T06:33:08Z",
  "Author": "✨小透明・宸✨"
}