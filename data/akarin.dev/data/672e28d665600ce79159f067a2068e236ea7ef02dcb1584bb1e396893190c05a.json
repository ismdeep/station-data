{
  "Source": "akarin.dev",
  "Title": "在 hexo-theme-material 主题上使用 highlight.js 进行代码高亮/显示行号",
  "Link": "https://akarin.dev/2019/04/19/use-hljs-in-material-theme/",
  "Content": "\u003carticle class=\"mdui-p-a-3 mdui-card-content mdui-typo\"\u003e\u003cp\u003eHexo 自带了在渲染网页时进行代码高亮的功能，现在本站正在使用的主题 \u003ca href=\"https://github.com/viosey/hexo-theme-material\" target=\"_blank\" rel=\"noopener\"\u003eMaterial Theme \u003c/a\u003e也加入了 \u003ca href=\"https://github.com/google/code-prettify\" target=\"_blank\" rel=\"noopener\"\u003eprettify.js\u003c/a\u003e 和 \u003ca href=\"https://github.com/egoist/hanabi\" target=\"_blank\" rel=\"noopener\"\u003ehanabi\u003c/a\u003e 两种代码高亮工具的支持。\u003c/p\u003e\u003cp\u003e然鹅小透明出于以下理由还是想折腾一下，使用 \u003ca href=\"https://highlightjs.org/\" target=\"_blank\" rel=\"noopener\"\u003ehighlight.js\u003c/a\u003e 来进行代码高亮～\u003c/p\u003e\u003cul\u003e\u003cli\u003e不知道是哪里出了问题，Hexo 自带的代码高亮完全没有任何效果( ｡･_･｡)\u003c/li\u003e\u003cli\u003ehanabi 的颜色过于鲜艳，而且不论类型对每一块代码的着色似乎是完全随机的？！Σ（ﾟдﾟlll）\u003c/li\u003e\u003cli\u003eprettify.js 的效果其实也不算差啦～( ๑´•ω•)۶\u003c/li\u003e\u003cli\u003ehighlight.js 有\u003cdel\u003e宇宙第一 IDE\u003c/del\u003e Visual Studio 的配色主题！_(•̀ω•́ 」∠)_\u003cdel\u003e好像这个才是真实原因吧\u003c/del\u003e\u003c/li\u003e\u003c/ul\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/778*224),224px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/225ebe60b8f3175343e545499b26f65f/__7_nbt3.png\" data-src-webp=\"https://p.sda1.dev/12/710129d213f05e88ce20510e4430d3d1/cwI1g2vW.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAJACADASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAcBAgP/xAAiEAACAgAEBwAAAAAAAAAAAAAAAQIDByFFlBESF0GRwtL/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8Aerr5Z5yln4N1VJl13ABHLFyt6LLc8PQOsNS0OW4XwJBkAf/Z\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/225ebe60b8f3175343e545499b26f65f/__7_nbt3.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003cp\u003e左上是 Hexo 自带的\u003cdel\u003e高亮\u003c/del\u003e（根本没有颜色），右上是 hanabi，左下是使用了 \u003ccode\u003eGitHub v2\u003c/code\u003e 主题的 prettify.js，右下是使用了 \u003ccode\u003eVS 2015\u003c/code\u003e 主题（以及按这里的步骤进行魔改后）的 highlight.js。\u003c/p\u003e\u003cp\u003e吐槽一下，代码高亮工具并不能做到和 IDE 的效果一模一样……比如 \u003ccode\u003eputs()\u003c/code\u003e 是个函数，结果还是被 hanabi 和 highlight.js 着色了(っ ̯ -｡)\u003c/p\u003e\u003ch1 id=\"引入-highlight-js\"\u003e\u003ca href=\"#引入-highlight-js\" class=\"headerlink\" title=\"引入 highlight.js\"\u003e\u003c/a\u003e引入 highlight.js\u003c/h1\u003e\u003cp\u003e首先要把 Hexo 和 Material Theme 自带的高亮关掉(。・`ω´・)\u003c/p\u003e\u003cpre class=\"line-numbers language-yaml\" data-language=\"yaml\"\u003e\u003ccode class=\"language-yaml\"\u003e\u003cspan class=\"token comment\"\u003e# Writing\u003c/span\u003e\n\u003cspan class=\"token atrule key\"\u003ehighlight\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"token atrule key\"\u003eenable\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token important boolean\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"token atrule key\"\u003eline_number\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token important boolean\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"token atrule key\"\u003eauto_detect\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token important boolean\"\u003efalse\u003c/span\u003e\n  tab_replace\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cpre class=\"line-numbers language-yaml\" data-language=\"yaml\"\u003e\u003ccode class=\"language-yaml\"\u003e\u003cspan class=\"token comment\"\u003e# Code highlight\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e#   Prettify\u003c/span\u003e\n\u003cspan class=\"token atrule key\"\u003eprettify\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"token atrule key\"\u003eenable\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token important boolean\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"token atrule key\"\u003etheme\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#34;github-v2\u0026#34;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e#   Hanabi (https://github.com/egoist/hanabi)\u003c/span\u003e\n\u003cspan class=\"token atrule key\"\u003ehanabi\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n  \u003cspan class=\"token atrule key\"\u003eenable\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token important boolean\"\u003efalse\u003c/span\u003e\n  \u003cspan class=\"token atrule key\"\u003eline_number\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token important boolean\"\u003etrue\u003c/span\u003e\n  \u003cspan class=\"token atrule key\"\u003eincludeDefaultColors\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token important boolean\"\u003etrue\u003c/span\u003e\n  customColors\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e然后在生成的网页上引入 highlight.js 的本体和主题( つ•̀ω•́)つ\u003c/p\u003e\u003cp\u003e涉及到的页面模板的路径为 \u003ccode\u003e\\themes\\hexo-theme-material\\layout\\_partial\u003c/code\u003e 目录下的 \u003ccode\u003eimport_js.ejs\u003c/code\u003e 和 \u003ccode\u003econfig_css.ejs\u003c/code\u003e 两个文件，把下面的代码（也可以修改 CSS 使用别的主题）写在文件的最后面。\u003c/p\u003e\u003cp\u003e\u003cdel\u003e\u003ca href=\"https://www.jsdelivr.com/\" target=\"_blank\" rel=\"noopener\"\u003ejsDelivr\u003c/a\u003e 是本站唯一钦定的前端资源公用 CDN 库\u003c/del\u003e\u003c/p\u003e\u003cpre class=\"line-numbers language-markup\" data-language=\"markup\"\u003e\u003ccode class=\"language-markup\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003escript\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003esrc\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003ehttps://cdn.jsdelivr.net/gh/highlightjs/cdn-release@latest/build/highlight.min.js\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token script\"\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003escript\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003escript\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token script\"\u003e\u003cspan class=\"token language-javascript\"\u003e\n    hljs\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003einitHighlightingOnLoad\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003escript\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cpre class=\"line-numbers language-markup\" data-language=\"markup\"\u003e\u003ccode class=\"language-markup\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003elink\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003erel\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003estylesheet\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003ehref\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003ehttps://cdn.jsdelivr.net/gh/highlightjs/cdn-release@latest/build/styles/vs2015.min.css\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e按理来说，这样就已经可以有 highlight.js 的代码高亮效果了……但是官网的演示中，\u003ccode\u003eVS 2015\u003c/code\u003e 主题下代码块的背景色应该是黑色，这里怎么还是白色背景呢？(っ’-‘)╮\u003c/p\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/280*108),108px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/b4c56c3c92e9ba4d53cbdd0ada51659a/ZNYIkiqA.png\" data-src-webp=\"https://p.sda1.dev/12/8e8871515d0c27c4d3d8fef4965ce679/JCy7T1yA.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAMACADASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIH/8QAGRABAQEBAQEAAAAAAAAAAAAAAAECESEx/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhEDEQA/AN01bn3pNW/J1YAAD//Z\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/b4c56c3c92e9ba4d53cbdd0ada51659a/ZNYIkiqA.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003cp\u003ehighlight.js 默认对 \u003ccode\u003e\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;...\u0026lt;/code\u0026gt;\u0026lt;pre\u0026gt;\u003c/code\u003e 的代码块着色，然后会给 \u003ccode\u003e\u0026lt;code\u0026gt;\u003c/code\u003e 加上类 \u003ccode\u003ehljs\u003c/code\u003e，主题的背景色写进了 CSS 的 \u003ccode\u003e.hljs\u003c/code\u003e \u003cstrong\u003e类选择器\u003c/strong\u003e。然而 Material Theme 的文章本体包含在 \u003ccode\u003e\u0026lt;div id=\u0026#34;post-content\u0026#34;\u0026gt;\u003c/code\u003e中，代码块背景色写进了 CSS 的 \u003ccode\u003e#post-content pre\u003c/code\u003e 选择器，有一个 \u003cstrong\u003eID 选择器\u003c/strong\u003e，自然要优先于 \u003ccode\u003ehljs\u003c/code\u003e 这个类选择器了。\u003c/p\u003e\u003cp\u003e简单直接的解决方法就是把背景色等被覆盖的样式再抄一遍，然后加上 \u003ccode\u003e!important\u003c/code\u003e 提高优先级咯～（*‘ε·*）\u003c/p\u003e\u003cpre class=\"line-numbers language-css\" data-language=\"css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token comment\"\u003e/* highlight.js: vs2015.css */\u003c/span\u003e\n\u003cspan class=\"token selector\"\u003e.hljs\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e/* 其余部分略 */\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e #1e1e1e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e/* Material Theme: style.css*/\u003c/span\u003e\n\u003cspan class=\"token selector\"\u003e#post-content pre\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e/* 其余部分略 */\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e #f7f7f7\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e/* 在config_css.ejs中加入的内容，使用!important提高优先级 */\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e/* 如果不使用公用CDN库，可以直接修改CSS文件 */\u003c/span\u003e\n\u003cspan class=\"token selector\"\u003epre\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ebackground-color\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e #1e1e1e \u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003efont-size\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e 15px \u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token selector\"\u003e.hljs\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003emargin\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e 0 0 0 0 \u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003epadding-left\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e 0 \u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003eline-height\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e 1.5em \u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e/* （可选）把highlight.js主题加入的斜体去掉，Visual Studio的注释并不是斜体啊喂！ */\u003c/span\u003e\n\u003cspan class=\"token selector\"\u003e.hljs-comment\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003efont-style\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e normal\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e到这里，文章中代码的颜色就已经是 Visual Studio 的形状了～٩( ‘ω’ )و\u003c/p\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/280*108),108px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/f71d05d5b8ec5a734fa37e8260d4965f/k6ZJOYCT.png\" data-src-webp=\"https://p.sda1.dev/12/88589591bd5042d0b5bc90d02bf78992/B-5eh2Bn.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAMACADASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAIBAwQH/8QAHRABAAMAAQUAAAAAAAAAAAAAAQACEQMSQnGBkf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/xAAVEQEBAAAAAAAAAAAAAAAAAAAAQf/aAAwDAQACEQMRAD8A5JwtWwPHV8i78SWX46pZzpDO1mVdyRBTpQHL76iQhA//2Q\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/f71d05d5b8ec5a734fa37e8260d4965f/k6ZJOYCT.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003ch1 id=\"为-highlight-js-添加行号显示功能\"\u003e\u003ca href=\"#为-highlight-js-添加行号显示功能\" class=\"headerlink\" title=\"为 highlight.js 添加行号显示功能\"\u003e\u003c/a\u003e为 highlight.js 添加行号显示功能\u003c/h1\u003e\u003cp\u003e\u003cdel\u003eprettify.js 已经自带行号显示了\u003c/del\u003e\u003c/p\u003e\u003cp\u003ehighlight.js 本身没有行号显示功能，开发者甚至\u003ca href=\"https://highlightjs.readthedocs.io/en/latest/line-numbers.html\" target=\"_blank\" rel=\"noopener\"\u003e在说明书中专门写了几段话\u003c/a\u003e说明自己为什么不愿意加入这个功能←_←\u003c/p\u003e\u003cblockquote\u003e\u003cp\u003eMany highlighters, in my opinion, are overdoing it with such things as separate colors for every single type of lexemes, striped backgrounds, fancy buttons around code blocks and — yes — line numbers. The more fancy stuff resides around the code the more it distracts a reader from understanding it.\u003cbr/\u003eThis is why it’s not a straightforward decision: this new feature will not just make highlight.js better, it might actually make it worse simply by making it look more bloated in blog posts around the Internet.\u003c/p\u003e\u003c/blockquote\u003e\u003cp\u003e嗯……别人可以不用，但是你不能没有啊(⑉･̆-･̆⑉)\u003c/p\u003e\u003cp\u003e不过加上行号也不难，HTML 的有序列表 \u003ccode\u003e\u0026lt;ol\u0026gt;\u003c/code\u003e 可以在列表的每一项前面显示一个序号。把每一行代码写进 \u003ccode\u003e\u0026lt;li\u0026gt;\u003c/code\u003e 放进这个有序列表里面，显示的序号就相当于行号了。实际上 prettify.js 的行号显示就是这么实现的～\u003c/p\u003e\u003cp\u003e从\u003ca href=\"https://juejin.im/entry/5b3047db6fb9a00e523989fc#5\" target=\"_blank\" rel=\"noopener\"\u003e这里\u003c/a\u003e找到了一段 JS，在使用 \u003ccode\u003ehljs.initHighlightingOnLoad()\u003c/code\u003e 进行高亮之前，可以通过 \u003ccode\u003e\u0026lt;li\u0026gt;\u003c/code\u003e 标签替换换行符 \u003ccode\u003e\\n\u003c/code\u003e，把代码弄成有序列表的形式。\u003c/p\u003e\u003cpre class=\"line-numbers language-javascript\" data-language=\"javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token comment\"\u003e//Material Theme主题本身已经用到了jQuery，可以直接使用\u003c/span\u003e\n\u003cspan class=\"token function\"\u003e$\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#34;pre code\u0026#34;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eeach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003e$\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ehtml\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#34;\u0026lt;ol\u0026gt;\u0026lt;li\u0026gt;\u0026#34;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token function\"\u003e$\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ehtml\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ereplace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token regex\"\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token language-regex regex-source\"\u003e\\n\u003c/span\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token regex-flags\"\u003eg\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#34;\\n\u0026lt;/li\u0026gt;\u0026lt;li\u0026gt;\u0026#34;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#34;\\n\u0026lt;/li\u0026gt;\u0026lt;/ol\u0026gt;\u0026#34;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e//不过，如果不想使用jQuery，而是使用原生JS实现的话……\u003c/span\u003e\nArray\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003efrom\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edocument\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003equerySelectorAll\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#34;pre code\u0026#34;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eforEach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ecodeBlock\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    codeBlock\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einnerHTML \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#34;\u0026lt;ol\u0026gt;\u0026lt;li\u0026gt;\u0026#34;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e codeBlock\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einnerHTML\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ereplace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token regex\"\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token language-regex regex-source\"\u003e\\n\u003c/span\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token regex-flags\"\u003eg\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#34;\\n\u0026lt;/li\u0026gt;\u0026lt;li\u0026gt;\u0026#34;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#34;\\n\u0026lt;/li\u0026gt;\u0026lt;/ol\u0026gt;\u0026#34;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e//IE11不支持使用Array.from，所以也可以用这种写法代替\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eslice\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecall\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edocument\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003equerySelectorAll\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#34;pre code\u0026#34;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eforEach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ecodeBlock\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    codeBlock\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einnerHTML \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#34;\u0026lt;ol\u0026gt;\u0026lt;li\u0026gt;\u0026#34;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e codeBlock\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einnerHTML\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ereplace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token regex\"\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token language-regex regex-source\"\u003e\\n\u003c/span\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token regex-flags\"\u003eg\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#34;\\n\u0026lt;/li\u0026gt;\u0026lt;li\u0026gt;\u0026#34;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#34;\\n\u0026lt;/li\u0026gt;\u0026lt;/ol\u0026gt;\u0026#34;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/298*189),189px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/05075b51a2dd4f4bf8ea60beaf8aa0a8/8wTKTtk-.png\" data-src-webp=\"https://p.sda1.dev/12/eb6fa54a50090302039e62ff6ff02470/JJmDl_px.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAUACADASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAMH/8QAIBAAAgAGAgMAAAAAAAAAAAAAAAECAxESITFBUQQicf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwDILVRNt5T4LPx+r2+nBQk0rIXrD43kKZr0hAOTNW5cS+omAAAAAAAf/9k\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/05075b51a2dd4f4bf8ea60beaf8aa0a8/8wTKTtk-.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003cp\u003e效果已经很不错了！ᕦ( ᐛ )ᘎ\u003c/p\u003e\u003cp\u003e不过还有些不完美的地方……这个代码块的上下边距比较大（调整 \u003ccode\u003emargin\u003c/code\u003e 或 \u003ccode\u003epadding\u003c/code\u003e 就可以解决）、最后还多出了一个空行、和 Visual Studio 的行号显示还是有点差别：Visual Studio 的黑色主题中行号是水蓝色的，而且数字的后面没有点。\u003c/p\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/423*258),258px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/e321c6b80f3c36ba5e73d762368936ca/OJc_f9QT.png\" data-src-webp=\"https://p.sda1.dev/12/eb9776bf601a8ba711144eeb9ffaa408/qFEqF8NJ.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAUACADASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIDBAb/xAAlEAACAgEDAwQDAAAAAAAAAAABAgADEQQhMRIycRQiQVFCUmH/xAAWAQEBAQAAAAAAAAAAAAAAAAADAAH/xAAdEQACAQQDAAAAAAAAAAAAAAAAEgIRISMxAXGB/9oADAMBAAIRAxEAPwDg0rtuVGOjsZFrCZVQOPnIWSdEqSo2VEHfIIx1eMrMja/V1hQtnIPKg8DHzJJbqLMDuOM90XEupN5QLM+4L1c0odO7e8dO+ck7Y+tlin03SxCnJ4HV2+dt5ke24DZGH95kfUXfcOvAtxrvw8GS6ipBH6iEJEKXY8mLCEwj/9k\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/e321c6b80f3c36ba5e73d762368936ca/OJc_f9QT.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003cp\u003e\u003ccode\u003e\u0026lt;ol\u0026gt;\u003c/code\u003e 和 \u003ccode\u003e\u0026lt;ul\u0026gt;\u003c/code\u003e 有个名为 \u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/list-style-type\" target=\"_blank\" rel=\"noopener\"\u003e\u003ccode\u003elist-style-type\u003c/code\u003e\u003c/a\u003e 的 CSS 属性可以改变列表前面的序号格式，不过没有只有数字的样式，而且序号的颜色只能和列表内的文本颜色一样，所以要实现 Visual Studio 的行号显示大概不能指望这个了……_(:_」∠)_\u003c/p\u003e\u003cp\u003e小透明后来从 Stack Overflow 上找到了\u003ca href=\"https://stackoverflow.com/questions/40842277/create-line-numbers-on-pre-with-css-only\" target=\"_blank\" rel=\"noopener\"\u003e另外一个方法\u003c/a\u003e～\u003c/p\u003e\u003cp\u003e这个方法的原理是对每一行使用 CSS 的 \u003ccode\u003e:before\u003c/code\u003e 伪元素。\u003ccode\u003e:before\u003c/code\u003e 和 \u003ccode\u003e:after\u003c/code\u003e 两个伪元素可以在网页上的\u003cstrong\u003e元素内部\u003c/strong\u003e的前面和后面添加内容，CSS 还有 \u003ccode\u003ecounter()\u003c/code\u003e 函数和 \u003ccode\u003ecounter-reset\u003c/code\u003e、\u003ccode\u003ecounter-increment\u003c/code\u003e 两个属性，配合起来可以实现“计数器”的效果，于是就可以对每一行进行计数（相当于行号），并显示在每一行开头的 \u003ccode\u003e:before\u003c/code\u003e 里面|ω•`)\u003c/p\u003e\u003cp\u003e用伪元素实现行号后，也就不需要添加 \u003ccode\u003e\u0026lt;ol\u0026gt;\u003c/code\u003e 了。复制代码的时候也不会复制到行号，因为伪元素是不能被选中的。\u003c/p\u003e\u003cpre class=\"line-numbers language-javascript\" data-language=\"javascript\"\u003e\u003ccode class=\"language-javascript\"\u003e\u003cspan class=\"token comment\"\u003e//使用jQuery实现\u003c/span\u003e\n\u003cspan class=\"token function\"\u003e$\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#34;pre code\u0026#34;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eeach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003e$\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ehtml\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#34;\u0026lt;li\u0026gt;\u0026#34;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token function\"\u003e$\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ehtml\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ereplace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token regex\"\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token language-regex regex-source\"\u003e\\n\u003c/span\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token regex-flags\"\u003eg\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#34;\\n\u0026lt;/li\u0026gt;\u0026lt;li\u0026gt;\u0026#34;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#34;\\n\u0026lt;/li\u0026gt;\u0026#34;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e//使用原生JS实现\u003c/span\u003e\nArray\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003efrom\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edocument\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003equerySelectorAll\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#34;pre code\u0026#34;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eforEach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003ecodeBlock\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    codeBlock\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einnerHTML \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#34;\u0026lt;li\u0026gt;\u0026#34;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e codeBlock\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einnerHTML\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ereplace\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token regex\"\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token language-regex regex-source\"\u003e\\n\u003c/span\u003e\u003cspan class=\"token regex-delimiter\"\u003e/\u003c/span\u003e\u003cspan class=\"token regex-flags\"\u003eg\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#34;\\n\u0026lt;/li\u0026gt;\u0026lt;li\u0026gt;\u0026#34;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#34;\\n\u0026lt;/li\u0026gt;\u0026#34;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cpre class=\"line-numbers language-css\" data-language=\"css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token selector\"\u003e.hljs\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003emargin\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e 0 0 0 0 \u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003epadding-left\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e 0 \u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003eline-height\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e 1.5em \u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003elist-style\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e none \u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ecounter-reset\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e item\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* 为每个代码块指定名为item的计数器，计数从0开始 */\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token selector\"\u003e.hljs \u0026gt; li:before\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003econtent\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"token function\"\u003ecounter\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eitem\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* 在伪元素中显示计数器item的值 */\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ecounter-increment\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e item\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* 计数器item的值+1 */\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003edisplay\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e inline-block\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* 实现Visual Studio行号右对齐的效果 */\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003etext-align\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e right\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* 实现Visual Studio行号右对齐的效果 */\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003emin-width\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e 2em\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* 文章中行号一般不会超过两位数，所以设定行号区的宽度为两个数字 */\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003emargin-right\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e 1em\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* 行号和代码有一个字符的间隔 */\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ecolor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e #2b91af\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* Visual Studio的行号颜色 */\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e最后的空行很容易解决。CSS 有 \u003ccode\u003e:last-of-type\u003c/code\u003e 选择器，指定符合选择条件的最后一个元素，正好可以用来隐藏掉最后的空行～\u003c/p\u003e\u003cpre class=\"line-numbers language-css\" data-language=\"css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token selector\"\u003e.hljs \u0026gt; li:last-of-type\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003edisplay\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e none\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e这样就实现了一开始那张图的效果了！不考虑那个绿色的 \u003ccode\u003eputs()\u003c/code\u003e，这个代码高亮效果和 Visual Studio 已经一模一样了～\u003c/p\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/280*122),122px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/4b8eb09b95468d9bfd8e11d0eb5443fe/7N-9KTgI.png\" data-src-webp=\"https://p.sda1.dev/12/0bcd07f97ef2510a5ae9ac955c2a723b/x9Kg7tN2.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAOACADASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMEAQf/xAAfEAEAAgEEAwEAAAAAAAAAAAABAhEAAyExQVFSYeH/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/EABURAQEAAAAAAAAAAAAAAAAAAAAh/9oADAMBAAIRAxEAPwDj5XL5yiBoMFYF37/mTiDuXvgTnEomh8cJTHSPeBx24qRXY7dYMpSq1aKL8GZhX//Z\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/4b8eb09b95468d9bfd8e11d0eb5443fe/7N-9KTgI.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003cp\u003e另外，在使用 Markdown 进行写作的时候，指定某个代码块的语言类型为 \u003ccode\u003eplain\u003c/code\u003e 或 \u003ccode\u003etext\u003c/code\u003e 可以让 highlight.js 不对这个代码块进行操作。这些没有被着色的代码块不会被加上类 \u003ccode\u003ehljs\u003c/code\u003e，所以需要再添加一些 CSS 进行特殊处理(´っω･｡｀)\u003c/p\u003e\u003cpre class=\"line-numbers language-css\" data-language=\"css\"\u003e\u003ccode class=\"language-css\"\u003e\u003cspan class=\"token selector\"\u003e.hljs \u0026gt; li:last-of-type, code.plain \u0026gt; li:last-of-type, code.text \u0026gt; li:last-of-type\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003edisplay\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e none\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token selector\"\u003ecode.plain, code.text\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003elist-style\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e none \u003cspan class=\"token important\"\u003e!important\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* 不显示行号 */\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003ecolor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e #dcdcdc\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* 和着色后代码的主要颜色相同 */\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003edisplay\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e block\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* 左右滚动代码块 */\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003eoverflow-x\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e auto\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e/* 左右滚动代码块 */\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/450*127),127px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/35588deea3c94b17c80469756c5bed5c/PVhFp1rb.png\" data-src-webp=\"https://p.sda1.dev/12/1bf704d9b5bd7841d945f4bb0d2bd9a0/HA56bNM7.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAJACADASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAIBAwQH/8QAHhAAAwEAAAcAAAAAAAAAAAAAAAECEQMSITEyQXH/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8A5Bs9dQrz0iAA0zfB5cuXu90kUU4fjLX16KAH/9k\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/35588deea3c94b17c80469756c5bed5c/PVhFp1rb.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003cp\u003e不进行处理的效果是左边，处理后的效果是右边～\u003c/p\u003e\u003cblockquote class=\"mdui-m-b-0 mdui-m-x-0 mdui-p-y-1\" style=\"border-left:4px solid rgba(0,0,0,.36)\"\u003e\u003cstrong\u003e本作品采用\u003ca href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh\" target=\"_blank\"\u003e知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议\u003c/a\u003e进行许可。不允许内容农场类网站、CSDN 用户和微信公众号转载。\u003c/strong\u003e\u003cbr/\u003e\u003cstrong\u003e本文作者：✨小透明・宸✨\u003c/strong\u003e\u003cbr/\u003e\u003cstrong\u003e本文链接：\u003ca href=\"https://akarin.dev/2019/04/19/use-hljs-in-material-theme/\"\u003ehttps://akarin.dev/2019/04/19/use-hljs-in-material-theme/\u003c/a\u003e\u003c/strong\u003e\u003c/blockquote\u003e\u003c/article\u003e",
  "Date": "2019-04-19T04:25:07Z",
  "Author": "✨小透明・宸✨"
}