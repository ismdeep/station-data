{
  "Source": "akarin.dev",
  "Title": "使用 waifu2x-caffe 和 ImageMagick 放大 GIF 动图",
  "Link": "https://akarin.dev/2019/11/23/powershell-waifu2xgif/",
  "Content": "\u003carticle class=\"mdui-p-a-3 mdui-card-content mdui-typo\"\u003e\u003cblockquote\u003e\u003cp\u003e封面图：\u003ca href=\"https://www.pixiv.net/artworks/65506510\" target=\"_blank\" rel=\"noopener\"\u003ePixiv ID: 65506510 「干物妹!うまるちゃん」 by にゃー\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\u003cp\u003e因为收集了很多\u003cdel\u003e萌萌的\u003c/del\u003e动图表情包，然鹅它们的分辨率都太低了，所以就有了将这些表情包高清化的想法(๑‾ ꇴ ‾๑)\u003c/p\u003e\u003cp\u003e比如下面的这只小埋，分辨率就只有 176x180……\u003c/p\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/176*180),180px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/8c7c5f0484037372802a6e4ade6a5e41/6INczE-R.gif\" data-src-webp=\"https://p.sda1.dev/12/b4636ff0252f8a1cefb4ee6b1c8126b3/1iDgMzo_.jpg\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAgBAMAAAAYrL5yAAAAMFBMVEWtcUXwfVWaX0CMVj26hlB+TTrGbk3ed1LVrJLzw6bVx7zu3NCpkITclW/x9PNUNSdeCpz7AAAACXBIWXMAAAPoAAAD6AG1e1JrAAABtklEQVR42i2QMWsUQRTHXzbLFlZ5FtkqsMxAKosww1YWWcNgrDNsEy1cgxexchXc6gpByO4dansbtJXDC6doY+5ABE0hWZWAGE/IF7C4L2DjfzYuuwPvN7//25lHQmsdC6mVTK22aUpCK70llBRxbN1LQgmpBFadQoUhhdBCSiW1S8SIuF1FHS9Gs7aHgJMx8z0kHADpuJp5R8Wuh+dFu7OTZYCutHFr0MKMQ4CV2zbFb73Iy8OzX09y5otauwgRXyvrwSDn5fYcEQUrZVU/r/eYYViiZHU2PBz0SijSAUNB9er94Pigf4V3YqsdKI++7B811eY5SCjovb7cf7ddX+UHOD7Aau/Z9dH3vw5YIYgo2H/Rn749rje5wLXIJ6rq6fSwrk+4WFKtcaea9KaTxzkXDCPxqZN1f5SnPwMO81swkoC7e2dfi2L3HPhJxnc/3hwPT91MAIzJ+PewGX14mTsgySRZ+G0+n4z+OOABmIX7zdM5nkfMYQs21psb4/nB+A0GvagAKBkK8Wnr0nr2kOQagG8+A17QNopIRGhqjEl802B2RGv0HyC4gdoDRAIVPkybFon+ASwjllTE1gLvAAAAAElFTkSuQmCC\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/8c7c5f0484037372802a6e4ade6a5e41/6INczE-R.gif\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003cp\u003e放大动漫图片一般都是使用 waifu2x 算法，因为自己有 N 卡所以会使用 N 卡专用的 \u003ca href=\"https://github.com/lltcggie/waifu2x-caffe\" target=\"_blank\" rel=\"noopener\"\u003ewaifu2x-caffe\u003c/a\u003e，虽然能把 GIF 拖进去但是放大后的图片会变成\u003cstrong\u003e只有第一帧的静态图片\u003c/strong\u003e，所以就需要别的方法了。\u003c/p\u003e\u003cp\u003e在 Google 上找了一下，找到了\u003ca href=\"https://web.archive.org/web/20200807215107/https://nichijou.date/archives/6/gif2x.html\" target=\"_blank\" rel=\"noopener\"\u003e这篇文章\u003c/a\u003e，尝试用 ImageMagick 把 GIF 的每一帧拆出来，使用 waifu2x 放大每一张图以后再拼回去，倒是个不错的想法（我好像用类似的方法，不过是用来放大视频 233）\u003c/p\u003e\u003cp\u003e因为步骤还是有些繁琐，所以原文也写了若干个 \u003cstrong\u003eBash 脚本\u003c/strong\u003e来自动完成使用 ImageMagick 拆图和生成 GIF 的步骤，不过 waifu2x-caffe 明明是 Windows 上的软件，难道作者是想着把图片从 Linux 复制到 Windows 里面，放大以后再拼回去？还是有点麻烦，所以就打算自己写个 PowerShell 脚本，自动在 Windows 系统内直接完成所有操作∠( ᐛ 」∠)_\u003c/p\u003e\u003cp\u003e在写脚本之前，首先需要准备两个软件：\u003c/p\u003e\u003col\u003e\u003cli\u003e\u003ca href=\"https://github.com/lltcggie/waifu2x-caffe/releases\" target=\"_blank\" rel=\"noopener\"\u003ewaifu2x-caffe\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"https://imagemagick.org/script/download.php#windows\" target=\"_blank\" rel=\"noopener\"\u003eImageMagick\u003c/a\u003e\u003c/li\u003e\u003c/ol\u003e\u003cp\u003e对于 waifu2x-caffe，\u003cstrong\u003e只有 N 卡才可以使用 GPU 加速\u003c/strong\u003e，A 或 I 卡用户就只能选择\u003cdel\u003e慢如蜗牛\u003c/del\u003e的 CPU 计算了，当然也可以另请高明，使用其它调用 waifu2x 算法的软件～\u003c/p\u003e\u003cp\u003eN 卡用户还可以考虑开启 cuDNN 继续提速，只需要找一个 \u003ca href=\"https://alilin-my.sharepoint.com/personal/ebolyhgj_xlu_me/_layouts/15/download.aspx?share=EU0iM7-ZePZCm_sBJ2sVU1kBO5HHL5AnkvYnMxR1g4h6hg\" target=\"_blank\" rel=\"noopener\"\u003e\u003ccode\u003ecudnn64_7.dll\u003c/code\u003e\u003c/a\u003e 和 \u003ccode\u003ewaifu2x-caffe.exe\u003c/code\u003e 放在同一个目录就可以了。\u003c/p\u003e\u003ch1 id=\"指定路径\"\u003e\u003ca href=\"#指定路径\" class=\"headerlink\" title=\"指定路径\"\u003e\u003c/a\u003e指定路径\u003c/h1\u003e\u003cp\u003ewaifu2x-caffe 有图形界面，不过脚本里调用的是它的命令行版程序。先在脚本里指定一些路径：\u003c/p\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u003cspan class=\"token comment\"\u003e# waifu2x-caffe和ImageMagick的程序路径\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Waifu2xCUIPath\u003c/span\u003e = \u003cspan class=\"token string\"\u003e\u0026#39;D:\\waifu2x-caffe\\waifu2x-caffe-cui.exe\u0026#39;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$MagickPath\u003c/span\u003e = \u003cspan class=\"token string\"\u003e\u0026#39;D:\\ImageMagick-7.0.8-Q16-HDRI\\magick.exe\u0026#39;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 将路径转换为绝对路径\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$InputFile\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$ExecutionContext\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eSessionState\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ePath\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eGetUnresolvedProviderPathFromPSPath\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$InputFile\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$OutputFile\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$ExecutionContext\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eSessionState\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ePath\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eGetUnresolvedProviderPathFromPSPath\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$OutputFile\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 指定GIF帧的保存路径\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$InputDirectory\u003c/span\u003e = \u003cspan class=\"token namespace\"\u003e[IO.Path]\u003c/span\u003e::GetDirectoryName\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$InputFile\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$OutputDirectory\u003c/span\u003e = \u003cspan class=\"token namespace\"\u003e[IO.Path]\u003c/span\u003e::GetDirectoryName\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$OutputFile\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$SourceDirectory\u003c/span\u003e = \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$InputDirectory\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;\\temp_frames_source\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$UpscaledDirectory\u003c/span\u003e = \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$InputDirectory\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;\\temp_frames_upscaled\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003ch1 id=\"拆分图片\"\u003e\u003ca href=\"#拆分图片\" class=\"headerlink\" title=\"拆分图片\"\u003e\u003c/a\u003e拆分图片\u003c/h1\u003e\u003cp\u003eGIF 图片把帧拆出来不难，但是除了每一帧的图片，还应该把每一帧的时间信息保存下来，否则就没办法把放大后的图片拼回 GIF 了。ImageMagick 的 identify 工具可以获取 GIF 每一帧的时间，还可以使用类似于 \u003ccode\u003eprintf()\u003c/code\u003e 的格式化字符串自定义输出。为了方便起见，这里就直接把输出格式自定义为\u003cstrong\u003e后面合成 GIF 时需要的参数\u003c/strong\u003e：\u003c/p\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u0026amp;\u003cspan class=\"token variable\"\u003e$MagickPath\u003c/span\u003e identify \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eformat \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#34;-delay %T \\`\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$UpscaledDirectory\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eReplace\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;\\\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;\\\\\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#34;\\\\frame-%s.png\\`\u0026#34; \u0026#34;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$InputFile\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e把上面的小埋丢进来，得到的输出是这样的（已添加换行）：\u003c/p\u003e\u003cpre class=\"line-numbers language-none\"\u003e\u003ccode class=\"language-none\"\u003e-delay 10 \u0026#34;C:\\Users\\Admin\\Desktop\\temp_frames_upscaled\\frame-0.png\u0026#34;\n-delay 10 \u0026#34;C:\\Users\\Admin\\Desktop\\temp_frames_upscaled\\frame-1.png\u0026#34;\n-delay 10 \u0026#34;C:\\Users\\Admin\\Desktop\\temp_frames_upscaled\\frame-2.png\u0026#34;\n-delay 10 \u0026#34;C:\\Users\\Admin\\Desktop\\temp_frames_upscaled\\frame-3.png\u0026#34;\n...\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e从这里也可以看出，原图中的每一帧的时间都是 0.1 秒。可以将这些输出保存到文件中，只要添加管道输出 \u003ccode\u003eOut-File ($InputDirectory + \u0026#39;\\\u0026#39; + [IO.Path]::GetFileNameWithoutExtension($InputFile) +\u0026#39;.txt\u0026#39;) -Encoding utf8\u003c/code\u003e 就可以了。\u003c/p\u003e\u003cp\u003e然后就是拆图的操作：\u003c/p\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-not\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003eTest-Path\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$SourceDirectory\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    mkdir \u003cspan class=\"token variable\"\u003e$SourceDirectory\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e|\u003c/span\u003e \u003cspan class=\"token function\"\u003eOut-Null\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u0026amp;\u003cspan class=\"token variable\"\u003e$MagickPath\u003c/span\u003e convert \u003cspan class=\"token operator\"\u003e-\u003c/span\u003ecoalesce \u003cspan class=\"token variable\"\u003e$InputFile\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$SourceDirectory\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;\\frame.png\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e|\u003c/span\u003e \u003cspan class=\"token function\"\u003eOut-Null\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cblockquote\u003e\u003cp\u003e\u003ca href=\"https://aotu.io/notes/2018/06/06/ImageMagick_intro/\" target=\"_blank\" rel=\"noopener\"\u003e《图像处理 - ImageMagick 简单介绍与案例》\u003c/a\u003e：\u003c/p\u003e\u003cp\u003e“-coalesce：根据图像 -dispose 元数据的设置覆盖图像序列中的每个图像，以重现动画序列中每个点的动画效果。下面用一张结果对比图来解释这句话。”\u003c/p\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/1349*1346),1346px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/0db6a7154110745dc03948dbb7d6b60e/S3Engglm.jpg\" data-src-webp=\"https://p.sda1.dev/12/fbddfb37b45213efae33514df4c5f1f5/ewhOhe2U.webp\" data-src-avif=\"https://p.sda1.dev/12/e2e6b234392bd3efc44078a65df84cdb/SZN28xZL.avif\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAgACADASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAABQQDBgL/xAAkEAACAgEFAAIDAQEAAAAAAAABAgMEBQAGERIhEzEHQlEUIv/EABcBAAMBAAAAAAAAAAAAAAAAAAABAgP/xAAdEQACAgIDAQAAAAAAAAAAAAAAARExAhIhIiNx/9oADAMBAAIRAxEAPwBHdm6s3S3Bfq1szNXjSbrx0RlUdARq3ZG7MrkdxVqM+RnsRskpbuFX1V0Xu7cGSqbiv1ocnNAiTccdVZVHxgjVuxdyXru5K1N7k0yFJSxcKPpdLK1Zg36JbZXQZnN356DN5KCLOTwRR2rKAdEYDpJwAuup/Hm58ll8zZq2bs08aVGfmQKPQ6jSmSyrR3rMfzMirNMD4PtWAHHmlNs5J7eRmTtyq1+fQAeQQNDtWVD3Xd/DDMb/AMfirtilLj7zsjFA8SoQSFDf3VmE3vQzF6KlHStQyOGK/MEHijn6VjozNfj6rkcnPkP9ttXmfuRH0AUhQuve3NgVMNk48mty28qK69Jen7jTc8QP02VQdDb3DBDJJD8ExYMwHTr70PB+yNV4/MV7s7QJG6ssff3jRFzbKy2pZhPY/wC3dz1K+Fzzx7rfEYSPGzvOJJi7R9CJOv8AQf10F9pP/9k\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/0db6a7154110745dc03948dbb7d6b60e/S3Engglm.jpg\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003c/blockquote\u003e\u003cp\u003e拆完图片以后，就能在 \u003ccode\u003etemp_frames_source\u003c/code\u003e 文件夹下看到一批 \u003ccode\u003eframe-0.png\u003c/code\u003e、\u003ccode\u003eframe-1.png\u003c/code\u003e……了。\u003c/p\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/1077*687),687px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/f8540212ccb5fd9da71a30522fdfa3f1/gqRjYDO1.png\" data-src-webp=\"https://p.sda1.dev/12/1315a5ad388046cbecf09e4886f5df5c/wyP9V4CA.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAUACADASIAAhEBAxEB/8QAGgAAAgIDAAAAAAAAAAAAAAAAAAYBAgMFB//EACUQAAIABAUFAQEAAAAAAAAAAAECAAMEEQUSMUJRBhMhQVIiJP/EABYBAQEBAAAAAAAAAAAAAAAAAAMEAP/EAB4RAAEEAQUAAAAAAAAAAAAAAAABAxESYgIhIyQx/9oADAMBAAIRAxEAPwDtM3uScPqZiMtpWYWYk6c3MaAY/WgAgUez39Lf6hmr+4uG4hdMqEMQxHJ4MLFNgmIVNPKny5knI4Qi6gaLbiAdvdKzMFLKN0VdaJ7G5cdQV5IH8mrDXhc31FRj9e2W5pfPb3fa3O6Mw6cxQEEvI8FjovtbcQDpzFAFJeR47e1dosfUHzZCdfAbltMT9AEG4IiQoUAKAANAIIIrIgiJjFUZh6EEEYx//9k\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/f8540212ccb5fd9da71a30522fdfa3f1/gqRjYDO1.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003ch1 id=\"使用-waifu2x-放大\"\u003e\u003ca href=\"#使用-waifu2x-放大\" class=\"headerlink\" title=\"使用 waifu2x 放大\"\u003e\u003c/a\u003e使用 waifu2x 放大\u003c/h1\u003e\u003cp\u003ewaifu2x-caffe 支持将一整个文件夹输入，放大文件夹中的所有图片，所以这一步其实还是挺简单的？\u003c/p\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u0026amp;\u003cspan class=\"token variable\"\u003e$Waifu2xCUIPath\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003ei \u003cspan class=\"token variable\"\u003e$SourceDirectory\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eo \u003cspan class=\"token variable\"\u003e$UpscaledDirectory\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003ey cunet \u003cspan class=\"token operator\"\u003e-\u003c/span\u003em noise_scale \u003cspan class=\"token operator\"\u003e-\u003c/span\u003es 2 \u003cspan class=\"token operator\"\u003e-\u003c/span\u003en 3 \u003cspan class=\"token operator\"\u003e-\u003c/span\u003ep cudnn \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eb 8 \u003cspan class=\"token operator\"\u003e-\u003c/span\u003et 1 \u003cspan class=\"token operator\"\u003e--\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e|\u003c/span\u003e \u003cspan class=\"token function\"\u003eOut-Null\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e上面这个是我习惯使用的配置：3 级降噪、CUnet 模型、放大 2 倍、使用 cuDNN 和 TTA 模式。如果要修改的话，可以参考 \u003ca href=\"https://github.com/lltcggie/waifu2x-caffe#%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%83%A9%E3%82%A4%E3%83%B3%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3%E5%85%B1%E9%80%9A\" target=\"_blank\" rel=\"noopener\"\u003eREADME.md\u003c/a\u003e 里面的命令行参数说明～（请自备 Google 翻译）\u003c/p\u003e\u003cp\u003e这一步执行之后，在 \u003ccode\u003etemp_frames_upscaled\u003c/code\u003e 文件夹中也会出现放大后的每一帧的图片。\u003c/p\u003e\u003ch1 id=\"合成-GIF\"\u003e\u003ca href=\"#合成-GIF\" class=\"headerlink\" title=\"合成 GIF\"\u003e\u003c/a\u003e合成 GIF\u003c/h1\u003e\u003cp\u003e使用 ImageMagick 从帧序列合成 GIF 的命令是 \u003ccode\u003emagick -dispose previous -delay 10 frame-0.png -delay 10 frame-1.png ... -delay 10 frame-X.png output.gif\u003c/code\u003e，可以通过拼接字符串来生成这些命令行参数：\u003c/p\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u003cspan class=\"token variable\"\u003e$Params\u003c/span\u003e = \u003cspan class=\"token string\"\u003e\u0026#39;-dispose previous \u0026#39;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Params\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token namespace\"\u003e[IO.File]\u003c/span\u003e::ReadAllText\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$InputDirectory\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;\\\u0026#39;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token namespace\"\u003e[IO.Path]\u003c/span\u003e::GetFileNameWithoutExtension\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$InputFile\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;.txt\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eReplace\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#34;`r`n\u0026#34;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39; \u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Params\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;\u0026#34;\u0026#39;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$OutputFile\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;\u0026#34;\u0026#39;\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-not\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003eTest-Path\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$OutputDirectory\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    mkdir \u003cspan class=\"token variable\"\u003e$OutputDirectory\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e|\u003c/span\u003e \u003cspan class=\"token function\"\u003eOut-Null\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token function\"\u003eStart-Process\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eFilePath \u003cspan class=\"token variable\"\u003e$MagickPath\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eArgumentList \u003cspan class=\"token variable\"\u003e$Params\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eNoNewWindow \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eWait\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e其中，帧序列的参数之前已经通过格式化输出保存到了文件中，在这里直接读取就可以了。\u003c/p\u003e\u003ch1 id=\"完整脚本\"\u003e\u003ca href=\"#完整脚本\" class=\"headerlink\" title=\"完整脚本\"\u003e\u003c/a\u003e完整脚本\u003c/h1\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e Invoke-Waifu2xGIF\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token namespace\"\u003e[String]\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$InputFile\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token namespace\"\u003e[String]\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$OutputFile\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token namespace\"\u003e[Float]\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$Scale\u003c/span\u003e = 2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token namespace\"\u003e[Switch]\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$TTA\u003c/span\u003e = \u003cspan class=\"token boolean\"\u003e$false\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$Waifu2xCUIPath\u003c/span\u003e = \u003cspan class=\"token string\"\u003e\u0026#39;D:\\waifu2x-caffe\\waifu2x-caffe-cui.exe\u0026#39;\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$MagickPath\u003c/span\u003e = \u003cspan class=\"token string\"\u003e\u0026#39;D:\\ImageMagick-7.0.8-Q16-HDRI\\magick.exe\u0026#39;\u003c/span\u003e\n\n    \u003cspan class=\"token variable\"\u003e$InputFile\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$ExecutionContext\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eSessionState\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ePath\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eGetUnresolvedProviderPathFromPSPath\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$InputFile\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$OutputFile\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$ExecutionContext\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eSessionState\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ePath\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eGetUnresolvedProviderPathFromPSPath\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$OutputFile\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n    \u003cspan class=\"token variable\"\u003e$InputDirectory\u003c/span\u003e = \u003cspan class=\"token namespace\"\u003e[IO.Path]\u003c/span\u003e::GetDirectoryName\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$InputFile\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$OutputDirectory\u003c/span\u003e = \u003cspan class=\"token namespace\"\u003e[IO.Path]\u003c/span\u003e::GetDirectoryName\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$OutputFile\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$SourceDirectory\u003c/span\u003e = \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$InputDirectory\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;\\temp_frames_source\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$UpscaledDirectory\u003c/span\u003e = \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$InputDirectory\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;\\temp_frames_upscaled\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n    \u0026amp;\u003cspan class=\"token variable\"\u003e$MagickPath\u003c/span\u003e identify \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eformat \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#34;-delay %T \\`\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$UpscaledDirectory\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eReplace\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;\\\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;\\\\\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#34;\\\\frame-%s.png\\`\u0026#34; \u0026#34;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$InputFile\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e|\u003c/span\u003e \u003cspan class=\"token function\"\u003eOut-File\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$InputDirectory\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;\\\u0026#39;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token namespace\"\u003e[IO.Path]\u003c/span\u003e::GetFileNameWithoutExtension\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$InputFile\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;.txt\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eEncoding utf8\n    \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-not\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003eTest-Path\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$SourceDirectory\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        mkdir \u003cspan class=\"token variable\"\u003e$SourceDirectory\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e|\u003c/span\u003e \u003cspan class=\"token function\"\u003eOut-Null\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u0026amp;\u003cspan class=\"token variable\"\u003e$MagickPath\u003c/span\u003e convert \u003cspan class=\"token operator\"\u003e-\u003c/span\u003ecoalesce \u003cspan class=\"token variable\"\u003e$InputFile\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$SourceDirectory\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;\\frame.png\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e|\u003c/span\u003e \u003cspan class=\"token function\"\u003eOut-Null\u003c/span\u003e\n\n    \u0026amp;\u003cspan class=\"token variable\"\u003e$Waifu2xCUIPath\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003ei \u003cspan class=\"token variable\"\u003e$SourceDirectory\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eo \u003cspan class=\"token variable\"\u003e$UpscaledDirectory\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003ey cunet \u003cspan class=\"token operator\"\u003e-\u003c/span\u003em noise_scale \u003cspan class=\"token operator\"\u003e-\u003c/span\u003es \u003cspan class=\"token variable\"\u003e$Scale\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003en 3 \u003cspan class=\"token operator\"\u003e-\u003c/span\u003ep cudnn \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eb 8 \u003cspan class=\"token operator\"\u003e-\u003c/span\u003et \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token namespace\"\u003e[Int32]\u003c/span\u003e\u003cspan class=\"token namespace\"\u003e[Bool]\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$TTA\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e--\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e|\u003c/span\u003e \u003cspan class=\"token function\"\u003eOut-Null\u003c/span\u003e\n\n    \u003cspan class=\"token variable\"\u003e$Params\u003c/span\u003e = \u003cspan class=\"token string\"\u003e\u0026#39;-dispose previous \u0026#39;\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$Params\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token namespace\"\u003e[IO.File]\u003c/span\u003e::ReadAllText\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$InputDirectory\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;\\\u0026#39;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token namespace\"\u003e[IO.Path]\u003c/span\u003e::GetFileNameWithoutExtension\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$InputFile\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;.txt\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eReplace\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#34;`r`n\u0026#34;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39; \u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$Params\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;\u0026#34;\u0026#39;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$OutputFile\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;\u0026#34;\u0026#39;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-not\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003eTest-Path\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$OutputDirectory\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        mkdir \u003cspan class=\"token variable\"\u003e$OutputDirectory\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e|\u003c/span\u003e \u003cspan class=\"token function\"\u003eOut-Null\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003eStart-Process\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eFilePath \u003cspan class=\"token variable\"\u003e$MagickPath\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eArgumentList \u003cspan class=\"token variable\"\u003e$Params\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eNoNewWindow \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eWait\n\n    \u003cspan class=\"token function\"\u003eRemove-Item\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$SourceDirectory\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eRecurse\n    \u003cspan class=\"token function\"\u003eRemove-Item\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$UpscaledDirectory\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eRecurse\n    \u003cspan class=\"token function\"\u003eRemove-Item\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$InputDirectory\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;\\\u0026#39;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token namespace\"\u003e[IO.Path]\u003c/span\u003e::GetFileNameWithoutExtension\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$InputFile\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;.txt\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 调用示例\u003c/span\u003e\nInvoke-Waifu2xGIF \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eInputFile \u003cspan class=\"token string\"\u003e\u0026#39;input.gif\u0026#39;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eOutputFile \u003cspan class=\"token string\"\u003e\u0026#39;output.gif\u0026#39;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eScale 2 \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eTTA\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e最后是放大为原图尺寸 4 倍的小埋：\u003c/p\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/704*720),720px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/f8d3dace3f3a6911e2cb9fdadffd7f57/0wdoAOz5.gif\" data-src-webp=\"https://p.sda1.dev/12/9c2bf54c40f4b60a0c5e7f3728756f34/VrrTcv1Q.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAgAB8DASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAABQYHBAL/xAAmEAACAQMEAQMFAAAAAAAAAAABAgMABBEFEiExURMiQRQjMmGh/8QAGQEAAQUAAAAAAAAAAAAAAAAAAgEDBAUG/8QAHxEAAgICAgMBAAAAAAAAAAAAAQIDEQAhEjEEEyJR/9oADAMBAAIRAxEAPwAYIGZwoHuNb10mbA34TPQPdbLKANdwxnstyaao/ojbTyhvVEZKO+1iU2nBJHfFUgEjj5zQ84I69lkm9DJ5d6fPCdzAMnlaGNVEvYYGiQoD6cwbAIPQ+Rnzmp/JF9wofjujRmsq3YxZFTikkZtWxstGkiuo5VAJGTz4pognhaF7M6egF1uZ1HAkMgyTmldkZsqrlTjBYUVttb1G0DQxuskW3hJhv2DwCCKGB0F85Co10MYm+kUJGC27JOdXzyiSCA2vopFGAqk8gYAH8FLGoW8cZEigAsTu/Z80YvtavbgwxyJAdnuZ1QoSCPxoNdO07qGHAGcUL6mJV7X9yXHIh8UIyU99Z//Z\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/f8d3dace3f3a6911e2cb9fdadffd7f57/0wdoAOz5.gif\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003cp\u003e因为 GIF 格式过于古老，压缩效率太低，所以图片分辨率变大的话文件大小也会大量增加。可以使用\u003ca href=\"https://ezgif.com/optimize\" target=\"_blank\" rel=\"noopener\"\u003e这个在线小工具\u003c/a\u003e对 GIF 进一步进行各种有损压缩，降低文件大小。\u003c/p\u003e\u003cp\u003e（为了进一步压缩，上面的动图已经转换成 Animated WebP 了）\u003c/p\u003e\u003cblockquote class=\"mdui-m-b-0 mdui-m-x-0 mdui-p-y-1\" style=\"border-left:4px solid rgba(0,0,0,.36)\"\u003e\u003cstrong\u003e本作品采用\u003ca href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh\" target=\"_blank\"\u003e知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议\u003c/a\u003e进行许可。不允许内容农场类网站、CSDN 用户和微信公众号转载。\u003c/strong\u003e\u003cbr/\u003e\u003cstrong\u003e本文作者：✨小透明・宸✨\u003c/strong\u003e\u003cbr/\u003e\u003cstrong\u003e本文链接：\u003ca href=\"https://akarin.dev/2019/11/23/powershell-waifu2xgif/\"\u003ehttps://akarin.dev/2019/11/23/powershell-waifu2xgif/\u003c/a\u003e\u003c/strong\u003e\u003c/blockquote\u003e\u003c/article\u003e",
  "Date": "2019-11-23T03:28:42Z",
  "Author": "✨小透明・宸✨"
}