{
  "Source": "akarin.dev",
  "Title": "使用 PowerShell 爬取妹子图网站",
  "Link": "https://akarin.dev/2019/07/30/powershell-mzitu-crawler/",
  "Content": "\u003carticle class=\"mdui-p-a-3 mdui-card-content mdui-typo\"\u003e\u003cblockquote\u003e\u003cp\u003e封面图：\u003ca href=\"https://www.pixiv.net/member_illust.php?mode=medium\u0026amp;illust_id=75886262\" target=\"_blank\" rel=\"noopener\"\u003ePixiv ID: 75886262 「お誕生日おめでとうあかり！Happy Birthday!」 by Kyouzama アリンスター\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\u003cp\u003e不知道是不是被“精准营销”了，总之小透明最近在很多网站上都看到了各种“Python 入门教程”(`へ´*)ノ\u003c/p\u003e\u003cp\u003e一想到 Python 入门，小透明就记得诸如 C$DN 之类的网站上经常会使用制作各种爬虫作为 Python 入门的案例是。一提到 Python 的入门级爬虫，似乎大部分教程都在爬各种妹子图网站。如果这些网站的站长们发现自己的网站除了吸引肥宅以外居然还能成为\u003cstrong\u003e编程入门教具\u003c/strong\u003e之一，不知道会有什么感想呢？(´ﾟωﾟ｀)\u003c/p\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/1232*803),803px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/98c39d62b9777b4e2bf683c29bdc911c/mjM9qytG.png\" data-src-webp=\"https://p.sda1.dev/12/6d97468712135471c632be35b537273a/IqL5JzhX.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAVACADASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAMBBAUH/8QAJhAAAgIBAwQABwAAAAAAAAAAAQIDEQAEEzESISJBBVFhYqHB0f/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/8QAGBEBAQADAAAAAAAAAAAAAAAAABEBIUH/2gAMAwEAAhEDEQA/AO5SwwRBGZR5YIdK3pfzjdWp24qDHnjKsQezYkBr7hl0NCLTwPdKhGLn+HqNyRXpQthekev7jYLog3V9rv8AeS4tGH0OLBR1jr0R3Gpq+cpxMGYnbTj5YYZLlOtXTznbPjR45OMaTxbt6wwwr//Z\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/98c39d62b9777b4e2bf683c29bdc911c/mjM9qytG.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003cp\u003e\u003cdel\u003e迷之声：“给我也整一个！”\u003c/del\u003e\u003c/p\u003e\u003cp\u003e由于用 Python 写的妹子图爬虫实在是太多了，复读这些教程也没什么意思，所以小透明还是打算使用熟悉的 PowerShell 来编写爬虫～当然也就不需要装各种包配置各种环境（右键就可以直接运行，Windows 内置了 PowerShell 的运行环境，甚至还内置了一个 IDE），而且诸君看了以下的教程后，也许能举一反三，制作适用于其它（爬取难度较低的）网站的爬虫也说不定？\u003c/p\u003e\u003cp\u003e当然，制作网站爬虫，基本的网络编程知识还是需要有的～\u003c/p\u003e\u003cp\u003e这里要爬取的是 \u003ca href=\"https://www.mzitu.com/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://www.mzitu.com/\u003c/a\u003e 这个网站。虽然它显然不是唯一的妹子图网站，不过这个网站出现在了大部分爬虫教程中（站长真可怜 233），而且访问速度也很快，所以就用它作为例子(ᴗ•̀ᴗ-)✧ 小透明找到的另外一个妹子图网站是 \u003ca href=\"https://meizitu.com/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://meizitu.com/\u003c/a\u003e，但是似乎是需要翻墙才能访问……有条件的话，也可以开着梯子爬一下试试看？\u003c/p\u003e\u003ch1 id=\"使用-ParsedHTML-解析网页数据\"\u003e\u003ca href=\"#使用-ParsedHTML-解析网页数据\" class=\"headerlink\" title=\"使用 ParsedHTML 解析网页数据\"\u003e\u003c/a\u003e使用 \u003ccode\u003eParsedHTML\u003c/code\u003e 解析网页数据\u003c/h1\u003e\u003cp\u003ePowerShell 访问网页用的是 \u003ccode\u003eInvoke-WebRequest\u003c/code\u003e 这个 cmdlet，比如要访问妹子图网站的主页：\u003c/p\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u003cspan class=\"token variable\"\u003e$Response\u003c/span\u003e = \u003cspan class=\"token function\"\u003eInvoke-WebRequest\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;https://www.mzitu.com/page/1/\u0026#39;\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e得到的 \u003ccode\u003e$Response\u003c/code\u003e 就是包含了网页数据的对象：\u003c/p\u003e\u003cpre class=\"line-numbers language-none\"\u003e\u003ccode class=\"language-none\"\u003eStatusCode        : 200\nStatusDescription : OK\nContent           : \u0026lt;!DOCTYPE html\u0026gt;\n                    \u0026lt;html\u0026gt;\n                    \u0026lt;head\u0026gt;\n                    \u0026lt;meta http-equiv=\u0026#34;Content-Type\u0026#34; content=\u0026#34;text/html; charset=UTF-8\u0026#34; /\u0026gt;\n                    \u0026lt;title\u0026gt;妹子图 - 性感美女图片每日更新\u0026lt;/title\u0026gt;\n                    \u0026lt;meta name=\u0026#34;keywords\u0026#34; content=\u0026#34;妹子图,妹子,美女图片,性感美女,美女写真\u0026#34; /\u0026gt;\n                    \u0026lt;meta name=...\nRawContent        : HTTP/1.1 200 OK\n                    Connection: keep-alive\n                    X-NWS-UUID-VERIFY: ce2a0876df4584dcf4baa32cd89c7195\n                    X-NWS-LOG-UUID: 56e2625d-3abc-4866-a94f-6b0e4c316bf0\n                    X-Cache-Lookup: Hit From Disktank3,Hit From Inner Cl...\nForms             : {}\nHeaders           : {[Connection, keep-alive], [X-NWS-UUID-VERIFY, ce2a0876df4584dcf4baa32cd89c7195], [X-NWS-LOG-UUID,\n                    56e2625d-3abc-4866-a94f-6b0e4c316bf0], [X-Cache-Lookup, Hit From Disktank3,Hit From Inner Cluster,H\n                    it From Upstream]...}\nImages            : {@{innerHTML=; innerText=; outerHTML=\u0026lt;IMG class=lazy alt=\u0026#34;有胸有腿有翘臀 妩媚尤物芝芝Booty黑丝一线裆让你大饱眼福\u0026#34; src=\u0026#34;http\n                    s://i.meizitu.net/pfiles/img/lazy.png\u0026#34; width=236 height=354 data-original=\u0026#34;https://i.meizitu.net/th\n                    umbs/2019/07/189007_10b27_236.jpg\u0026#34;\u0026gt;; outerText=; tagName=IMG; class=lazy; alt=有胸有腿有翘臀 妩媚尤物芝芝Booty黑丝\n                    一线裆让你大饱眼福; src=https://i.meizitu.net/pfiles/img/lazy.png; width=236; height=354; data-original=http\n                    s://i.meizitu.net/thumbs/2019/07/189007_10b27_236.jpg}...}\nInputFields       : {@{innerHTML=; innerText=; outerHTML=\u0026lt;INPUT class=search-input name=s placeholder=\u0026#34;搜一搜，看一看\u0026#34;\u0026gt;; outer\n                    Text=; tagName=INPUT; class=search-input; name=s; placeholder=搜一搜，看一看}}\nLinks             : {@{innerHTML=妹子图; innerText=妹子图; outerHTML=\u0026lt;A href=\u0026#34;https://www.mzitu.com/\u0026#34;\u0026gt;妹子图\u0026lt;/A\u0026gt;; outerText=妹子图;\n                     tagName=A; href=https://www.mzitu.com/}, @{innerHTML=首页; innerText=首页; outerHTML=\u0026lt;A title=首页 href=\n                    \u0026#34;https://www.mzitu.com/\u0026#34; aria-current=\u0026#34;page\u0026#34;\u0026gt;首页\u0026lt;/A\u0026gt;; outerText=首页; tagName=A; title=首页; href=https:\n                    //www.mzitu.com/; aria-current=page}...}\nParsedHtml        : mshtml.HTMLDocumentClass\nRawContentLength  : 22250\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e显而易见，\u003ccode\u003e$Response.Content\u003c/code\u003e 就是网页的所有源代码。小透明很久以前用 PowerShell 写过一个从 \u003ca href=\"https://ffmpeg.zeranoe.com/builds/\" target=\"_blank\" rel=\"noopener\"\u003ehttps://ffmpeg.zeranoe.com/builds/\u003c/a\u003e 自动下载更新电脑上的 FFmpeg 的脚本，需要从网页上获取 \u003ccode\u003ehttps://ffmpeg.zeranoe.com/builds/win64/shared/ffmpeg-20190729-43891ea-win64-shared.zip\u003c/code\u003e 这样的下载链接。由于当时的姿势水平实在是不怎么高，小透明当时使用的方法就是\u003cstrong\u003e直接从网页源代码中使用正则表达式去搜索\u003c/strong\u003e……(　ε:)\u003c/p\u003e\u003cp\u003e能直接查找下载链接是因为\u003cstrong\u003e下载链接的格式相当固定\u003c/strong\u003e（会改变的元素仅有是八位数字的日期和七位十六进制数字的 Git 提交版本号），但是实在是太不优雅了，而且通用性也不强⊂彡☆))∀`)\u003c/p\u003e\u003cp\u003e更优雅的查找方式是通过 \u003ccode\u003e$Response.ParsedHTML.documentElement\u003c/code\u003e 这个使用了 IE 浏览器对网页源代码进行解析的产物（由此可见为什么 IE 浏览器已经严重过时但是仍然没有被 Windows 砍掉，它早就成为了被很多程序在 Windows 系统中使用的访问网络的“基础设施”），有点像用浏览器打开某网页后 \u003ckbd\u003eF12\u003c/kbd\u003e 然后找到控制台输入 \u003ccode\u003edocument\u003c/code\u003e 得到的东西，当然也就可以像 JavaScript 一样对 DOM 节点进行很多基本的操作：\u003c/p\u003e\u003cul\u003e\u003cli\u003e查找元素：\u003ccode\u003egetElementById\u003c/code\u003e、\u003ccode\u003egetElementsByClassName\u003c/code\u003e、\u003ccode\u003egetElementsByTagName\u003c/code\u003e（不包括使用 CSS 进行选择的 \u003ccode\u003equerySelector\u003c/code\u003e 和 \u003ccode\u003equerySelectorAll\u003c/code\u003e）\u003c/li\u003e\u003cli\u003e查找父子兄弟节点： \u003ccode\u003epreviousSibling\u003c/code\u003e、\u003ccode\u003enextSibling\u003c/code\u003e、\u003ccode\u003eparentElement\u003c/code\u003e、\u003ccode\u003echildren\u003c/code\u003e\u003c/li\u003e\u003cli\u003e获取元素内的数据： \u003ccode\u003einnerText\u003c/code\u003e、\u003ccode\u003einnerHTML\u003c/code\u003e\u003c/li\u003e\u003cli\u003e获取元素的属性：\u003ccode\u003egetAttribute\u003c/code\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e不过这里有一个坑：\u003ccode\u003e$Response.ParsedHTML.documentElement\u003c/code\u003e 和 \u003ccode\u003e$Response.ParsedHTML\u003c/code\u003e非常容易混淆，这两个对象的类型是不同的，能进行的操作也不同。前者可以使用以上的所有操作但是**不能使用 \u003ccode\u003egetElementById\u003c/code\u003e\u003cstrong\u003e，后者\u003c/strong\u003e只能使用以上操作中的 \u003ccode\u003egetElementById\u003c/code\u003e 和 \u003ccode\u003egetElementsByTagName\u003c/code\u003e**……不知道为什么会弄出这种区别(っ’-‘)╮\u003c/p\u003e\u003cp\u003e另外“查找元素”和“查找父子兄弟节点”得到的对象和 \u003ccode\u003e$Response.ParsedHTML.documentElement\u003c/code\u003e 是相同的类型。\u003c/p\u003e\u003cblockquote\u003e\u003cp\u003ePowerShell 6 中 \u003ccode\u003eParsedHTML\u003c/code\u003e 被\u003cdel\u003e微软大刀部\u003c/del\u003e\u003ca href=\"https://docs.microsoft.com/zh-cn/powershell/scripting/whats-new/breaking-changes-ps6?view=powershell-6#changes-to-web-cmdlets\" target=\"_blank\" rel=\"noopener\"\u003e砍掉了\u003c/a\u003e，不过 Windows 10 内置的是 PowerShell 5.1，因此不受影响～\u003c/p\u003e\u003c/blockquote\u003e\u003ch1 id=\"分析网页，获取套图信息\"\u003e\u003ca href=\"#分析网页，获取套图信息\" class=\"headerlink\" title=\"分析网页，获取套图信息\"\u003e\u003c/a\u003e分析网页，获取套图信息\u003c/h1\u003e\u003cp\u003e妹子图网站的主页上每一页有若干组套图的链接，对照着网页源代码就可以找到和套图相关的部分(っ’ω’)っ\u003c/p\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/1232*803),803px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/63b7000c2a4cc82f1dcf3215b689545a/SlAeJ7mn.png\" data-src-webp=\"https://p.sda1.dev/12/d39d72ddcb6bdad81368b2bb797d11f8/WCK80LuK.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAVACADASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMEBQf/xAAoEAACAgICAAQGAwAAAAAAAAABAgMRAAQSIQUxUZITFBUiJTIzwtL/xAAVAQEBAAAAAAAAAAAAAAAAAAACA//EAB8RAAICAQQDAAAAAAAAAAAAAAECABETElGBkiExQf/aAAwDAQACEQMRAD8A6zuOsc6nkqhlFDNCMxlI7C2VF40a6y1ySMsvldEjKflZV7KqMbNYAr1AFIYnVd/JMHgFluHEDvyxEc+nMTwkhZgO0Rw/R7BymbUJX4UsKMjggqTQIyePwzT1VZodYIaF/ez/AK+nI4PMoKiE1t9Tf1SW/URxj+uPEPiJr8tP7I/84YZXM+ydFksS7t2MaqbUf8+204voMqrXtAyksODCuqwwwMSxs1wKjAAFC+Tc/9k\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/63b7000c2a4cc82f1dcf3215b689545a/SlAeJ7mn.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003cpre class=\"line-numbers language-markup\" data-language=\"markup\"\u003e\u003ccode class=\"language-markup\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003eul\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eid\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003epins\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003eli\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n        \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003ea\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003ehref\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003ehttps://www.mzitu.com/189007\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003etarget\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e_blank\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n            \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003eimg\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003elazy\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003esrc\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003ehttps://i.meizitu.net/pfiles/img/lazy.png\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003edata-original\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003ehttps://i.meizitu.net/thumbs/2019/07/189007_10b27_236.jpg\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003ealt\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003e有胸有腿有翘臀 妩媚尤物芝芝Booty黑丝一线裆让你大饱眼福\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003ewidth\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003e236\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eheight\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003e354\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e/\u0026gt;\u003c/span\u003e\u003c/span\u003e\n        \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ea\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n        \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003espan\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003ea\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003ehref\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003ehttps://www.mzitu.com/189007\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003etarget\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e_blank\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e有胸有腿有翘臀 妩媚尤物芝芝Booty黑丝一线裆让你大饱眼福\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ea\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003espan\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n        \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003espan\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003etime\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e2019-07-29\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003espan\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003eli\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003eli\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n        \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003ea\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003ehref\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003ehttps://www.mzitu.com/193773\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003etarget\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e_blank\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n            \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003eimg\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003elazy\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003esrc\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003ehttps://i.meizitu.net/pfiles/img/lazy.png\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003edata-original\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003ehttps://i.meizitu.net/thumbs/2019/07/193773_07b27_236.jpg\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003ealt\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003e温柔体贴的小女仆 甜美嫩模toro羽住高清美照梦幻动人\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003ewidth\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003e236\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eheight\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003e354\u003cspan class=\"token punctuation\"\u003e\u0026#39;\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e/\u0026gt;\u003c/span\u003e\u003c/span\u003e\n        \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ea\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n        \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003espan\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003ea\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003ehref\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003ehttps://www.mzitu.com/193773\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003etarget\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e_blank\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e温柔体贴的小女仆 甜美嫩模toro羽住高清美照梦幻动人\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003ea\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003espan\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n        \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003espan\u003c/span\u003e \u003cspan class=\"token attr-name\"\u003eclass\u003c/span\u003e\u003cspan class=\"token attr-value\"\u003e\u003cspan class=\"token punctuation attr-equals\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003etime\u003cspan class=\"token punctuation\"\u003e\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e2019-07-29\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003espan\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003eli\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n    \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;\u003c/span\u003eli\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n        ……\n    \u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003eli\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token tag\"\u003e\u003cspan class=\"token punctuation\"\u003e\u0026lt;/\u003c/span\u003eul\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e如果要获取套图的链接和标题，也就要获取到 \u003ccode\u003e\u0026lt;a href=\u0026#34;（套图链接）\u0026#34; target=\u0026#34;_blank\u0026#34;\u0026gt;（套图标题）\u0026lt;/a\u0026gt;\u003c/code\u003e 这样的节点。获取到第一页的所有套图信息的代码如下：\u003c/p\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u003cspan class=\"token variable\"\u003e$Response\u003c/span\u003e = \u003cspan class=\"token function\"\u003eInvoke-WebRequest\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;https://www.mzitu.com/page/1/\u0026#39;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 获取document\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# $Response.ParsedHTML\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 获取\u0026lt;ul id=\u0026#34;pins\u0026#34;\u0026gt;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# $Response.ParsedHTML.getElementById(\u0026#39;pins\u0026#39;)\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 每一组套图对应\u0026lt;ul id=\u0026#34;pins\u0026#34;\u0026gt;中的每一个\u0026lt;li\u0026gt;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# $Response.ParsedHTML.getElementById(\u0026#39;pins\u0026#39;).children\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# $Response.ParsedHTML.getElementById(\u0026#39;pins\u0026#39;).getElementsByTagName(\u0026#39;li\u0026#39;)\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# 显然选择器的写法是不唯一的～\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eforeach\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$li\u003c/span\u003e in \u003cspan class=\"token variable\"\u003e$Response\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eParsedHTML\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003egetElementById\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;pins\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003echildren\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e# 获取套图链接的\u0026lt;a\u0026gt;外面的\u0026lt;span\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e# $li.children[1]\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e# $li.firstChild.nextSibling\u003c/span\u003e\n\n    \u003cspan class=\"token comment\"\u003e# 获取套图链接的\u0026lt;a\u0026gt;本身\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e# $li.children[1].firstChild\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e# $li.children[1].children[0]\u003c/span\u003e\n\n    \u003cspan class=\"token comment\"\u003e# 从\u0026lt;a\u0026gt;获取套图的标题和链接\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;URL: \u0026#39;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$li\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003echildren\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e1\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003efirstChild\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ehref\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;Title: \u0026#39;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$li\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003echildren\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e1\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003efirstChild\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einnerText\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e那第二页、第三页……的套图呢？第一页的网址 \u003ccode\u003ehttps://www.mzitu.com/page/1/\u003c/code\u003e 里面的这个 \u003ccode\u003e1\u003c/code\u003e，不就是页数嘛！\u003c/p\u003e\u003cp\u003e当时妹子图网站的页数是 \u003ccode\u003e226\u003c/code\u003e，写个循环就可以全部提取了੭ ᐕ)੭*⁾⁾ 不过这次要把所有套图的信息以对象的形式，保存到 \u003ccode\u003e$Articles\u003c/code\u003e 这个数组中：\u003c/p\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u003cspan class=\"token variable\"\u003e$Articles\u003c/span\u003e = @\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e = 1\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-le\u003c/span\u003e 226\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e\u003cspan class=\"token operator\"\u003e++\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$SitePageURL\u003c/span\u003e = \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;https://www.mzitu.com/page/\u0026#39;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;/\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$SitePage\u003c/span\u003e = \u003cspan class=\"token function\"\u003eInvoke-WebRequest\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$SitePageURL\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eforeach\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$ArticleEntry\u003c/span\u003e in \u003cspan class=\"token variable\"\u003e$SitePage\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eParsedHTML\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003egetElementById\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;pins\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003echildren\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token variable\"\u003e$Articles\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+=\u003c/span\u003e @\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"token string\"\u003e\u0026#39;URL\u0026#39;\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$ArticleEntry\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003efirstChild\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ehref \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;/\u0026#39;\u003c/span\u003e\n            \u003cspan class=\"token string\"\u003e\u0026#39;Title\u0026#39;\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$ArticleEntry\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003efirstChild\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003enextSibling\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003efirstChild\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einnerText\n        \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e还可以把套图的信息以 JSON 格式保存到文件中，之后下载时可以直接读取，而不需要重新爬取一遍：\u003c/p\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u003cspan class=\"token comment\"\u003e# 保存\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Articles\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e|\u003c/span\u003e \u003cspan class=\"token function\"\u003eConvertTo-Json\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e|\u003c/span\u003e \u003cspan class=\"token function\"\u003eOut-File\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;D:\\mzitu\\mzitu.json\u0026#39;\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# 读取\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Articles\u003c/span\u003e = \u003cspan class=\"token function\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;D:\\mzitu\\mzitu.json\u0026#39;\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e|\u003c/span\u003e \u003cspan class=\"token function\"\u003eConvertFrom-Json\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e也可以从\u003ca href=\"https://files.catbox.moe/3nhtx0.json\" target=\"_blank\" rel=\"noopener\"\u003e这里\u003c/a\u003e下载小透明已经爬取完了的套图信息～一共有 5423 条_(:△」∠)_\u003c/p\u003e\u003cp\u003e为了方便使用 PowerShell 直接读取，这个文件是使用 \u003ccode\u003eUTF-16 LE\u003c/code\u003e 编码保存的，因此直接用浏览器打开的话看到的可能是乱码。\u003c/p\u003e\u003ch1 id=\"自动下载妹子图\"\u003e\u003ca href=\"#自动下载妹子图\" class=\"headerlink\" title=\"自动下载妹子图\"\u003e\u003c/a\u003e自动下载妹子图\u003c/h1\u003e\u003cp\u003e打开某一组套图的第一页，用同样的方法分析网页源代码，就可以得到每张图片的链接，以及这组套图的图片总数。\u003c/p\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/1232*803),803px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/9133989461a736d49141154e380a002f/FtoKG4pk.png\" data-src-webp=\"https://p.sda1.dev/12/11e0255119dfb15f9aa9c8ba3a703cae/7ddf-CJb.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAVACADASIAAhEBAxEB/8QAGgAAAQUBAAAAAAAAAAAAAAAAAAECAwQFB//EACIQAAICAgAHAQEAAAAAAAAAAAECAAMEEQUSEyExQVEUwf/EABYBAQEBAAAAAAAAAAAAAAAAAAIBA//EAB8RAQABBAEFAAAAAAAAAAAAAAEAAgMRIRMiMVJhkf/aAAwDAQACEQMRAD8A69ely5lTIahSygFChJ2T6O5osaaUVremuyBttAbMqpxHCHb9dBX6LBHHL4Yw0cnGI2Do2DzNOK54VfIG7Q466dHqWwqdNmKDY9aEhKodsVUKOwH9jhk05Iaumymz7yuDqKcZVQkov2BEcIjEI7ExGPfYGJVmAPoGaFeQ/IBCET2JJFfYWKEjxuIWHIw1CEMRP//Z\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/9133989461a736d49141154e380a002f/FtoKG4pk.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003cp\u003e图片的链接在 \u003ccode\u003e\u0026lt;div class=\u0026#34;main-image\u0026#34;\u0026gt;\u003c/code\u003e 里面的 \u003ccode\u003e\u0026lt;img\u0026gt;\u003c/code\u003e 中，总页数可以从最后一个跳转页面的按钮获取，也就是 \u003ccode\u003e\u0026lt;div class=\u0026#34;pagenavi\u0026#34;\u0026gt;\u003c/code\u003e 的最后一个 \u003ccode\u003e\u0026lt;a\u0026gt;\u003c/code\u003e，写一个循环就可以把这组套图的所有图片下载下来～\u003c/p\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u003cspan class=\"token comment\"\u003e# 读取之前获取的所有套图的信息\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Articles\u003c/span\u003e = \u003cspan class=\"token function\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;D:\\mzitu\\mzitu.json\u0026#39;\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e|\u003c/span\u003e \u003cspan class=\"token function\"\u003eConvertFrom-Json\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e = 0\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-lt\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$Articles\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eLength\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e\u003cspan class=\"token operator\"\u003e++\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$Articles\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eTitle \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39; \u0026#39;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$Articles\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eURL\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eNoNewline\n    \u003cspan class=\"token variable\"\u003e$ArticlePage\u003c/span\u003e = \u003cspan class=\"token function\"\u003eInvoke-WebRequest\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$Articles\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eURL\n\n    \u003cspan class=\"token comment\"\u003e# 获取每组套图的图片总数\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e# lastChild指向\u0026lt;div class=\u0026#34;pagenavi\u0026#34;\u0026gt;的最后一个空文本节点\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e# lastChild.previousSibling指向“下一页”的按钮\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e# lastChild.previousSibling.previousSibling指向的就是“下一页”的前一个，也就是可以跳转到最后一页的按钮\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e# 这个按钮里面的数字就是图片总数，用innerText获取\u003c/span\u003e\n    \u003cspan class=\"token namespace\"\u003e[Int32]\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$ArticlePageCount\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$ArticlePage\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eParsedHTML\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edocumentElement\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003egetElementsByClassName\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;pagenavi\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e0\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elastChild\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003epreviousSibling\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003epreviousSibling\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einnerText\n\n    \u003cspan class=\"token comment\"\u003e# 根据套图名称建立文件夹\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e# 将函数的执行结果赋值给$null，可以隐藏掉新建文件夹时输出的提示文本，隐藏的方法也不唯一\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$null\u003c/span\u003e = \u003cspan class=\"token namespace\"\u003e[IO.Directory]\u003c/span\u003e::CreateDirectory\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;D:\\mzitu\\\u0026#39;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$Articles\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eTitle\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e# 使用类型转换：[void][IO.Directory]::CreateDirectory(\u0026#39;D:\\mzitu\\\u0026#39; + $Articles[$i].Title)\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e# 使用管道接收输出：[IO.Directory]::CreateDirectory(\u0026#39;D:\\mzitu\\\u0026#39; + $Articles[$i].Title) | Out-Null\u003c/span\u003e\n\n    \u003cspan class=\"token comment\"\u003e# 循环下载所有图片\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$j\u003c/span\u003e = 1\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$j\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-le\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$ArticlePageCount\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$j\u003c/span\u003e\u003cspan class=\"token operator\"\u003e++\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token comment\"\u003e# 根据规律构造网页URL\u003c/span\u003e\n        \u003cspan class=\"token comment\"\u003e# 例如 https://www.mzitu.com/189711/2 表示的就是这一组套图的第二张图\u003c/span\u003e\n        \u003cspan class=\"token variable\"\u003e$ImagePageURL\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$Articles\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eURL \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$j\u003c/span\u003e\n        \u003cspan class=\"token variable\"\u003e$ImagePage\u003c/span\u003e = \u003cspan class=\"token function\"\u003eInvoke-WebRequest\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$ImagePageURL\u003c/span\u003e\n\n        \u003cspan class=\"token comment\"\u003e# 获取图片的URL，构造保存路径\u003c/span\u003e\n        \u003cspan class=\"token variable\"\u003e$ImageURL\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$ImagePage\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eParsedHTML\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003edocumentElement\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003egetElementsByClassName\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;main-image\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e0\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003egetElementsByTagName\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;img\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e0\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esrc\n        \u003cspan class=\"token variable\"\u003e$ImagePath\u003c/span\u003e = \u003cspan class=\"token string\"\u003e\u0026#39;D:\\mzitu\\\u0026#39;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$Articles\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eTitle \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;\\\u0026#39;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token namespace\"\u003e[IO.Path]\u003c/span\u003e::GetFileName\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$ImageURL\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token function\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$ImageURL\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eNoNewline\n\n        \u003cspan class=\"token comment\"\u003e# 下载图片，保存到对应路径中\u003c/span\u003e\n        \u003cspan class=\"token comment\"\u003e# 妹子图网站似乎有防盗链，在网页上可以正常加载图片，但是直接打开图片的URL会遇到403错误\u003c/span\u003e\n        \u003cspan class=\"token comment\"\u003e# 在请求头中加上妹子图网站的链接就可以回避这一限制～\u003c/span\u003e\n        \u003cspan class=\"token comment\"\u003e# 由于下载的是文件，不需要进行网页解析，所以可以加上-UseBasicParsing这个参数禁用解析，提高一点点速度\u003c/span\u003e\n        \u003cspan class=\"token function\"\u003eInvoke-WebRequest\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eUri \u003cspan class=\"token variable\"\u003e$ImageURL\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eHeaders @\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;Referer\u0026#39;\u003c/span\u003e = \u003cspan class=\"token string\"\u003e\u0026#39;https://www.mzitu.com\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eOutFile \u003cspan class=\"token variable\"\u003e$ImagePath\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eUseBasicParsing \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eUserAgent \u003cspan class=\"token string\"\u003e\u0026#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:68.0) Gecko/20100101 Firefox/68.0\u0026#39;\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e只要运行了这段脚本，就可以源源不断地下载妹子图了～(⑉･̆-･̆⑉)\u003c/p\u003e\u003ch1 id=\"脚本优化\"\u003e\u003ca href=\"#脚本优化\" class=\"headerlink\" title=\"脚本优化\"\u003e\u003c/a\u003e脚本优化\u003c/h1\u003e\u003ch2 id=\"自动重连\"\u003e\u003ca href=\"#自动重连\" class=\"headerlink\" title=\"自动重连\"\u003e\u003c/a\u003e自动重连\u003c/h2\u003e\u003cp\u003e如果因为网络问题导致页面加载失败的话，那么某一张妹子图的下载就会因为出错被\u003cstrong\u003e直接跳过\u003c/strong\u003e，这样的程序显然是缺少健壮性（？）的，因此就需要在页面加载失败时自动重新加载。把加载页面的代码放到 \u003ccode\u003etry {...} catch {...}\u003c/code\u003e 语句中就可以实现：\u003c/p\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u003cspan class=\"token comment\"\u003e# 用一个变量标记是否加载成功\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Success\u003c/span\u003e = \u003cspan class=\"token boolean\"\u003e$false\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 除非加载成功一次，否则一直加载\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003ewhile\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$Success\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token comment\"\u003e# 设定十秒的连接时间限制，超时的话也会按加载失败处理\u003c/span\u003e\n        \u003cspan class=\"token function\"\u003eInvoke-WebRequest\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;...\u0026#39;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eTimeoutSec 10\n\n        \u003cspan class=\"token comment\"\u003e# Invoke-WebRequest的加载成功就会继续执行try部分的代码，并在控制台上输出绿色的Success\u003c/span\u003e\n        \u003cspan class=\"token variable\"\u003e$Success\u003c/span\u003e = \u003cspan class=\"token boolean\"\u003e$true\u003c/span\u003e\n        \u003cspan class=\"token function\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;Success\u0026#39;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eBackgroundColor DarkGreen \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eForegroundColor White \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eNoNewLine\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token comment\"\u003e# 加载失败就会跳转到catch部分，并在控制台上输出红色的Fail\u003c/span\u003e\n        \u003cspan class=\"token variable\"\u003e$Success\u003c/span\u003e = \u003cspan class=\"token boolean\"\u003e$false\u003c/span\u003e\n        \u003cspan class=\"token function\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;Fail\u0026#39;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eBackgroundColor DarkRed \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eForegroundColor White \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eNoNewline\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003eWrite-Host\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39; \u0026#39;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eNoNewline\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e如图所示，每次加载网页都会在控制台上输出一次加载结果，自动重连，一直到加载成功为止～\u003c/p\u003e\u003cp\u003e截图中还输出了文件大小和百分比之类的信息，是小透明自己添加的使用 \u003ccode\u003ejpegtran\u003c/code\u003e 对图片进行优化的效果。通过对图像数据进行重新排列，这个工具可以在不影响 JPEG 图片质量的情况下把图片变成渐进式，而且还能减少 5~7% 的文件大小٩( ‘ω’ )و\u003c/p\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/1231*707),707px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/3d55bbbb02e687d426183d0dd9579c15/jqT_2IBr.png\" data-src-webp=\"https://p.sda1.dev/12/a9fd9ab420fec4ea42f60fb8e0e4d889/-dF5Hrac.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAASACADASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAABAAFBgP/xAAlEAABBAEDAgcAAAAAAAAAAAABAAIEBREhMUEDEhQjNVFhk8H/xAAXAQADAQAAAAAAAAAAAAAAAAABBAUC/8QAIhEAAQIFBAMAAAAAAAAAAAAAAQACAwQRITEyM8HCcnOR/9oADAMBAAIRAxEAPwDkRcXPf6pM+16RIubcRI5baS8lz8kdZ6xG579glyQTC6GANC/45Coxg0Pl7Dc6lS3l1WXOrheMu7vgQWWs7ABzjrPQm3983a4nDJ4kPRpoOWHTlBG4TQa2mB8RJdXJXQADu2SZAHhI+nL/AMUpLRtcv7OpWX5h+XBWTLA8vT3QwBkaBSk0MIlf/9k\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/3d55bbbb02e687d426183d0dd9579c15/jqT_2IBr.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003ch2 id=\"断点续爬\"\u003e\u003ca href=\"#断点续爬\" class=\"headerlink\" title=\"断点续爬\"\u003e\u003c/a\u003e断点续爬\u003c/h2\u003e\u003cp\u003e妹子图网站一共有五千多张套图，一次性爬取完成显然是不可能的，因此也有必要实现断点续爬的功能～\u003c/p\u003e\u003cp\u003e实现的原理也不难，把爬取的进度保存到一个文件中，每次运行脚本的时候读取一下就可以了，还可以跳过已经下载过的图片，避免重复下载。\u003c/p\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u003cspan class=\"token variable\"\u003e$Articles\u003c/span\u003e = \u003cspan class=\"token function\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;D:\\mzitu\\mzitu.json\u0026#39;\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e|\u003c/span\u003e \u003cspan class=\"token function\"\u003eConvertFrom-Json\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 读取爬取进度\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# 文件的内容是从0开始的一个数，表示目前爬取到了第几份套图\u003c/span\u003e\n\u003cspan class=\"token namespace\"\u003e[Int32]\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$Start\u003c/span\u003e = \u003cspan class=\"token function\"\u003eGet-Content\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;D:\\mzitu\\progress.txt\u0026#39;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 循环也是从$Start开始的\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$Start\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-lt\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$Articles\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eLength\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e\u003cspan class=\"token operator\"\u003e++\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e# 将当前的爬取进度保存到文件中\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e \u0026gt; \u003cspan class=\"token string\"\u003e\u0026#39;D:\\mzitu\\progress.txt\u0026#39;\u003c/span\u003e\n\n    \u003cspan class=\"token comment\"\u003e# 获取套图的图片数量……\u003c/span\u003e\n\n    \u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$j\u003c/span\u003e = 1\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$j\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-le\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$ArticlePageCount\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$j\u003c/span\u003e\u003cspan class=\"token operator\"\u003e++\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token comment\"\u003e# 获取每张图片的URL并构造保存路径……\u003c/span\u003e\n\n        \u003cspan class=\"token comment\"\u003e# 如果图片已经存在，就直接下载下一张图片，而不是重复下载\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token namespace\"\u003e[IO.File]\u003c/span\u003e::Exists\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$ImagePath\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econtinue\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n        \u003cspan class=\"token comment\"\u003e# 根据URL下载图片……\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003chr/\u003e\u003cp\u003e最后来一张爬取结果，一晚上爬了三百多份套图，一共一万多张图……|ω•`)\u003c/p\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/1326*763),763px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/66ca5b4b99f7356bd3c425f3667adb5d/tJDIMwOe.png\" data-src-webp=\"https://p.sda1.dev/12/ae6b7b1f80746ba46791108a61670c43/ZjdooTTV.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAASACADASIAAhEBAxEB/8QAGgAAAgIDAAAAAAAAAAAAAAAAAAIBAwQFB//EACUQAAIBAwMDBQEAAAAAAAAAAAECAAMRIQQSMVFxsRMiIzIzQv/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAFB/9oADAMBAAIRAxEAPwDt7/Do/UQWs+0c2tI02oqVULEj+uB0EnW0jT0TMXYguLDpKNF+R7P4jaNjUDiowDWAsMw2ti5uCpj1kVncl1XI56RBg7d6Gym20wKa3u0+c5iUVUK1gBz4hCSaMtkRvsoPcRHRVRyqgGxyBaEJR//Z\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/66ca5b4b99f7356bd3c425f3667adb5d/tJDIMwOe.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003cp\u003e（然后被服务器\u003cstrong\u003e关进小黑屋\u003c/strong\u003e了，打开这个网站的所有图片都是 403，所以运行爬虫还得用代理啊喂！）\u003c/p\u003e\u003cp\u003e那么……妹子图呢？\u003ca href=\"https://tooup.fun/file/get/659/mzitu.7z\" target=\"_blank\" rel=\"noopener\"\u003e( ･᷄ὢ･᷅ )\u003c/a\u003e\u003c/p\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/220*182),182px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/e8e67ddec259e884939a7d53743a0b40/UyKX1UgS.gif\" data-src-webp=\"https://p.sda1.dev/12/de48761dbc38c18bf763e2027a8b2dc5/ou2gYEi-.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAaBAMAAAAktUMMAAAAMFBMVEXl2b9VY3VHTj80QCxeYUe+sJZ6eWPZx68VLxpQWmBeboVneJOQp8ann4iRjXp1iaUtgCO2AAAACXBIWXMAAAPoAAAD6AG1e1JrAAABe0lEQVR42j3OvU/CQBgG8HfBTphcB7UMqC0aWRgoQ51MoCFhIZhYjSEw6FFWYgKNA4MfQ9eii4lL12NwpwNx9hKMWhwMBEQYNPwFkOi1JD655X557t4XZHmXUqc9czqO48zpE8jyHp212OWXHUofGdw/NX9IixDSbFPaYfBASP6bEDtE7DmlDCxi54fIix1iIIoCWgl++CCg9Y4PYc6d9voTBkgANSqE3ysAYBSnQ0toQDLKD97STGo46SJBBDXDl9IxBlVxHPOANfTPDQZByR1Zi4Z7kHhmkMoeWmEfjoLZHEDgwK2j1RPAGf6dq7MpUH1e9kBX+TJ35EGgsoTKEZhgfsvw9gDOqKEum5IQ/uEcja4gFb+LceDHOBbkK5Auo2JlAbDPmyaY5oVUZj96b6w1Hy5vIjm/8LqpMND1dENKeHJmWpJigtbdvj1VrseG9qKu6EkFCliK7sjZnqZ1J7qKZZjoOBUvFfqaVvzCkbgMGOvSADjNS18UlT+TNo/b4yTmPgAAAABJRU5ErkJggg\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/e8e67ddec259e884939a7d53743a0b40/UyKX1UgS.gif\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003cp\u003e\u003cdel\u003e这种妹子图有什么好看的，还是纸片人更可爱！σ*ゝω･)\u003c/del\u003e\u003c/p\u003e\u003cblockquote class=\"mdui-m-b-0 mdui-m-x-0 mdui-p-y-1\" style=\"border-left:4px solid rgba(0,0,0,.36)\"\u003e\u003cstrong\u003e本作品采用\u003ca href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh\" target=\"_blank\"\u003e知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议\u003c/a\u003e进行许可。不允许内容农场类网站、CSDN 用户和微信公众号转载。\u003c/strong\u003e\u003cbr/\u003e\u003cstrong\u003e本文作者：✨小透明・宸✨\u003c/strong\u003e\u003cbr/\u003e\u003cstrong\u003e本文链接：\u003ca href=\"https://akarin.dev/2019/07/30/powershell-mzitu-crawler/\"\u003ehttps://akarin.dev/2019/07/30/powershell-mzitu-crawler/\u003c/a\u003e\u003c/strong\u003e\u003c/blockquote\u003e\u003c/article\u003e",
  "Date": "2019-07-30T08:19:56Z",
  "Author": "✨小透明・宸✨"
}