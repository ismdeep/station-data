{
  "Source": "akarin.dev",
  "Title": "使用 PowerShell 自动读写 Excel 表格",
  "Link": "https://akarin.dev/2019/10/06/powershell-automated-excel/",
  "Content": "\u003carticle class=\"mdui-p-a-3 mdui-card-content mdui-typo\"\u003e\u003cblockquote\u003e\u003cp\u003e封面图：\u003ca href=\"https://www.pixiv.net/member_illust.php?mode=medium\u0026amp;illust_id=76499828\" target=\"_blank\" rel=\"noopener\"\u003ePixiv ID: 23245036 「綾あか」 by 雄塩\u003c/a\u003e\u003cbr/\u003e写完这篇去看了一下，《摇曳百合》的十周年纪念 OVA 有\u003ca href=\"https://vcb-s.com/archives/11266\" target=\"_blank\" rel=\"noopener\"\u003e资源\u003c/a\u003e啦！\u003c/p\u003e\u003c/blockquote\u003e\u003cdiv class=\"aplayer\" style=\"margin-bottom:20px\" id=\"aplayer-445b0685\"\u003e\u003c/div\u003e\u003cscript\u003e(window.aplayersLite||(window.aplayersLite=[])).push({container:document.getElementById(\"aplayer-445b0685\"),audio:{title:\"ゆるゆり、てんやわんや☆\",author:\"七森中☆ごらく部\",url:\"https://fs-im-kefu.7moor-fs2.com/im/2768a390-5474-11ea-afc9-7b323e3e16c0/SovRPZ8x.m4a\",cover:\"https://p.sda1.dev/12/fc9982fa2ff82a77fc58877a0804abfe/MsV2hC-t.jpg\"}})\u003c/script\u003e\u003cnoscript\u003e\u003cp\u003e\u003cem\u003e♪ ゆるゆり、てんやわんや☆ - 七森中☆ごらく部\u003c/em\u003e\u003c/p\u003e\u003caudio controls preload=\"metadata\" src=\"https://fs-im-kefu.7moor-fs2.com/im/2768a390-5474-11ea-afc9-7b323e3e16c0/SovRPZ8x.m4a\"\u003e\u003c/audio\u003e\u003c/noscript\u003e\u003cp\u003e一个前提：\u003cstrong\u003e只有在电脑上安装了微软的 Office 软件才能使用 PowerShell 进行自动操作\u003c/strong\u003e，对于 WPS Office 是无效的。\u003c/p\u003e\u003cp\u003e使用 PowerShell 对 Excel 表格进行操作，实际上并不是让 PowerShell 解析 \u003ccode\u003e*.xlsx\u003c/code\u003e 文件然后进行修改，而是在调用 Excel 的软件对文件进行操作——简单来说，就是用脚本模拟了在 Excel 里面的各种点点点。\u003c/p\u003e\u003ch1 id=\"打开和保存工作表\"\u003e\u003ca href=\"#打开和保存工作表\" class=\"headerlink\" title=\"打开和保存工作表\"\u003e\u003c/a\u003e打开和保存工作表\u003c/h1\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/1161*720),720px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/2ed2e73734775328aea5ce712c11442e/jRnh-V4Y.png\" data-src-webp=\"https://p.sda1.dev/12/caa2eeb0e974ac4dcd1da52d818f492c/QRTWwLGs.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAUACADASIAAhEBAxEB/8QAGgAAAgIDAAAAAAAAAAAAAAAAAAMBBgIFB//EACkQAAEDAgMGBwAAAAAAAAAAAAEAAgMEEQYTIQUUFjJCcSIkMTNRYdH/xAAXAQEBAQEAAAAAAAAAAAAAAAAAAQID/8QAHBEAAgAHAAAAAAAAAAAAAAAAAAECAxETUVOR/9oADAMBAAIRAxEAPwDpgwzh+RrAaCI2FrguCnhDD4J8lF9eN6tcPsxadATFKLBzsytcPEU9+D9gm9qSIDu9TwlsHqpWOAbYXkk/Vb1i7ld2SiwhZla4OI10NRJlxjTlCdnyfIQhU2GfJY+iTvMro76ahCEB/9k\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/2ed2e73734775328aea5ce712c11442e/jRnh-V4Y.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003cp\u003e如图所示，打开一个 Excel 表格的时候，实际上是依次打开了以下三个东西：\u003c/p\u003e\u003col\u003e\u003cli\u003eExcel 软件本体的一个实例\u003c/li\u003e\u003cli\u003e一个名为“工作簿 1”的工作簿（文件）\u003c/li\u003e\u003cli\u003e工作簿名为“Sheet1”的工作表\u003c/li\u003e\u003c/ol\u003e\u003cp\u003e在 PowerShell 中对应的操作是：\u003c/p\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u003cspan class=\"token comment\"\u003e# Excel软件本体\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Excel\u003c/span\u003e = \u003cspan class=\"token function\"\u003eNew-Object\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eComObject Excel\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eApplication\n\n\u003cspan class=\"token comment\"\u003e# 新建或打开工作簿（文件）\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Workbook\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$Excel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eWorkbooks\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eAdd\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Workbook\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$Excel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eWorkbooks\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eOpen\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$Path\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 打开工作表，可以使用从1开始的序号或名称\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$Workbook\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eWorksheets\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e1\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$Workbook\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eWorksheets\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;Sheet1\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 新建工作簿时会默认添加一个名为Sheet1的工作表\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# 也可以自己添加、重命名、删除工作表\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$Workbook\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eWorksheets\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eAdd\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e# 添加，新工作表的序号为1，其它工作表的序号向后顺延\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eName = \u003cspan class=\"token string\"\u003e\u0026#39;新的工作表\u0026#39;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e# 重命名\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eDelete\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e# 删除，工作簿中至少要有一个工作表\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 保存工作簿\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Workbook\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eSave\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 工作簿另存为\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# 使用相对路径的话，根目录为“文档”文件夹\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# 可以用常数指定类型，各个类型对应的常数可以参见：\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# https://docs.microsoft.com/zh-CN/office/vba/api/excel.xlfileformat\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Workbook\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eSaveAs\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$Path\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e# 默认用xlsx格式保存\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Workbook\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eSaveAs\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$Path\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e 56\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e# 旧版Excel的xls格式\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Workbook\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eSaveAs\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$Path\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e 62\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token comment\"\u003e# 使用UTF-8编码的csv格式\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 退出Excel软件\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Excel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eQuit\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e为了便于自动化操作，可以在脚本中设定 Excel 软件的实例是否需要显示窗口（默认不显示）和警告提示框（默认显示）。“警告提示框”的典型例子是退出 Excel 时显示的“是否保存对○○的更改？”或者保存时的“是否覆盖○○？”，如果设定为不显示的话，就会默认选取“不保存”然后直接退出。\u003c/p\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u003cspan class=\"token variable\"\u003e$Excel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eVisible = \u003cspan class=\"token boolean\"\u003e$false\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Excel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eDisplayAlerts = \u003cspan class=\"token boolean\"\u003e$true\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003ch1 id=\"修改单元格\"\u003e\u003ca href=\"#修改单元格\" class=\"headerlink\" title=\"修改单元格\"\u003e\u003c/a\u003e修改单元格\u003c/h1\u003e\u003cp\u003e工作表中的每个单元格也是一个对象，可以直接进行赋值，也可以通过它的属性获取单元格的值。\u003c/p\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u003cspan class=\"token comment\"\u003e# 修改位于第1行第2列的单元格B1的内容\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eCells\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e 2\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e = \u003cspan class=\"token string\"\u003e\u0026#39;B1单元格\u0026#39;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 可以直接使用 PowerShell 中基本类型的变量\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# 使用循环，将A1到A50的单元格用0-255的随机数填充\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e = 1\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-le\u003c/span\u003e 50\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e\u003cspan class=\"token operator\"\u003e++\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eCells\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e 1\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e = \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003eGet-Random\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eMinimum 0 \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eMaximum 256\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 使用公式和函数\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eCells\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e 2\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e = \u003cspan class=\"token string\"\u003e\u0026#39;=A1+A2\u0026#39;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eCells\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e 2\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e = \u003cspan class=\"token string\"\u003e\u0026#39;=AVERAGE(A1:A50)\u0026#39;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 获取单元格内的值\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eCells\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e 2\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eText\n\n\u003cspan class=\"token comment\"\u003e# 获取单元格内的原始公式或函数\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eCells\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e 2\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eFormula\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eExcel 中的单元格使用的是类似于 \u003ccode\u003eA1\u003c/code\u003e、\u003ccode\u003eB2\u003c/code\u003e 这样的坐标，字母为列，数字为行，但是使用 PowerShell 脚本进行操作时，定位单元格时就是直接用数字指定行和列了。公式和函数中使用的还是单元格坐标而不是行和列，可以使用下面的函数将行和列转换为单元格坐标：\u003c/p\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eGet-ExcelCellIndex\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token namespace\"\u003e[Int32]\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$Row\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token namespace\"\u003e[Int32]\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$Column\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$ColumnIndex\u003c/span\u003e = \u003cspan class=\"token string\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003edo\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token variable\"\u003e$Column\u003c/span\u003e\u003cspan class=\"token operator\"\u003e--\u003c/span\u003e\n        \u003cspan class=\"token variable\"\u003e$Remainder\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$Column\u003c/span\u003e \u003cspan class=\"token operator\"\u003e%\u003c/span\u003e 26\n        \u003cspan class=\"token variable\"\u003e$ColumnIndex\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+=\u003c/span\u003e \u003cspan class=\"token namespace\"\u003e[Char]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e0x41 \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$Remainder\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token variable\"\u003e$Column\u003c/span\u003e = \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$Column\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$Remainder\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e 26\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ewhile\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$Column\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-gt\u003c/span\u003e 0\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$ColumnIndex\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$Row\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token function\"\u003eGet-ExcelCellIndex\u003c/span\u003e 1 1 \u003cspan class=\"token comment\"\u003e# 输出A1\u003c/span\u003e\n\u003cspan class=\"token function\"\u003eGet-ExcelCellIndex\u003c/span\u003e 1 2 \u003cspan class=\"token comment\"\u003e# 输出B1\u003c/span\u003e\n\u003cspan class=\"token function\"\u003eGet-ExcelCellIndex\u003c/span\u003e 4 26 \u003cspan class=\"token comment\"\u003e# 输出Z4\u003c/span\u003e\n\u003cspan class=\"token function\"\u003eGet-ExcelCellIndex\u003c/span\u003e 5 27 \u003cspan class=\"token comment\"\u003e# 输出AA5\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e如果需要遍历某一整行/列单元格的话，可以通过工作表的 \u003ccode\u003eUsedRange\u003c/code\u003e 来获取工作表的行/列数：\u003c/p\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u003cspan class=\"token comment\"\u003e# 获取行数\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eUsedRange\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eRows\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eCount\n\u003cspan class=\"token comment\"\u003e# 获取列数\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eUsedRange\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eColumns\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eCount\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003ch1 id=\"实例：古诗词打印稿\"\u003e\u003ca href=\"#实例：古诗词打印稿\" class=\"headerlink\" title=\"实例：古诗词打印稿\"\u003e\u003c/a\u003e实例：古诗词打印稿\u003c/h1\u003e\u003cp\u003e这个例子是瞎扯的，主要是为了展示使用 PowerShell 操作整个微软 Office 全家桶的便利性_(:зゝ∠)_\u003c/p\u003e\u003cblockquote\u003e\u003cp\u003e某校正在开展传统文化宣传活动，内容之一是将用 A4 纸打印的古诗词名句张贴在校园各处。为此需要收集一批古诗词名句，以及将收集到的每条名句用 Word 制作成打印稿。\u003c/p\u003e\u003cp\u003e为了简化例子，这里就只考虑古诗（不考虑词）的打印稿样式，如图所示：\u003c/p\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/1163*775),775px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/ea87d0a34052ab2f4593747a53442a0e/rta7oWIB.png\" data-src-webp=\"https://p.sda1.dev/12/e860147ddbdbeda3659f6d62d3dfbc34/rAD-eojv.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAVACADASIAAhEBAxEB/8QAGQAAAwADAAAAAAAAAAAAAAAAAAQFAQMH/8QAKRAAAgAFAgQGAwAAAAAAAAAAAQIAAwQFEQYSITEzcRMjNEFRklJUcv/EABcBAAMBAAAAAAAAAAAAAAAAAAACAwH/xAAbEQABBAMAAAAAAAAAAAAAAAAAAgMTkQFSU//aAAwDAQACEQMRAD8A6amlbFP2KbfKyqfLCGRoWy/oyfu8X7b1j/BiNX22c9TUTDaKZwXYKz1LqWU8ckCKTPdF3kSNvRNGltCWVh6GV93hObpSwo6hqEHaPzeK1HbtlwlVLWqml7WPmJPZiMbuS8veKFd137CNme6rvIRt6JoWkVJkneEzwxiH2rS+C0pTBBExjK1pUYWUo7ROef42X245jHaCCAD/2Q\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/ea87d0a34052ab2f4593747a53442a0e/rta7oWIB.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003c/blockquote\u003e\u003ch2 id=\"获取古诗词\"\u003e\u003ca href=\"#获取古诗词\" class=\"headerlink\" title=\"获取古诗词\"\u003e\u003c/a\u003e获取古诗词\u003c/h2\u003e\u003cp\u003e古诗词的收集并不需要去从图书馆里翻出《唐诗三百首》之类的书籍然后一个一个字地录入，在网上有现成的接口“古诗词・一言 API”，访问 \u003ca href=\"https://api.gushi.ci/all\" target=\"_blank\" rel=\"noopener\"\u003e\u003ccode\u003ehttps://api.gushi.ci/all\u003c/code\u003e\u003c/a\u003e 就可以随机得到一条古诗词名句。这个接口使用 JSON 格式返回数据，示例：\u003c/p\u003e\u003cpre class=\"line-numbers language-none\"\u003e\u003ccode class=\"language-none\"\u003e{\n    \u0026#34;content\u0026#34; : \u0026#34;飞来山上千寻塔，闻说鸡鸣见日升。\u0026#34;,\n    \u0026#34;origin\u0026#34; : \u0026#34;登飞来峰\u0026#34;,\n    \u0026#34;author\u0026#34; : \u0026#34;王安石\u0026#34;,\n    \u0026#34;category\u0026#34; : \u0026#34;古诗文-天气-太阳\u0026#34;\n}\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003ePowerShell 可以解析 JSON 数据，于是可以使用下面的代码获取一批（这里设为十条）古诗词，保存在数组 \u003ccode\u003e$PoemList\u003c/code\u003e 中：\u003c/p\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u003cspan class=\"token variable\"\u003e$PoemList\u003c/span\u003e = @\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e = 0\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-lt\u003c/span\u003e 10\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e\u003cspan class=\"token operator\"\u003e++\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token comment\"\u003e# 使用Invoke-RestMethod直接得到解析后的JSON数据\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$Poem\u003c/span\u003e = \u003cspan class=\"token function\"\u003eInvoke-RestMethod\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;https://api.gushi.ci/all\u0026#39;\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$PoemList\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+=\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$Poem\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/1241*774),774px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/d76669f10030257c2f22bffb7d0a4882/ScEFi_Go.png\" data-src-webp=\"https://p.sda1.dev/12/3b727b08337e33c986e4dda4f75e24c2/-uB4LbJ9.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAUACADASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIEBQP/xAAlEAACAQIFBAMBAAAAAAAAAAABAgADBQQREiExE0NR0QYjMnL/xAAXAQEBAQEAAAAAAAAAAAAAAAAAAQQF/8QAGhEAAgMBAQAAAAAAAAAAAAAAAAERUVICEv/aAAwDAQACEQMRAD8AxHvN/DEC5Yzk95/c4G+X8rrF0xmR8V39yetiqTawQ2+3IMlGJK0lVdjmc501ysowy7ZotevkKgk3bG7c/e8RL9fS6g3bG8jvvInxCNTdcmzPvOTJ+0/oS+VlCXZW9BNbbnkxegnkwhKA6CeTGSgmtdzyIQgH/9k\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/d76669f10030257c2f22bffb7d0a4882/ScEFi_Go.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003ch2 id=\"整理古诗词，保存到-Excel-表格中\"\u003e\u003ca href=\"#整理古诗词，保存到-Excel-表格中\" class=\"headerlink\" title=\"整理古诗词，保存到 Excel 表格中\"\u003e\u003c/a\u003e整理古诗词，保存到 Excel 表格中\u003c/h2\u003e\u003cp\u003e使用一个循环就可以将数组 \u003ccode\u003e$PoemList\u003c/code\u003e 保存古诗词保存到表格中。\u003c/p\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u003cspan class=\"token variable\"\u003e$Excel\u003c/span\u003e = \u003cspan class=\"token function\"\u003eNew-Object\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eComObject Excel\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eApplication\n\u003cspan class=\"token variable\"\u003e$Workbook\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$Excel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eWorkbooks\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eAdd\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$Workbook\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eWorksheets\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e1\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eName = \u003cspan class=\"token string\"\u003e\u0026#39;古诗词\u0026#39;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 第一行用作表头\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eCells\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e 1\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e = \u003cspan class=\"token string\"\u003e\u0026#39;出处\u0026#39;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eCells\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e 2\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e = \u003cspan class=\"token string\"\u003e\u0026#39;作者\u0026#39;\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eCells\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e 3\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e = \u003cspan class=\"token string\"\u003e\u0026#39;正文\u0026#39;\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 设定列宽\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eColumns\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e1\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eColumnWidth = 18\n\u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eColumns\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e2\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eColumnWidth = 10\n\u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eColumns\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e3\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eColumnWidth = 40\n\n\u003cspan class=\"token comment\"\u003e# 从第二行开始保存古诗词数据\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Line\u003c/span\u003e = 2\n\u003cspan class=\"token keyword\"\u003eforeach\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$Poem\u003c/span\u003e in \u003cspan class=\"token variable\"\u003e$PoemList\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eCells\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$Line\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e 1\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$Poem\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eorigin\n    \u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eCells\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$Line\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e 2\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$Poem\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eauthor\n    \u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eCells\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$Line\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e 3\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$Poem\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003econtent\n    \u003cspan class=\"token variable\"\u003e$Line\u003c/span\u003e\u003cspan class=\"token operator\"\u003e++\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token variable\"\u003e$Workbook\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eSaveAs\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;古诗词.xlsx\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Excel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eQuit\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/1161*720),720px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/651f951f3981e4119cd306ad3f7b7a2a/TdO8GAW3.png\" data-src-webp=\"https://p.sda1.dev/12/9fb2469154622a1f13d32298d263e143/b8ggg5B8.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAUACADASIAAhEBAxEB/8QAGgAAAgIDAAAAAAAAAAAAAAAAAAIDBQEGB//EACYQAAEEAQIGAgMAAAAAAAAAAAEAAgMRBAYTBRYhIjFRFHEyYdH/xAAXAQEBAQEAAAAAAAAAAAAAAAAAAQID/8QAHBEAAgAHAAAAAAAAAAAAAAAAAAECAxETUVOR/9oADAMBAAIRAxEAPwDpQ01p57WA4ERIbVhzgn5Q0+Cawov13vV3DjSbTe1tGyPfcCnxsR7HgyAUApRYOdmVrg4igdpDgJusSID7es8o8B8uxWEBtC5JP6tvSu/F30lFhCzK1wcRXQ5Em2wdKDQpt+T2EIVNhvyUfCh+TK6O+nUIQgP/2Q\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/651f951f3981e4119cd306ad3f7b7a2a/TdO8GAW3.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003ch2 id=\"用-Word-生成打印稿\"\u003e\u003ca href=\"#用-Word-生成打印稿\" class=\"headerlink\" title=\"用 Word 生成打印稿\"\u003e\u003c/a\u003e用 Word 生成打印稿\u003c/h2\u003e\u003cp\u003e虽然这里涉及到的是用 PowerShell 操作 Word，但是和操作 Excel 是差不多的：\u003c/p\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u003cspan class=\"token comment\"\u003e# Word软件本体\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Word\u003c/span\u003e = \u003cspan class=\"token function\"\u003eNew-Object\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eComObject Word\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eApplication\n\n\u003cspan class=\"token comment\"\u003e# 打开文档\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Document\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$Word\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eDocuments\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eOpen\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$Path\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 另存为文档\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Document\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eSaveAs\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$Path\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 关闭文档，但不退出Word\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Document\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eClose\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# 退出Word软件\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Word\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eQuit\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e由于 Word 文档不像 Excel 表格可以使用单元格直接定位修改位置，所以这里使用一个\u003cstrong\u003e模板\u003c/strong\u003e来生成打印稿：模板上留下四个\u003cstrong\u003e用 \u003ccode\u003e%\u003c/code\u003e 表示的占位符\u003c/strong\u003e（也可以使用其它符号），分别对应古诗词正文的前半句、后半句、作者、出处。在脚本运行时\u003cstrong\u003e将占位符替换为对应的值\u003c/strong\u003e，然后以古诗词的出处作为文件名，将文档另存为。\u003c/p\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/1163*775),775px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/85b6ae67f2947b6c6c515fb5aa0ba3dd/xKTPxVpr.png\" data-src-webp=\"https://p.sda1.dev/12/80891bcad10910e3a2adf332ab75ba8b/gbpypCq_.webp\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAAVACADASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAQDBQYH/8QAKBAAAgIBBAADCQAAAAAAAAAAAQIAAxEEBQYxE0GSEiIjMzRUYXKR/8QAFwEAAwEAAAAAAAAAAAAAAAAAAAIDAf/EABsRAAEEAwAAAAAAAAAAAAAAAAACAxORAVJT/9oADAMBAAIRAxEAPwDpqcV2K/2FO31ZVMdsI0OC7L9jT6nl9tvzj+hjO5VeLQF8Kuz3unYqOj0RKTPdF3kSNvRNGXbgmyMPoa/W8Uu4nsKOqtoQcDzd5s9FWtVJRa0QBjgI2RiI60/HY/gTZnuq7yEbeiaINPea2LBfLEsTqXbBKiEJMYF1LqMAASsttNpZsY7H8hCAH//Z\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/85b6ae67f2947b6c6c515fb5aa0ba3dd/xKTPxVpr.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003cpre class=\"language-powershell line-numbers\" data-language=\"powershell\"\u003e\u003ccode class=\"language-powershell\"\u003e\u003cspan class=\"token comment\"\u003e# 用于在Word文档中执行一次替换的函数\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e Replace-WordDoc\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$Document\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$FindText\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$ReplaceText\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$Range\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$Document\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eContent\n    \u003cspan class=\"token namespace\"\u003e[void]\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$Range\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eFind\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eExecute\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$FindText\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$Range\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eText = \u003cspan class=\"token variable\"\u003e$ReplaceText\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token variable\"\u003e$Excel\u003c/span\u003e = \u003cspan class=\"token function\"\u003eNew-Object\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eComObject Excel\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eApplication\n\u003cspan class=\"token variable\"\u003e$Workbook\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$Excel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eWorkbooks\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eOpen\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;C:\\Users\\Admin\\Documents\\古诗词.xlsx\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$Workbook\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eWorksheets\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;古诗词\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token variable\"\u003e$Word\u003c/span\u003e = \u003cspan class=\"token function\"\u003eNew-Object\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-\u003c/span\u003eComObject Word\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eApplication\n\n\u003cspan class=\"token comment\"\u003e# 读取表格中的每一行数据（表头除外），在文档中进行替换，然后另存为\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e = 2\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e \u003cspan class=\"token operator\"\u003e-le\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eUsedRange\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eRows\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eCount\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e\u003cspan class=\"token operator\"\u003e++\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$Origin\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eCells\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e 1\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eText\n    \u003cspan class=\"token variable\"\u003e$Author\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eCells\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e 2\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eText\n    \u003cspan class=\"token variable\"\u003e$Content\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$Sheet\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eCells\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eItem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token variable\"\u003e$i\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e 3\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eText\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eSplit\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;，。\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$Document\u003c/span\u003e = \u003cspan class=\"token variable\"\u003e$Word\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eDocuments\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eOpen\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;C:\\Users\\Admin\\Documents\\古诗词打印稿模板.docx\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n    Replace-WordDoc \u003cspan class=\"token variable\"\u003e$Document\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;%0%\u0026#39;\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$Content\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e0\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n    Replace-WordDoc \u003cspan class=\"token variable\"\u003e$Document\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;%1%\u0026#39;\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$Content\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e1\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n    Replace-WordDoc \u003cspan class=\"token variable\"\u003e$Document\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;%2%\u0026#39;\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$Author\u003c/span\u003e\n    Replace-WordDoc \u003cspan class=\"token variable\"\u003e$Document\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;%3%\u0026#39;\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$Origin\u003c/span\u003e\n\n    \u003cspan class=\"token variable\"\u003e$Document\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eSaveAs\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\u0026#39;C:\\Users\\Admin\\Documents\\古诗词打印稿\\\u0026#39;\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token variable\"\u003e$Origin\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\u0026#39;.docx\u0026#39;\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token variable\"\u003e$Document\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eClose\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token variable\"\u003e$Excel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eQuit\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token variable\"\u003e$Word\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eQuit\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"line-numbers-rows\" aria-hidden=\"true\"\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003cspan\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e脚本执行完成后，就可以得到批量生成的打印稿了。\u003c/p\u003e\u003cfigure class=\"akarin-blurred-container\"\u003e\u003cdiv style=\"padding-bottom:min(calc(100%/1920*1080),1080px,480px)\"\u003e\u003c/div\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded\" data-src=\"https://p.sda1.dev/12/478a36e080a52bab96da07f431974712/X8OM9eW_.png\" data-src-webp=\"https://p.sda1.dev/12/c4163198ad466b939e93844f2a4f0424/RW8moTQt.jpg\"/\u003e \u003cimg class=\"mdui-hoverable mdui-img-rounded akarin-blurred\" src=\"data:image/jpeg;base64,/9j/2wBDAAgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/2wBDAQgICAgJCAkKCgkNDgwODRMREBARExwUFhQWFBwrGx8bGx8bKyYuJSMlLiZENS8vNUROQj5CTl9VVV93cXecnNH/wAARCAASACADASIAAhEBAxEB/8QAGwAAAQQDAAAAAAAAAAAAAAAAAAEDBQYCBAf/xAAkEAACAgEDAwUBAAAAAAAAAAABAgMRAAQSUQUhcQYTFSIxQf/EABcBAQEBAQAAAAAAAAAAAAAAAAECAAP/xAAaEQEBAAMBAQAAAAAAAAAAAAABAAJCgRFR/9oADAMBAAIRAxEAPwDuiJKrQ0tJRsDISWLXqu/5qVCQdqsIACR5TLNmo+ldoSrxAhSWBvEU+dIQasQN6minR3kSeMfqNKgDedsAOTUGt6m80KS9O0yozgOw1LEgcgbBeOsnuwKo1EkbAk/RmW752492EmnUSNJtYWzXfc3/AHLcx0x5Bj5szyMxu2OZ2eThhnOqLPJxCxo9zhhmi//Z\"/\u003e\u003cnoscript\u003e\u003cimg class=\"mdui-hoverable mdui-img-rounded mdui-center mdui-img-fluid\" src=\"https://p.sda1.dev/12/478a36e080a52bab96da07f431974712/X8OM9eW_.png\" alt=\"undefined\" title=\"undefined\"\u003e\u003c/noscript\u003e\u003c/figure\u003e\u003cp\u003e如果把 Excel 表格中的内容以 CSV 格式保存的话，就可以使用 PowerShell 的 \u003ccode\u003eImport-Csv\u003c/code\u003e 命令直接读取数据，不需要在脚本中频繁调用 Excel，提高运行速度。\u003c/p\u003e\u003cblockquote class=\"mdui-m-b-0 mdui-m-x-0 mdui-p-y-1\" style=\"border-left:4px solid rgba(0,0,0,.36)\"\u003e\u003cstrong\u003e本作品采用\u003ca href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh\" target=\"_blank\"\u003e知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议\u003c/a\u003e进行许可。不允许内容农场类网站、CSDN 用户和微信公众号转载。\u003c/strong\u003e\u003cbr/\u003e\u003cstrong\u003e本文作者：✨小透明・宸✨\u003c/strong\u003e\u003cbr/\u003e\u003cstrong\u003e本文链接：\u003ca href=\"https://akarin.dev/2019/10/06/powershell-automated-excel/\"\u003ehttps://akarin.dev/2019/10/06/powershell-automated-excel/\u003c/a\u003e\u003c/strong\u003e\u003c/blockquote\u003e\u003c/article\u003e",
  "Date": "2019-10-06T12:07:21Z",
  "Author": "✨小透明・宸✨"
}