{
  "Source": "antonz.org",
  "Title": "Modern SQLite: Delete limit",
  "Link": "https://antonz.org/sqlite-delete-limit/",
  "Content": "\u003carticle class=\"post\"\u003e\u003cdiv class=\"row\"\u003e\u003cdiv class=\"col-xs-12 col-md-10 article\"\u003e\u003cheader\u003e\u003ch1\u003eModern SQLite: Delete limit\u003c/h1\u003e\u003c/header\u003e\u003cp\u003e\u003cem\u003eThis post is part of the \u003ca href=\"/tags/modern-sqlite/\"\u003eModern SQLite\u003c/a\u003e series, where I write about handy SQLite features you might not have heard about.\u003c/em\u003e\u003c/p\u003e\u003cp\u003eBet you\u0026#39;ve never heard of it! The \u003ccode\u003edelete\u003c/code\u003e statement in SQLite supports \u003ccode\u003eorder by\u003c/code\u003e and \u003ccode\u003elimit\u003c/code\u003e/\u003ccode\u003eoffset\u003c/code\u003e clauses, so that you can limit the number of rows to be deleted.\u003c/p\u003e\u003cp\u003eThis can be useful if there is (potentially) a lot to delete and you don\u0026#39;t want the query to take forever (perhaps you will schedule such \u0026#34;limited\u0026#34; deletes to run regularly).\u003c/p\u003e\u003cp\u003eThe \u003ccode\u003eorder by\u003c/code\u003e combined with \u003ccode\u003elimit\u003c/code\u003e allows you to \u0026#34;prioritize\u0026#34; deletes (for example, delete older records first).\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003ecreate\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003etable\u003c/span\u003e \u003cspan style=\"color:#000\"\u003eevents\u003c/span\u003e(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#000\"\u003eid\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003einteger\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eprimary\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003ekey\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#000\"\u003ectime\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003etext\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#000\"\u003edescr\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003etext\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003einsert\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003einto\u003c/span\u003e \u003cspan style=\"color:#000\"\u003eevents\u003c/span\u003e(\u003cspan style=\"color:#000\"\u003ectime\u003c/span\u003e, \u003cspan style=\"color:#000\"\u003edescr\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003evalues\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e(\u003cspan style=\"color:#c41a16\"\u003e\u0026#39;2024-05-20T12:34:00\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#c41a16\"\u003e\u0026#39;event a\u0026#39;\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e(\u003cspan style=\"color:#c41a16\"\u003e\u0026#39;2024-05-20T12:34:01\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#c41a16\"\u003e\u0026#39;event b\u0026#39;\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e(\u003cspan style=\"color:#c41a16\"\u003e\u0026#39;2024-05-20T12:34:02\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#c41a16\"\u003e\u0026#39;event c\u0026#39;\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e(\u003cspan style=\"color:#c41a16\"\u003e\u0026#39;2024-05-20T12:34:03\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#c41a16\"\u003e\u0026#39;event d\u0026#39;\u003c/span\u003e),\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e(\u003cspan style=\"color:#c41a16\"\u003e\u0026#39;2024-05-20T12:34:04\u0026#39;\u003c/span\u003e, \u003cspan style=\"color:#c41a16\"\u003e\u0026#39;event e\u0026#39;\u003c/span\u003e);\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#177500\"\u003e-- delete 3 oldest events (a, b, c)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#177500\"\u003e\u003c/span\u003e\u003cspan style=\"color:#a90d91\"\u003edelete\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#000\"\u003eevents\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eorder\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eby\u003c/span\u003e \u003cspan style=\"color:#000\"\u003ectime\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003elimit\u003c/span\u003e \u003cspan style=\"color:#1c01ce\"\u003e3\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThere is a big \u003cem\u003ebut\u003c/em\u003e though. For some reason, the SQLite authors don\u0026#39;t include this feature in the amalgamation. So it\u0026#39;s effectively unavailable to most third-party drivers and programs that use the amalgamation to compile SQLite.\u003c/p\u003e\u003cp\u003eMaybe one day the SQLite team will change their mind and we\u0026#39;ll be able to limit our deletes! Until then, the feature requires building from source (not amalgamated) with a compile-time flag.\u003c/p\u003e\u003cp\u003eDocumentation:\u003c/p\u003e\u003cul\u003e\u003cli\u003e\u003ca href=\"https://www.sqlite.org/lang_delete.html#optional_limit_and_order_by_clauses\"\u003eOptional LIMIT and ORDER BY clauses\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"https://www.sqlite.org/compile.html#enable_update_delete_limit\"\u003eSQLITE_ENABLE_UPDATE_DELETE_LIMIT\u003c/a\u003e\u003c/li\u003e\u003c/ul\u003e\u003cp\u003e──\u003c/p\u003e\u003cp\u003eP.S. Like SQLite? Check out \u003ca href=\"https://github.com/nalgeon/redka\"\u003eRedka\u003c/a\u003e — Redis re-implemented with SQLite.\u003c/p\u003e\u003cp\u003e\u003ca href=\"/subscribe/\"\u003e★ Subscribe\u003c/a\u003e to keep up with new posts.\u003c/p\u003e\u003c/div\u003e\u003c/div\u003e\u003cfooter class=\"post__footer\"\u003e\u003cdiv class=\"row\"\u003e\u003cdiv class=\"col-xs-12\"\u003e\u003cdiv class=\"post__date\"\u003e\u003ctime datetime=\"2024-06-11 12:50:00 +0000 UTC\"\u003e11 Jun, 2024\u003c/time\u003e\u003c/div\u003e\u003cdiv class=\"post__tags\"\u003e\u003ca href=\"/tags/sqlite/\"\u003esqlite\u003c/a\u003e \n\u003ca href=\"/tags/modern-sqlite/\"\u003emodern-sqlite\u003c/a\u003e \u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/footer\u003e\u003c/article\u003e",
  "Date": "2024-06-11T12:50:00Z",
  "Author": "Anton Zhiyanov"
}