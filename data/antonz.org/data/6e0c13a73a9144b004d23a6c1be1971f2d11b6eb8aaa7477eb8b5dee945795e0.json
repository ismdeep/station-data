{
  "Source": "antonz.org",
  "Title": "SQL recipe: Compare with neighbors",
  "Link": "https://antonz.org/sql-compare-neighbors/",
  "Content": "\u003carticle class=\"post\"\u003e\u003cdiv class=\"row\"\u003e\u003cdiv class=\"col-xs-12 col-md-10 article\"\u003e\u003cheader\u003e\u003ch1\u003eSQL recipe: Compare with neighbors\u003c/h1\u003e\u003c/header\u003e\u003cp\u003e\u003cem\u003eThis post is part of the \u0026#34;SQL Recipes\u0026#34; series, where I provide short patterns for solving common SQL data analysis tasks.\u003c/em\u003e\u003c/p\u003e\u003cp\u003eSuppose we want to compare each data record with its neighbors based on some column value. For example:\u003c/p\u003e\u003cul\u003e\u003cli\u003eCompare sales from one month to the previous month (month-over-month or MoM change) or to the same month a year ago (year-over-year or YoY change).\u003c/li\u003e\u003cli\u003eCompare financial results for a given period to the same period in the previous year (like-for-like or LFL analysis).\u003c/li\u003e\u003cli\u003eObserve the daily difference in stock prices to understand market trends.\u003c/li\u003e\u003cli\u003eCalculate the difference in traffic between days of the week to plan capacity changes.\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eThe solution is to use the \u003ccode\u003elag()\u003c/code\u003e function over an SQL window ordered by target columns.\u003c/p\u003e\u003ch2 id=\"example\"\u003eExample\u003c/h2\u003e\u003cp\u003eLet\u0026#39;s compare the company\u0026#39;s \u003ccode\u003eexpenses\u003c/code\u003e for each month to the previous month in absolute terms:\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eselect\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a90d91\"\u003eyear\u003c/span\u003e, \u003cspan style=\"color:#a90d91\"\u003emonth\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#000\"\u003eexpense\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#000\"\u003eexpense\u003c/span\u003e \u003cspan style=\"color:#000\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#000\"\u003elag\u003c/span\u003e(\u003cspan style=\"color:#000\"\u003eexpense\u003c/span\u003e) \u003cspan style=\"color:#000\"\u003eover\u003c/span\u003e \u003cspan style=\"color:#000\"\u003ew\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#000\"\u003ediff\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#000\"\u003eexpenses\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#000\"\u003ewindow\u003c/span\u003e \u003cspan style=\"color:#000\"\u003ew\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eas\u003c/span\u003e (\u003cspan style=\"color:#a90d91\"\u003eorder\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eby\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eyear\u003c/span\u003e, \u003cspan style=\"color:#a90d91\"\u003emonth\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eorder\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eby\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eyear\u003c/span\u003e, \u003cspan style=\"color:#a90d91\"\u003emonth\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe \u003ccode\u003elag(value, offset)\u003c/code\u003e function returns the \u003ccode\u003evalue\u003c/code\u003e of the record that is \u003ccode\u003eoffset\u003c/code\u003e rows behind the current one. By default, the offset is 1 and can be omitted.\u003c/p\u003e\u003cp\u003eNow let\u0026#39;s calculate the relative change from month to month:\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eselect\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a90d91\"\u003eyear\u003c/span\u003e, \u003cspan style=\"color:#a90d91\"\u003emonth\u003c/span\u003e, \u003cspan style=\"color:#000\"\u003eexpense\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#000\"\u003eround\u003c/span\u003e(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e    (\u003cspan style=\"color:#000\"\u003eexpense\u003c/span\u003e \u003cspan style=\"color:#000\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#000\"\u003elag\u003c/span\u003e(\u003cspan style=\"color:#000\"\u003eexpense\u003c/span\u003e) \u003cspan style=\"color:#000\"\u003eover\u003c/span\u003e \u003cspan style=\"color:#000\"\u003ew\u003c/span\u003e)\u003cspan style=\"color:#000\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#1c01ce\"\u003e100\u003c/span\u003e.\u003cspan style=\"color:#1c01ce\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#000\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#000\"\u003elag\u003c/span\u003e(\u003cspan style=\"color:#000\"\u003eexpense\u003c/span\u003e) \u003cspan style=\"color:#000\"\u003eover\u003c/span\u003e \u003cspan style=\"color:#000\"\u003ew\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e  ) \u003cspan style=\"color:#a90d91\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#c41a16\"\u003e\u0026#34;diff %\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#000\"\u003eexpenses\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#000\"\u003ewindow\u003c/span\u003e \u003cspan style=\"color:#000\"\u003ew\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eas\u003c/span\u003e (\u003cspan style=\"color:#a90d91\"\u003eorder\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eby\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eyear\u003c/span\u003e, \u003cspan style=\"color:#a90d91\"\u003emonth\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eorder\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eby\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eyear\u003c/span\u003e, \u003cspan style=\"color:#a90d91\"\u003emonth\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"alternatives\"\u003eAlternatives\u003c/h2\u003e\u003cp\u003eSuppose we want to compare quarterly \u003ccode\u003esales\u003c/code\u003e with the previous year. This is where the \u003ccode\u003eoffset\u003c/code\u003e parameter comes in handy:\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003ewith\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003edata\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eas\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a90d91\"\u003eselect\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a90d91\"\u003eyear\u003c/span\u003e, \u003cspan style=\"color:#000\"\u003equarter\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#000\"\u003elag\u003c/span\u003e(\u003cspan style=\"color:#000\"\u003eamount\u003c/span\u003e, \u003cspan style=\"color:#1c01ce\"\u003e4\u003c/span\u003e) \u003cspan style=\"color:#000\"\u003eover\u003c/span\u003e \u003cspan style=\"color:#000\"\u003ew\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#000\"\u003eprev\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#000\"\u003eamount\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003ecurrent\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#000\"\u003eround\u003c/span\u003e(\u003cspan style=\"color:#000\"\u003eamount\u003c/span\u003e\u003cspan style=\"color:#000\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#1c01ce\"\u003e100\u003c/span\u003e.\u003cspan style=\"color:#1c01ce\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#000\"\u003e/\u003c/span\u003e \u003cspan style=\"color:#000\"\u003elag\u003c/span\u003e(\u003cspan style=\"color:#000\"\u003eamount\u003c/span\u003e, \u003cspan style=\"color:#1c01ce\"\u003e4\u003c/span\u003e) \u003cspan style=\"color:#000\"\u003eover\u003c/span\u003e \u003cspan style=\"color:#000\"\u003ew\u003c/span\u003e) \u003cspan style=\"color:#a90d91\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#c41a16\"\u003e\u0026#34;increase %\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a90d91\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#000\"\u003esales\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#000\"\u003ewindow\u003c/span\u003e \u003cspan style=\"color:#000\"\u003ew\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eas\u003c/span\u003e (\u003cspan style=\"color:#a90d91\"\u003eorder\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eby\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eyear\u003c/span\u003e, \u003cspan style=\"color:#000\"\u003equarter\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eselect\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#000\"\u003equarter\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#000\"\u003eprev\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#000\"\u003ey2019\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a90d91\"\u003ecurrent\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#000\"\u003ey2020\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#c41a16\"\u003e\u0026#34;increase %\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003edata\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003ewhere\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eyear\u003c/span\u003e \u003cspan style=\"color:#000\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#1c01ce\"\u003e2020\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eorder\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eby\u003c/span\u003e \u003cspan style=\"color:#000\"\u003equarter\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eLooking back 4 quarters with \u003ccode\u003elag(amount, 4)\u003c/code\u003e gives us the same quarter but from the previous year.\u003c/p\u003e\u003cp\u003eThere is also a \u003ccode\u003elead()\u003c/code\u003e function. It works just like \u003ccode\u003elag()\u003c/code\u003e, except that it looks forward instead of backward.\u003c/p\u003e\u003ch2 id=\"compatibility\"\u003eCompatibility\u003c/h2\u003e\u003cp\u003eAll major vendors support the \u003ccode\u003elag()\u003c/code\u003e and \u003ccode\u003elead()\u003c/code\u003e window functions. Some of them, such as MS SQL and Oracle, do not support the \u003ccode\u003ewindow\u003c/code\u003e clause. In these cases, we can inline the window definition:\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eselect\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#a90d91\"\u003eyear\u003c/span\u003e, \u003cspan style=\"color:#a90d91\"\u003emonth\u003c/span\u003e, \u003cspan style=\"color:#000\"\u003eexpense\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#000\"\u003eexpense\u003c/span\u003e \u003cspan style=\"color:#000\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#000\"\u003elag\u003c/span\u003e(\u003cspan style=\"color:#000\"\u003eexpense\u003c/span\u003e) \u003cspan style=\"color:#000\"\u003eover\u003c/span\u003e (\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a90d91\"\u003eorder\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eby\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eyear\u003c/span\u003e, \u003cspan style=\"color:#a90d91\"\u003emonth\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e  ) \u003cspan style=\"color:#a90d91\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#000\"\u003ediff\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#000\"\u003eexpenses\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eorder\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eby\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eyear\u003c/span\u003e, \u003cspan style=\"color:#a90d91\"\u003emonth\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eWe can also rewrite the query without window functions:\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eselect\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#000\"\u003ecur\u003c/span\u003e.\u003cspan style=\"color:#a90d91\"\u003eyear\u003c/span\u003e, \u003cspan style=\"color:#000\"\u003ecur\u003c/span\u003e.\u003cspan style=\"color:#a90d91\"\u003emonth\u003c/span\u003e, \u003cspan style=\"color:#000\"\u003ecur\u003c/span\u003e.\u003cspan style=\"color:#000\"\u003eexpense\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#000\"\u003ecur\u003c/span\u003e.\u003cspan style=\"color:#000\"\u003eexpense\u003c/span\u003e \u003cspan style=\"color:#000\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#000\"\u003eprev\u003c/span\u003e.\u003cspan style=\"color:#000\"\u003eexpense\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eas\u003c/span\u003e \u003cspan style=\"color:#000\"\u003ediff\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#000\"\u003eexpenses\u003c/span\u003e \u003cspan style=\"color:#000\"\u003ecur\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eleft\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003ejoin\u003c/span\u003e \u003cspan style=\"color:#000\"\u003eexpenses\u003c/span\u003e \u003cspan style=\"color:#000\"\u003eprev\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eon\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#000\"\u003ecur\u003c/span\u003e.\u003cspan style=\"color:#a90d91\"\u003eyear\u003c/span\u003e \u003cspan style=\"color:#000\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#000\"\u003eprev\u003c/span\u003e.\u003cspan style=\"color:#a90d91\"\u003eyear\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eand\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e  \u003cspan style=\"color:#000\"\u003ecur\u003c/span\u003e.\u003cspan style=\"color:#a90d91\"\u003emonth\u003c/span\u003e \u003cspan style=\"color:#000\"\u003e-\u003c/span\u003e \u003cspan style=\"color:#1c01ce\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#000\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#000\"\u003eprev\u003c/span\u003e.\u003cspan style=\"color:#a90d91\"\u003emonth\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eorder\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eby\u003c/span\u003e \u003cspan style=\"color:#000\"\u003ecur\u003c/span\u003e.\u003cspan style=\"color:#a90d91\"\u003eyear\u003c/span\u003e, \u003cspan style=\"color:#000\"\u003ecur\u003c/span\u003e.\u003cspan style=\"color:#a90d91\"\u003emonth\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cbr/\u003e\u003cp\u003eWant to learn more about window functions? Read my book — \u003ca href=\"/sql-window-functions-book/\"\u003e\u003cstrong\u003eSQL Window Functions Explained\u003c/strong\u003e\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003csqlime-db name=\"employees\" path=\"data.sql\"\u003e\u003c/sqlime-db\u003e\n\u003csqlime-examples db=\"employees\" selector=\"div.highlight\" editable=\"\"\u003e\u003c/sqlime-examples\u003e\u003c/p\u003e\u003cscript defer=\"\" src=\"/modules/sqlean/sqlean.js\"\u003e\u003c/script\u003e\n\u003cscript defer=\"\" src=\"/modules/sqlime/sqlime-db.js\"\u003e\u003c/script\u003e\n\u003cscript defer=\"\" src=\"/modules/sqlime/sqlime-examples.js\"\u003e\u003c/script\u003e\u003cp\u003e\u003cem\u003e\u003ca href=\"/subscribe/\"\u003e\u003ci class=\"fas fa-star\"\u003e\u003c/i\u003e \u003cstrong\u003eSubscribe\u003c/strong\u003e\u003c/a\u003e\nto keep up with new posts.\u003c/em\u003e\u003c/p\u003e\u003c/div\u003e\u003c/div\u003e\u003cfooter class=\"post__footer\"\u003e\u003cdiv class=\"row\"\u003e\u003cdiv class=\"col-xs-12\"\u003e\u003cdiv class=\"post__date\"\u003e\u003ctime datetime=\"2023-06-03 15:00:00 +0000 UTC\"\u003e03 Jun, 2023\u003c/time\u003e\u003c/div\u003e\u003cdiv class=\"post__tags\"\u003e\u003ca href=\"/tags/data/\"\u003edata\u003c/a\u003e \u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/footer\u003e\u003c/article\u003e",
  "Date": "2023-06-03T15:00:00Z",
  "Author": "Anton Zhiyanov"
}