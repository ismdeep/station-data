{
  "Source": "antonz.org",
  "Title": "LIMIT vs. FETCH in SQL",
  "Link": "https://antonz.org/sql-fetch/",
  "Content": "\u003carticle class=\"post\"\u003e\u003cdiv class=\"row\"\u003e\u003cdiv class=\"col-xs-12 col-md-10 article\"\u003e\u003cheader\u003e\u003ch1\u003eLIMIT vs. FETCH in SQL\u003c/h1\u003e\u003c/header\u003e\u003cp\u003eFun fact: There is no \u003ccode\u003elimit\u003c/code\u003e clause in the SQL standard.\u003c/p\u003e\u003cp\u003eEveryone uses \u003ccode\u003elimit\u003c/code\u003e:\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eselect\u003c/span\u003e \u003cspan style=\"color:#000\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#000\"\u003eemployees\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eorder\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eby\u003c/span\u003e \u003cspan style=\"color:#000\"\u003esalary\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003edesc\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003elimit\u003c/span\u003e \u003cspan style=\"color:#1c01ce\"\u003e5\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ccodapi-snippet sandbox=\"postgres\" editor=\"basic\" template=\"main.sql\"\u003e\u003c/codapi-snippet\u003e\u003cp\u003eAnd yet, according to the standard, we should be using \u003ccode\u003efetch\u003c/code\u003e:\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eselect\u003c/span\u003e \u003cspan style=\"color:#000\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#000\"\u003eemployees\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eorder\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eby\u003c/span\u003e \u003cspan style=\"color:#000\"\u003esalary\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003edesc\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003efetch\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003efirst\u003c/span\u003e \u003cspan style=\"color:#1c01ce\"\u003e5\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003erows\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eonly\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ccodapi-snippet sandbox=\"postgres\" editor=\"basic\" template=\"main.sql\"\u003e\u003c/codapi-snippet\u003e\u003cp\u003e\u003ccode\u003efetch first N rows only\u003c/code\u003e does exactly what \u003ccode\u003elimit N\u003c/code\u003e does. But \u003ccode\u003efetch\u003c/code\u003e can do more.\u003c/p\u003e\u003ch2 id=\"limit-with-ties\"\u003eLimit with ties\u003c/h2\u003e\u003cp\u003eSuppose we want to select the top 5 employees by salary, but also select anyone with the same salary as the last (5th) employee. Here comes \u003ccode\u003ewith ties\u003c/code\u003e:\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eselect\u003c/span\u003e \u003cspan style=\"color:#000\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#000\"\u003eemployees\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eorder\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eby\u003c/span\u003e \u003cspan style=\"color:#000\"\u003esalary\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003edesc\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003efetch\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003efirst\u003c/span\u003e \u003cspan style=\"color:#1c01ce\"\u003e5\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003erows\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003ewith\u003c/span\u003e \u003cspan style=\"color:#000\"\u003eties\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ccodapi-snippet sandbox=\"postgres\" editor=\"basic\" template=\"main.sql\"\u003e\u003c/codapi-snippet\u003e\u003ch2 id=\"relative-limit\"\u003eRelative limit\u003c/h2\u003e\u003cp\u003eSuppose we want to select the top 10% of employees by salary. \u003ccode\u003epercent\u003c/code\u003e to the rescue:\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eselect\u003c/span\u003e \u003cspan style=\"color:#000\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#000\"\u003eemployees\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eorder\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eby\u003c/span\u003e \u003cspan style=\"color:#000\"\u003esalary\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003edesc\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003efetch\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003efirst\u003c/span\u003e \u003cspan style=\"color:#1c01ce\"\u003e10\u003c/span\u003e \u003cspan style=\"color:#000\"\u003epercent\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003erows\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eonly\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cpre tabindex=\"0\"\u003e\u003ccode\u003e┌────┬───────┬────────────┬────────┐\n│ id │ name  │ department │ salary │\n├────┼───────┼────────────┼────────┤\n│ 25 │ Frank │ it         │ 120    │\n│ 23 │ Henry │ it         │ 104    │\n└────┴───────┴────────────┴────────┘\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e(there are 20 employees, so 10% is 2 records)\u003c/p\u003e\u003ch2 id=\"offset-with-fetch\"\u003eOffset with fetch\u003c/h2\u003e\u003cp\u003eSuppose we want to skip the first 3 employees and select the next 5. No problem: \u003ccode\u003efetch\u003c/code\u003e plays nicely with \u003ccode\u003eoffset\u003c/code\u003e, as does \u003ccode\u003elimit\u003c/code\u003e:\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eselect\u003c/span\u003e \u003cspan style=\"color:#000\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#000\"\u003eemployees\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eorder\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eby\u003c/span\u003e \u003cspan style=\"color:#000\"\u003esalary\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003edesc\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eoffset\u003c/span\u003e \u003cspan style=\"color:#1c01ce\"\u003e3\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003erows\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003efetch\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003enext\u003c/span\u003e \u003cspan style=\"color:#1c01ce\"\u003e5\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003erows\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eonly\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ccodapi-snippet sandbox=\"postgres\" editor=\"basic\" template=\"main.sql\"\u003e\u003c/codapi-snippet\u003e\u003cp\u003e\u003ccode\u003enext\u003c/code\u003e here is just a syntactic sugar, a synonym for \u003ccode\u003efirst\u003c/code\u003e in the previous examples. We can use \u003ccode\u003efirst\u003c/code\u003e and get exactly the same result:\u003c/p\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4\"\u003e\u003ccode class=\"language-sql\" data-lang=\"sql\"\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eselect\u003c/span\u003e \u003cspan style=\"color:#000\"\u003e*\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003efrom\u003c/span\u003e \u003cspan style=\"color:#000\"\u003eemployees\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eorder\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eby\u003c/span\u003e \u003cspan style=\"color:#000\"\u003esalary\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003edesc\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003eoffset\u003c/span\u003e \u003cspan style=\"color:#1c01ce\"\u003e3\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003erows\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a90d91\"\u003efetch\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003efirst\u003c/span\u003e \u003cspan style=\"color:#1c01ce\"\u003e5\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003erows\u003c/span\u003e \u003cspan style=\"color:#a90d91\"\u003eonly\u003c/span\u003e;\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ccodapi-snippet sandbox=\"postgres\" editor=\"basic\" template=\"main.sql\"\u003e\u003c/codapi-snippet\u003e\u003cp\u003eOh, and by the way, \u003ccode\u003erow\u003c/code\u003e and \u003ccode\u003erows\u003c/code\u003e are also synonyms.\u003c/p\u003e\u003ch2 id=\"database-support\"\u003eDatabase support\u003c/h2\u003e\u003cp\u003eThe following DBMS support \u003ccode\u003efetch\u003c/code\u003e:\u003c/p\u003e\u003cul\u003e\u003cli\u003ePostgreSQL 8.4+\u003c/li\u003e\u003cli\u003eOracle 12c+\u003c/li\u003e\u003cli\u003eMS SQL 2012+\u003c/li\u003e\u003cli\u003eDB2 9+\u003c/li\u003e\u003c/ul\u003e\u003cp\u003eHowever, only Oracle supports \u003ccode\u003epercent\u003c/code\u003e fetching.\u003c/p\u003e\u003cp\u003eMySQL and SQLite do not support \u003ccode\u003efetch\u003c/code\u003e at all.\u003c/p\u003e\u003cp\u003e──\u003c/p\u003e\u003cp\u003eP.S. \u003cmark\u003eInterested in mastering modern SQL?\u003c/mark\u003e Check out my book — \u003ca href=\"/sql-window-functions-book\"\u003eSQL Window Functions Explained\u003c/a\u003e\u003c/p\u003e\u003cscript defer=\"\" src=\"/modules/codapi/snippet.js\"\u003e\u003c/script\u003e\u003cp\u003e\u003cem\u003e\u003ca href=\"/subscribe/\"\u003e\u003ci class=\"fas fa-star\"\u003e\u003c/i\u003e \u003cstrong\u003eSubscribe\u003c/strong\u003e\u003c/a\u003e\nto keep up with new posts.\u003c/em\u003e\u003c/p\u003e\u003c/div\u003e\u003c/div\u003e\u003cfooter class=\"post__footer\"\u003e\u003cdiv class=\"row\"\u003e\u003cdiv class=\"col-xs-12\"\u003e\u003cdiv class=\"post__date\"\u003e\u003ctime datetime=\"2023-05-30 18:00:00 +0000 UTC\"\u003e30 May, 2023\u003c/time\u003e\u003c/div\u003e\u003cdiv class=\"post__tags\"\u003e\u003ca href=\"/tags/data/\"\u003edata\u003c/a\u003e \u003c/div\u003e\u003c/div\u003e\u003c/div\u003e\u003c/footer\u003e\u003c/article\u003e",
  "Date": "2023-05-30T18:00:00Z",
  "Author": "Anton Zhiyanov"
}