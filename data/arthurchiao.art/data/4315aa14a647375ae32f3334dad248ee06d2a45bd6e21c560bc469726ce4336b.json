{
  "Source": "arthurchiao.art",
  "Title": "GPU 进阶笔记（四）：NVIDIA GH200 芯片、服务器及集群组网（2024）",
  "Link": "https://arthurchiao.art/blog/gpu-advanced-notes-4-zh/",
  "Content": "\u003cdiv class=\"post\"\u003e\n  \n  \u003ch1 class=\"postTitle\"\u003eGPU 进阶笔记（四）：NVIDIA GH200 芯片、服务器及集群组网（2024）\u003c/h1\u003e\n  \u003cp class=\"meta\"\u003ePublished at 2024-08-19 | Last Update 2024-08-19\u003c/p\u003e\n  \n  \u003cp\u003e记录一些平时接触到的 GPU 知识。由于是笔记而非教程，因此内容不求连贯，有基础的同学可作查漏补缺之用。\u003c/p\u003e\n\n\u003cul\u003e\n  \u003cli\u003e\u003ca href=\"/blog/gpu-advanced-notes-1-zh/\"\u003eGPU 进阶笔记（一）：高性能 GPU 服务器硬件拓扑与集群组网（2023）\u003c/a\u003e\u003c/li\u003e\n  \u003cli\u003e\u003ca href=\"/blog/gpu-advanced-notes-2-zh/\"\u003eGPU 进阶笔记（二）：华为昇腾 910B GPU 相关（2023）\u003c/a\u003e\u003c/li\u003e\n  \u003cli\u003e\u003ca href=\"/blog/gpu-advanced-notes-3-zh/\"\u003eGPU 进阶笔记（三）：华为 NPU (GPU) 演进（2024）\u003c/a\u003e\u003c/li\u003e\n  \u003cli\u003e\u003ca href=\"/blog/gpu-advanced-notes-4-zh/\"\u003eGPU 进阶笔记（四）：NVIDIA GH200 芯片、服务器及集群组网（2024）\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e水平及维护精力所限，文中不免存在错误或过时之处，请酌情参考。\n\u003cstrong\u003e\u003cmark\u003e传播知识，尊重劳动，年满十八周岁，转载请注明\u003ca href=\"https://arthurchiao.art\"\u003e出处\u003c/a\u003e\u003c/mark\u003e\u003c/strong\u003e。\u003c/p\u003e\n\n\u003chr/\u003e\n\n\u003cul id=\"markdown-toc\"\u003e\n  \u003cli\u003e\u003ca href=\"#1-传统原厂-gpu-服务器intelamd-x86-cpu--nvidia-gpu\" id=\"markdown-toc-1-传统原厂-gpu-服务器intelamd-x86-cpu--nvidia-gpu\"\u003e1 传统原厂 GPU 服务器：\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eIntel/AMD x86 CPU\u003c/code\u003e + \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eNVIDIA GPU\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n  \u003cli\u003e\u003ca href=\"#2-新一代原厂-gpu-服务器nvidia-cpu--nvidia-gpu\" id=\"markdown-toc-2-新一代原厂-gpu-服务器nvidia-cpu--nvidia-gpu\"\u003e2 新一代原厂 GPU 服务器：\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eNVIDIA CPU\u003c/code\u003e + \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eNVIDIA GPU\u003c/code\u003e\u003c/a\u003e    \u003cul\u003e\n      \u003cli\u003e\u003ca href=\"#21-cpu-芯片grace-arm\" id=\"markdown-toc-21-cpu-芯片grace-arm\"\u003e2.1 CPU 芯片：Grace (\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eARM\u003c/code\u003e)\u003c/a\u003e\u003c/li\u003e\n      \u003cli\u003e\u003ca href=\"#22-gpu-芯片hopperblackwell\" id=\"markdown-toc-22-gpu-芯片hopperblackwell\"\u003e2.2 GPU 芯片：Hopper/Blackwell/…\u003c/a\u003e\u003c/li\u003e\n      \u003cli\u003e\u003ca href=\"#23-芯片产品命名举例\" id=\"markdown-toc-23-芯片产品命名举例\"\u003e2.3 芯片产品（命名）举例\u003c/a\u003e        \u003cul\u003e\n          \u003cli\u003e\u003ca href=\"#231-grace-cpu--hopper-200-h200-gpugh200\" id=\"markdown-toc-231-grace-cpu--hopper-200-h200-gpugh200\"\u003e2.3.1 Grace CPU + Hopper 200 (H200) GPU：\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eGH200\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n          \u003cli\u003e\u003ca href=\"#232-grace-cpu--blackwell-200-b200-gpugb200\" id=\"markdown-toc-232-grace-cpu--blackwell-200-b200-gpugb200\"\u003e2.3.2 Grace CPU + Blackwell 200 (B200) GPU：\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eGB200\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n        \u003c/ul\u003e\n      \u003c/li\u003e\n    \u003c/ul\u003e\n  \u003c/li\u003e\n  \u003cli\u003e\u003ca href=\"#3-gh200-服务器内部设计\" id=\"markdown-toc-3-gh200-服务器内部设计\"\u003e3 GH200 服务器内部设计\u003c/a\u003e    \u003cul\u003e\n      \u003cli\u003e\u003ca href=\"#31-gh200-芯片逻辑图cpugpuramvram-集成到单颗芯片\" id=\"markdown-toc-31-gh200-芯片逻辑图cpugpuramvram-集成到单颗芯片\"\u003e3.1 GH200 芯片逻辑图：\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eCPU+GPU+RAM+VRAM\u003c/code\u003e 集成到单颗芯片\u003c/a\u003e        \u003cul\u003e\n          \u003cli\u003e\u003ca href=\"#311-核心硬件\" id=\"markdown-toc-311-核心硬件\"\u003e3.1.1 核心硬件\u003c/a\u003e\u003c/li\u003e\n          \u003cli\u003e\u003ca href=\"#312-芯片硬件互连\" id=\"markdown-toc-312-芯片硬件互连\"\u003e3.1.2 芯片硬件互连\u003c/a\u003e\u003c/li\u003e\n        \u003c/ul\u003e\n      \u003c/li\u003e\n      \u003cli\u003e\u003ca href=\"#32-cpu-和内存\" id=\"markdown-toc-32-cpu-和内存\"\u003e3.2 CPU 和内存\u003c/a\u003e        \u003cul\u003e\n          \u003cli\u003e\u003ca href=\"#321-72-core-armv9-cpu\" id=\"markdown-toc-321-72-core-armv9-cpu\"\u003e3.2.1 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003e72-core ARMv9\u003c/code\u003e CPU\u003c/a\u003e\u003c/li\u003e\n          \u003cli\u003e\u003ca href=\"#322-480gb-lpddr5x-low-power-ddr-内存\" id=\"markdown-toc-322-480gb-lpddr5x-low-power-ddr-内存\"\u003e3.2.2 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003e480GB LPDDR5X\u003c/code\u003e (Low-Power DDR) 内存\u003c/a\u003e\u003c/li\u003e\n          \u003cli\u003e\u003ca href=\"#323-三种内存对比ddr-vs-lpddr-vs-hbm\" id=\"markdown-toc-323-三种内存对比ddr-vs-lpddr-vs-hbm\"\u003e3.2.3 三种内存对比：\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eDDR vs. LPDDR vs. HBM\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n        \u003c/ul\u003e\n      \u003c/li\u003e\n      \u003cli\u003e\u003ca href=\"#33-gpu-和显存\" id=\"markdown-toc-33-gpu-和显存\"\u003e3.3 GPU 和显存\u003c/a\u003e        \u003cul\u003e\n          \u003cli\u003e\u003ca href=\"#331-h200-gpu\" id=\"markdown-toc-331-h200-gpu\"\u003e3.3.1 H200 GPU\u003c/a\u003e\u003c/li\u003e\n          \u003cli\u003e\u003ca href=\"#332-显存选配\" id=\"markdown-toc-332-显存选配\"\u003e3.3.2 显存选配\u003c/a\u003e\u003c/li\u003e\n        \u003c/ul\u003e\n      \u003c/li\u003e\n      \u003cli\u003e\u003ca href=\"#34-变种gh200-nvl2用-nvlink-全连接两颗-gh200\" id=\"markdown-toc-34-变种gh200-nvl2用-nvlink-全连接两颗-gh200\"\u003e3.4 变种：\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eGH200 NVL2\u003c/code\u003e，用 NVLINK 全连接两颗 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eGH200\u003c/code\u003e\u003c/a\u003e\u003c/li\u003e\n      \u003cli\u003e\u003ca href=\"#35-gh200--gh200-nvl2-产品参数算力\" id=\"markdown-toc-35-gh200--gh200-nvl2-产品参数算力\"\u003e3.5 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eGH200\u003c/code\u003e \u0026amp; \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eGH200 NVL2\u003c/code\u003e 产品参数（算力）\u003c/a\u003e\u003c/li\u003e\n    \u003c/ul\u003e\n  \u003c/li\u003e\n  \u003cli\u003e\u003ca href=\"#4-gh200-服务器及组网\" id=\"markdown-toc-4-gh200-服务器及组网\"\u003e4 GH200 服务器及组网\u003c/a\u003e    \u003cul\u003e\n      \u003cli\u003e\u003ca href=\"#41-nvidia-mgx-with-gh200原厂主机及组网\" id=\"markdown-toc-41-nvidia-mgx-with-gh200原厂主机及组网\"\u003e4.1 NVIDIA MGX with GH200：原厂主机及组网\u003c/a\u003e\u003c/li\u003e\n      \u003cli\u003e\u003ca href=\"#42-nvidia-gh200-nvl32原厂-32-卡机柜\" id=\"markdown-toc-42-nvidia-gh200-nvl32原厂-32-卡机柜\"\u003e4.2 NVIDIA GH200 NVL32：原厂 32 卡机柜\u003c/a\u003e\u003c/li\u003e\n    \u003c/ul\u003e\n  \u003c/li\u003e\n  \u003cli\u003e\u003ca href=\"#5-总结\" id=\"markdown-toc-5-总结\"\u003e5 总结\u003c/a\u003e\u003c/li\u003e\n  \u003cli\u003e\u003ca href=\"#参考资料\" id=\"markdown-toc-参考资料\"\u003e参考资料\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003chr/\u003e\n\n\u003ch1 id=\"1-传统原厂-gpu-服务器intelamd-x86-cpu--nvidia-gpu\"\u003e1 传统原厂 GPU 服务器：\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eIntel/AMD x86 CPU\u003c/code\u003e + \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eNVIDIA GPU\u003c/code\u003e\u003c/h1\u003e\n\n\u003cp\u003e2024 之前，不管是 NVIDIA 原厂还是第三方服务器厂商的 NVIDIA GPU 机器，都是以 x86 CPU 机器为底座，\nGPU 以 PCIe 板卡或 8 卡模组的方式连接到主板上，我们在第一篇中有过详细介绍，\u003c/p\u003e\n\n\u003cp align=\"center\"\u003e\u003cimg src=\"/assets/img/gpu-notes/8x-a100-node-hw-topo.png\" width=\"90%\" height=\"90%\"/\u003e\u003c/p\u003e\n\u003cp align=\"center\"\u003e典型 8 卡 A100 主机硬件拓扑\u003c/p\u003e\n\n\u003cp\u003e这时 CPU 和 GPU 是独立的，服务器厂商只要买 GPU 模组（例如 8*A100），都可以自己组装服务器。\n至于 Intel/AMD CPU 用哪家，就看性能、成本或性价比考虑了。\u003c/p\u003e\n\n\u003ch1 id=\"2-新一代原厂-gpu-服务器nvidia-cpu--nvidia-gpu\"\u003e2 新一代原厂 GPU 服务器：\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eNVIDIA CPU\u003c/code\u003e + \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eNVIDIA GPU\u003c/code\u003e\u003c/h1\u003e\n\n\u003cp\u003e随着 2024 年 NVIDIA GH200 芯片的问世，NVIDIA 的 \u003cstrong\u003e\u003cmark\u003eGPU 开始自带 CPU\u003c/mark\u003e\u003c/strong\u003e 了。\u003c/p\u003e\n\n\u003cul\u003e\n  \u003cli\u003e\u003cstrong\u003e\u003cmark\u003e桌面计算机时代\u003c/mark\u003e\u003c/strong\u003e：CPU 为主，GPU（显卡）为辅，CPU 芯片中可以集成一块 GPU 芯片，\n叫\u003cstrong\u003e\u003cmark\u003e集成显卡\u003c/mark\u003e\u003c/strong\u003e；\u003c/li\u003e\n  \u003cli\u003eAI 数据中心时代：GPU 反客为主，CPU 退居次席，GPU 芯片/板卡中集成 CPU。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e所以 NVIDIA 集成度越来越高，开始提供整机或整机柜。\u003c/p\u003e\n\n\u003ch2 id=\"21-cpu-芯片grace-arm\"\u003e2.1 CPU 芯片：Grace (\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eARM\u003c/code\u003e)\u003c/h2\u003e\n\n\u003cp\u003e基于 \u003cstrong\u003e\u003cmark\u003e\u003ccode\u003eARMv9\u003c/code\u003e\u003c/mark\u003e\u003c/strong\u003e 设计。\u003c/p\u003e\n\n\u003ch2 id=\"22-gpu-芯片hopperblackwell\"\u003e2.2 GPU 芯片：Hopper/Blackwell/…\u003c/h2\u003e\n\n\u003cp\u003e比如 Hopper 系列，先出的 H100-80GB，后面继续迭代：\u003c/p\u003e\n\n\u003col\u003e\n  \u003cli\u003e\u003cstrong\u003e\u003cmark\u003e\u003ccode\u003eH800\u003c/code\u003e\u003c/mark\u003e\u003c/strong\u003e：H100 的阉割版，\u003c/li\u003e\n  \u003cli\u003eH200：H100 的升级版，\u003c/li\u003e\n  \u003cli\u003e\u003cstrong\u003e\u003cmark\u003e\u003ccode\u003eH20\u003c/code\u003e\u003c/mark\u003e\u003c/strong\u003e：H200 的阉割版，比 H800 还差，差多了。\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003e算力对比：\u003ca href=\"/blog/gpu-data-sheets/\"\u003eGPU Performance (Data Sheets) Quick Reference (2023)\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"23-芯片产品命名举例\"\u003e2.3 芯片产品（命名）举例\u003c/h2\u003e\n\n\u003ch3 id=\"231-grace-cpu--hopper-200-h200-gpugh200\"\u003e2.3.1 Grace CPU + Hopper 200 (H200) GPU：\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eGH200\u003c/code\u003e\u003c/h3\u003e\n\n\u003cp\u003e一张板子：\u003c/p\u003e\n\n\u003cp align=\"center\"\u003e\u003cimg src=\"/assets/img/gpu-notes/gh200-chip-render.png\" width=\"60%\" height=\"60%\"/\u003e\u003c/p\u003e\n\u003cp align=\"center\"\u003eNVIDIA GH200 芯片（板卡）渲染图。左：Grace CPU 芯片；右：Hopper GPU 芯片 [2]\u003c/p\u003e\n\n\u003ch3 id=\"232-grace-cpu--blackwell-200-b200-gpugb200\"\u003e2.3.2 Grace CPU + Blackwell 200 (B200) GPU：\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eGB200\u003c/code\u003e\u003c/h3\u003e\n\n\u003cp\u003e一个板子（模块），功耗太大，自带液冷：\u003c/p\u003e\n\n\u003cp align=\"center\"\u003e\u003cimg src=\"/assets/img/gpu-notes/gb200-compute-tray.png\" width=\"50%\" height=\"50%\"/\u003e\u003c/p\u003e\n\u003cp align=\"center\"\u003eNVIDIA GB200 渲染图，一个模块包括 \u003cmark\u003e2 Grace CPU + 4 B200 GPU\u003c/mark\u003e，另外\u003cmark\u003e自带了液冷模块\u003c/mark\u003e。 [3]\u003c/p\u003e\n\n\u003cp\u003e72 张 B200 组成一个原厂机柜 NVL72：\u003c/p\u003e\n\n\u003cp align=\"center\"\u003e\u003cimg src=\"/assets/img/gpu-notes/gb200-nvl72-rack.png\" width=\"50%\" height=\"50%\"/\u003e\u003c/p\u003e\n\u003cp align=\"center\"\u003eNVIDIA GB200 NVL72 机柜。 [3]\u003c/p\u003e\n\n\u003ch1 id=\"3-gh200-服务器内部设计\"\u003e3 GH200 服务器内部设计\u003c/h1\u003e\n\n\u003ch2 id=\"31-gh200-芯片逻辑图cpugpuramvram-集成到单颗芯片\"\u003e3.1 GH200 芯片逻辑图：\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eCPU+GPU+RAM+VRAM\u003c/code\u003e 集成到单颗芯片\u003c/h2\u003e\n\n\u003cp align=\"center\"\u003e\u003cimg src=\"/assets/img/gpu-notes/gh200-chip-logical.png\" width=\"80%\" height=\"80%\"/\u003e\u003c/p\u003e\n\u003cp align=\"center\"\u003eNVIDIA GH200 芯片（单颗）逻辑图。[2] \u003c/p\u003e\n\n\u003ch3 id=\"311-核心硬件\"\u003e3.1.1 核心硬件\u003c/h3\u003e\n\n\u003cp\u003e如上图所示，一颗 GH200 超级芯片集成了下面这些核心部件：\u003c/p\u003e\n\n\u003col\u003e\n  \u003cli\u003e一颗 NVIDIA Grace CPU；\u003c/li\u003e\n  \u003cli\u003e一颗 NVIDIA H200 GPU；\u003c/li\u003e\n  \u003cli\u003e最多 480GB CPU 内存；\u003c/li\u003e\n  \u003cli\u003e96GB 或 144GB GPU 显存。\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch3 id=\"312-芯片硬件互连\"\u003e3.1.2 芯片硬件互连\u003c/h3\u003e\n\n\u003col\u003e\n  \u003cli\u003e\n    \u003cp\u003eCPU 通过 4 个 PCIe Gen5 x16 连接到主板，\u003c/p\u003e\n\n    \u003cul\u003e\n      \u003cli\u003e单个 PCIe Gen5 x16 的速度是双向 128GB/s，\u003c/li\u003e\n      \u003cli\u003e所以 4 个的总速度是 512GB/s；\u003c/li\u003e\n    \u003c/ul\u003e\n  \u003c/li\u003e\n  \u003cli\u003e\n    \u003cp\u003eCPU 和 GPU 之间，通过 NVLink® Chip-2-Chip (\u003cstrong\u003e\u003cmark\u003e\u003ccode\u003eNVLink-C2C\u003c/code\u003e\u003c/mark\u003e\u003c/strong\u003e) 技术互连，\u003c/p\u003e\n\n    \u003cul\u003e\n      \u003cli\u003e900 GB/s，比 PCIe Gen5 x16 的速度快 7 倍；\u003c/li\u003e\n    \u003c/ul\u003e\n  \u003c/li\u003e\n  \u003cli\u003e\n    \u003cp\u003eGPU 互连（同主机扩跨主机）：18x NVLINK4\u003c/p\u003e\n\n    \u003cul\u003e\n      \u003cli\u003e900 GB/s\u003c/li\u003e\n    \u003c/ul\u003e\n  \u003c/li\u003e\n\u003c/ol\u003e\n\n\u003cp\u003eNVLink-C2C 提供了一种 NVIDIA 所谓的“memory coherency”：内存/显存一致性。好处：\u003c/p\u003e\n\n\u003cul\u003e\n  \u003cli\u003e内存+显存高达 624GB，对用户来说是统一的，可以不区分的使用；提升开发者效率；\u003c/li\u003e\n  \u003cli\u003eCPU 和 GPU 可以同时（concurrently and transparently）访问 CPU 和 GPU 内存。\u003c/li\u003e\n  \u003cli\u003eGPU 显存可以超分（oversubscribe），不够了就用 CPU 的内存，互连带宽够大，延迟很低。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e下面再展开看看 CPU、内存、GPU 等等硬件。\u003c/p\u003e\n\n\u003ch2 id=\"32-cpu-和内存\"\u003e3.2 CPU 和内存\u003c/h2\u003e\n\n\u003ch3 id=\"321-72-core-armv9-cpu\"\u003e3.2.1 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003e72-core ARMv9\u003c/code\u003e CPU\u003c/h3\u003e\n\n\u003cul\u003e\n  \u003cli\u003e\u003cstrong\u003e\u003cmark\u003e\u003ccode\u003e72-core\u003c/code\u003e\u003c/mark\u003e\u003c/strong\u003e Grace CPU (\u003cstrong\u003e\u003cmark\u003e\u003ccode\u003eNeoverse V2 Armv9 core\u003c/code\u003e\u003c/mark\u003e\u003c/strong\u003e)\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch3 id=\"322-480gb-lpddr5x-low-power-ddr-内存\"\u003e3.2.2 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003e480GB LPDDR5X\u003c/code\u003e (Low-Power DDR) 内存\u003c/h3\u003e\n\n\u003cul\u003e\n  \u003cli\u003e最大支持 480GB LPDDR5X 内存；\u003c/li\u003e\n  \u003cli\u003e500GB/s per-CPU memory bandwidth。\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e参考下这个速度在存储领域的位置：\u003c/p\u003e\n\n\u003cp align=\"center\"\u003e\u003cimg src=\"/assets/img/practical-storage-hierarchy/storage-bandwidth-3.png\" width=\"90%\"/\u003e\u003c/p\u003e\n\u003cp align=\"center\"\u003eFig. Peak bandwidth of storage media, networking, and distributed storage solutions. [1]\u003c/p\u003e\n\n\u003ch3 id=\"323-三种内存对比ddr-vs-lpddr-vs-hbm\"\u003e3.2.3 三种内存对比：\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eDDR vs. LPDDR vs. HBM\u003c/code\u003e\u003c/h3\u003e\n\n\u003cul\u003e\n  \u003cli\u003e\u003cstrong\u003e\u003cmark\u003e普通服务器\u003c/mark\u003e\u003c/strong\u003e（绝大部分服务器）用的是 \u003cstrong\u003e\u003cmark\u003e\u003ccode\u003eDDR\u003c/code\u003e\u003c/mark\u003e\u003c/strong\u003e 内存，通过主板上的 DIMM 插槽连接到 CPU，[1] 中有详细介绍；\u003c/li\u003e\n  \u003cli\u003e1-4 代的 LPDDR 是对应的 1-4 代 DDR 的低功耗版，常用于手机等设备。\n    \u003cul\u003e\n      \u003cli\u003eLPDDR5 是独立于 DDR5 设计的，甚至比 DDR5 投产还早；\u003c/li\u003e\n      \u003cli\u003e直接和 CPU 焊到一起的，不可插拔，不可扩展，成本更高，但好处是\u003cstrong\u003e\u003cmark\u003e速度更快\u003c/mark\u003e\u003c/strong\u003e；\u003c/li\u003e\n      \u003cli\u003e还有个类似的是 GDDR，例如 RTX 4090 用的 GDDR。\u003c/li\u003e\n    \u003c/ul\u003e\n  \u003c/li\u003e\n  \u003cli\u003eHBM 在第一篇中已经介绍过了；\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003e下面列个表格对比三种内存的优缺点，注意其中的高/中/低都是三者相对而言的：\u003c/p\u003e\n\n\u003ctable\u003e\n  \u003cthead\u003e\n    \u003ctr\u003e\n      \u003cth style=\"text-align: left\"\u003e \u003c/th\u003e\n      \u003cth style=\"text-align: left\"\u003eDDR\u003c/th\u003e\n      \u003cth style=\"text-align: left\"\u003eLPDDR\u003c/th\u003e\n      \u003cth style=\"text-align: left\"\u003eHBM\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e容量\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003cstrong\u003e\u003cmark\u003e大\u003c/mark\u003e\u003c/strong\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e中\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e小\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e速度\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003cstrong\u003e\u003cmark\u003e慢\u003c/mark\u003e\u003c/strong\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e中\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e快\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e带宽\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003cstrong\u003e\u003cmark\u003e低\u003c/mark\u003e\u003c/strong\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e中\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e高\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e可扩展性\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003cstrong\u003e\u003cmark\u003e好\u003c/mark\u003e\u003c/strong\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e差\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e差\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e可插拔\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e可\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e不可\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e不可\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e成本\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003cstrong\u003e\u003cmark\u003e低\u003c/mark\u003e\u003c/strong\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e中\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e高\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e功耗\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003cstrong\u003e\u003cmark\u003e高\u003c/mark\u003e\u003c/strong\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e中\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e低\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003e更多细节，见 [1]。\u003c/p\u003e\n\n\u003cp\u003e例如，与 \u003cstrong\u003e\u003cmark\u003e\u003ccode\u003e8-channel DDR5\u003c/code\u003e\u003c/mark\u003e\u003c/strong\u003e（目前高端 x86 服务器的配置）相比，\nGH200 的 LPDDR5X 内存带宽高 \u003cstrong\u003e\u003cmark\u003e\u003ccode\u003e53%\u003c/code\u003e\u003c/mark\u003e\u003c/strong\u003e，功耗还低 \u003cstrong\u003e\u003cmark\u003e\u003ccode\u003e1/8\u003c/code\u003e\u003c/mark\u003e\u003c/strong\u003e。\u003c/p\u003e\n\n\u003ch2 id=\"33-gpu-和显存\"\u003e3.3 GPU 和显存\u003c/h2\u003e\n\n\u003ch3 id=\"331-h200-gpu\"\u003e3.3.1 H200 GPU\u003c/h3\u003e\n\n\u003cp\u003e算力见下面。\u003c/p\u003e\n\n\u003ch3 id=\"332-显存选配\"\u003e3.3.2 显存选配\u003c/h3\u003e\n\n\u003cp\u003e支持两种显存，二选一：\u003c/p\u003e\n\n\u003cul\u003e\n  \u003cli\u003e96GB HBM3\u003c/li\u003e\n  \u003cli\u003e144GB HBM3e，4.9TB/s，比 H100 SXM 的带宽高 50%；\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"34-变种gh200-nvl2用-nvlink-全连接两颗-gh200\"\u003e3.4 变种：\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eGH200 NVL2\u003c/code\u003e，用 NVLINK 全连接两颗 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eGH200\u003c/code\u003e\u003c/h2\u003e\n\n\u003cp\u003e在一张板子内放两颗 GH200 芯片，CPU/GPU/RAM/VRAM 等等都翻倍，而且两颗芯片之间是全连接。\u003c/p\u003e\n\n\u003cp\u003e例如，对于一台能插 8 张板卡的服务器，\u003c/p\u003e\n\n\u003cul\u003e\n  \u003cli\u003e用 GH200 芯片：CPU 和 GPU 数量 \u003cstrong\u003e\u003cmark\u003e\u003ccode\u003e8 * {72 Grace CPU, 1 H200 GPU}\u003c/code\u003e\u003c/mark\u003e\u003c/strong\u003e\u003c/li\u003e\n  \u003cli\u003e用 GH200 NVL2 变种：CPU 和 GPU 数量 \u003cstrong\u003e\u003cmark\u003e\u003ccode\u003e8 * {144 Grace CPU, 2 H200 GPU}\u003c/code\u003e\u003c/mark\u003e\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch2 id=\"35-gh200--gh200-nvl2-产品参数算力\"\u003e3.5 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eGH200\u003c/code\u003e \u0026amp; \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eGH200 NVL2\u003c/code\u003e 产品参数（算力）\u003c/h2\u003e\n\n\u003cp align=\"center\"\u003e\u003cimg src=\"/assets/img/gpu-notes/gh200-product-spec.png\" width=\"80%\" height=\"80%\"/\u003e\u003c/p\u003e\n\u003cp align=\"center\"\u003eNVIDIA GH200 产品参数。上半部分是 CPU、内存等参数，从 \u003cmark\u003e\u0026#34;FP64\u0026#34;\u003c/mark\u003e 往下是 GPU 参数。[2] \u003c/p\u003e\n\n\u003ch1 id=\"4-gh200-服务器及组网\"\u003e4 GH200 服务器及组网\u003c/h1\u003e\n\n\u003cp\u003e两种服务器规格，分别对应 PCIe 板卡和 NVLINK 板卡。\u003c/p\u003e\n\n\u003ch2 id=\"41-nvidia-mgx-with-gh200原厂主机及组网\"\u003e4.1 NVIDIA MGX with GH200：原厂主机及组网\u003c/h2\u003e\n\n\u003cp\u003e下图是单卡 node 的一种组网方式：\u003c/p\u003e\n\n\u003cp align=\"center\"\u003e\u003cimg src=\"/assets/img/gpu-notes/gh200-mgx-cluster-topo.png\" width=\"100%\" height=\"100%\"/\u003e\u003c/p\u003e\n\u003cp align=\"center\"\u003eNVIDIA GH200 MGX 服务器组网。\u003cmark\u003e每台 node 只有一片 GH200 芯片，作为 PCIe 板卡，没有 NVLINK\u003c/mark\u003e。[2] \u003c/p\u003e\n\n\u003col\u003e\n  \u003cli\u003e每台 node 只有一片 GH200 芯片（所以只有一个 GPU），作为 PCIe 板卡，没有 NVLINK；\u003c/li\u003e\n  \u003cli\u003e每台 node 的网卡或加速卡 BlueField-3 (BF3) DPUs 连接到交换机；\u003c/li\u003e\n  \u003cli\u003e跨 node 的 GPU 之间没有直连，而是通过主机网络（走 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eGPU-\u0026gt;CPU--\u0026gt;NIC\u003c/code\u003e 出去）的方式实现通信；\u003c/li\u003e\n  \u003cli\u003e适合 HPC workload、中小规模的 AI workload。\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch2 id=\"42-nvidia-gh200-nvl32原厂-32-卡机柜\"\u003e4.2 NVIDIA GH200 NVL32：原厂 32 卡机柜\u003c/h2\u003e\n\n\u003cp\u003e通过 NVLINk 将 \u003cstrong\u003e\u003cmark\u003e32 个 GH200 芯片\u003c/mark\u003e\u003c/strong\u003e全连接为一个逻辑 GPU 模块，所以叫 \u003cstrong\u003e\u003cmark\u003e\u003ccode\u003eNVL32\u003c/code\u003e\u003c/mark\u003e\u003c/strong\u003e，\u003c/p\u003e\n\n\u003cp align=\"center\"\u003e\u003cimg src=\"/assets/img/gpu-notes/gh200-nvl32-cluster-topo.png\" width=\"100%\" height=\"100%\"/\u003e\u003c/p\u003e\n\u003cp align=\"center\"\u003eNVIDIA GH200 NVL32 组网。[2] \u003c/p\u003e\n\n\u003col\u003e\n  \u003cli\u003eNVL32 模块实际形态是一个\u003cstrong\u003e\u003cmark\u003e机柜\u003c/mark\u003e\u003c/strong\u003e；\n    \u003cul\u003e\n      \u003cli\u003e一个机柜能提供 \u003cstrong\u003e\u003cmark\u003e\u003ccode\u003e19.5TB\u003c/code\u003e\u003c/mark\u003e\u003c/strong\u003e 内存+显存；\u003c/li\u003e\n      \u003cli\u003e\n        \u003cp\u003eNVLink TLB 能让任意一个 GPU 访问这个机柜内的任意内存/显存；\u003c/p\u003e\n\n        \u003cp align=\"center\"\u003e\u003cimg src=\"/assets/img/gpu-notes/gh200-nvl32-mem-access.png\" width=\"80%\" height=\"80%\"/\u003e\u003c/p\u003e\n        \u003cp align=\"center\"\u003eNVIDIA GH200 NVL32 中 3 种内存/显存访问方式。[2] \u003c/p\u003e\n      \u003c/li\u003e\n      \u003cli\u003eExtended GPU Memory (EGM)\u003c/li\u003e\n    \u003c/ul\u003e\n  \u003c/li\u003e\n  \u003cli\u003e多个机柜再通过网络互连，形成集群，适合超大规模 AI workload。\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003ch1 id=\"5-总结\"\u003e5 总结\u003c/h1\u003e\n\n\u003cp\u003e本文粗浅地整理了一些 NVIDIA GH200 相关技术知识。\u003c/p\u003e\n\n\u003cp\u003e其他：\u003c/p\u003e\n\n\u003cul\u003e\n  \u003cli\u003e\u003ca href=\"https://chipsandcheese.com/2024/07/31/grace-hopper-nvidias-halfway-apu/\"\u003eGrace CPU 的测评\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003ch1 id=\"参考资料\"\u003e参考资料\u003c/h1\u003e\n\n\u003col\u003e\n  \u003cli\u003e\u003ca href=\"/blog/practical-storage-hierarchy/\"\u003ePractical Storage Hierarchy and Performance: From HDDs to On-chip Caches（2024）\u003c/a\u003e\u003c/li\u003e\n  \u003cli\u003e\u003ca href=\"https://www.nvidia.com/en-us/data-center/grace-hopper-superchip/\"\u003eNVIDIA GH200 Grace Hopper Superchip \u0026amp; Architecture\u003c/a\u003e, datasheet, 2024\u003c/li\u003e\n  \u003cli\u003e\u003ca href=\"https://developer.nvidia.com/blog/nvidia-gb200-nvl72-delivers-trillion-parameter-llm-training-and-real-time-inference/\"\u003eNVIDIA GB200 NVL72 Delivers Trillion-Parameter LLM Training and Real-Time Inference\u003c/a\u003e, 2024\u003c/li\u003e\n\u003c/ol\u003e\n\n\u003chr/\u003e\n\n\u003cp\u003e\u003ca href=\"https://notbyai.fyi\"\u003e\u003cimg src=\"/assets/img/Written-By-Human-Not-By-AI-Badge-white.svg\" alt=\"Written by Human, Not by AI\"/\u003e\u003c/a\u003e\n\u003ca href=\"https://notbyai.fyi\"\u003e\u003cimg src=\"/assets/img/Written-By-Human-Not-By-AI-Badge-black.svg\" alt=\"Written by Human, Not by AI\"/\u003e\u003c/a\u003e\u003c/p\u003e\n\n\n  \u003c!-- POST NAVIGATION --\u003e\n  \u003cdiv class=\"postNav clearfix\"\u003e\n     \n      \u003ca class=\"prev\" href=\"/blog/rag-basis-bge-zh/\"\u003e\u003cspan\u003e« 大模型 RAG 基础：信息检索、文本向量化及 BGE-M3 embedding 实践（2024）\u003c/span\u003e\n      \n    \u003c/a\u003e\n      \n      \n      \u003ca class=\"next\" href=\"/blog/juicefs-metadata-deep-dive-1-zh/\"\u003e\u003cspan\u003eJuiceFS 元数据引擎初探：高层架构、引擎选型、读写工作流（2024） »\u003c/span\u003e\n       \n      \u003c/a\u003e\n     \n  \u003c/div\u003e\n\u003c/div\u003e",
  "Date": "2024-08-19T00:00:00Z",
  "Author": "Arthur Chiao"
}