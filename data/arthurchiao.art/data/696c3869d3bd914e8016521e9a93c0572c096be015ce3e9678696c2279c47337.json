{
  "Source": "arthurchiao.art",
  "Title": "Cilium Cheat Sheet",
  "Link": "https://arthurchiao.art/blog/cilium-cheat-sheet/",
  "Content": "\u003cdiv class=\"post\"\u003e\n  \n  \u003ch1 class=\"postTitle\"\u003eCilium Cheat Sheet\u003c/h1\u003e\n  \u003cp class=\"meta\"\u003ePublished at 2019-01-25 | Last Update 2019-07-18\u003c/p\u003e\n  \n  \u003ch3 id=\"tldr\"\u003eTL;DR\u003c/h3\u003e\n\n\u003cp\u003e\u003ca href=\"https://github.com/cilium/cilium\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eCilium\u003c/code\u003e\u003c/a\u003e is an eBPF-based open source\nsoftware.  It provides transparent network connectivity, L3-L7 security, and\nloadbalancing between application workloads [1].\u003c/p\u003e\n\n\u003cp\u003eThis post serves as a cheat sheet of cilium \u003ccode class=\"language-plaintext highlighter-rouge\"\u003e1.5.0\u003c/code\u003e CLIs. Note that command set\nvaries among different cilium releases, you should run \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium -h\u003c/code\u003e to get the\nfull list of your installed version.\u003c/p\u003e\n\n\u003cp\u003eCLI list:\u003c/p\u003e\n\n\u003ctable\u003e\n  \u003cthead\u003e\n    \u003ctr\u003e\n      \u003cth style=\"text-align: left\"\u003eCommand\u003c/th\u003e\n      \u003cth style=\"text-align: left\"\u003eUsed For\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"#chap_1\"\u003ebpf Subcommands\u003c/a\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e \u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf config   [get           ]\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eManage endpoint configuration BPF maps\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf ct       [list          ]\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eConnection tracking tables\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf endpoint [list|delete   ]\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eLocal endpoint map\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf ipcache  [list|get      ]\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eManage the IPCache mappings for IP/CIDR \u0026lt;-\u0026gt; Identity\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf lb       [list          ]\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eLoad-balancing configuration\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf metrics  [list          ]\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eBPF datapath traffic metrics\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf nat      [flush|list    ]\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eNAT mapping tables\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf policy   [add|delete|get]\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eManage policy related BPF maps\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf proxy    [list|flush    ]\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eProxy configuration\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf sha      [list|flush    ]\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eManage compiled BPF template objects\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf tunnel   [list          ]\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eTunnel endpoint map\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"#chap_2\"\u003ecleanup Subcommands\u003c/a\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e \u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium cleanup  \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eReset the agent state\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"#chap_3\"\u003ecompletion Subcommands\u003c/a\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e \u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium completion\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eOutput shell completion code for bash\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"#chap_4\"\u003econfig Subcommands\u003c/a\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e \u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium config\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eCilium configuration options\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"#chap_5\"\u003edebuginfo Subcommands\u003c/a\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e \u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium debuginfo\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eRequest available debugging information from agent\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"#chap_6\"\u003eendpoint Subcommands\u003c/a\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e \u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium endpoint config    \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eView \u0026amp; modify endpoint configuration\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium endpoint disconnect\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eDisconnect an endpoint from the network\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium endpoint get       \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eDisplay endpoint information\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium endpoint health    \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eView endpoint health\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium endpoint labels    \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eManage label configuration of endpoint\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium endpoint list      \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eList all endpoints\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium endpoint log       \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eView endpoint status log\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium endpoint regenerate\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eForce regeneration of endpoint program\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"#chap_7\"\u003efqdn Subcommands\u003c/a\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eManage fqdn proxy\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium fqdn [flags]\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e \u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium fqdn cache [list|clean] [flags]\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e \u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"#chap_8\"\u003ehelp Subcommands\u003c/a\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eHelp about any command\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium help [command] [flags]\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e \u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"#chap_9\"\u003eidentity Subcommands\u003c/a\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e \u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium identity get \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eRetrieve information about an identity\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium identity list\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eList identities\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"#chap_10\"\u003ekvstore Subcommands\u003c/a\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e \u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium kvstore delete \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eDelete a key\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium kvstore get    \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eRetrieve a key\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium kvstore set    \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eSet a key and value\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"#chap_11\"\u003emap Subcommands\u003c/a\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e \u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium map get  \u0026lt;name\u0026gt; [flags] \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eDisplay BPF map information\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium map list  \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eList all open BPF maps\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"#chap_12\"\u003emetrics Subcommands\u003c/a\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e \u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium metrics list\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eList all metrics\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"#chap_13\"\u003emonitor subcommands\u003c/a\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eMonitor notifications and events emitted by the BPF programs\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium monitor [flags] \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eIncludes 1. Dropped packets; 2. Captured packet traces; 3. Debugging information\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"#chap_14\"\u003enode subcommands\u003c/a\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e \u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium node list\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eList nodes\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"#chap_15\"\u003ePolicy Subcommands\u003c/a\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e \u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium policy delete    \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eDelete policy rules\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium policy get       \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eDisplay policy node information\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium policy import    \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eImport security policy in JSON format\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium policy trace     \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eTrace a policy decision\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium policy validate  \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eValidate a policy\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium policy wait      \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eWait for all endpoints to have updated to a given policy revision\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"#chap_16\"\u003ePrefilter Subcommands\u003c/a\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eManage XDP CIDR filters\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium prefilter delete \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eDelete CIDR filters\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium prefilter list   \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eList CIDR filters\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium prefilter update \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eUpdate CIDR filters\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"#chap_17\"\u003ePreflight Subcommands\u003c/a\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003ecilium upgrade helper\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium preflight \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e \u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"#chap_18\"\u003eservice subcommands\u003c/a\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eManage services \u0026amp; loadbalancers\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium service delete   \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eDelete a service\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium service get      \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eDisplay service information\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium service list     \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eList services\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium service update   \u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eUpdate a service\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"#chap_19\"\u003estatus subcommands\u003c/a\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003eDisplay status of daemon\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium status [flags]\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e \u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"#chap_20\"\u003eversion subcommands\u003c/a\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e \u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: left\"\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium version [flags]\u003c/code\u003e\u003c/td\u003e\n      \u003ctd style=\"text-align: left\"\u003e \u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003eFor each subcommand, \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium [subcommand] -h\u003c/code\u003e will print the detailed usage,\ne.g. \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf -h\u003c/code\u003e, \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf config -h\u003c/code\u003e.\u003c/p\u003e\n\n\u003cp\u003eLooking at the commands’ outputs is a good way for learning cilium. So in the\nfollowing, we will give some illustrative examples and the respective outputs.\nYou could deploy a minikube+cilium environment to have a try [2].\u003c/p\u003e\n\n\u003cp\u003e\u003ca id=\"chap_1\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"1-cilium-bpf\"\u003e1 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf\u003c/code\u003e\u003c/h2\u003e\n\n\u003ch3 id=\"11-cilium-bpf-config\"\u003e1.1 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf config\u003c/code\u003e\u003c/h3\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium bfp config get \u003cspan class=\"nt\"\u003e--host\u003c/span\u003e \u0026lt;URI to host API\u0026gt; \u003cspan class=\"nt\"\u003e-o\u003c/span\u003e json\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3 id=\"12-cilium-bpf-ct\"\u003e1.2 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf ct\u003c/code\u003e\u003c/h3\u003e\n\n\u003cp\u003ect: connection tracker.\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium bpf ct list \u0026lt;endpoint\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eList global ct:\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium bpf ct list global\nTCP IN 10.15.0.1 9090:34382 \u003cspan class=\"nv\"\u003eexpires\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e277365 \u003cspan class=\"nv\"\u003eRxPackets\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e5 \u003cspan class=\"nv\"\u003eRxBytes\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e452 \u003cspan class=\"nv\"\u003eTxPackets\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e5 \u003cspan class=\"nv\"\u003eTxBytes\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e1116 \u003cspan class=\"nv\"\u003eFlags\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e13 \u003cspan class=\"nv\"\u003eRevNAT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e0 \u003cspan class=\"nv\"\u003eSourceSecurityID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e2\nTCP IN 10.15.0.1 8080:48346 \u003cspan class=\"nv\"\u003eexpires\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e277345 \u003cspan class=\"nv\"\u003eRxPackets\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e5 \u003cspan class=\"nv\"\u003eRxBytes\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e458 \u003cspan class=\"nv\"\u003eTxPackets\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e5 \u003cspan class=\"nv\"\u003eTxBytes\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e475 \u003cspan class=\"nv\"\u003eFlags\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e13 \u003cspan class=\"nv\"\u003eRevNAT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e0 \u003cspan class=\"nv\"\u003eSourceSecurityID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e2\nICMP IN 10.15.0.1 0:0 related \u003cspan class=\"nv\"\u003eexpires\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e277435 \u003cspan class=\"nv\"\u003eRxPackets\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e1 \u003cspan class=\"nv\"\u003eRxBytes\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e74 \u003cspan class=\"nv\"\u003eTxPackets\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e0 \u003cspan class=\"nv\"\u003eTxBytes\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e0 \u003cspan class=\"nv\"\u003eFlags\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e10 \u003cspan class=\"nv\"\u003eRevNAT\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e0 \u003cspan class=\"nv\"\u003eSourceSecurityID\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e2\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eBeneath the surface, it retrieves CT info from \u003ccode class=\"language-plaintext highlighter-rouge\"\u003e/sys/fs/bpf/tc/globals/\u0026lt;ct file\u0026gt;\u003c/code\u003e.\u003c/p\u003e\n\n\u003ch3 id=\"13-cilium-bpf-endpoint\"\u003e1.3 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf endpoint\u003c/code\u003e\u003c/h3\u003e\n\n\u003cp\u003eAn endpoint is a namespaced network interface that will be applied policies on.\u003c/p\u003e\n\n\u003cp\u003eList all local endpoint entries:\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium bpf endpoint list\nIP ADDRESS           LOCAL ENDPOINT INFO\n10.15.0.1            \u003cspan class=\"o\"\u003e(\u003c/span\u003elocalhost\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n10.15.117.125        \u003cspan class=\"nb\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e12908 \u003cspan class=\"nv\"\u003eifindex\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e22  \u003cspan class=\"nv\"\u003emac\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eDA:83:01:55:60:C2 \u003cspan class=\"nv\"\u003enodemac\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e62:05:3A:4E:A7:4B\n10.15.237.131        \u003cspan class=\"nb\"\u003eid\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e60459 \u003cspan class=\"nv\"\u003eifindex\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e18  \u003cspan class=\"nv\"\u003emac\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003eAA:E2:2B:D5:AD:41 \u003cspan class=\"nv\"\u003enodemac\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e0A:DB:58:35:CB:41\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eColumn meanings:\u003c/p\u003e\n\n\u003cul\u003e\n  \u003cli\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eIP ADDRESS\u003c/code\u003e: IP address of the endpoint\u003c/li\u003e\n  \u003cli\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eLOCAL ENDPOINT INFO\u003c/code\u003e\n    \u003cul\u003e\n      \u003cli\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eid\u003c/code\u003e: endpoint ID\u003c/li\u003e\n      \u003cli\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eifindex\u003c/code\u003e: corresponding container’s network interface index (host side)\u003c/li\u003e\n      \u003cli\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003emac\u003c/code\u003e: container side MAC address of veth pair (or other type)\u003c/li\u003e\n      \u003cli\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003enodemac\u003c/code\u003e: host side MAC address of veth pair (or other type)\u003c/li\u003e\n    \u003c/ul\u003e\n  \u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cp\u003eLet’s get endpoint \u003ccode class=\"language-plaintext highlighter-rouge\"\u003e12908\u003c/code\u003e’s veth pair on host:\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003eip \u003cspan class=\"nb\"\u003elink\u003c/span\u003e | \u003cspan class=\"nb\"\u003egrep\u003c/span\u003e \u003cspan class=\"nt\"\u003e-B\u003c/span\u003e 1 \u003cspan class=\"nt\"\u003e-i\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;62:05:3A:4E:A7:4B\u0026#34;\u003c/span\u003e\n22: lxce37f4e5d98ad@if21: \u0026lt;BROADCAST,MULTICAST,UP,LOWER_UP\u0026gt; mtu 1500 qdisc noqueue state UP mode DEFAULT qlen 1000\n    \u003cspan class=\"nb\"\u003elink\u003c/span\u003e/ether 62:05:3a:4e:a7:4b brd ff:ff:ff:ff:ff:ff link-netnsid 9\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eDelete local endpoint entries:\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium bpf endpoint delete\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3 id=\"14-cilium-bpf-ipcache\"\u003e1.4 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf ipcache\u003c/code\u003e\u003c/h3\u003e\n\n\u003cp\u003eipcache is a \u003cstrong\u003ekey-value store\u003c/strong\u003e, maps endpoint’s IP to endpoint metadata.\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium bpf ipcache list\nNo entries found.\n\nNote that \u003cspan class=\"k\"\u003efor \u003c/span\u003eLinux kernel versions between 4.11 and 4.15 inclusive, the native\nLPM map \u003cspan class=\"nb\"\u003etype \u003c/span\u003eused \u003cspan class=\"k\"\u003efor \u003c/span\u003eimplementing the IPCache does not provide the ability to\nwalk / dump the entries, so on these kernel versions this tool will never\n\u003cspan class=\"k\"\u003ereturn \u003c/span\u003eany entries, even \u003cspan class=\"k\"\u003eif \u003c/span\u003eentries exist \u003cspan class=\"k\"\u003ein \u003c/span\u003ethe map. You may instead run:\n    cilium map get cilium_ipcache\n\n\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium map get cilium_ipcache\nKey               Value               State   Error\n10.50.191.164/32   43640 0 0.0.0.0     \u003cspan class=\"nb\"\u003esync\n\u003c/span\u003e10.50.127.5/32     23488 0 10.50.8.52   \u003cspan class=\"nb\"\u003esync\n\u003c/span\u003e10.50.178.1/32     1 0 10.50.8.44       \u003cspan class=\"nb\"\u003esync\n\u003c/span\u003e10.50.191.97/32    0 0 0.0.0.0         \u003cspan class=\"nb\"\u003esync\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eColumn meanings:\u003c/p\u003e\n\n\u003cul\u003e\n  \u003cli\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eKey\u003c/code\u003e: endpoint IP\u003c/li\u003e\n  \u003cli\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eValue\u003c/code\u003e:\n    \u003cul\u003e\n      \u003cli\u003eidentity ID\u003c/li\u003e\n      \u003cli\u003eTODO: not known to me\u003c/li\u003e\n      \u003cli\u003eendpoint’s host IP (\u003ccode class=\"language-plaintext highlighter-rouge\"\u003e0.0.0.0\u003c/code\u003e means local host)\u003c/li\u003e\n    \u003c/ul\u003e\n  \u003c/li\u003e\n  \u003cli\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eState\u003c/code\u003e: is in sync state or not\u003c/li\u003e\n  \u003cli\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eError\u003c/code\u003e: error message\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cdiv class=\"language-plaintext highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e$ cilium bpf ipcache get\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3 id=\"15-cilium-bpf-lb\"\u003e1.5 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf lb\u003c/code\u003e\u003c/h3\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium bpf lb list\nSERVICE ADDRESS        BACKEND ADDRESS\n10.96.0.10:53          0.0.0.0:0 \u003cspan class=\"o\"\u003e(\u003c/span\u003e0\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n                       10.15.38.236:53 \u003cspan class=\"o\"\u003e(\u003c/span\u003e3\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n                       10.15.35.129:53 \u003cspan class=\"o\"\u003e(\u003c/span\u003e3\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n10.102.163.245:80      10.15.49.158:9090 \u003cspan class=\"o\"\u003e(\u003c/span\u003e4\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n                       0.0.0.0:0 \u003cspan class=\"o\"\u003e(\u003c/span\u003e0\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3 id=\"16-cilium-bpf-metrics\"\u003e1.6 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf metrics\u003c/code\u003e\u003c/h3\u003e\n\n\u003cp\u003eBPF datapath traffic metrics.\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium bpf metrics list\nREASON                        DIRECTION   PACKETS   BYTES\nError retrieving tunnel key   Egress      231382    18545353\nInvalid \u003cspan class=\"nb\"\u003esource \u003c/span\u003eip             Unknown     1508284   120985464\nSuccess                       Egress      226488    69418245\nSuccess                       Unknown     207163    20200009\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3 id=\"17-cilium-bpf-nat\"\u003e1.7 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf nat\u003c/code\u003e\u003c/h3\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium bpf nat list\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eIt will retrieve NAT info from \u003ccode class=\"language-plaintext highlighter-rouge\"\u003e/sys/fs/bpf/tc/globals/cilium_snat_v4_external\u003c/code\u003e.\u003c/p\u003e\n\n\u003cdiv class=\"language-plaintext highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e$ cilium bpf nat flush\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3 id=\"18-cilium-bpf-policy\"\u003e1.8 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf policy\u003c/code\u003e\u003c/h3\u003e\n\n\u003cp\u003eMange policy related BPF maps.\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium bpf policy \u003cspan class=\"o\"\u003e[\u003c/span\u003eadd|delete|get]\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium bpf policy get \u003cspan class=\"nt\"\u003e--all\u003c/span\u003e\n/sys/fs/bpf/tc/globals/cilium_policy_2159:\n\nDIRECTION   LABELS \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003esource\u003c/span\u003e:key[\u003cspan class=\"o\"\u003e=\u003c/span\u003evalue]\u003cspan class=\"o\"\u003e)\u003c/span\u003e                                    PORT/PROTO   PROXY PORT   BYTES     PACKETS\nIngress     reserved:host                                                  ANY          NONE         0         0\nIngress     reserved:world                                                 ANY          NONE         0         0\nIngress     reserved:health                                                ANY          NONE         0         0\nIngress     k8s:io.cilium.k8s.policy.cluster\u003cspan class=\"o\"\u003e=\u003c/span\u003edefault                       ANY          NONE         0         0\n\n\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium bpf policy get \u003cspan class=\"nt\"\u003e--all\u003c/span\u003e \u003cspan class=\"nt\"\u003e-n\u003c/span\u003e\n/sys/fs/bpf/tc/globals/cilium_policy_2159:\n\nDIRECTION   IDENTITY   PORT/PROTO   PROXY PORT   BYTES     PACKETS\nIngress     1          ANY          NONE         0         0\nIngress     2          ANY          NONE         0         0\nIngress     104        ANY          NONE         0         0\nIngress     105        ANY          NONE         0         0\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3 id=\"19-cilium-bpf-proxy\"\u003e1.9 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf proxy\u003c/code\u003e\u003c/h3\u003e\n\n\u003cp\u003eProxy configuration.\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium bpf proxy list\n\n\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium bpf proxy flush\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3 id=\"110-cilium-bpf-sha\"\u003e1.10 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf sha\u003c/code\u003e\u003c/h3\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium bpf sha\nDatapath SHA                               Endpoint\u003cspan class=\"o\"\u003e(\u003c/span\u003es\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n677ceeb764aab1432e220cf66d304d1feedab281   1104\n                                           1270\n                                           256\n                                           2751\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3 id=\"111-cilium-bpf-tunnel\"\u003e1.11 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium bpf tunnel\u003c/code\u003e\u003c/h3\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium bpf tunnel list\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca id=\"chap_2\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"2-cilium-cleanup\"\u003e2 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium cleanup\u003c/code\u003e\u003c/h2\u003e\n\n\u003cp\u003e\u003ca id=\"chap_3\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"3-cilium-completion\"\u003e3 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium completion\u003c/code\u003e\u003c/h2\u003e\n\n\u003cp\u003e\u003ca id=\"chap_4\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"4-cilium-config\"\u003e4 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium config\u003c/code\u003e\u003c/h2\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium config \u003cspan class=\"nt\"\u003e-o\u003c/span\u003e json\n\u003cspan class=\"o\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\u0026#34;Conntrack\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;Enabled\u0026#34;\u003c/span\u003e,\n  \u003cspan class=\"s2\"\u003e\u0026#34;ConntrackAccounting\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;Enabled\u0026#34;\u003c/span\u003e,\n  \u003cspan class=\"s2\"\u003e\u0026#34;ConntrackLocal\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;Disabled\u0026#34;\u003c/span\u003e,\n  \u003cspan class=\"s2\"\u003e\u0026#34;Debug\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;Disabled\u0026#34;\u003c/span\u003e,\n  \u003cspan class=\"s2\"\u003e\u0026#34;DropNotification\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;Enabled\u0026#34;\u003c/span\u003e,\n  \u003cspan class=\"s2\"\u003e\u0026#34;MonitorAggregationLevel\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;None\u0026#34;\u003c/span\u003e,\n  \u003cspan class=\"s2\"\u003e\u0026#34;PolicyTracing\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;Disabled\u0026#34;\u003c/span\u003e,\n  \u003cspan class=\"s2\"\u003e\u0026#34;TraceNotification\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;Enabled\u0026#34;\u003c/span\u003e\n\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca id=\"chap_5\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"5-cilium-debuginfo\"\u003e5 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium debuginfo\u003c/code\u003e\u003c/h2\u003e\n\n\u003cp\u003eThis command will dump the \u003cstrong\u003every very\u003c/strong\u003e detailed information about all aspects\nof debugging, following is a highly truncated output:\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium debuginfo\n\n\u003cspan class=\"c\"\u003e# Cilium debug information\u003c/span\u003e\n\n\u003cspan class=\"c\"\u003e#### Service list\u003c/span\u003e\n\nID   Frontend               Backend\n1    10.108.128.131:32379   1 \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e 10.0.2.15:32379\n2    10.108.128.131:32380   1 \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e 10.0.2.15:32380\n3    10.96.0.10:53          1 \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e 10.15.35.129:53\n\n\u003cspan class=\"c\"\u003e#### Policy get\u003c/span\u003e\n\nRevision: 5\n\n\u003cspan class=\"c\"\u003e#### Cilium memory map\u003c/span\u003e\n\n00400000-038ec000 r-xp 00000000 08:01 2097166                            /usr/bin/cilium-agent\n04359000-0437a000 rw-p 00000000 00:00 0                                  \u003cspan class=\"o\"\u003e[\u003c/span\u003eheap]\nc000000000-c000017000 rw-p 00000000 00:00 0\n\n\u003cspan class=\"c\"\u003e#### Endpoint Health 60459\u003c/span\u003e\n\nOverall Health:   OK\nBPF Health:       OK\nPolicy Health:    OK\nConnected:        \u003cspan class=\"nb\"\u003eyes\u003c/span\u003e\n\n\u003cspan class=\"c\"\u003e#### Cilium status\u003c/span\u003e\n\nKVStore:                Ok   etcd: 1/1 connected: http://127.0.0.1:31079 - 3.3.2 \u003cspan class=\"o\"\u003e(\u003c/span\u003eLeader\u003cspan class=\"o\"\u003e)\u003c/span\u003e\nContainerRuntime:       Ok   docker daemon: OK\nKubernetes:             Ok   1.13 \u003cspan class=\"o\"\u003e(\u003c/span\u003ev1.13.2\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003elinux/amd64]\nKubernetes APIs:        \u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;networking.k8s.io/v1::NetworkPolicy\u0026#34;\u003c/span\u003e, \u003cspan class=\"s2\"\u003e\u0026#34;cilium/v2::CiliumNetworkPolicy\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\nCilium:                 Ok   OK\nNodeMonitor:            Disabled\nCilium health daemon:   Ok\nIPv4 address pool:      10/65535 allocated\n\nController Status:   63/63 healthy\n  Name                                        Last success   Last error   Count   Message\n  cilium-health-ep                            never          never        0       no error\n  dns-poller                                  never          never        0       no error\n  ipcache-bpf-garbage-collection              never          never        0       no error\n\n\u003cspan class=\"c\"\u003e#### Cilium environment keys\u003c/span\u003e\n\nbpf-root:\nkvstore-opt:map[etcd.config:/var/lib/etcd-config/etcd.config]\nmasquerade:true\ncluster-id:0\n\n\u003cspan class=\"c\"\u003e#### Endpoint list\u003c/span\u003e\n\nENDPOINT   POLICY \u003cspan class=\"o\"\u003e(\u003c/span\u003eingress\u003cspan class=\"o\"\u003e)\u003c/span\u003e   POLICY \u003cspan class=\"o\"\u003e(\u003c/span\u003eegress\u003cspan class=\"o\"\u003e)\u003c/span\u003e   IDENTITY   LABELS \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003esource\u003c/span\u003e:key[\u003cspan class=\"o\"\u003e=\u003c/span\u003evalue]\u003cspan class=\"o\"\u003e)\u003c/span\u003e  IPv4            STATUS\n           ENFORCEMENT        ENFORCEMENT\n10916      Disabled           Disabled          44531      k8s:class\u003cspan class=\"o\"\u003e=\u003c/span\u003edeathstar          10.15.43.62     ready\n                                                           k8s:org\u003cspan class=\"o\"\u003e=\u003c/span\u003eempire\n\n\u003cspan class=\"c\"\u003e#### BPF Policy Get 10916\u003c/span\u003e\n\nDIRECTION   LABELS \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003esource\u003c/span\u003e:key[\u003cspan class=\"o\"\u003e=\u003c/span\u003evalue]\u003cspan class=\"o\"\u003e)\u003c/span\u003e     PORT/PROTO   PROXY PORT   BYTES   PACKETS\nIngress     k8s:app\u003cspan class=\"o\"\u003e=\u003c/span\u003eetcd                    ANY          NONE         0       0\nEgress      reserved:host                   ANY          NONE         4998    51\n\n\u003cspan class=\"c\"\u003e#### Endpoint Get 10916\u003c/span\u003e\n\n\u003cspan class=\"o\"\u003e[\u003c/span\u003e\n  \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e: 10916,\n    \u003cspan class=\"s2\"\u003e\u0026#34;spec\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;label-configuration\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"s2\"\u003e\u0026#34;user\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e[]\u003c/span\u003e\n      \u003cspan class=\"o\"\u003e}\u003c/span\u003e,\n      \u003cspan class=\"s2\"\u003e\u0026#34;options\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"s2\"\u003e\u0026#34;Conntrack\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;Enabled\u0026#34;\u003c/span\u003e,\n        ...\n        \u003cspan class=\"s2\"\u003e\u0026#34;TraceNotification\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;Enabled\u0026#34;\u003c/span\u003e\n      \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e}\u003c/span\u003e,\n    \u003cspan class=\"s2\"\u003e\u0026#34;status\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;controllers\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e[\u003c/span\u003e\n        \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"s2\"\u003e\u0026#34;name\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;resolve-identity-10916\u0026#34;\u003c/span\u003e,\n          \u003cspan class=\"s2\"\u003e\u0026#34;status\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"s2\"\u003e\u0026#34;last-failure-timestamp\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;0001-01-01T00:00:00.000Z\u0026#34;\u003c/span\u003e,\n            \u003cspan class=\"s2\"\u003e\u0026#34;last-success-timestamp\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;2019-01-25T08:28:55.761Z\u0026#34;\u003c/span\u003e,\n            \u003cspan class=\"s2\"\u003e\u0026#34;success-count\u0026#34;\u003c/span\u003e: 295\n          \u003cspan class=\"o\"\u003e}\u003c/span\u003e,\n        \u003cspan class=\"o\"\u003e}\u003c/span\u003e,\n     \u003cspan class=\"s2\"\u003e\u0026#34;external-identifiers\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n       \u003cspan class=\"s2\"\u003e\u0026#34;container-id\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;7ba580c3b49c53ba03e72b32a182150\u0026#34;\u003c/span\u003e,\n       \u003cspan class=\"s2\"\u003e\u0026#34;container-name\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;k8s_POD_deathstar-6fb8-ttln2_default_e3b-77bc14c_0\u0026#34;\u003c/span\u003e,\n       \u003cspan class=\"s2\"\u003e\u0026#34;pod-name\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;default/deathstar-6fb5694d48-ttln2\u0026#34;\u003c/span\u003e\n     \u003cspan class=\"o\"\u003e}\u003c/span\u003e,\n     \u003cspan class=\"s2\"\u003e\u0026#34;identity\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n       \u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e: 44531,\n       \u003cspan class=\"s2\"\u003e\u0026#34;labels\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e[\u003c/span\u003e\n         \u003cspan class=\"s2\"\u003e\u0026#34;k8s:io.cilium.k8s.policy.cluster=default\u0026#34;\u003c/span\u003e,\n       \u003cspan class=\"o\"\u003e]\u003c/span\u003e,\n      \u003cspan class=\"o\"\u003e}\u003c/span\u003e,\n      \u003cspan class=\"s2\"\u003e\u0026#34;networking\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"s2\"\u003e\u0026#34;addressing\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e[\u003c/span\u003e\n          \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"s2\"\u003e\u0026#34;ipv4\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;10.15.43.62\u0026#34;\u003c/span\u003e,\n          \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"o\"\u003e]\u003c/span\u003e,\n        \u003cspan class=\"s2\"\u003e\u0026#34;interface-index\u0026#34;\u003c/span\u003e: 20,\n        \u003cspan class=\"s2\"\u003e\u0026#34;interface-name\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;lxc692d4fb6516a\u0026#34;\u003c/span\u003e,\n  \u003cspan class=\"s2\"\u003e\u0026#34;policy\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"s2\"\u003e\u0026#34;proxy-statistics\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e[]\u003c/span\u003e,\n    \u003cspan class=\"s2\"\u003e\u0026#34;realized\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;allowed-egress-identities\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e[\u003c/span\u003e\n        101,\n        44531,\n        4\n      \u003cspan class=\"o\"\u003e]\u003c/span\u003e,\n\n\u003cspan class=\"c\"\u003e#### Identity get 44531\u003c/span\u003e\n\nID      LABELS\n44531   k8s:class\u003cspan class=\"o\"\u003e=\u003c/span\u003edeathstar\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eThe output is a markdown file, which could be used when reporting a bug on the\ngithub \u003ca href=\"https://github.com/cilium/cilium/issues\"\u003eissue tracker\u003c/a\u003e, or sending to\nthe Cilium develop team [3].\u003c/p\u003e\n\n\u003cp\u003eWrite to file:\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium debuginfo \u003cspan class=\"nt\"\u003e-f\u003c/span\u003e debuginfo.md\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca id=\"chap_6\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"6-cilium-endpoint\"\u003e6 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium endpoint\u003c/code\u003e\u003c/h2\u003e\n\n\u003cp\u003eList all endpoints:\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium endpoint list\nENDPOINT   POLICY \u003cspan class=\"o\"\u003e(\u003c/span\u003eingress\u003cspan class=\"o\"\u003e)\u003c/span\u003e   POLICY \u003cspan class=\"o\"\u003e(\u003c/span\u003eegress\u003cspan class=\"o\"\u003e)\u003c/span\u003e   IDENTITY   LABELS \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003esource\u003c/span\u003e:key[\u003cspan class=\"o\"\u003e=\u003c/span\u003evalue]\u003cspan class=\"o\"\u003e)\u003c/span\u003e                    IPv6  IPv4            STATUS\n           ENFORCEMENT        ENFORCEMENT\n10916      Disabled           Disabled          44531      k8s:class\u003cspan class=\"o\"\u003e=\u003c/span\u003edeathstar                                  10.15.43.62     ready\n                                                           k8s:org\u003cspan class=\"o\"\u003e=\u003c/span\u003eempire\n12041      Disabled           Disabled          104        k8s:io.cilium.k8s.policy.cluster\u003cspan class=\"o\"\u003e=\u003c/span\u003edefault             10.15.35.129    ready\n                                                           k8s:io.cilium.k8s.policy.serviceaccount\u003cspan class=\"o\"\u003e=\u003c/span\u003ecoredns\n                                                           k8s:k8s-app\u003cspan class=\"o\"\u003e=\u003c/span\u003ekube-dns\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eChange endpoint configurations:\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium endpoint config \u0026lt;endpoint ID\u0026gt; \u003cspan class=\"nv\"\u003eDropNotification\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nb\"\u003efalse \u003c/span\u003e\u003cspan class=\"nv\"\u003eTraceNotification\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nb\"\u003efalse\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eCheck \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium-health\u003c/code\u003e’s (with endpoint ID \u003ccode class=\"language-plaintext highlighter-rouge\"\u003e59709\u003c/code\u003e in this example) logs:\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium endpoint log 59709\nTimestamp              Status   State                   Message\n2019-01-29T10:33:29Z   OK       ready                   Successfully regenerated endpoint program \u003cspan class=\"o\"\u003e(\u003c/span\u003eReason: datapath ipcache\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n2019-01-29T10:33:29Z   OK       ready                   Completed endpoint regeneration with no pending regeneration requests\n2019-01-29T10:33:28Z   OK       regenerating            Regenerating endpoint: datapath ipcache\n2019-01-29T10:33:28Z   OK       waiting-to-regenerate   Triggering endpoint regeneration due to datapath ipcache\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eOther commands:\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium endpoint get/health/labels/regenerate\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca id=\"chap_7\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"7-cilium-help\"\u003e7 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium help\u003c/code\u003e\u003c/h2\u003e\n\n\u003cp\u003e\u003ca id=\"chap_9\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"9-cilium-identity\"\u003e9 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium identity\u003c/code\u003e\u003c/h2\u003e\n\n\u003cp\u003ecilium identity get/list\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium identity list\nID      LABELS\n1       reserved:host\n2       reserved:world\n4       reserved:health\n5       reserved:init\n100     k8s:io.cilium.k8s.policy.cluster\u003cspan class=\"o\"\u003e=\u003c/span\u003edefault\n        k8s:io.cilium.k8s.policy.serviceaccount\u003cspan class=\"o\"\u003e=\u003c/span\u003ecilium-etcd-sa\n        k8s:io.cilium/app\u003cspan class=\"o\"\u003e=\u003c/span\u003eetcd-operator\n101     k8s:app\u003cspan class=\"o\"\u003e=\u003c/span\u003eetcd\n...\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eNote that the first 5 identities are all \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ereserved\u003c/code\u003e ones, you will see them in\nsome ingress/egress rules.\u003c/p\u003e\n\n\u003cp\u003e\u003ca id=\"chap_10\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"10-cilium-kvstore\"\u003e10 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium kvstore\u003c/code\u003e\u003c/h2\u003e\n\n\u003cp\u003ecilium kvstore get/set/delete.\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium  kvstore get \u003cspan class=\"nt\"\u003e--recursive\u003c/span\u003e \u0026lt;key\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca id=\"chap_11\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"11-cilium-map\"\u003e11 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium map\u003c/code\u003e\u003c/h2\u003e\n\n\u003cp\u003eAccess BPF maps.\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e# cilium map list\u003c/span\u003e\nName                     Num entries   Num errors   Cache enabled\ncilium_lb4_reverse_nat   6             0            \u003cspan class=\"nb\"\u003etrue\n\u003c/span\u003ecilium_lb4_rr_seq        0             0            \u003cspan class=\"nb\"\u003etrue\n\u003c/span\u003ecilium_lb4_services      6             0            \u003cspan class=\"nb\"\u003etrue\n\u003c/span\u003ecilium_lxc               20            0            \u003cspan class=\"nb\"\u003etrue\n\u003c/span\u003ecilium_proxy4            0             0            \u003cspan class=\"nb\"\u003efalse\n\u003c/span\u003ecilium_ipcache           22            0            \u003cspan class=\"nb\"\u003etrue\n\u003c/span\u003ecilium_ep_config_12041   1             0            \u003cspan class=\"nb\"\u003etrue\u003c/span\u003e\n...\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eDump map content:\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium map get cilium_ipcache\nKey                      Value   State   Error\n10.15.38.236/32          104     \u003cspan class=\"nb\"\u003esync\n\u003c/span\u003e10.0.2.15/32             1       \u003cspan class=\"nb\"\u003esync\n\u003c/span\u003e10.15.86.181/32          4       \u003cspan class=\"nb\"\u003esync\n\u003c/span\u003e10.15.71.253/32          44531   \u003cspan class=\"nb\"\u003esync\u003c/span\u003e\n\n\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ec map get cilium_ep_config_3847\nKey Value State   Error\n0 SKIP_POLICY_INGRESS,SKIP_POLICY_EGRESS,0004,0008,0010,...,40000000,80000000,, 0, 0, 0.0.0.0, ::, 0, 0, 00:00:00:00:00:00   \u003cspan class=\"nb\"\u003esync\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca id=\"chap_12\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"12-cilium-metrics\"\u003e12 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium metrics\u003c/code\u003e\u003c/h2\u003e\n\n\u003cp\u003eAccess cilium’s (Prometheus) metrics:\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium metrics list\nMetric                                              Labels                                                     Value\ncilium_controllers_failing                                                                                     0.000000\ncilium_controllers_runs_duration_seconds            \u003cspan class=\"nv\"\u003estatus\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;failure\u0026#34;\u003c/span\u003e                                           0.029636\ncilium_controllers_runs_duration_seconds            \u003cspan class=\"nv\"\u003estatus\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;success\u0026#34;\u003c/span\u003e                                           2569.774532\ncilium_controllers_runs_total                       \u003cspan class=\"nv\"\u003estatus\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;failure\u0026#34;\u003c/span\u003e                                           1.000000\ncilium_controllers_runs_total                       \u003cspan class=\"nv\"\u003estatus\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;success\u0026#34;\u003c/span\u003e                                           179296.000000\ncilium_datapath_conntrack_gc_duration_seconds       \u003cspan class=\"nv\"\u003efamily\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ipv4\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eprotocol\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;TCP\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003estatus\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;completed\u0026#34;\u003c/span\u003e            5.213934\ncilium_datapath_conntrack_gc_duration_seconds       \u003cspan class=\"nv\"\u003efamily\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;ipv4\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003eprotocol\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;non-TCP\u0026#34;\u003c/span\u003e \u003cspan class=\"nv\"\u003estatus\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;completed\u0026#34;\u003c/span\u003e        1.898584\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca id=\"chap_13\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"13-cilium-monitor\"\u003e13 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium monitor\u003c/code\u003e\u003c/h2\u003e\n\n\u003cp\u003eThe monitor displays notifications and events emitted by the BPF\nprograms attached to endpoints and devices. This includes:\u003c/p\u003e\n\n\u003cul\u003e\n  \u003cli\u003eDropped packet notifications\u003c/li\u003e\n  \u003cli\u003eCaptured packet traces\u003c/li\u003e\n  \u003cli\u003eDebugging information\u003c/li\u003e\n\u003c/ul\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e# cilium monitor [flags]\u003c/span\u003e\n\nFlags:\n      \u003cspan class=\"nt\"\u003e--from\u003c/span\u003e \u003cspan class=\"o\"\u003e[]\u003c/span\u003euint16         Filter by \u003cspan class=\"nb\"\u003esource \u003c/span\u003eendpoint \u003cspan class=\"nb\"\u003eid\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e--hex\u003c/span\u003e                   Do not dissect, print payload \u003cspan class=\"k\"\u003ein \u003c/span\u003eHEX\n  \u003cspan class=\"nt\"\u003e-j\u003c/span\u003e, \u003cspan class=\"nt\"\u003e--json\u003c/span\u003e                  Enable json output. Shadows \u003cspan class=\"nt\"\u003e-v\u003c/span\u003e flag\n      \u003cspan class=\"nt\"\u003e--related-to\u003c/span\u003e \u003cspan class=\"o\"\u003e[]\u003c/span\u003euint16   Filter by either \u003cspan class=\"nb\"\u003esource \u003c/span\u003eor destination endpoint \u003cspan class=\"nb\"\u003eid\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e--to\u003c/span\u003e \u003cspan class=\"o\"\u003e[]\u003c/span\u003euint16           Filter by destination endpoint \u003cspan class=\"nb\"\u003eid\u003c/span\u003e\n  \u003cspan class=\"nt\"\u003e-t\u003c/span\u003e, \u003cspan class=\"nt\"\u003e--type\u003c/span\u003e \u003cspan class=\"o\"\u003e[]\u003c/span\u003estring         Filter by event types \u003cspan class=\"o\"\u003e[\u003c/span\u003eagent capture debug drop l7 trace]\n  \u003cspan class=\"nt\"\u003e-v\u003c/span\u003e, \u003cspan class=\"nt\"\u003e--verbose\u003c/span\u003e               Enable verbose output\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eMonitor all BPF notifications and events:\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium monitor\n\u0026lt;- host flow 0x6154a2bb identity 2-\u0026gt;0 state new ifindex 0: 192.168.99.100:8443\n-\u0026gt; 10.15.38.236:36598 tcp ACK\n-\u0026gt; endpoint 34542 flow 0x6154a2bb identity 2-\u0026gt;104 state reply ifindex lxcc2615b8d08d2: 10.96.0.1:443 -\u0026gt; 10.15.38.236:36598 tcp ACK\n\u0026lt;- endpoint 34542 flow 0x30ce3dbd identity 104-\u0026gt;0 state new ifindex 0: 10.15.38.236:36598 -\u0026gt; 10.96.0.1:443 tcp ACK\n-\u0026gt; stack flow 0x30ce3dbd identity 104-\u0026gt;2 state established ifindex 0: 10.15.38.236:36598 -\u0026gt; 192.168.99.100:8443 tcp ACK\n\u0026lt;- host flow 0x43caa648 identity 2-\u0026gt;0 state new ifindex 0: 192.168.99.100:8443\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eMonitor packet drops:\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium monitor \u003cspan class=\"nt\"\u003e--type\u003c/span\u003e drop\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eCheck all traffic to endpoint \u003ccode class=\"language-plaintext highlighter-rouge\"\u003e3991\u003c/code\u003e (192.168.0.121 in the below output):\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium monitor \u003cspan class=\"nt\"\u003e--to\u003c/span\u003e 3991\n-\u0026gt; endpoint 3991 flow 0x3ed38d3c identity 1-\u0026gt;4 state new ifindex cilium_health: 192.168.0.1:58476 -\u0026gt; 192.168.0.121:4240 tcp SYN\n-\u0026gt; endpoint 3991 flow 0x3ed38d3c identity 1-\u0026gt;4 state established ifindex cilium_health: 192.168.0.1:58476 -\u0026gt; 192.168.0.121:4240 tcp ACK\n-\u0026gt; endpoint 3991 flow 0x3ed38d3c identity 1-\u0026gt;4 state established ifindex cilium_health: 192.168.0.1:58476 -\u0026gt; 192.168.0.121:4240 tcp ACK\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca id=\"chap_14\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"14-cilium-node\"\u003e14 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium node\u003c/code\u003e\u003c/h2\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium node list\nName       IPv4 Address   Endpoint CIDR   IPv6 Address   Endpoint CIDR\nminikube   10.0.2.15      10.15.0.0/16    \u0026lt;nil\u0026gt;          f00d::a0f:0:0:0/112\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca id=\"chap_15\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"15-cilium-policy\"\u003e15 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium policy\u003c/code\u003e\u003c/h2\u003e\n\n\u003cp\u003eManage security policies.\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium policy \u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003ecommand\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\nAvailable Commands:\n  delete      Delete policy rules\n  get         Display policy node information\n  import      Import security policy \u003cspan class=\"k\"\u003ein \u003c/span\u003eJSON format\n  trace       Trace a policy decision\n  validate    Validate a policy\n  \u003cspan class=\"nb\"\u003ewait        \u003c/span\u003eWait \u003cspan class=\"k\"\u003efor \u003c/span\u003eall endpoints to have updated to a given policy revision\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium policy get\n\u003cspan class=\"o\"\u003e[\u003c/span\u003e\n  \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"s2\"\u003e\u0026#34;endpointSelector\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;matchLabels\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"s2\"\u003e\u0026#34;any:class\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;deathstar\u0026#34;\u003c/span\u003e,\n        \u003cspan class=\"s2\"\u003e\u0026#34;any:org\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;empire\u0026#34;\u003c/span\u003e,\n        \u003cspan class=\"s2\"\u003e\u0026#34;k8s:io.kubernetes.pod.namespace\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;default\u0026#34;\u003c/span\u003e\n      \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e}\u003c/span\u003e,\n    \u003cspan class=\"s2\"\u003e\u0026#34;ingress\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e[\u003c/span\u003e\n      \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"s2\"\u003e\u0026#34;fromEndpoints\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e[\u003c/span\u003e\n          \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"s2\"\u003e\u0026#34;matchLabels\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n              \u003cspan class=\"s2\"\u003e\u0026#34;any:org\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;empire\u0026#34;\u003c/span\u003e,\n              \u003cspan class=\"s2\"\u003e\u0026#34;k8s:io.kubernetes.pod.namespace\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;default\u0026#34;\u003c/span\u003e\n            \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n          \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n        \u003cspan class=\"o\"\u003e]\u003c/span\u003e,\n        \u003cspan class=\"s2\"\u003e\u0026#34;toPorts\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e[\u003c/span\u003e\n          \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n            \u003cspan class=\"s2\"\u003e\u0026#34;ports\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e[\u003c/span\u003e\n              \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n                \u003cspan class=\"s2\"\u003e\u0026#34;port\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;80\u0026#34;\u003c/span\u003e,\n                \u003cspan class=\"s2\"\u003e\u0026#34;protocol\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;TCP\u0026#34;\u003c/span\u003e\n              \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n            \u003cspan class=\"o\"\u003e]\u003c/span\u003e,\n            \u003cspan class=\"s2\"\u003e\u0026#34;rules\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n              \u003cspan class=\"s2\"\u003e\u0026#34;http\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e[\u003c/span\u003e\n                \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n                  \u003cspan class=\"s2\"\u003e\u0026#34;path\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;/v1/request-landing\u0026#34;\u003c/span\u003e,\n                  \u003cspan class=\"s2\"\u003e\u0026#34;method\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;POST\u0026#34;\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca id=\"chap_16\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"16-cilium-prefilter\"\u003e16 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium prefilter\u003c/code\u003e\u003c/h2\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e# cilium prefilter -h\u003c/span\u003e\nManage XDP CIDR filters\n\nUsage:\n  cilium prefilter \u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003ecommand\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\nAvailable Commands:\n  delete      Delete CIDR filters\n  list        List CIDR filters\n  update      Update CIDR filters\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca id=\"chap_17\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"17-cilium-preflight\"\u003e17 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium preflight\u003c/code\u003e\u003c/h2\u003e\n\n\u003cp\u003e\u003ca id=\"chap_15\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"18-cilium-service\"\u003e18 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium service\u003c/code\u003e\u003c/h2\u003e\n\n\u003cp\u003eManage services \u0026amp; loadbalancers.\u003c/p\u003e\n\n\u003cp\u003eList all services:\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"c\"\u003e# cilium service list\u003c/span\u003e\nID   Frontend               Backend\n1    10.108.128.131:32379   1 \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e 10.0.2.15:32379\n2    10.108.128.131:32380   1 \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e 10.0.2.15:32380\n3    10.96.0.10:53          1 \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e 10.15.35.129:53\n                            2 \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e 10.15.38.236:53\n4    10.102.163.245:80      1 \u003cspan class=\"o\"\u003e=\u0026gt;\u003c/span\u003e 10.15.49.158:9090\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eGet service \u003ccode class=\"language-plaintext highlighter-rouge\"\u003e6\u003c/code\u003e:\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium service get 6 \u003cspan class=\"nt\"\u003e-o\u003c/span\u003e json\n\u003cspan class=\"o\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"s2\"\u003e\u0026#34;spec\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"s2\"\u003e\u0026#34;backend-addresses\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e[\u003c/span\u003e\n      \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"s2\"\u003e\u0026#34;ip\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e,\n        \u003cspan class=\"s2\"\u003e\u0026#34;port\u0026#34;\u003c/span\u003e: 6443\n      \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e]\u003c/span\u003e,\n    \u003cspan class=\"s2\"\u003e\u0026#34;frontend-address\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;ip\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;10.32.0.1\u0026#34;\u003c/span\u003e,\n      \u003cspan class=\"s2\"\u003e\u0026#34;port\u0026#34;\u003c/span\u003e: 443,\n      \u003cspan class=\"s2\"\u003e\u0026#34;protocol\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;TCP\u0026#34;\u003c/span\u003e\n    \u003cspan class=\"o\"\u003e}\u003c/span\u003e,\n    \u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e: 1\n  \u003cspan class=\"o\"\u003e}\u003c/span\u003e,\n  \u003cspan class=\"s2\"\u003e\u0026#34;status\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"s2\"\u003e\u0026#34;realized\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"s2\"\u003e\u0026#34;backend-addresses\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e[\u003c/span\u003e\n        \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n          \u003cspan class=\"s2\"\u003e\u0026#34;ip\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e,\n          \u003cspan class=\"s2\"\u003e\u0026#34;port\u0026#34;\u003c/span\u003e: 6443\n        \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n      \u003cspan class=\"o\"\u003e]\u003c/span\u003e,\n      \u003cspan class=\"s2\"\u003e\u0026#34;frontend-address\u0026#34;\u003c/span\u003e: \u003cspan class=\"o\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"s2\"\u003e\u0026#34;ip\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;10.32.0.1\u0026#34;\u003c/span\u003e,\n        \u003cspan class=\"s2\"\u003e\u0026#34;port\u0026#34;\u003c/span\u003e: 443,\n        \u003cspan class=\"s2\"\u003e\u0026#34;protocol\u0026#34;\u003c/span\u003e: \u003cspan class=\"s2\"\u003e\u0026#34;TCP\u0026#34;\u003c/span\u003e\n      \u003cspan class=\"o\"\u003e}\u003c/span\u003e,\n      \u003cspan class=\"s2\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e: 1\n    \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003cspan class=\"o\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca id=\"chap_19\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"19-cilium-status\"\u003e19 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium status\u003c/code\u003e\u003c/h2\u003e\n\n\u003cp\u003eDisplay status of daemon.\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003eUsage:\n  cilium status \u003cspan class=\"o\"\u003e[\u003c/span\u003eflags]\n\nFlags:\n      \u003cspan class=\"nt\"\u003e--all-addresses\u003c/span\u003e     Show all allocated addresses, not just count\n      \u003cspan class=\"nt\"\u003e--all-controllers\u003c/span\u003e   Show all controllers, not just failing\n      \u003cspan class=\"nt\"\u003e--all-health\u003c/span\u003e        Show all health status, not just failing\n      \u003cspan class=\"nt\"\u003e--all-nodes\u003c/span\u003e         Show all nodes, not just localhost\n      \u003cspan class=\"nt\"\u003e--all-redirects\u003c/span\u003e     Show all redirects\n      \u003cspan class=\"nt\"\u003e--brief\u003c/span\u003e             Only print a one-line status message\n  \u003cspan class=\"nt\"\u003e-h\u003c/span\u003e, \u003cspan class=\"nt\"\u003e--help\u003c/span\u003e              \u003cspan class=\"nb\"\u003ehelp \u003c/span\u003e\u003cspan class=\"k\"\u003efor \u003c/span\u003estatus\n  \u003cspan class=\"nt\"\u003e-o\u003c/span\u003e, \u003cspan class=\"nt\"\u003e--output\u003c/span\u003e string     json| \u003cspan class=\"nv\"\u003ejsonpath\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;{}\u0026#39;\u003c/span\u003e\n      \u003cspan class=\"nt\"\u003e--verbose\u003c/span\u003e           Equivalent to \u003cspan class=\"nt\"\u003e--all-addresses\u003c/span\u003e \u003cspan class=\"nt\"\u003e--all-controllers\u003c/span\u003e \u003cspan class=\"nt\"\u003e--all-nodes\u003c/span\u003e \u003cspan class=\"nt\"\u003e--all-health\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eCilium status overview:\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium status\nKVStore:                Ok   etcd: 1/1 connected: https://\u0026lt;IP\u0026gt;:2379 - 3.2.22 \u003cspan class=\"o\"\u003e(\u003c/span\u003eLeader\u003cspan class=\"o\"\u003e)\u003c/span\u003e\nContainerRuntime:       Ok   docker daemon: OK\nKubernetes:             Ok   1.13 \u003cspan class=\"o\"\u003e(\u003c/span\u003ev1.13.2\u003cspan class=\"o\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e[\u003c/span\u003elinux/amd64]\nKubernetes APIs:        \u003cspan class=\"o\"\u003e[\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;core/v1::Node\u0026#34;\u003c/span\u003e, \u003cspan class=\"s2\"\u003e\u0026#34;core/v1::Namespace\u0026#34;\u003c/span\u003e, \u003cspan class=\"s2\"\u003e\u0026#34;CustomResourceDefinition\u0026#34;\u003c/span\u003e, \u003cspan class=\"s2\"\u003e\u0026#34;cilium/v2::CiliumNetworkPolicy\u0026#34;\u003c/span\u003e, \u003cspan class=\"s2\"\u003e\u0026#34;networking.k8s.io/v1::NetworkPolicy\u0026#34;\u003c/span\u003e, \u003cspan class=\"s2\"\u003e\u0026#34;core/v1::Service\u0026#34;\u003c/span\u003e, \u003cspan class=\"s2\"\u003e\u0026#34;core/v1::Endpoint\u0026#34;\u003c/span\u003e, \u003cspan class=\"s2\"\u003e\u0026#34;core/v1::Pods\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e]\u003c/span\u003e\nCilium:                 Ok   OK\nNodeMonitor:            Disabled\nCilium health daemon:   Ok\nIPv4 address pool:      4/65535 allocated\nIPv6 address pool:      3/65535 allocated\nController Status:      27/27 healthy\nProxy Status:           OK, ip 10.94.0.1, port-range 10000-20000\nCluster health:   1/1 reachable   \u003cspan class=\"o\"\u003e(\u003c/span\u003e2019-01-29T10:17:04Z\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eShow all controllers (sync tasks) instead of summary:\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium status \u003cspan class=\"nt\"\u003e--all-controllers\u003c/span\u003e\n...\nController Status:      40/40 healthy\n  Name                                        Last success     Last error   Count   Message\n  cilium-health-ep                            16s ago          never        0       no error\n  dns-garbage-collector-job                   33s ago          never        0       no error\n  ipcache-bpf-garbage-collection              1m33s ago        never        0       no error\n  kvstore-etcd-session-renew                  never            never        0       no error\n  kvstore-sync-store-cilium/state/nodes/v1    21s ago          never        0       no error\n  lxcmap-bpf-host-sync                        3s ago           never        0       no error\n  metricsmap-bpf-prom-sync                    6s ago           never        0       no error\n  propagating \u003cspan class=\"nb\"\u003elocal \u003c/span\u003enode change to kv-store   124h50m26s ago   never        0       no error\n  resolve-identity-0                          34s ago          never        0       no error\n  resolve-identity-2751                       4m6s ago         never        0       no error\n  sync-IPv4-identity-mapping \u003cspan class=\"o\"\u003e(\u003c/span\u003e0\u003cspan class=\"o\"\u003e)\u003c/span\u003e              28s ago          never        0       no error\n  sync-IPv4-identity-mapping \u003cspan class=\"o\"\u003e(\u003c/span\u003e1104\u003cspan class=\"o\"\u003e)\u003c/span\u003e           4m1s ago         never        0       no error\n  sync-IPv4-identity-mapping \u003cspan class=\"o\"\u003e(\u003c/span\u003e2751\u003cspan class=\"o\"\u003e)\u003c/span\u003e           4m1s ago         never        0       no error\n  sync-cnp-policy-status \u003cspan class=\"o\"\u003e(\u003c/span\u003ev2 default/rule1\u003cspan class=\"o\"\u003e)\u003c/span\u003e   124h18m48s ago   never        0       no error\n  sync-lb-maps-with-k8s-services              124h50m35s ago   never        0       no error\n  sync-policymap-1104                         33s ago          never        0       no error\n  sync-policymap-2751                         33s ago          never        0       no error\n  sync-to-k8s-ciliumendpoint \u003cspan class=\"o\"\u003e(\u003c/span\u003e1104\u003cspan class=\"o\"\u003e)\u003c/span\u003e           6s ago           never        0       no error\n  sync-to-k8s-ciliumendpoint \u003cspan class=\"o\"\u003e(\u003c/span\u003e2751\u003cspan class=\"o\"\u003e)\u003c/span\u003e           11s ago          never        0       no error\n  template-dir-watcher                        never            never        0       no error\n  ...\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eShow all allocated IP addresses instead of summary:\u003c/p\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium status \u003cspan class=\"nt\"\u003e--all-addresses\u003c/span\u003e\n...\nIPv4 address pool:      10/255 allocated from 192.168.0.0/24\nAllocated addresses:\n  192.168.0.1 \u003cspan class=\"o\"\u003e(\u003c/span\u003erouter\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n  192.168.0.128 \u003cspan class=\"o\"\u003e(\u003c/span\u003edefault/tiefighter\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n  192.168.0.133 \u003cspan class=\"o\"\u003e(\u003c/span\u003ehealth\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n  192.168.0.155 \u003cspan class=\"o\"\u003e(\u003c/span\u003edefault/deathstar-6fb5694d48-69jpx\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n  192.168.0.16 \u003cspan class=\"o\"\u003e(\u003c/span\u003ecilium-monitoring/prometheus-f8454f7d6-cgl27 \u003cspan class=\"o\"\u003e[\u003c/span\u003erestored]\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n  192.168.0.2 \u003cspan class=\"o\"\u003e(\u003c/span\u003ekube-system/coredns-67688d6ffc-6dj5h \u003cspan class=\"o\"\u003e[\u003c/span\u003erestored]\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n  192.168.0.210 \u003cspan class=\"o\"\u003e(\u003c/span\u003edefault/deathstar-6fb5694d48-sv9zg\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n  192.168.0.217 \u003cspan class=\"o\"\u003e(\u003c/span\u003eloopback\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n  192.168.0.249 \u003cspan class=\"o\"\u003e(\u003c/span\u003edefault/xwing\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n  192.168.0.34 \u003cspan class=\"o\"\u003e(\u003c/span\u003ekube-system/cilium-operator-76f66dfd68-g6gr2\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n  ...\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e\u003ca id=\"chap_20\"\u003e\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"20-cilium-version\"\u003e20 \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ecilium version\u003c/code\u003e\u003c/h2\u003e\n\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecilium version\nClient: 1.5.0 e47b37c3a 2019-04-25T22:20:13-05:00 go version go1.12.1 linux/amd64\nDaemon: 1.5.0 e47b37c3a 2019-04-25T22:20:13-05:00 go version go1.12.1 linux/amd64\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\n\u003col\u003e\n  \u003cli\u003e\u003ca href=\"https://github.com/cilium/cilium\"\u003eCilium: github\u003c/a\u003e\u003c/li\u003e\n  \u003cli\u003e\u003ca href=\"https://cilium.readthedocs.io/en/stable/gettingstarted/minikube/\"\u003eCilium: getting started with minikube\u003c/a\u003e\u003c/li\u003e\n  \u003cli\u003e\u003ca href=\"https://cilium.readthedocs.io/en/v1.4/troubleshooting/\"\u003eCilium: Trouble Shooting\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\n\n  \u003c!-- POST NAVIGATION --\u003e\n  \u003cdiv class=\"postNav clearfix\"\u003e\n     \n      \u003ca class=\"prev\" href=\"/blog/tuning-stack-tx-zh/\"\u003e\u003cspan\u003e« [译] Linux 网络栈监控和调优：发送数据（2017）\u003c/span\u003e\n      \n    \u003c/a\u003e\n      \n      \n      \u003ca class=\"next\" href=\"/blog/bcc-ebpf-tutorial-zh/\"\u003e\u003cspan\u003ebcc/ebpf 安装及示例（2019） »\u003c/span\u003e\n       \n      \u003c/a\u003e\n     \n  \u003c/div\u003e\n\u003c/div\u003e",
  "Date": "2019-01-25T00:00:00Z",
  "Author": "Arthur Chiao"
}