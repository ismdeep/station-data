{
  "Source": "blog.zzbd.org",
  "Title": "nohup引发的血案",
  "Link": "https://blog.zzbd.org/2016/07/07/think-before-nohup/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\u003cp\u003e今天用BWA处理一个重测序数据，用了下面这条命令\u003c/p\u003e\u003cfigure class=\"highlight apache\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attribute\"\u003enohup\u003c/span\u003e bwa mem -t \u003cspan class=\"number\"\u003e8\u003c/span\u003e ~/zjf/ara\u003cspan class=\"number\"\u003e11\u003c/span\u003e/TAIR\u003cspan class=\"number\"\u003e10\u003c/span\u003e_Chr.\u003cspan class=\"literal\"\u003eall\u003c/span\u003e.fasta BN\u003cspan class=\"number\"\u003e4\u003c/span\u003e-\u003cspan class=\"number\"\u003e218\u003c/span\u003e_HW\u003cspan class=\"number\"\u003e3\u003c/span\u003eTLCCXX_L\u003cspan class=\"number\"\u003e3\u003c/span\u003e_\u003cspan class=\"number\"\u003e1\u003c/span\u003e.clean.fq BN\u003cspan class=\"number\"\u003e4\u003c/span\u003e-\u003cspan class=\"number\"\u003e218\u003c/span\u003e_HW\u003cspan class=\"number\"\u003e3\u003c/span\u003eTLCCXX_L\u003cspan class=\"number\"\u003e3\u003c/span\u003e_\u003cspan class=\"number\"\u003e2\u003c/span\u003e.clean.fq \u0026gt; me_pe.sam \u0026amp;\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\u003cp\u003e原本担心终端掉线导致运行终止，所以用上了nohup命令。没有想到的是末尾的\u003ccode\u003e\u0026gt;\u003c/code\u003e符号是个大大的陷阱！这会把运行过程中的log信息都写到输出文件里。这个大于号本身不是给nohup用的，而是bwa的一部分！这就是偷懒copy-paste别人命令的悲剧。最后的结果就是，生成的sam文件（30多G）里到处都是log的碎片字串。用samtools调试了一下午才终于意识到这个问题，我是有多愚蠢。。可悲的是一开始居然花费大量时间企图把这些‘刺’都拔掉，直到我发现不仅仅是文件的开头有这些log信息。不过这个过程也google到了一个有用的技巧\u003c/p\u003e\u003cfigure class=\"highlight gams\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"symbol\"\u003e$\u003c/span\u003e tail -n +{x} \u003cspan class=\"keyword\"\u003efile\u003c/span\u003e \u0026gt; newfile\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\u003cp\u003e用它删掉文件的前x-1行确实比sed命令要快。\u003c/p\u003e\u003c/div\u003e",
  "Date": "2016-07-07T12:02:41Z",
  "Author": "J. F"
}