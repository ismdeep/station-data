{
  "Source": "blog.zzbd.org",
  "Title": "ggplot2简单实现waterfall柱形图",
  "Link": "https://blog.zzbd.org/2017/06/22/ggplot2-waterfall/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\u003cp\u003e安装最新版ggplot2，导入数据：\u003c/p\u003e\u003cfigure class=\"highlight powershell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u0026gt;library(ggplot2)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u0026gt;\u003cspan class=\"keyword\"\u003edata\u003c/span\u003e=read.table(\u003cspan class=\"string\"\u003e\u0026#39;clipboard\u0026#39;\u003c/span\u003e, T, sep=\u003cspan class=\"string\"\u003e\u0026#34;\\t\u0026#34;\u003c/span\u003e)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u0026gt;\u003cspan class=\"keyword\"\u003edata\u003c/span\u003e\u003cspan class=\"variable\"\u003e$pathway\u003c/span\u003e \u0026lt;- factor(\u003cspan class=\"keyword\"\u003edata\u003c/span\u003e\u003cspan class=\"variable\"\u003e$pathway\u003c/span\u003e, levels=unique(\u003cspan class=\"keyword\"\u003edata\u003c/span\u003e\u003cspan class=\"variable\"\u003e$pathway\u003c/span\u003e)) \u003cspan class=\"comment\"\u003e#固定顺序\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\u003cspan id=\"more\"\u003e\u003c/span\u003e 配置颜色、对齐方式，绘图\u003cfigure class=\"highlight reasonml\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u0026gt; data$colour \u0026lt;- ifelse(data$count \u0026lt; \u003cspan class=\"number\"\u003e0\u003c/span\u003e, \u003cspan class=\"string\"\u003e\u0026#34;downregulate\u0026#34;\u003c/span\u003e, \u003cspan class=\"string\"\u003e\u0026#34;upregulate\u0026#34;\u003c/span\u003e)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u0026gt; data$hjust \u0026lt;- ifelse(data$count \u0026gt; \u003cspan class=\"number\"\u003e0\u003c/span\u003e, \u003cspan class=\"number\"\u003e1\u003c/span\u003e,\u003cspan class=\"number\"\u003e0\u003c/span\u003e)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u0026gt; ggplot(data, aes(pathway, count, label = pathway,hjust = hjust))\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e+ geom\u003cspan class=\"constructor\"\u003e_text(\u003cspan class=\"params\"\u003eaes\u003c/span\u003e(\u003cspan class=\"params\"\u003ey\u003c/span\u003e = 0,\u003cspan class=\"params\"\u003ecolour\u003c/span\u003e = \u003cspan class=\"params\"\u003ecolour\u003c/span\u003e)\u003c/span\u003e) +geom\u003cspan class=\"constructor\"\u003e_bar(\u003cspan class=\"params\"\u003estat\u003c/span\u003e = \u003cspan class=\"string\"\u003e\u0026#34;identity\u0026#34;\u003c/span\u003e,\u003cspan class=\"params\"\u003eaes\u003c/span\u003e(\u003cspan class=\"params\"\u003efill\u003c/span\u003e = \u003cspan class=\"params\"\u003ecolour\u003c/span\u003e)\u003c/span\u003e)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e+ coord\u003cspan class=\"constructor\"\u003e_flip()\u003c/span\u003e + labs(x = \u003cspan class=\"string\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e, y = \u003cspan class=\"string\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e) + scale\u003cspan class=\"constructor\"\u003e_x_discrete(\u003cspan class=\"params\"\u003ebreaks\u003c/span\u003e = NULL, \u003cspan class=\"params\"\u003eexpand\u003c/span\u003e=\u003cspan class=\"params\"\u003ec\u003c/span\u003e(0.2, 0)\u003c/span\u003e) + ylim(-\u003cspan class=\"number\"\u003e20\u003c/span\u003e, \u003cspan class=\"number\"\u003e20\u003c/span\u003e)\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\u003cp\u003e最终效果\u003cbr/\u003e \u003cimg data-src=\"http://cdn.zzbd.org/godemo.png\" alt=\"img\"/\u003e\u003c/p\u003e\u003c/div\u003e",
  "Date": "2017-06-22T01:02:40Z",
  "Author": "J. F"
}