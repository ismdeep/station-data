{
  "Source": "blog.zzbd.org",
  "Title": "简易web terminal解决方案",
  "Link": "https://blog.zzbd.org/2020/03/13/ttyd/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\u003cp\u003e为了方便最快速度打开远程连接，浏览器是个不错的终端载体。在github上看到ttyd项目，麻雀虽小，五脏俱全，符合web terminal的需求，爱了爱了。另外，作者似乎还是MC玩家，折腾过树莓派，简直偶像有木有😘\u003c/p\u003e\u003cspan id=\"more\"\u003e\u003c/span\u003e\u003cp\u003e首先安装必要依赖\u003c/p\u003e\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta\"\u003e#\u003c/span\u003e\u003cspan class=\"bash\"\u003e 按需安装前置依赖\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esudo apt-get install build-essential cmake git libjson-c-dev\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta\"\u003e#\u003c/span\u003e\u003cspan class=\"bash\"\u003e 安装libwebsockets依赖包\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esudo apt install libuv1-dev\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta\"\u003e#\u003c/span\u003e\u003cspan class=\"bash\"\u003e 检查libwebsockets版本，需要\u0026gt;2.1\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esudo apt-cache show libwebsockets-dev\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta\"\u003e#\u003c/span\u003e\u003cspan class=\"bash\"\u003e 手动安装，从https://github.com/warmcat/libwebsockets/releases下载2.1.1版本\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eunzip libwebsockets-2.1.1.zip \u0026amp;\u0026amp; cd libwebsockets-2.1.1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003emkdir build \u0026amp;\u0026amp; cd build\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003ecmake .. -DLWS_WITH_LIBUV=ON\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003emake\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esudo make install\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esudo ldconfig\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\u003cp\u003e从\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/tsl0922/ttyd\"\u003e官方仓库\u003c/a\u003e克隆到本地，建议编译安装，默认安装到\u003ccode\u003e/usr/local/bin\u003c/code\u003e，使用\u003ccode\u003ettyd -h\u003c/code\u003e查看帮助文档。因为是明文传输密码，所以不建议Basic Authentication方式做鉴权，要么域名强制https，要么ssl认证方式。ttyd还提供很多使用功能，比如接受链接参数、ssl传输等等。\u003c/p\u003e\u003ch3 id=\"以非Root身份运行\"\u003e\u003ca href=\"#以非Root身份运行\" class=\"headerlink\" title=\"以非Root身份运行\"\u003e\u003c/a\u003e以非Root身份运行\u003c/h3\u003e\u003cp\u003e首先允许普通账户sudo ttyd时无需输入密码。运行\u003ccode\u003esudo visudo\u003c/code\u003e，在末尾添加一行（xxx是当前用户名）\u003c/p\u003e\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003exxx   ALL=NOPASSWD:/usr/local/bin/ttyd\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\u003cp\u003e然后\u003ccode\u003epm2 start -x \u0026#39;sudo ttyd --max-clients 2 login -p xxx\u0026#39; -n ttyd\u003c/code\u003e 即可\u003c/p\u003e\u003ch3 id=\"以Root身份运行\"\u003e\u003ca href=\"#以Root身份运行\" class=\"headerlink\" title=\"以Root身份运行\"\u003e\u003c/a\u003e以Root身份运行\u003c/h3\u003e\u003cp\u003e需要修改\u003ccode\u003e/etc/securetty\u003c/code\u003e，在末尾增加\u003c/p\u003e\u003cfigure class=\"highlight apache\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attribute\"\u003epts\u003c/span\u003e/\u003cspan class=\"number\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attribute\"\u003epts\u003c/span\u003e/\u003cspan class=\"number\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attribute\"\u003epts\u003c/span\u003e/\u003cspan class=\"number\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\u003cp\u003e然后运行\u003ccode\u003epm2 start -x \u0026#39;ttyd --max-clients 2 login\u0026#39; -n ttyd\u003c/code\u003e\u003c/p\u003e\u003ch3 id=\"上传下载文件\"\u003e\u003ca href=\"#上传下载文件\" class=\"headerlink\" title=\"上传下载文件\"\u003e\u003c/a\u003e上传下载文件\u003c/h3\u003e\u003cp\u003e编译安装lrzsz，使用rz上传文件到服务器，sz下载文件到本地。此外还可以安装axel，取代wget多线程下载。\u003c/p\u003e\u003ch3 id=\"参考链接\"\u003e\u003ca href=\"#参考链接\" class=\"headerlink\" title=\"参考链接\"\u003e\u003c/a\u003e参考链接\u003c/h3\u003e\u003cp\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://blog.51cto.com/professor/2437216\"\u003e更优于 Shellinabox 的 web shell 工具 – ttyd\u003c/a\u003e\u003cbr/\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://blog.csdn.net/ljxfblog/article/details/38396421\"\u003eLinux下rz/sz安装及使用方法\u003c/a\u003e\u003c/p\u003e\u003c/div\u003e",
  "Date": "2020-03-13T06:25:54Z",
  "Author": "J. F"
}