{
  "Source": "blog.zzbd.org",
  "Title": "hexo自定义渲染markdown",
  "Link": "https://blog.zzbd.org/2017/07/11/hexo-render-md/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\u003cp\u003e以lazyload插件为例，需要替换src标签为data-original，如果还想使用默认的markdown格式，势必要对img的渲染过程进行重载。\u003cspan id=\"more\"\u003e\u003c/span\u003e\u003cbr/\u003e首先修改默认的markdown插件，node_modules/hexo-renderer-marked/lib/renderer.js\u003c/p\u003e\u003cfigure class=\"highlight kotlin\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e26\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e27\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e28\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e29\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e30\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e31\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e32\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003emodule.exports = function(\u003cspan class=\"keyword\"\u003edata\u003c/span\u003e, options) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e// return marked(data.text, assign({\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e//    renderer: new Renderer()\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e//  }, this.config.marked, options));\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003evar\u003c/span\u003e curRender = new Renderer(),\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        markedRenderer = \u003cspan class=\"keyword\"\u003ethis\u003c/span\u003e.markedRenderer;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e// init function\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003eif\u003c/span\u003e (markedRenderer \u0026amp;\u0026amp; typeof(markedRenderer.\u003cspan class=\"keyword\"\u003einit\u003c/span\u003e) == \u003cspan class=\"string\"\u003e\u0026#39;function\u0026#39;\u003c/span\u003e) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        markedRenderer.\u003cspan class=\"keyword\"\u003einit\u003c/span\u003e.call(\u003cspan class=\"keyword\"\u003ethis\u003c/span\u003e, \u003cspan class=\"keyword\"\u003edata\u003c/span\u003e, options);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e// override marked.Render\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003eif\u003c/span\u003e (markedRenderer) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        curRender = assign(curRender, markedRenderer);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e// get html content\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003evar\u003c/span\u003e html = marked(\u003cspan class=\"keyword\"\u003edata\u003c/span\u003e.text, assign({\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        renderer: curRender\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }, \u003cspan class=\"keyword\"\u003ethis\u003c/span\u003e.config.marked, options));\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e// complete function\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003eif\u003c/span\u003e (markedRenderer \u0026amp;\u0026amp; typeof(markedRenderer.complete) == \u003cspan class=\"string\"\u003e\u0026#39;function\u0026#39;\u003c/span\u003e) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003evar\u003c/span\u003e tmpHtml = markedRenderer.complete.call(\u003cspan class=\"keyword\"\u003ethis\u003c/span\u003e, html);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003eif\u003c/span\u003e (!tmpHtml) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            html = tmpHtml;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003ereturn\u003c/span\u003e html;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e};\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\u003cp\u003e主题目录下新建scripts/marked-renderer.js\u003c/p\u003e\u003cfigure class=\"highlight awk\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003ehexo.markedRenderer = {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    init: \u003cspan class=\"keyword\"\u003efunction\u003c/span\u003e() {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"regexp\"\u003e//\u003c/span\u003e console.log(\u003cspan class=\"string\"\u003e\u0026#34;hexo.markedRenderer init!\u0026#34;\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"regexp\"\u003e//\u003c/span\u003e Called before rendering \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    },\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    complete: \u003cspan class=\"keyword\"\u003efunction\u003c/span\u003e(html) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"regexp\"\u003e//\u003c/span\u003e console.log(\u003cspan class=\"string\"\u003e\u0026#34;hexo.markedRenderer complete!\u0026#34;\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"regexp\"\u003e//\u003c/span\u003e Called after rendered\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"regexp\"\u003e//\u003c/span\u003e Deal with html here ...\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        return html;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    },\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    image: \u003cspan class=\"keyword\"\u003efunction\u003c/span\u003e(href, title, alt) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"regexp\"\u003e//\u003c/span\u003e Default method can be accessed via:\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"regexp\"\u003e//\u003c/span\u003e this._super.heading(text, level)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        var orimg = \u003cspan class=\"string\"\u003e\u0026#39;\u0026lt;img data-original=\u0026#34;\u0026#39;\u003c/span\u003e + href;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003eif\u003c/span\u003e (title) orimg += \u003cspan class=\"string\"\u003e\u0026#39;\u0026#34; title=\u0026#34;\u0026#39;\u003c/span\u003e + title;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003eif\u003c/span\u003e (alt) orimg += \u003cspan class=\"string\"\u003e\u0026#39;\u0026#34; alt=\u0026#34;\u0026#39;\u003c/span\u003e + alt;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        return orimg + \u003cspan class=\"string\"\u003e\u0026#39;\u0026#34;\u0026gt;\u0026#39;\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e};\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\u003cp\u003e完成。\u003cbr/\u003e参考：\u003cbr/\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/helinjiang/hexo-renderer-marked-enhanced/blob/master/lib/renderer.js\"\u003ehelinjiang/hexo-renderer-marked-enhanced\u003c/a\u003e\u003cbr/\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/chjj/marked/issues/339\"\u003eSupport image resizing\u003c/a\u003e\u003cbr/\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/jieyou/lazyload\"\u003ejieyou/lazyload\u003c/a\u003e\u003c/p\u003e\u003c/div\u003e",
  "Date": "2017-07-11T08:09:35Z",
  "Author": "J. F"
}