{
  "Source": "blog.zzbd.org",
  "Title": "Windows Search调教小记",
  "Link": "https://blog.zzbd.org/2021/05/19/win10_search/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\u003cp\u003e之前找取色工具的时候无意中发现了\u003ca href=\"github://microsoft/PowerToys\"\u003ePowerToys\u003c/a\u003e这个神器，官方手笔，集合了很多实用小工具，取色器、文件管理器预览、图像Resize、批量改名等等，并且采用统一界面风格（强迫症福音）。其中最有意思的就是PowerToys Run模块，有点类似Mac下的Spotlight和开源的\u003ca href=\"/2021/04/13/wox_dict/\"\u003eWox\u003c/a\u003e。可惜目前只能做些简单的搜索，比较重要的翻译和全局搜索功能还没有实现。这样就和win10搜索框区别不大了，后者还更方便直观，另外和Wox一样也比较吃内存。但快速定位文件还是刚需，于是开始了windows search的调教之路。\u003cimg class=\"emoji\" data-src=\"https://zzbd.org/images/smzdm/107.png\"/\u003e\u003c/p\u003e\u003cspan id=\"more\"\u003e\u003c/span\u003e\u003ch3 id=\"正题\"\u003e\u003ca href=\"#正题\" class=\"headerlink\" title=\"正题\"\u003e\u003c/a\u003e正题\u003c/h3\u003e\u003cp\u003e使用自带搜索的最大优点是方便，缺点一个是搜的不全，不过好在可以自定义索引的范围，另外，如果索引范围太大又会造成本本发热耗电量增大。我的文件经量都放在\u003ccode\u003e文档\u003c/code\u003e中，所以基本只需要把它加到白名单就能满足绝大多数的搜索需求。 唯一的问题就是\u003ccode\u003enode_modules\u003c/code\u003e \u003ccode\u003e.git\u003c/code\u003e这类毒瘤文件夹，当然可以一个个加到排除项里，但每次手动添加总是不那么优雅，一番搜索，发现居然可以用通配符！\u003cimg class=\"emoji\" data-src=\"https://zzbd.org/images/smzdm/64.png\"/\u003e下面放出教程：\u003c/p\u003e\u003col\u003e\u003cli\u003e\u003cp\u003e关掉自带的搜索服务，找到\u003ccode\u003eWindows Search\u003c/code\u003e，右键属性，先改启动类型为\u003ccode\u003e禁用\u003c/code\u003e（重要），然后点停止。\u003c/p\u003e\u003c/li\u003e\u003cli\u003e\u003cp\u003e打开RegEdit，定位到\u003ccode\u003eHKEY_LOCAL_MACHINE\\SOF class=\u0026#34;emoji\u0026#34;TWARE\\Microsoft\\Windows Search\\CrawlScopeManager\\Windows\\SystemIndex\\WorkingSetRules\u003c/code\u003e，展开后可以先尝试修改某一项的键值，如果弹出\u003ccode\u003e无法编辑URL:写该值的新内容时出错\u003c/code\u003e，请进行第三步。\u003c/p\u003e\u003c/li\u003e\u003cli\u003e\u003cp\u003e\u003cstrong\u003e（可选）\u003c/strong\u003e在\u003ccode\u003eWorkingSetRules\u003c/code\u003e上右键，依次点点\u003ccode\u003e权限\u003c/code\u003e-\u0026gt;\u003ccode\u003e高级\u003c/code\u003e，如果看到所有者是\u003ccode\u003eSYSTEM\u003c/code\u003e，点击更改，输入当前系统登录名，点确定。一定勾选上\u003ccode\u003e替换子容器和对象的所有者\u003c/code\u003e。回到权限设置里，赋予Administrators控制和读取权限（蓝框中的）。确定生效后子项就能编辑了。另外，重新启动搜索服务后，这些设定会自动还原。\u003c/p\u003e\u003cp\u003e\u003cimg data-src=\"https://dict.zzbd.org/images/win_search.png\" alt=\"微信截图_20210519152028\"/\u003e\u003c/p\u003e\u003c/li\u003e\u003cli\u003e\u003cp\u003e假设你的项目工程文件都放在\u003ccode\u003e文档/Github\u003c/code\u003e文件夹，那么URL规则可以写成\u003c/p\u003e\u003cfigure class=\"highlight asciidoc\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"link\"\u003efile:///C:\\\u003c/span\u003e[\u003cspan class=\"string\"\u003exxxx-xxxx-xxx-xxxx\u003c/span\u003e]\\Users\\xxx\\Documents\\Github\\*\\.git\\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"link\"\u003efile:///C:\\\u003c/span\u003e[\u003cspan class=\"string\"\u003exxxx-xxxx-xxx-xxxx\u003c/span\u003e]\\Users\\xxx\\Documents\\Github\\*\\node_modules\\\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\u003cp\u003e修改完后重启Windows Search服务，记得还原启动类型。\u003c/p\u003e\u003c/li\u003e\u003cli\u003e\u003cp\u003e现在去设置-\u0026gt;搜索-\u0026gt;搜索Windows，观察下搜索位置和排除项有没有错误。最后点击\u003ccode\u003e高级搜索索引器设置\u003c/code\u003e，点击高级，顺便在排除掉一些文件类型，比如\u003ccode\u003edll\u003c/code\u003e，修改后会自动重建索引，如果没有，手动点击\u003ccode\u003e删除和重建索引\u003c/code\u003e。等待一会，风扇会狂转，然后就可以愉快的搜索啦。\u003c/p\u003e\u003c/li\u003e\u003c/ol\u003e\u003cp\u003e自带搜索日常使用，如果搜不出来就开everything，所以也可以关掉everything的服务，又挤出一些内存，强迫症的胜利。此外，词典的解决方案我也折腾了许久，最终的方案是Golden Dict + ECDICT，\u003ccode\u003eCtrl+C+C\u003c/code\u003e取词，手机上放弃Fora dictionary，转投欧路词典，真香。\u003cimg class=\"emoji\" data-src=\"https://zzbd.org/images/smzdm/44.png\"/\u003e\u003c/p\u003e\u003ch3 id=\"插曲\"\u003e\u003ca href=\"#插曲\" class=\"headerlink\" title=\"插曲\"\u003e\u003c/a\u003e插曲\u003c/h3\u003e\u003cp\u003e一开始想的是everything可不可以整合到PowerToys中，还真有人\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/microsoft/PowerToys/pull/10937\"\u003e讨论\u003c/a\u003e这个问题，但帖子里没有提到整合的具体方法，所以作罢。之后在折腾Windows Search时在知乎发现了一篇技巧文，顺着最后作者的推广链接到B站，居然发现了整合的教程，一对头像，果然和issue里是同一个人。这哥们比我还能折腾~\u003cimg class=\"emoji\" data-src=\"https://zzbd.org/images/smzdm/37.png\"/\u003e\u003c/p\u003e\u003cp\u003e最后达成的效果是，搜索更快捷方便了，内存占用降低，续航小增。总之，整个解决问题的过程还是蛮有趣的。\u003c/p\u003e\u003ch3 id=\"更新\"\u003e\u003ca href=\"#更新\" class=\"headerlink\" title=\"更新\"\u003e\u003c/a\u003e更新\u003c/h3\u003e\u003cp\u003e6.13 又在B站发现一篇web search增强插件的教程，自己动手丰衣足食\u003cimg class=\"emoji\" data-src=\"https://zzbd.org/images/bilibili/tv_dianzan.png\"/\u003e\u003c/p\u003e\u003ch3 id=\"参考\"\u003e\u003ca href=\"#参考\" class=\"headerlink\" title=\"参考\"\u003e\u003c/a\u003e参考\u003c/h3\u003e\u003cp\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://superuser.com/questions/235799/exclude-directories-from-windows-search-by-wildcard\"\u003eExclude directories from Windows Search by wildcard - Super User\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://superuser.com/questions/986888/why-cant-i-change-window-10-registry-key\"\u003eWhy can’t I change Window 10 registry key? - Super User\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://superuser.com/questions/1003878/how-to-efficiently-exclude-svn-and-git-folders-in-windows-10-indexing\"\u003eHow to efficiently exclude .svn and .git folders in Windows 10 indexing? - Super User\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://zhuanlan.zhihu.com/p/68623923\"\u003e什么？你竟然不怎么用Win 10的搜索功能？ - 知乎 (zhihu.com)\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://www.bilibili.com/read/cv11111996\"\u003e将Everything搜索功能加入PowerToys Run - 哔哩哔哩专栏 (bilibili.com)\u003c/a\u003e\u003c/p\u003e\u003cp\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://www.bilibili.com/read/cv11426149/\"\u003e【教程】使PowerToys支持浏览器搜索 - 哔哩哔哩 (bilibili.com)\u003c/a\u003e\u003c/p\u003e\u003c/div\u003e",
  "Date": "2021-05-19T07:46:50Z",
  "Author": "J. F"
}