{
  "Source": "blog.zzbd.org",
  "Title": "telnet远程执行DOS",
  "Link": "https://blog.zzbd.org/2012/05/22/telnet-mobile/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\u003cp\u003e目的很简单，半夜躺在床上能监控本本下片的速度，并且远程关机什么的。不需要teamviewer那种把整个屏幕都搬到手机上，网速太慢还容易误操作。之前用AHK写过一个，模拟鼠标键盘发送QQ消息从而发送接受命令，虽然很山寨，还算好用。现在又想到另一个办法，利用windows的telnet服务直接远程执行命令行。\u003cspan id=\"more\"\u003e\u003c/span\u003e\u003c/p\u003e\u003ch4 id=\"启动PC上的telnet服务\"\u003e\u003ca href=\"#启动PC上的telnet服务\" class=\"headerlink\" title=\"启动PC上的telnet服务\"\u003e\u003c/a\u003e启动PC上的telnet服务\u003c/h4\u003e\u003cp\u003ewin7默认是不安装telnet功能的，需要安装并且启动系统服务，另外还要指定用来登陆的用户名和密码。这些网上大把的，不写了，只是不想把telnet服务设置为自动开启(不安全)，于是写个简单的批处理，方便开启和关闭。\u003c/p\u003e\u003cfigure class=\"highlight elixir\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e26\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e27\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e28\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e29\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e30\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e31\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e32\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e33\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e34\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e35\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"variable\"\u003e@echo\u003c/span\u003e off\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eecho 测试运行权限...\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003efsutil \u0026gt;nul || (\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    echo 请以管理员身份运行.\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    pause \u0026gt;nul \u0026amp;\u0026amp; exit\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  )\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eecho ::::::::::::::::::::::::::::::::::::\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eecho ::  查询TELNET服务状态输入 q        ::\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eecho ::  注意：以下命令需要管理员权限  ::\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eecho ::  关闭TELNET服务输入 stop         ::\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eecho ::  打开TELNET服务输入 start        ::\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eecho ::::::::::::::::::::::::::::::::::::\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"symbol\"\u003e:O\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eset /p input=请输入命令：\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eif \u003cspan class=\"string\"\u003e\u0026#34;%input%\u0026#34;\u003c/span\u003e==\u003cspan class=\"string\"\u003e\u0026#34;start\u0026#34;\u003c/span\u003e goto A\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eif \u003cspan class=\"string\"\u003e\u0026#34;%input%\u0026#34;\u003c/span\u003e==\u003cspan class=\"string\"\u003e\u0026#34;stop\u0026#34;\u003c/span\u003e goto B\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eif \u003cspan class=\"string\"\u003e\u0026#34;%input%\u0026#34;\u003c/span\u003e==\u003cspan class=\"string\"\u003e\u0026#34;q\u0026#34;\u003c/span\u003e goto C\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003epause\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eexit\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"symbol\"\u003e:A\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esc config TlntSvr start= demand\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esc start TlntSvr\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003epause\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eexit\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"symbol\"\u003e:B\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esc stop TlntSvr\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esc config upnphost start= disabled\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003epause\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eexit\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"symbol\"\u003e:C\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esc query TlntSvr\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003egoto O\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\u003cp\u003e注意，需要管理员权限运行\u003c/p\u003e\u003ch2 id=\"配置networx\"\u003e\u003ca href=\"#配置networx\" class=\"headerlink\" title=\"配置networx\"\u003e\u003c/a\u003e配置networx\u003c/h2\u003e\u003cp\u003e对，看网速还是要用它，把下面的脚本保存为vbs文件\u003c/p\u003e\u003cfigure class=\"highlight vbnet\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003eSet\u003c/span\u003e objArgs = WScript. Arguments\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e\u0026#39;Make up an instance\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003eset\u003c/span\u003e SpeedMeter = Wscript.CreateObject(\u003cspan class=\"string\"\u003e\u0026#34;NetWorx.SpeedMeter\u0026#34;\u003c/span\u003e)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e\u0026#39;Start the meter\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eSpeedMeter.Start\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e\u0026#39;Wait five seconds\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003eIf\u003c/span\u003e objArgs.count =\u003cspan class=\"number\"\u003e0\u003c/span\u003e \u003cspan class=\"keyword\"\u003eThen\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eWScript.Sleep \u003cspan class=\"number\"\u003e5000\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003eElse\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eWScript.Sleep objArgs(\u003cspan class=\"number\"\u003e0\u003c/span\u003e)*\u003cspan class=\"number\"\u003e1000\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003eEnd\u003c/span\u003e \u003cspan class=\"keyword\"\u003eIf\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e\u0026#39;Stop the meter\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eSpeedMeter.\u003cspan class=\"keyword\"\u003eStop\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e\u0026#39;Retrieve result\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eResult = SpeedMeter.\u003cspan class=\"keyword\"\u003eText\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eWScript.Echo \u003cspan class=\"string\"\u003e\u0026#34;Result: \u0026#34;\u003c/span\u003e \u0026amp; Result\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e\u0026#39;Free memory\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003eset\u003c/span\u003e SpeedMeter=\u003cspan class=\"literal\"\u003enothing\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\u003cp\u003e在远程端执行就能返回网速数据了。\u003c/p\u003e\u003ch4 id=\"手机上安装atelnet\"\u003e\u003ca href=\"#手机上安装atelnet\" class=\"headerlink\" title=\"手机上安装atelnet\"\u003e\u003c/a\u003e手机上安装atelnet\u003c/h4\u003e\u003cp\u003e试了N个android的telnet客户端，最后就这个atelnet稳定点而且中文不乱码(作者是中国人)。并且它还支持自动输入命令和预定义脚本。连接到PC有很多办法，如果是公网IP直接输入就行了，局域网的话需要手机跟电脑处在同一个ip段下。因为用的是校园网，我的方法是用win7自带的hostednetwork连接手机，毕竟我只想躺在床上，离得并不远。尝试登录。。。\u003c/p\u003e\u003cp\u003e好了，现在可以执行shutdown之类的简单命令了，如果你精通命令行，甚至让电脑给你发个截图过来都行。\u003c/p\u003e\u003c/div\u003e",
  "Date": "2012-05-22T08:29:57Z",
  "Author": "J. F"
}