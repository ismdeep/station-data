{
  "Source": "bou.ke",
  "Title": "Spreadsheet Formulas for Personal Finance",
  "Link": "https://bou.ke/blog/formulas/",
  "Content": "\u003cdiv class=\"content\"\u003e\n\u003cdiv class=\"post\"\u003e\n  \u003ch1\u003eSpreadsheet Formulas for Personal Finance\u003c/h1\u003e\n  \u003cp\u003eI love spreadsheets. Spreadsheet programs like Microsoft’s Excel, Apple’s Numbers and Google Sheets are the secret heroes of our civilization.\u003c/p\u003e\n\n\u003cp\u003eI’ve also been interested in personal finance and the \u003cem\u003eFIRE\u003c/em\u003e community for a while—not so much in the early retirement aspect but in the financial literacy it teaches its members. I have combined my passion for both into one mega-spreadsheet that I use to track my income, expenses, savings and investments in one overview. While creating this spreadsheet I got proficient in some new formulas, which I’ll share here—and also write down for my own reference.\u003c/p\u003e\n\n\u003ch2 id=\"annuity-functions\"\u003eAnnuity Functions\u003c/h2\u003e\n\n\u003cp\u003eAn \u003cem\u003eannuity\u003c/em\u003e is a regular set of payments that accumulates into/diminishes a \u003cem\u003eprincipal\u003c/em\u003e (basically a balance) that often has an associated \u003cem\u003einterest\u003c/em\u003e on the principal. This is traditionally used for answering questions around \u003cem\u003elife annuities\u003c/em\u003e which are products bought to guarantee an income for a certain amount of time—e.g. you want to buy an annuity that pays €250 per month for the next 10 years while the interest rate is 2%, what should its price be? These functions are also useful for calculating things before your retirement, however.\u003c/p\u003e\n\n\u003cp\u003eThe functions for calculating with annuities are \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ePMT\u003c/code\u003e, \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eRATE\u003c/code\u003e, \u003ccode class=\"language-plaintext highlighter-rouge\"\u003ePV\u003c/code\u003e, \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eNPER\u003c/code\u003e and \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eFV\u003c/code\u003e. I will give an example for each of these and you will notice that each takes the other four as input values.\u003c/p\u003e\n\n\u003ch3 id=\"fv\"\u003eFV\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eFV\u003c/code\u003e stands for Future Value and it allows you to answer the following question: given an initial sum, an interest rate, a periodic payment and a duration, what will the balance be after the last payment? The definition is:\u003c/p\u003e\n\n\u003cdiv class=\"language-plaintext highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003eFV(rate, nper, pmt, pv, type)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eThe only argument I’ll gloss over in this post is \u003ccode class=\"language-plaintext highlighter-rouge\"\u003etype\u003c/code\u003e, which specified whether the payment is done at the beginning (1) or end (0) of the period, which matters for the interest.\u003c/p\u003e\n\n\u003cp\u003eYou can use the \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eFV\u003c/code\u003e function to answer the following question:\u003c/p\u003e\n\n\u003cblockquote\u003e\n  \u003cp\u003eIf I have €1000 in an investment that grows with 5% annually and I contribute €100 per month for the next 10 years, how much will accrue?\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThis can be calculated with the following formula:\u003c/p\u003e\n\n\u003cdiv class=\"language-plaintext highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003eFV(5% ÷ 12, 10 × 12, 100, 1000) = -17,175.24\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eHuh? Why is it negative? It’s because the formulas work with ‘inflows’ and ‘outflows’. Every month 100 flows into the ‘sum’ and at the end the whole sum flows ‘out’—therefore it’s negative. You can also flip the signs on the \u003ccode class=\"language-plaintext highlighter-rouge\"\u003epmt\u003c/code\u003e and \u003ccode class=\"language-plaintext highlighter-rouge\"\u003epv\u003c/code\u003e values which will make the \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eFV\u003c/code\u003e result positive.\u003c/p\u003e\n\n\u003ch3 id=\"pmt\"\u003ePMT\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ePMT\u003c/code\u003e means Payment and is useful for mortgage calculations and savings goals. It is defined as:\u003c/p\u003e\n\n\u003cdiv class=\"language-plaintext highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003ePMT(rate, nper, pv, fv, type)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eFor example:\u003c/p\u003e\n\n\u003cblockquote\u003e\n  \u003cp\u003eI am looking to get a €200,000 mortgage to buy a house and the current interest rate is 2%. I will have to make monthly payments for the next 30 years. What will my monthly payment be?\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThe answer to this question is:\u003c/p\u003e\n\n\u003cdiv class=\"language-plaintext highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003ePMT(2% ÷ 12, 30 × 12, -200000, 0) = 739.24\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eAnother question that can be solved with the same function is:\u003c/p\u003e\n\n\u003cblockquote\u003e\n  \u003cp\u003eI have €3000 saved in an account that grows with 4% per year. I want to have €200,000 saved 10 years from now to buy a house, how much will I have to contribute per month to reach my goal?\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThe answer (note that \u003ccode class=\"language-plaintext highlighter-rouge\"\u003epv\u003c/code\u003e and \u003ccode class=\"language-plaintext highlighter-rouge\"\u003efv\u003c/code\u003e have opposite signs, because they flow in opposite directions):\u003c/p\u003e\n\n\u003cdiv class=\"language-plaintext highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003ePMT(4% ÷ 12, 10 × 12, 3000, -200000) = 1,327.86\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003ch3 id=\"rate\"\u003eRATE\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eRATE\u003c/code\u003e calculates what interest rate you need to match the other parameters. I personally haven’t found a need for this, but you could use it to figure out what investment target you need to hit to reach your goal.\u003c/p\u003e\n\n\u003cdiv class=\"language-plaintext highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003eRATE(nper, pmt, pv, fv, type)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eAs example, if you have €1000 and want to grow it to €100.000 in 20 years without making any contributions, what growth rate do you need?\u003c/p\u003e\n\n\u003cdiv class=\"language-plaintext highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003eRATE(20, 0, 1000, -100000) = 25.89%\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eNot very realistic!\u003c/p\u003e\n\n\u003ch3 id=\"nper\"\u003eNPER\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eNPER\u003c/code\u003e calculates the Number of Periods it takes to reach a Future Value. One of the fundamental blog posts in the FIRE community is \u003ca href=\"https://www.mrmoneymustache.com/2012/01/13/the-shockingly-simple-math-behind-early-retirement/\" target=\"_blank\"\u003eThe Shockingly Simple Math Behind Early Retirement\u003c/a\u003e—the gist of which is that the specific amounts of how much you make or save don’t matter for calculating how long until you’re financially independent, but rather the ratio between them: your savings rate. We can use \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eNPER\u003c/code\u003e to make this calculation.\u003c/p\u003e\n\n\u003cdiv class=\"language-plaintext highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003eNPER(rate, pmt, pv, fv, type)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eTo recreate the table from the blogpost we use the following formula:\u003c/p\u003e\n\n\u003cdiv class=\"language-plaintext highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003eInvestment Returns = 5%\nSavings Rate = 50%\nSafe Withdrawal Rate = 4%\n\nNPER(IR, -SR, 0, (1 - SR) ÷ SWR) = 16.62 years\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eIf we put this into a table we get the following:\u003c/p\u003e\n\n\u003ctable\u003e\n  \u003cthead\u003e\n    \u003ctr\u003e\n      \u003cth style=\"text-align: right\"\u003eSavings Rate\u003c/th\u003e\n      \u003cth style=\"text-align: right\"\u003eYears Until FI\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: right\"\u003e5%\u003c/td\u003e\n      \u003ctd style=\"text-align: right\"\u003e65.8\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: right\"\u003e10%\u003c/td\u003e\n      \u003ctd style=\"text-align: right\"\u003e51.4\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: right\"\u003e15%\u003c/td\u003e\n      \u003ctd style=\"text-align: right\"\u003e42.8\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: right\"\u003e20%\u003c/td\u003e\n      \u003ctd style=\"text-align: right\"\u003e36.7\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: right\"\u003e25%\u003c/td\u003e\n      \u003ctd style=\"text-align: right\"\u003e31.9\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: right\"\u003e30%\u003c/td\u003e\n      \u003ctd style=\"text-align: right\"\u003e28.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: right\"\u003e35%\u003c/td\u003e\n      \u003ctd style=\"text-align: right\"\u003e24.6\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: right\"\u003e40%\u003c/td\u003e\n      \u003ctd style=\"text-align: right\"\u003e21.6\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: right\"\u003e45%\u003c/td\u003e\n      \u003ctd style=\"text-align: right\"\u003e19.0\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: right\"\u003e50%\u003c/td\u003e\n      \u003ctd style=\"text-align: right\"\u003e16.6\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: right\"\u003e55%\u003c/td\u003e\n      \u003ctd style=\"text-align: right\"\u003e14.4\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: right\"\u003e60%\u003c/td\u003e\n      \u003ctd style=\"text-align: right\"\u003e12.4\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: right\"\u003e65%\u003c/td\u003e\n      \u003ctd style=\"text-align: right\"\u003e10.5\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: right\"\u003e70%\u003c/td\u003e\n      \u003ctd style=\"text-align: right\"\u003e8.8\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: right\"\u003e75%\u003c/td\u003e\n      \u003ctd style=\"text-align: right\"\u003e7.1\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: right\"\u003e80%\u003c/td\u003e\n      \u003ctd style=\"text-align: right\"\u003e5.6\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: right\"\u003e85%\u003c/td\u003e\n      \u003ctd style=\"text-align: right\"\u003e4.1\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: right\"\u003e90%\u003c/td\u003e\n      \u003ctd style=\"text-align: right\"\u003e2.7\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: right\"\u003e95%\u003c/td\u003e\n      \u003ctd style=\"text-align: right\"\u003e1.3\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd style=\"text-align: right\"\u003e100%\u003c/td\u003e\n      \u003ctd style=\"text-align: right\"\u003e0.0\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003cp\u003eWhich matches the table from the original blog post.\u003c/p\u003e\n\n\u003ch3 id=\"pv\"\u003ePV\u003c/h3\u003e\n\n\u003cp\u003e\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ePV\u003c/code\u003e for Present Value makes it possible to calculate how much you need to contribute today to get a certain result in the future, or the value of something today discounted from the future.\u003c/p\u003e\n\n\u003cdiv class=\"language-plaintext highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003ePV(rate, nper, pmt, fv, type)\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eLet’s answer the following question:\u003c/p\u003e\n\n\u003cblockquote\u003e\n  \u003cp\u003eI want to buy an annuity that yields €100/month for the next 10 years and the interest rate is 2%. How much will it cost?\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003eThe answer is:\u003c/p\u003e\n\n\u003cdiv class=\"language-plaintext highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003ePV(2% ÷ 12, 10 × 12, −100, 0) = 10,867.98\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eA controversial book on investing I recently read is \u003ca href=\"https://www.lifecycleinvesting.net\" target=\"_blank\"\u003eLifecycle Investing\u003c/a\u003e which argues that young people are often much too conservative in their investment strategy, because they should model their future earnings as a bond and allocate enough to equities to compensate for holding this bond, even leveraging up to 100% to get the right allocation. To calculate the present value we can use the following formula, assuming you will work for another 20 years, can save €300 per month and discount your future earnings by 4% annually:\u003c/p\u003e\n\n\u003cdiv class=\"language-plaintext highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003ePV(4% ÷ 12, 20 × 12, -300, 0) = -49,506.56\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003eSo we can value our future savings at about €50k in current monies and adjust our portfolio accordingly.\u003c/p\u003e\n\n\u003ch2 id=\"conclusion\"\u003eConclusion\u003c/h2\u003e\n\n\u003cp\u003eDo you have any useful spreadsheet tricks you learned recently? Please let me know, I’m always looking to expand my toolbox!\u003c/p\u003e\n\n  \u003cp\u003e\u003cspan class=\"date\"\u003eAug 2021\u003c/span\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e",
  "Date": "2021-08-01T00:00:00Z",
  "Author": "bou.ke"
}