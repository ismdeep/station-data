{
  "Source": "coolshell.cn",
  "Title": "纯文本配置还是注册表",
  "Link": "https://coolshell.cn/articles/4077.html",
  "Content": "\u003cdiv class=\"entry-content\"\u003e\n\u003cp\u003e\u003cscript async=\"\" src=\"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3415450859608158\" crossorigin=\"anonymous\" type=\"81e93928afb47eaed8244df3-text/javascript\"\u003e\u003c/script\u003e我们知道Unix/Linux下的程序配置文件从来都是纯文本的，你可以自由地修改和查看，他们也没有什么什么XML之类的玩意（参看XML的这两篇文章：\u003ca title=\"信XML，得永生！\" href=\"https://coolshell.cn/articles/2504.html\" target=\"_blank\"\u003e一\u003c/a\u003e，\u003ca title=\"信XML，得自信\" href=\"https://coolshell.cn/articles/3498.html\" target=\"_blank\"\u003e二\u003c/a\u003e），这个最重要的Unix文化（参看\u003ca title=\"Unix传奇(下篇)\" href=\"https://coolshell.cn/articles/2324.html\" target=\"_blank\"\u003eUnix传奇下篇\u003c/a\u003e）40多年来就这么沿续下来了。我很佩服Microsoft的创新能力，一会儿用INI，一会儿用注册表，一会又是用XML，这就是\u003ca title=\"Windows编程革命简史\" href=\"https://coolshell.cn/articles/3008.html\" target=\"_blank\"\u003eWindows的编程中那“强大”的创新\u003c/a\u003e。在网上又看到有人在争论为什么用注册表而不是纯文本，所以，写下这篇文章。\u003c/p\u003e\n\u003cdiv id=\"ez-toc-container\" class=\"ez-toc-v2_0_48 counter-hierarchy ez-toc-counter ez-toc-grey ez-toc-container-direction\"\u003e\n\u003cdiv class=\"ez-toc-title-container\"\u003e\n\u003cp class=\"ez-toc-title\"\u003e目录\u003c/p\u003e\n\u003cspan class=\"ez-toc-title-toggle\"\u003e\u003c/span\u003e\u003c/div\u003e\n\u003cnav\u003e\u003cul class=\"ez-toc-list ez-toc-list-level-1 \"\u003e\u003cli class=\"ez-toc-page-1 ez-toc-heading-level-4\"\u003e\u003ca class=\"ez-toc-link ez-toc-heading-1\" href=\"#%E5%BC%95%E5%85%A5%E6%B3%A8%E5%86%8C%E8%A1%A8%E6%89%80%E8%B0%93%E7%9A%84%E5%8E%9F%E5%9B%A0\" title=\"引入注册表所谓的原因\"\u003e引入注册表所谓的原因\u003c/a\u003e\u003c/li\u003e\u003cli class=\"ez-toc-page-1 ez-toc-heading-level-4\"\u003e\u003ca class=\"ez-toc-link ez-toc-heading-2\" href=\"#%E6%88%91%E7%9A%84%E8%A7%82%E7%82%B9\" title=\"我的观点\"\u003e我的观点\u003c/a\u003e\u003c/li\u003e\u003cli class=\"ez-toc-page-1 ez-toc-heading-level-4\"\u003e\u003ca class=\"ez-toc-link ez-toc-heading-3\" href=\"#%E7%BA%AF%E6%96%87%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E5%A5%BD%E5%A4%84\" title=\"纯文本配置文件的好处\"\u003e纯文本配置文件的好处\u003c/a\u003e\u003c/li\u003e\u003cli class=\"ez-toc-page-1 ez-toc-heading-level-4\"\u003e\u003ca class=\"ez-toc-link ez-toc-heading-4\" href=\"#%E7%9C%9F%E6%AD%A3%E7%9A%84%E5%8E%9F%E5%9B%A0\" title=\"真正的原因\"\u003e真正的原因\u003c/a\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/nav\u003e\u003c/div\u003e\n\u003ch4\u003e\u003cspan class=\"ez-toc-section\" id=\"%E5%BC%95%E5%85%A5%E6%B3%A8%E5%86%8C%E8%A1%A8%E6%89%80%E8%B0%93%E7%9A%84%E5%8E%9F%E5%9B%A0\"\u003e\u003c/span\u003e引入注册表所谓的原因\u003cspan class=\"ez-toc-section-end\"\u003e\u003c/span\u003e\u003c/h4\u003e\n\u003cp\u003e首先，让我们来看一下为什么微软觉得要使用注册表而不是ini文件，下面是一些其列出来的ini方面的毛病：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eini文件不支持Unicode\u003c/li\u003e\n\u003cli\u003eini文件的安全权限不够\u003c/li\u003e\n\u003cli\u003eini文件在多进程下存取会有问题\u003c/li\u003e\n\u003cli\u003e如果一个进程锁上了这个文件，另一个进程就无法获得，只能出错。\u003c/li\u003e\n\u003cli\u003eini文件只能包含字符串，无法使用二进制\u003c/li\u003e\n\u003cli\u003e解析ini文件相对来说性能比较慢，第一次读写都需要把整个文件读入内存，然后再写回去。\u003c/li\u003e\n\u003cli\u003eini文件最大只有32K\u003c/li\u003e\n\u003cli\u003eini文件的默认目录在Windows系统目录下，只能这个目录只能Windows管理员才能访问\u003c/li\u003e\n\u003cli\u003eini只能包含了两层，对于多层不支持。\u003c/li\u003e\n\u003cli\u003e把ini文件放在中央服务器上管理很困难。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e而微软说，注册表可以完美地解决这些问题。居然微软只说到了ini文件，但我觉得不单单是ini，所有的以纯文本方式保存配置文件的方法都会出现上述这样的问题。\u003c/p\u003e\n\u003ch4\u003e\u003cspan class=\"ez-toc-section\" id=\"%E6%88%91%E7%9A%84%E8%A7%82%E7%82%B9\"\u003e\u003c/span\u003e我的观点\u003cspan class=\"ez-toc-section-end\"\u003e\u003c/span\u003e\u003c/h4\u003e\n\u003cp\u003e那么，当你在看到这些言论时，你是怎么想的？你有没有经过自己的独立思考？还是你觉得注册表完美地解决了所有的一切？下面是我的一些观点：\u003c/p\u003e\n\u003cp\u003e\u003cspan id=\"more-4077\"\u003e\u003c/span\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cspan style=\"color: #800000;\"\u003e首先，我们要知道没有任何一件事是完美的，凡事必然有好的一面，也有不好的一面。\u003c/span\u003e\u003c/li\u003e\n\u003cli\u003e\u003cspan style=\"color: #800000;\"\u003e其次，当我们在改进一个东西时，不单单要解决其不好的东西，还要把其好的东西给传承下来。\u003c/span\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e所以，当你看到一些只说好或是只说坏的东西时，这往往意味着“宗教”或“洗脑”，这正是需要你独立思考的时候。\u003c/p\u003e\n\u003ch4\u003e\u003cspan class=\"ez-toc-section\" id=\"%E7%BA%AF%E6%96%87%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%9A%84%E5%A5%BD%E5%A4%84\"\u003e\u003c/span\u003e纯文本配置文件的好处\u003cspan class=\"ez-toc-section-end\"\u003e\u003c/span\u003e\u003c/h4\u003e\n\u003cp\u003e下面，是我觉得纯文本配置文件的好处（我用Unix下的纯文本配置文件来举例）：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e很容易进行版本管理（配置文件和程序代码一样都需要版本控制）\u003c/li\u003e\n\u003cli\u003e很容易移植到别的平台\u003c/li\u003e\n\u003cli\u003e很容易自定义文本文件的格式和语法，已也有相关的库支持（ini只支持ANSI字符，只有32K，只支持两级，那是ini的问题，解决这些问题不需要引入注册表）\u003c/li\u003e\n\u003cli\u003e可以在配置文本中写注释信息\u003c/li\u003e\n\u003cli\u003e你要很容易的使用grep，awk，sed等等以及来和脚本集成。\u003c/li\u003e\n\u003cli\u003e你可以很容易地拆分配置文件把其放到conf.d中，这样一来，你就非常灵活\n\u003cul\u003e\n\u003cli\u003e你就不用整个文件都读入内存，\u003c/li\u003e\n\u003cli\u003e你也可以分别设置上不同的存取权限，\u003c/li\u003e\n\u003cli\u003e同样可以减小多个进程同时存取的问题\u003c/li\u003e\n\u003cli\u003e同样可以引用别的二进制配置的文件\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e你可以很容易地产生备份或是在不同的配置中来回地切换配置文件以进行调试。\u003c/li\u003e\n\u003cli\u003e你可以很容易地使用rsync来向中央服务器同步你的配置文件。或者使用NFS/NIS直接就把配置放在中央服务器上。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003e\u003cspan class=\"ez-toc-section\" id=\"%E7%9C%9F%E6%AD%A3%E7%9A%84%E5%8E%9F%E5%9B%A0\"\u003e\u003c/span\u003e真正的原因\u003cspan class=\"ez-toc-section-end\"\u003e\u003c/span\u003e\u003c/h4\u003e\n\u003cp\u003e可见，Windows 的注册表并没有把纯文本配置文件的这些好处都带过来，所以，经过这样的独立思考，我们可以知道，微软引入注册表的真正原因是——\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e让你的程序不具移植性，让你的软件永远运行在Windows上。\u003c/li\u003e\n\u003cli\u003e增加你编程的复杂度和你维护配置文件的复杂度，让你在痛苦之后，苦苦哀求微软再发布下一个“创新”。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e各位程序员——Windows是很危险的，你们还是回火星去吧。\u003c/p\u003e\n\u003cp\u003e（\u003cstrong\u003e全文完，转载时请注明作者和出处\u003c/strong\u003e）\u003c/p\u003e\n\u003cdiv style=\"margin-top: 15px; font-size: 16px;color: #cc0000;\"\u003e\n\u003cp align=\"center\"\u003e\u003cstrong\u003e（转载本站文章请注明作者和出处 \u003ca href=\"https://coolshell.cn/\"\u003e酷 壳 – CoolShell\u003c/a\u003e ，请勿用于任何商业用途）\u003c/strong\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"wp_rp_wrap  wp_rp_vertical_m\" id=\"wp_rp_first\"\u003e\u003cdiv class=\"wp_rp_content\"\u003e\u003ch3 class=\"related_post_title\"\u003e相关文章\u003c/h3\u003e\u003cul class=\"related_post wp_rp\"\u003e\u003cli\u003e\u003ca href=\"https://coolshell.cn/articles/4102.html\" class=\"wp_rp_thumbnail\"\u003e\u003cimg src=\"https://coolshell.cn/wp-content/plugins/wordpress-23-related-posts-plugin/static/thumbs/25.jpg\" alt=\"如何学好C语言\" width=\"150\" height=\"150\"/\u003e\u003c/a\u003e\u003ca href=\"https://coolshell.cn/articles/4102.html\" class=\"wp_rp_title\"\u003e如何学好C语言\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"https://coolshell.cn/articles/1272.html\" class=\"wp_rp_thumbnail\"\u003e\u003cimg src=\"https://coolshell.cn/wp-content/uploads/2009/08/linux_airline-150x150.jpg\" alt=\"操作系统航空公司\" width=\"150\" height=\"150\"/\u003e\u003c/a\u003e\u003ca href=\"https://coolshell.cn/articles/1272.html\" class=\"wp_rp_title\"\u003e操作系统航空公司\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"https://coolshell.cn/articles/18360.html\" class=\"wp_rp_thumbnail\"\u003e\u003cimg src=\"https://coolshell.cn/wp-content/uploads/2018/05/300x262-150x150.jpg\" alt=\"程序员练级攻略（2018)  与我的专栏\" width=\"150\" height=\"150\"/\u003e\u003c/a\u003e\u003ca href=\"https://coolshell.cn/articles/18360.html\" class=\"wp_rp_title\"\u003e程序员练级攻略（2018) 与我的专栏\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"https://coolshell.cn/articles/17998.html\" class=\"wp_rp_thumbnail\"\u003e\u003cimg src=\"https://coolshell.cn/wp-content/uploads/2017/07/systemd-1-150x150.jpeg\" alt=\"Linux PID 1 和 Systemd\" width=\"150\" height=\"150\"/\u003e\u003c/a\u003e\u003ca href=\"https://coolshell.cn/articles/17998.html\" class=\"wp_rp_title\"\u003eLinux PID 1 和 Systemd\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"https://coolshell.cn/articles/12103.html\" class=\"wp_rp_thumbnail\"\u003e\u003cimg src=\"https://coolshell.cn/wp-content/uploads/2014/11/tux-fork-150x150.gif\" alt=\"vfork 挂掉的一个问题\" width=\"150\" height=\"150\"/\u003e\u003c/a\u003e\u003ca href=\"https://coolshell.cn/articles/12103.html\" class=\"wp_rp_title\"\u003evfork 挂掉的一个问题\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"https://coolshell.cn/articles/11847.html\" class=\"wp_rp_thumbnail\"\u003e\u003cimg src=\"https://coolshell.cn/wp-content/uploads/2014/08/puzzle-150x150.png\" alt=\"谜题的答案和活动的心得体会\" width=\"150\" height=\"150\"/\u003e\u003c/a\u003e\u003ca href=\"https://coolshell.cn/articles/11847.html\" class=\"wp_rp_title\"\u003e谜题的答案和活动的心得体会\u003c/a\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/div\u003e\n\u003cdiv id=\"post-ratings-4077\" class=\"post-ratings\" itemscope=\"\" itemtype=\"https://schema.org/Article\" data-nonce=\"2bcad0537b\"\u003e\u003cimg id=\"rating_4077_1\" src=\"https://coolshell.cn/wp-content/plugins/wp-postratings/images/stars_crystal/rating_on.gif\" alt=\"好烂啊\" title=\"好烂啊\" onmouseover=\"if (!window.__cfRLUnblockHandlers) return false; current_rating(4077, 1, \u0026#39;好烂啊\u0026#39;);\" onmouseout=\"if (!window.__cfRLUnblockHandlers) return false; ratings_off(3.6, 4, 0);\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" onkeypress=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" style=\"cursor: pointer; border: 0px;\" data-cf-modified-81e93928afb47eaed8244df3-=\"\"/\u003e\u003cimg id=\"rating_4077_2\" src=\"https://coolshell.cn/wp-content/plugins/wp-postratings/images/stars_crystal/rating_on.gif\" alt=\"有点差\" title=\"有点差\" onmouseover=\"if (!window.__cfRLUnblockHandlers) return false; current_rating(4077, 2, \u0026#39;有点差\u0026#39;);\" onmouseout=\"if (!window.__cfRLUnblockHandlers) return false; ratings_off(3.6, 4, 0);\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" onkeypress=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" style=\"cursor: pointer; border: 0px;\" data-cf-modified-81e93928afb47eaed8244df3-=\"\"/\u003e\u003cimg id=\"rating_4077_3\" src=\"https://coolshell.cn/wp-content/plugins/wp-postratings/images/stars_crystal/rating_on.gif\" alt=\"凑合看看\" title=\"凑合看看\" onmouseover=\"if (!window.__cfRLUnblockHandlers) return false; current_rating(4077, 3, \u0026#39;凑合看看\u0026#39;);\" onmouseout=\"if (!window.__cfRLUnblockHandlers) return false; ratings_off(3.6, 4, 0);\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" onkeypress=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" style=\"cursor: pointer; border: 0px;\" data-cf-modified-81e93928afb47eaed8244df3-=\"\"/\u003e\u003cimg id=\"rating_4077_4\" src=\"https://coolshell.cn/wp-content/plugins/wp-postratings/images/stars_crystal/rating_half.gif\" alt=\"还不错\" title=\"还不错\" onmouseover=\"if (!window.__cfRLUnblockHandlers) return false; current_rating(4077, 4, \u0026#39;还不错\u0026#39;);\" onmouseout=\"if (!window.__cfRLUnblockHandlers) return false; ratings_off(3.6, 4, 0);\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" onkeypress=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" style=\"cursor: pointer; border: 0px;\" data-cf-modified-81e93928afb47eaed8244df3-=\"\"/\u003e\u003cimg id=\"rating_4077_5\" src=\"https://coolshell.cn/wp-content/plugins/wp-postratings/images/stars_crystal/rating_off.gif\" alt=\"很精彩\" title=\"很精彩\" onmouseover=\"if (!window.__cfRLUnblockHandlers) return false; current_rating(4077, 5, \u0026#39;很精彩\u0026#39;);\" onmouseout=\"if (!window.__cfRLUnblockHandlers) return false; ratings_off(3.6, 4, 0);\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" onkeypress=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" style=\"cursor: pointer; border: 0px;\" data-cf-modified-81e93928afb47eaed8244df3-=\"\"/\u003e (\u003cstrong\u003e26\u003c/strong\u003e 人打了分，平均分： \u003cstrong\u003e3.58\u003c/strong\u003e )\u003cbr/\u003e\u003cspan class=\"post-ratings-text\" id=\"ratings_4077_text\"\u003e\u003c/span\u003e\u003cmeta itemprop=\"name\" content=\"纯文本配置还是注册表\"/\u003e\u003cmeta itemprop=\"headline\" content=\"纯文本配置还是注册表\"/\u003e\u003cmeta itemprop=\"description\" content=\"我们知道Unix/Linux下的程序配置文件从来都是纯文本的，你可以自由地修改和查看，他们也没有什么什么XML之类的玩意（参看XML的这两篇文章：一，二），这个最重要的Unix文化（参看Unix传奇下篇）40多年来就这么沿续下来了。我很佩服Microsoft的创新能力，一会儿用INI，一会儿用注册表，一会又是用XML，这就是Windows的编程中那“强大”的创新。在网上又看到有人在争论为什么用注册...\"/\u003e\u003cmeta itemprop=\"datePublished\" content=\"2011-03-28T08:42:10+08:00\"/\u003e\u003cmeta itemprop=\"dateModified\" content=\"2011-03-28T09:48:34+08:00\"/\u003e\u003cmeta itemprop=\"url\" content=\"https://coolshell.cn/articles/4077.html\"/\u003e\u003cmeta itemprop=\"author\" content=\"陈皓\"/\u003e\u003cmeta itemprop=\"mainEntityOfPage\" content=\"https://coolshell.cn/articles/4077.html\"/\u003e\u003cdiv style=\"display: none;\" itemprop=\"publisher\" itemscope=\"\" itemtype=\"https://schema.org/Organization\"\u003e\u003cmeta itemprop=\"name\" content=\"酷 壳 - CoolShell\"/\u003e\u003cmeta itemprop=\"url\" content=\"https://coolshell.cn\"/\u003e\u003cdiv itemprop=\"logo\" itemscope=\"\" itemtype=\"https://schema.org/ImageObject\"\u003e\u003cmeta itemprop=\"url\" content=\"\"/\u003e\u003c/div\u003e\u003c/div\u003e\u003cdiv style=\"display: none;\" itemprop=\"aggregateRating\" itemscope=\"\" itemtype=\"https://schema.org/AggregateRating\"\u003e\u003cmeta itemprop=\"bestRating\" content=\"5\"/\u003e\u003cmeta itemprop=\"worstRating\" content=\"1\"/\u003e\u003cmeta itemprop=\"ratingValue\" content=\"3.58\"/\u003e\u003cmeta itemprop=\"ratingCount\" content=\"26\"/\u003e\u003c/div\u003e\u003c/div\u003e\u003cdiv id=\"post-ratings-4077-loading\" class=\"post-ratings-loading\"\u003e\u003cimg src=\"https://coolshell.cn/wp-content/plugins/wp-postratings/images/loading.gif\" width=\"16\" height=\"16\" class=\"post-ratings-image\"/\u003eLoading...\u003c/div\u003e\n\u003c/div\u003e",
  "Date": "2011-03-28T08:42:10+08:00",
  "Author": "陈皓"
}