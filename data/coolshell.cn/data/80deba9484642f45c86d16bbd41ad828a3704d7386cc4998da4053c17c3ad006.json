{
  "Source": "coolshell.cn",
  "Title": "恐怖的C++语言",
  "Link": "https://coolshell.cn/articles/1724.html",
  "Content": "\u003cdiv class=\"entry-content\"\u003e\n\u003cp\u003e\u003cscript async=\"\" src=\"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3415450859608158\" crossorigin=\"anonymous\" type=\"ee44ec9f0cb359cf93ad358a-text/javascript\"\u003e\u003c/script\u003e\u003ca href=\"https://coolshell.cn/wp-content/uploads/2009/11/cpp.jpg\"\u003e\u003cimg decoding=\"async\" class=\"alignright size-medium wp-image-1740\" title=\"我爱C++\" src=\"https://coolshell.cn/wp-content/uploads/2009/11/cpp-300x216.jpg\" alt=\"我爱C++\" width=\"200\" height=\"144\"/\u003e\u003c/a\u003e Linus曾经(2007年9月)在新闻组\u003ca href=\"http://news.gmane.org/gmane.comp.version-control.git\" target=\"_top\"\u003egmane.comp.version-control.git\u003c/a\u003e里和一个微软的工程师（Dmitry Kakurin）争执过用C还是用C++，当时的那个微软的工程师主要是在做Git的Windows版，但他却发现Git的源码居然是C语言写的，而不是C++，于是他（Dmitry Kakurin）在Linux社区里发贴表示对Linux的不满，语言很直接：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp style=\"padding-left: 30px;\"\u003ePure C as opposed to C++. No idea why. Please don’t talk about portability, it’s BS. （\u003cspan style=\"color: #008000;\"\u003e纯C写的，而不是C++，不知道为什么，请别告诉我是为了移植性，这完全是胡扯\u003c/span\u003e。）\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eLinux之父Linus Torvalds马上跟贴，在贴子中，Linus言辞很直接，直接表明C++是一个很恐怖的语言，他在\u003ca href=\"http://thread.gmane.org/gmane.comp.version-control.git/57643/focus=57918\" target=\"_blank\"\u003e\u003cstrong\u003e贴子\u003c/strong\u003e\u003c/a\u003e中说：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp style=\"padding-left: 30px;\"\u003e\u003cstrong\u003e*YOU*\u003c/strong\u003e are full of bullshit. C++ is a horrible language. It’s made more horrible by the fact that a lot of substandard programmers use it. （\u003cspan style=\"color: #008000;\"\u003e你才是完全在胡扯。C++是一门很恐怖的语言，而比它更恐怖的是很多不合格的程序员在使用着它\u003c/span\u003e）\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eLinus的这个观点我是比较同意的，我个人也在几年前的《\u003ca href=\"http://blog.csdn.net/haoel/archive/2004/06/23/24058.aspx\" target=\"_blank\"\u003eSTL String类的写时才拷贝\u003c/a\u003e》以及以后的一些文章中表达过C++的确并不是一个很成熟的语言，这种观点一直都围绕着我。这是因为它的学习成本实在是太高了，编译器和类背着你做了很多你不知道的事，而且，C++非常容易地出错和发生很多意想不到的问题。\u003c/p\u003e\n\u003cp\u003e当然，这篇文章并不是要继续声讨C++，也不是回顾以前的某个事件。我们这里只谈技术。昨天，我在网上看到一个邪恶的C++的示例，在这里给大家share一下，让大家看看C++这种编程语言的恐怖和邪恶的一面。下面的这个例子，比那个“#define  private  public”还更加邪恶。\u003c/p\u003e\n\u003cp\u003e\u003cspan id=\"more-1724\"\u003e\u003c/span\u003e\u003c/p\u003e\n\u003cp\u003e请看下面这段代码，你能告诉我它会输出什么吗？（注意main函数中高亮的那一行）\u003c/p\u003e\n\u003cpre data-enlighter-language=\"c\" class=\"EnlighterJSRAW\" data-enlighter-highlight=\"28\"\u003e#include \u0026lt;iostream\u0026gt;\n#include \u0026lt;vector\u0026gt;\n\ntypedef int UINT4;\nusing namespace std;\nclass Hack\n{\n};\n\nHack\u0026amp; operator\u0026lt; (Hack \u0026amp;a , Hack \u0026amp;b)\n{\n    std::cerr \u0026lt;\u0026lt; \u0026#34;小于操作符\\n\u0026#34;;\n    return a;\n}\n\nHack\u0026amp; operator\u0026gt; (Hack \u0026amp;a, Hack \u0026amp;b)\n{\n    std::cerr \u0026lt;\u0026lt;  \u0026#34;大于操作符\\n\u0026#34;;\n    return a;\n}\n\nint main(int argc, char ** argv)\n{\n    Hack vector;\n    Hack UINT4;\n    Hack foo;\n\n    vector\u0026lt;UINT4\u0026gt; foo;\n\nreturn(0);\n}\u003c/pre\u003e\n\u003cp style=\"text-align: left;\"\u003e\u003cimg decoding=\"async\" loading=\"lazy\" class=\"alignleft\" title=\"不是吧\" src=\"https://coolshell.cn/wp-content/uploads/2009/11/bushiba-150x150.jpg\" alt=\"不是吧\" width=\"98\" height=\"96\"/\u003e是的，上面这段代码如果只看main函数中的那句“vector\u0026lt;UINT4\u0026gt; foo”，你会觉得很眼熟，然而，事情并非那么简单，我们可以看到vector, UINT4和foo都是Hack类的实例，这就是邪恶的开始，那两个尖括号\u0026lt; \u0026gt;则成了两个运算符，大于和小于，这两个运算符却又被重载了。其实，真正的语句是：\u003c/p\u003e\n\u003cp\u003e\u003ccode data-enlighter-language=\"c\" class=\"EnlighterJSRAW\"\u003evector.operator\u0026lt;(UNIT4).operator\u0026gt;(foo);\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e所以，所有的一切都符合我们的C++的规范和语法，自然程序也能被顺利编译通过（至少，在我的G++上是没有问题的）。而整个程序的运行结果自然是：\u003c/p\u003e\n\u003cpre data-enlighter-language=\"bash\" class=\"EnlighterJSRAW\"\u003e$ ./horror\n小于操作符\n大于操作符\u003c/pre\u003e\n\u003cp\u003e是的，如果你通晓C++的一切的一切，你自然不会对这段程序感到惊奇。这样的事情在C/C++的世界中并不少见，要搞乱C/C++的代码并不是一件难事，花样多得数不胜数，只要看看《\u003ca title=\"6个变态的C语言Hello World程序 - 4,749 次浏览\" href=\"https://coolshell.cn/articles/914.html\"\u003e6个变态的C语言Hello World程序\u003c/a\u003e》你就知道了，而且，还有一个简单的教程《\u003ca title=\"如何加密/混乱C源代码 - 2,420 次浏览\" href=\"https://coolshell.cn/articles/933.html\"\u003e如何加密/混乱C源代码\u003c/a\u003e》告诉你一些简单的做法。\u003c/p\u003e\n\u003cp\u003e那么，如果你有一天在读程序中看到“vector\u0026lt;UINT4\u0026gt; foo”，你会觉得那只是一个幻觉吗？\u003c/p\u003e\n\u003cp\u003e（全文完）\u003c/p\u003e\n\u003cdiv style=\"margin-top: 15px; font-size: 16px;color: #cc0000;\"\u003e\n\u003cp align=\"center\"\u003e\u003cstrong\u003e（转载本站文章请注明作者和出处 \u003ca href=\"https://coolshell.cn/\"\u003e酷 壳 – CoolShell\u003c/a\u003e ，请勿用于任何商业用途）\u003c/strong\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"wp_rp_wrap  wp_rp_vertical_m\" id=\"wp_rp_first\"\u003e\u003cdiv class=\"wp_rp_content\"\u003e\u003ch3 class=\"related_post_title\"\u003e相关文章\u003c/h3\u003e\u003cul class=\"related_post wp_rp\"\u003e\u003cli\u003e\u003ca href=\"https://coolshell.cn/articles/20845.html\" class=\"wp_rp_thumbnail\"\u003e\u003cimg src=\"https://coolshell.cn/wp-content/uploads/2020/03/rust-social-wide-150x150.jpg\" alt=\"Rust语言的编程范式\" width=\"150\" height=\"150\"/\u003e\u003c/a\u003e\u003ca href=\"https://coolshell.cn/articles/20845.html\" class=\"wp_rp_title\"\u003eRust语言的编程范式\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"https://coolshell.cn/articles/18360.html\" class=\"wp_rp_thumbnail\"\u003e\u003cimg src=\"https://coolshell.cn/wp-content/uploads/2018/05/300x262-150x150.jpg\" alt=\"程序员练级攻略（2018)  与我的专栏\" width=\"150\" height=\"150\"/\u003e\u003c/a\u003e\u003ca href=\"https://coolshell.cn/articles/18360.html\" class=\"wp_rp_title\"\u003e程序员练级攻略（2018) 与我的专栏\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"https://coolshell.cn/articles/18024.html\" class=\"wp_rp_thumbnail\"\u003e\u003cimg src=\"https://coolshell.cn/wp-content/uploads/2017/07/api-design-300x278-2-150x150.jpg\" alt=\"API设计原则 – Qt官网的设计实践总结\" width=\"150\" height=\"150\"/\u003e\u003c/a\u003e\u003ca href=\"https://coolshell.cn/articles/18024.html\" class=\"wp_rp_title\"\u003eAPI设计原则 – Qt官网的设计实践总结\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"https://coolshell.cn/articles/12052.html\" class=\"wp_rp_thumbnail\"\u003e\u003cimg src=\"https://coolshell.cn/wp-content/plugins/wordpress-23-related-posts-plugin/static/thumbs/29.jpg\" alt=\"Leetcode 编程训练\" width=\"150\" height=\"150\"/\u003e\u003c/a\u003e\u003ca href=\"https://coolshell.cn/articles/12052.html\" class=\"wp_rp_title\"\u003eLeetcode 编程训练\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"https://coolshell.cn/articles/12012.html\" class=\"wp_rp_thumbnail\"\u003e\u003cimg src=\"https://coolshell.cn/wp-content/uploads/2014/10/edsm-150x150.gif\" alt=\"State Threads 回调终结者\" width=\"150\" height=\"150\"/\u003e\u003c/a\u003e\u003ca href=\"https://coolshell.cn/articles/12012.html\" class=\"wp_rp_title\"\u003eState Threads 回调终结者\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"https://coolshell.cn/articles/11466.html\" class=\"wp_rp_thumbnail\"\u003e\u003cimg src=\"https://coolshell.cn/wp-content/uploads/2014/04/c99-150x150.jpg\" alt=\"C语言的整型溢出问题\" width=\"150\" height=\"150\"/\u003e\u003c/a\u003e\u003ca href=\"https://coolshell.cn/articles/11466.html\" class=\"wp_rp_title\"\u003eC语言的整型溢出问题\u003c/a\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/div\u003e\n\u003cdiv id=\"post-ratings-1724\" class=\"post-ratings\" itemscope=\"\" itemtype=\"https://schema.org/Article\" data-nonce=\"583f930132\"\u003e\u003cimg id=\"rating_1724_1\" src=\"https://coolshell.cn/wp-content/plugins/wp-postratings/images/stars_crystal/rating_on.gif\" alt=\"好烂啊\" title=\"好烂啊\" onmouseover=\"if (!window.__cfRLUnblockHandlers) return false; current_rating(1724, 1, \u0026#39;好烂啊\u0026#39;);\" onmouseout=\"if (!window.__cfRLUnblockHandlers) return false; ratings_off(4.4, 5, 0);\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" onkeypress=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" style=\"cursor: pointer; border: 0px;\" data-cf-modified-ee44ec9f0cb359cf93ad358a-=\"\"/\u003e\u003cimg id=\"rating_1724_2\" src=\"https://coolshell.cn/wp-content/plugins/wp-postratings/images/stars_crystal/rating_on.gif\" alt=\"有点差\" title=\"有点差\" onmouseover=\"if (!window.__cfRLUnblockHandlers) return false; current_rating(1724, 2, \u0026#39;有点差\u0026#39;);\" onmouseout=\"if (!window.__cfRLUnblockHandlers) return false; ratings_off(4.4, 5, 0);\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" onkeypress=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" style=\"cursor: pointer; border: 0px;\" data-cf-modified-ee44ec9f0cb359cf93ad358a-=\"\"/\u003e\u003cimg id=\"rating_1724_3\" src=\"https://coolshell.cn/wp-content/plugins/wp-postratings/images/stars_crystal/rating_on.gif\" alt=\"凑合看看\" title=\"凑合看看\" onmouseover=\"if (!window.__cfRLUnblockHandlers) return false; current_rating(1724, 3, \u0026#39;凑合看看\u0026#39;);\" onmouseout=\"if (!window.__cfRLUnblockHandlers) return false; ratings_off(4.4, 5, 0);\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" onkeypress=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" style=\"cursor: pointer; border: 0px;\" data-cf-modified-ee44ec9f0cb359cf93ad358a-=\"\"/\u003e\u003cimg id=\"rating_1724_4\" src=\"https://coolshell.cn/wp-content/plugins/wp-postratings/images/stars_crystal/rating_on.gif\" alt=\"还不错\" title=\"还不错\" onmouseover=\"if (!window.__cfRLUnblockHandlers) return false; current_rating(1724, 4, \u0026#39;还不错\u0026#39;);\" onmouseout=\"if (!window.__cfRLUnblockHandlers) return false; ratings_off(4.4, 5, 0);\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" onkeypress=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" style=\"cursor: pointer; border: 0px;\" data-cf-modified-ee44ec9f0cb359cf93ad358a-=\"\"/\u003e\u003cimg id=\"rating_1724_5\" src=\"https://coolshell.cn/wp-content/plugins/wp-postratings/images/stars_crystal/rating_half.gif\" alt=\"很精彩\" title=\"很精彩\" onmouseover=\"if (!window.__cfRLUnblockHandlers) return false; current_rating(1724, 5, \u0026#39;很精彩\u0026#39;);\" onmouseout=\"if (!window.__cfRLUnblockHandlers) return false; ratings_off(4.4, 5, 0);\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" onkeypress=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" style=\"cursor: pointer; border: 0px;\" data-cf-modified-ee44ec9f0cb359cf93ad358a-=\"\"/\u003e (\u003cstrong\u003e42\u003c/strong\u003e 人打了分，平均分： \u003cstrong\u003e4.38\u003c/strong\u003e )\u003cbr/\u003e\u003cspan class=\"post-ratings-text\" id=\"ratings_1724_text\"\u003e\u003c/span\u003e\u003cmeta itemprop=\"name\" content=\"恐怖的C++语言\"/\u003e\u003cmeta itemprop=\"headline\" content=\"恐怖的C++语言\"/\u003e\u003cmeta itemprop=\"description\" content=\" Linus曾经(2007年9月)在新闻组gmane.comp.version-control.git里和一个微软的工程师（Dmitry Kakurin）争执过用C还是用C++，当时的那个微软的工程师主要是在做Git的Windows版，但他却发现Git的源码居然是C语言写的，而不是C++，于是他（Dmitry Kakurin）在Linux社区里发贴表示对Linux的不满，语言很直接：\n\nPur...\"/\u003e\u003cmeta itemprop=\"datePublished\" content=\"2009-11-11T12:06:25+08:00\"/\u003e\u003cmeta itemprop=\"dateModified\" content=\"2009-11-14T11:23:55+08:00\"/\u003e\u003cmeta itemprop=\"url\" content=\"https://coolshell.cn/articles/1724.html\"/\u003e\u003cmeta itemprop=\"author\" content=\"陈皓\"/\u003e\u003cmeta itemprop=\"mainEntityOfPage\" content=\"https://coolshell.cn/articles/1724.html\"/\u003e\u003cdiv style=\"display: none;\" itemprop=\"publisher\" itemscope=\"\" itemtype=\"https://schema.org/Organization\"\u003e\u003cmeta itemprop=\"name\" content=\"酷 壳 - CoolShell\"/\u003e\u003cmeta itemprop=\"url\" content=\"https://coolshell.cn\"/\u003e\u003cdiv itemprop=\"logo\" itemscope=\"\" itemtype=\"https://schema.org/ImageObject\"\u003e\u003cmeta itemprop=\"url\" content=\"\"/\u003e\u003c/div\u003e\u003c/div\u003e\u003cdiv style=\"display: none;\" itemprop=\"aggregateRating\" itemscope=\"\" itemtype=\"https://schema.org/AggregateRating\"\u003e\u003cmeta itemprop=\"bestRating\" content=\"5\"/\u003e\u003cmeta itemprop=\"worstRating\" content=\"1\"/\u003e\u003cmeta itemprop=\"ratingValue\" content=\"4.38\"/\u003e\u003cmeta itemprop=\"ratingCount\" content=\"42\"/\u003e\u003c/div\u003e\u003c/div\u003e\u003cdiv id=\"post-ratings-1724-loading\" class=\"post-ratings-loading\"\u003e\u003cimg src=\"https://coolshell.cn/wp-content/plugins/wp-postratings/images/loading.gif\" width=\"16\" height=\"16\" class=\"post-ratings-image\"/\u003eLoading...\u003c/div\u003e\n\u003c/div\u003e",
  "Date": "2009-11-11T12:06:25+08:00",
  "Author": "陈皓"
}