{
  "Source": "coolshell.cn",
  "Title": "图解SQL的Join",
  "Link": "https://coolshell.cn/articles/3463.html",
  "Content": "\u003cdiv class=\"entry-content\"\u003e\n\u003cp\u003e\u003cscript async=\"\" src=\"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3415450859608158\" crossorigin=\"anonymous\" type=\"09492fb61ad84ad4d4edfc71-text/javascript\"\u003e\u003c/script\u003e对于SQL的Join，在学习起来可能是比较乱的。我们知道，\u003ca href=\"https://en.wikipedia.org/wiki/Join_(SQL)\" target=\"_blank\"\u003eSQL的Join语法\u003c/a\u003e有很多inner的，有outer的，有left的，有时候，对于Select出来的结果集是什么样子有点不是很清楚。Coding Horror上有\u003ca href=\"http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html\" target=\"_blank\"\u003e一篇文章\u003c/a\u003e（实在不清楚为什么Coding Horror也被墙）通过 文氏图 \u003ca href=\"https://en.wikipedia.org/wiki/Venn_diagram\" target=\"_blank\"\u003eVenn diagrams\u003c/a\u003e 解释了SQL的Join。我觉得清楚易懂，转过来。\u003c/p\u003e\n\u003cp\u003e假设我们有两张表。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eTable A\u003c/strong\u003e 是左边的表。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTable B\u003c/strong\u003e 是右边的表。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e其各有四条记录，其中有两条记录是相同的，如下所示：\u003c/p\u003e\n\u003cpre\u003eid name       id  name\n-- ----       --  ----\n1  \u003cspan style=\"color: red;\"\u003ePirate\u003c/span\u003e     1   Rutabaga\n2  Monkey     2   \u003cspan style=\"color: red;\"\u003ePirate\u003c/span\u003e\n3  \u003cspan style=\"color: red;\"\u003eNinja\u003c/span\u003e      3   Darth Vader\n4  Spaghetti  4   \u003cspan style=\"color: red;\"\u003eNinja\u003c/span\u003e\u003c/pre\u003e\n\u003cp\u003e下面让我们来看看不同的Join会产生什么样的结果。\u003c/p\u003e\n\u003cp\u003e\u003cspan id=\"more-3463\"\u003e\u003c/span\u003e\u003c/p\u003e\n\u003ctable\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\n\u003cpre\u003eSELECT * FROM TableA\n\u003cstrong\u003eINNER JOIN\u003c/strong\u003e TableB\nON TableA.name = TableB.name\n\nid  name       id   name\n--  ----       --   ----\n1   Pirate     2    Pirate\n3   Ninja      4    Ninja\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eInner join\u003c/strong\u003e\u003cbr/\u003e\n产生的结果集中，是A和B的交集。\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cimg decoding=\"async\" style=\"border: 0px initial initial;\" alt=\"Venn diagram of SQL inner join\" src=\"https://coolshell.cn/wp-content/uploads/2011/01/Inner_Join.png\" border=\"0\"/\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\n\u003cpre\u003eSELECT * FROM TableA\n\u003cstrong\u003eFULL OUTER JOIN\u003c/strong\u003e TableB\nON TableA.name = TableB.name\n\nid    name       id    name\n--    ----       --    ----\n1     Pirate     2     Pirate\n2     Monkey     \u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e  \u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e\n3     Ninja      4     Ninja\n4     Spaghetti  \u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e  \u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e\n\u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e  \u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e       1     Rutabaga\n\u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e  \u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e       3     Darth Vader\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eFull outer join\u003c/strong\u003e 产生A和B的并集。但是需要注意的是，对于没有匹配的记录，则会以null做为值。\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cimg decoding=\"async\" loading=\"lazy\" style=\"border: 0px initial initial;\" alt=\"Venn diagram of SQL cartesian join\" src=\"https://coolshell.cn/wp-content/uploads/2011/01/Full_Outer_Join.png\" width=\"300\" height=\"197\" border=\"0\"/\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\n\u003cpre\u003eSELECT * FROM TableA\n\u003cstrong\u003eLEFT OUTER JOIN\u003c/strong\u003e TableB\nON TableA.name = TableB.name\n\nid  name       id    name\n--  ----       --    ----\n1   Pirate     2     Pirate\n2   Monkey     \u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e  \u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e\n3   Ninja      4     Ninja\n4   Spaghetti  \u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e  \u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e\u003c/pre\u003e\n\u003cp\u003e\u003cstrong\u003eLeft outer join\u003c/strong\u003e 产生表A的完全集，而B表中匹配的则有值，没有匹配的则以null值取代。\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cimg decoding=\"async\" style=\"border: 0px initial initial;\" alt=\"Venn diagram of SQL left join\" src=\"https://coolshell.cn/wp-content/uploads/2011/01/Left_Outer_Join.png\" border=\"0\"/\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\n\u003cpre\u003eSELECT * FROM TableA\nLEFT OUTER JOIN TableB\nON TableA.name = TableB.name\n\u003cstrong\u003eWHERE TableB.id IS null\u003c/strong\u003e \n\nid  name       id     name\n--  ----       --     ----\n2   Monkey     \u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e   \u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e\n4   Spaghetti  \u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e   \u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e\u003c/pre\u003e\n\u003cp\u003e产生在A表中有而在B表中没有的集合。\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cimg decoding=\"async\" style=\"border: 0px initial initial;\" alt=\"join-left-outer.png\" src=\"https://coolshell.cn/wp-content/uploads/2011/01/Left_Out_Join_2.png\" border=\"0\"/\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\n\u003cpre\u003eSELECT * FROM TableA\nFULL OUTER JOIN TableB\nON TableA.name = TableB.name\n\u003cstrong\u003eWHERE TableA.id IS null\nOR TableB.id IS null\n\u003c/strong\u003e\nid    name       id    name\n--    ----       --    ----\n2     Monkey     \u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e  \u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e\n4     Spaghetti  \u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e  \u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e\n\u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e  \u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e       1     Rutabaga\n\u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e  \u003cspan style=\"color: gray;\"\u003enull\u003c/span\u003e       3     Darth Vader\u003c/pre\u003e\n\u003cp\u003e产生A表和B表都没有出现的数据集。\u003c/p\u003e\u003c/td\u003e\n\u003ctd\u003e\u003cimg decoding=\"async\" style=\"border: 0px initial initial;\" alt=\"join-outer.png\" src=\"https://coolshell.cn/wp-content/uploads/2011/01/Full_Outer_Join_2.png\" border=\"0\"/\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e还需要注册的是我们还有一个是“交差集” \u003cstrong\u003ecross join\u003c/strong\u003e, 这种Join没有办法用文式图表示，因为其就是把表A和表B的数据进行一个N*M的组合，即笛卡尔积。表达式如下：\u003c/p\u003e\n\u003cpre\u003eSELECT * FROM TableA\n\u003cstrong\u003eCROSS JOIN\u003c/strong\u003e TableB\u003c/pre\u003e\n\u003cp\u003e这个笛卡尔乘积会产生 4 x 4 = 16 条记录，一般来说，我们很少用到这个语法。但是我们得小心，如果不是使用嵌套的select语句，一般系统都会产生笛卡尔乘积然再做过滤。这是对于性能来说是非常危险的，尤其是表很大的时候。\u003c/p\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003e更新:2014年3月30日\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-full wp-image-11371\" alt=\"\" src=\"https://coolshell.cn/wp-content/uploads/2011/01/SQL-Join.jpg\" width=\"600\" height=\"472\" srcset=\"https://coolshell.cn/wp-content/uploads/2011/01/SQL-Join.jpg 600w, https://coolshell.cn/wp-content/uploads/2011/01/SQL-Join-300x236.jpg 300w\" sizes=\"(max-width: 600px) 100vw, 600px\"/\u003e\u003c/p\u003e\n\u003cp\u003e(全文完)\u003c/p\u003e\n\u003cdiv style=\"margin-top: 15px; font-size: 16px;color: #cc0000;\"\u003e\n\u003cp align=\"center\"\u003e\u003cstrong\u003e（转载本站文章请注明作者和出处 \u003ca href=\"https://coolshell.cn/\"\u003e酷 壳 – CoolShell\u003c/a\u003e ，请勿用于任何商业用途）\u003c/strong\u003e\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"wp_rp_wrap  wp_rp_vertical_m\" id=\"wp_rp_first\"\u003e\u003cdiv class=\"wp_rp_content\"\u003e\u003ch3 class=\"related_post_title\"\u003e相关文章\u003c/h3\u003e\u003cul class=\"related_post wp_rp\"\u003e\u003cli\u003e\u003ca href=\"https://coolshell.cn/articles/8711.html\" class=\"wp_rp_thumbnail\"\u003e\u003cimg src=\"https://coolshell.cn/wp-content/uploads/2012/12/200906020837401710-150x150.jpg\" alt=\"程序员疫苗：代码注入\" width=\"150\" height=\"150\"/\u003e\u003c/a\u003e\u003ca href=\"https://coolshell.cn/articles/8711.html\" class=\"wp_rp_title\"\u003e程序员疫苗：代码注入\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"https://coolshell.cn/articles/7490.html\" class=\"wp_rp_thumbnail\"\u003e\u003cimg src=\"https://coolshell.cn/wp-content/uploads/2012/06/f1-150x150.jpg\" alt=\"性能调优攻略\" width=\"150\" height=\"150\"/\u003e\u003c/a\u003e\u003ca href=\"https://coolshell.cn/articles/7490.html\" class=\"wp_rp_title\"\u003e性能调优攻略\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"https://coolshell.cn/articles/7270.html\" class=\"wp_rp_thumbnail\"\u003e\u003cimg src=\"https://coolshell.cn/wp-content/uploads/2012/05/overview2-1-150x150.png\" alt=\"NoSQL 数据建模技术\" width=\"150\" height=\"150\"/\u003e\u003c/a\u003e\u003ca href=\"https://coolshell.cn/articles/7270.html\" class=\"wp_rp_title\"\u003eNoSQL 数据建模技术\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"https://coolshell.cn/articles/6639.html\" class=\"wp_rp_thumbnail\"\u003e\u003cimg src=\"https://coolshell.cn/wp-content/uploads/2012/02/programming-language-150x150.jpg\" alt=\"千万别惹程序员 \" width=\"150\" height=\"150\"/\u003e\u003c/a\u003e\u003ca href=\"https://coolshell.cn/articles/6639.html\" class=\"wp_rp_title\"\u003e千万别惹程序员 \u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"https://coolshell.cn/articles/3433.html\" class=\"wp_rp_thumbnail\"\u003e\u003cimg src=\"https://coolshell.cn/wp-content/plugins/wordpress-23-related-posts-plugin/static/thumbs/10.jpg\" alt=\"6个有用的MySQL语句\" width=\"150\" height=\"150\"/\u003e\u003c/a\u003e\u003ca href=\"https://coolshell.cn/articles/3433.html\" class=\"wp_rp_title\"\u003e6个有用的MySQL语句\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"https://coolshell.cn/articles/1957.html\" class=\"wp_rp_thumbnail\"\u003e\u003cimg src=\"https://coolshell.cn/wp-content/plugins/wordpress-23-related-posts-plugin/static/thumbs/9.jpg\" alt=\"Web程序的最佳测试数据\" width=\"150\" height=\"150\"/\u003e\u003c/a\u003e\u003ca href=\"https://coolshell.cn/articles/1957.html\" class=\"wp_rp_title\"\u003eWeb程序的最佳测试数据\u003c/a\u003e\u003c/li\u003e\u003c/ul\u003e\u003c/div\u003e\u003c/div\u003e\n\u003cdiv id=\"post-ratings-3463\" class=\"post-ratings\" itemscope=\"\" itemtype=\"https://schema.org/Article\" data-nonce=\"7b87ba8433\"\u003e\u003cimg id=\"rating_3463_1\" src=\"https://coolshell.cn/wp-content/plugins/wp-postratings/images/stars_crystal/rating_on.gif\" alt=\"好烂啊\" title=\"好烂啊\" onmouseover=\"if (!window.__cfRLUnblockHandlers) return false; current_rating(3463, 1, \u0026#39;好烂啊\u0026#39;);\" onmouseout=\"if (!window.__cfRLUnblockHandlers) return false; ratings_off(4.4, 5, 0);\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" onkeypress=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" style=\"cursor: pointer; border: 0px;\" data-cf-modified-09492fb61ad84ad4d4edfc71-=\"\"/\u003e\u003cimg id=\"rating_3463_2\" src=\"https://coolshell.cn/wp-content/plugins/wp-postratings/images/stars_crystal/rating_on.gif\" alt=\"有点差\" title=\"有点差\" onmouseover=\"if (!window.__cfRLUnblockHandlers) return false; current_rating(3463, 2, \u0026#39;有点差\u0026#39;);\" onmouseout=\"if (!window.__cfRLUnblockHandlers) return false; ratings_off(4.4, 5, 0);\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" onkeypress=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" style=\"cursor: pointer; border: 0px;\" data-cf-modified-09492fb61ad84ad4d4edfc71-=\"\"/\u003e\u003cimg id=\"rating_3463_3\" src=\"https://coolshell.cn/wp-content/plugins/wp-postratings/images/stars_crystal/rating_on.gif\" alt=\"凑合看看\" title=\"凑合看看\" onmouseover=\"if (!window.__cfRLUnblockHandlers) return false; current_rating(3463, 3, \u0026#39;凑合看看\u0026#39;);\" onmouseout=\"if (!window.__cfRLUnblockHandlers) return false; ratings_off(4.4, 5, 0);\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" onkeypress=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" style=\"cursor: pointer; border: 0px;\" data-cf-modified-09492fb61ad84ad4d4edfc71-=\"\"/\u003e\u003cimg id=\"rating_3463_4\" src=\"https://coolshell.cn/wp-content/plugins/wp-postratings/images/stars_crystal/rating_on.gif\" alt=\"还不错\" title=\"还不错\" onmouseover=\"if (!window.__cfRLUnblockHandlers) return false; current_rating(3463, 4, \u0026#39;还不错\u0026#39;);\" onmouseout=\"if (!window.__cfRLUnblockHandlers) return false; ratings_off(4.4, 5, 0);\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" onkeypress=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" style=\"cursor: pointer; border: 0px;\" data-cf-modified-09492fb61ad84ad4d4edfc71-=\"\"/\u003e\u003cimg id=\"rating_3463_5\" src=\"https://coolshell.cn/wp-content/plugins/wp-postratings/images/stars_crystal/rating_half.gif\" alt=\"很精彩\" title=\"很精彩\" onmouseover=\"if (!window.__cfRLUnblockHandlers) return false; current_rating(3463, 5, \u0026#39;很精彩\u0026#39;);\" onmouseout=\"if (!window.__cfRLUnblockHandlers) return false; ratings_off(4.4, 5, 0);\" onclick=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" onkeypress=\"if (!window.__cfRLUnblockHandlers) return false; rate_post();\" style=\"cursor: pointer; border: 0px;\" data-cf-modified-09492fb61ad84ad4d4edfc71-=\"\"/\u003e (\u003cstrong\u003e28\u003c/strong\u003e 人打了分，平均分： \u003cstrong\u003e4.39\u003c/strong\u003e )\u003cbr/\u003e\u003cspan class=\"post-ratings-text\" id=\"ratings_3463_text\"\u003e\u003c/span\u003e\u003cmeta itemprop=\"name\" content=\"图解SQL的Join\"/\u003e\u003cmeta itemprop=\"headline\" content=\"图解SQL的Join\"/\u003e\u003cmeta itemprop=\"description\" content=\"对于SQL的Join，在学习起来可能是比较乱的。我们知道，SQL的Join语法有很多inner的，有outer的，有left的，有时候，对于Select出来的结果集是什么样子有点不是很清楚。Coding Horror上有一篇文章（实在不清楚为什么Coding Horror也被墙）通过 文氏图 Venn diagrams 解释了SQL的Join。我觉得清楚易懂，转过来。\n\n假设我们有两张表。\n...\"/\u003e\u003cmeta itemprop=\"datePublished\" content=\"2011-01-11T08:44:09+08:00\"/\u003e\u003cmeta itemprop=\"dateModified\" content=\"2014-03-30T11:41:00+08:00\"/\u003e\u003cmeta itemprop=\"url\" content=\"https://coolshell.cn/articles/3463.html\"/\u003e\u003cmeta itemprop=\"author\" content=\"陈皓\"/\u003e\u003cmeta itemprop=\"mainEntityOfPage\" content=\"https://coolshell.cn/articles/3463.html\"/\u003e\u003cdiv style=\"display: none;\" itemprop=\"publisher\" itemscope=\"\" itemtype=\"https://schema.org/Organization\"\u003e\u003cmeta itemprop=\"name\" content=\"酷 壳 - CoolShell\"/\u003e\u003cmeta itemprop=\"url\" content=\"https://coolshell.cn\"/\u003e\u003cdiv itemprop=\"logo\" itemscope=\"\" itemtype=\"https://schema.org/ImageObject\"\u003e\u003cmeta itemprop=\"url\" content=\"\"/\u003e\u003c/div\u003e\u003c/div\u003e\u003cdiv style=\"display: none;\" itemprop=\"aggregateRating\" itemscope=\"\" itemtype=\"https://schema.org/AggregateRating\"\u003e\u003cmeta itemprop=\"bestRating\" content=\"5\"/\u003e\u003cmeta itemprop=\"worstRating\" content=\"1\"/\u003e\u003cmeta itemprop=\"ratingValue\" content=\"4.39\"/\u003e\u003cmeta itemprop=\"ratingCount\" content=\"28\"/\u003e\u003c/div\u003e\u003c/div\u003e\u003cdiv id=\"post-ratings-3463-loading\" class=\"post-ratings-loading\"\u003e\u003cimg src=\"https://coolshell.cn/wp-content/plugins/wp-postratings/images/loading.gif\" width=\"16\" height=\"16\" class=\"post-ratings-image\"/\u003eLoading...\u003c/div\u003e\n\u003c/div\u003e",
  "Date": "2011-01-11T08:44:09+08:00",
  "Author": "陈皓"
}