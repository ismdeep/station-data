{
  "Source": "dunwu",
  "Title": "Spring 校验",
  "Link": "https://dunwu.github.io/blog/pages/fe6aad/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\u003ch1 id=\"Spring-校验\"\u003e\u003ca href=\"#Spring-校验\" class=\"headerlink\" title=\"Spring 校验\"\u003e\u003c/a\u003eSpring 校验\u003c/h1\u003e\u003cp\u003eJava API 规范(\u003ccode\u003eJSR303\u003c/code\u003e)定义了\u003ccode\u003eBean\u003c/code\u003e校验的标准\u003ccode\u003evalidation-api\u003c/code\u003e，但没有提供实现。\u003ccode\u003ehibernate validation\u003c/code\u003e是对这个规范的实现，并增加了校验注解如\u003ccode\u003e@Email\u003c/code\u003e、\u003ccode\u003e@Length\u003c/code\u003e等。\u003ccode\u003eSpring Validation\u003c/code\u003e是对\u003ccode\u003ehibernate validation\u003c/code\u003e的二次封装，用于支持\u003ccode\u003espring mvc\u003c/code\u003e参数自动校验。\u003c/p\u003e\n\u003ch2 id=\"快速入门\"\u003e\u003ca href=\"#快速入门\" class=\"headerlink\" title=\"快速入门\"\u003e\u003c/a\u003e快速入门\u003c/h2\u003e\u003ch3 id=\"引入依赖\"\u003e\u003ca href=\"#引入依赖\" class=\"headerlink\" title=\"引入依赖\"\u003e\u003c/a\u003e引入依赖\u003c/h3\u003e\u003cp\u003e如果 spring-boot 版本小于 2.3.x，spring-boot-starter-web 会自动传入 hibernate-validator 依赖。如果 spring-boot 版本大于 2.3.x，则需要手动引入依赖：\u003c/p\u003e\n\u003cfigure class=\"highlight xml\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"tag\"\u003e\u0026lt;\u003cspan class=\"name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"tag\"\u003e\u0026lt;\u003cspan class=\"name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003eorg.hibernate.validator\u003cspan class=\"tag\"\u003e\u0026lt;/\u003cspan class=\"name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"tag\"\u003e\u0026lt;\u003cspan class=\"name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003ehibernate-validator-parent\u003cspan class=\"tag\"\u003e\u0026lt;/\u003cspan class=\"name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"tag\"\u003e\u0026lt;\u003cspan class=\"name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e6.2.5.Final\u003cspan class=\"tag\"\u003e\u0026lt;/\u003cspan class=\"name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"tag\"\u003e\u0026lt;/\u003cspan class=\"name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e对于 web 服务来说，为防止非法参数对业务造成影响，在 Controller 层一定要做参数校验的！大部分情况下，请求参数分为如下两种形式：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ePOST、PUT 请求，使用 requestBody 传递参数；\u003c/li\u003e\n\u003cli\u003eGET 请求，使用 requestParam/PathVariable 传递参数。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e实际上，不管是 requestBody 参数校验还是方法级别的校验，最终都是调用 Hibernate Validator 执行校验，Spring Validation 只是做了一层封装。\u003c/p\u003e\n\u003ch3 id=\"校验示例\"\u003e\u003ca href=\"#校验示例\" class=\"headerlink\" title=\"校验示例\"\u003e\u003c/a\u003e校验示例\u003c/h3\u003e\u003cp\u003e（1）在实体上标记校验注解\u003c/p\u003e\n\u003cfigure class=\"highlight kotlin\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta\"\u003e@Data\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta\"\u003e@NoArgsConstructor\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta\"\u003e@AllArgsConstructor\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"title class_\"\u003eUser\u003c/span\u003e \u003cspan class=\"title\"\u003eimplements\u003c/span\u003e \u003cspan class=\"title\"\u003eSerializable\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"meta\"\u003e@NotNull\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003eprivate\u003c/span\u003e \u003cspan class=\"built_in\"\u003eLong\u003c/span\u003e id;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"meta\"\u003e@NotBlank\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"meta\"\u003e@Size(min = 2, max = 10)\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003eprivate\u003c/span\u003e String name;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"meta\"\u003e@Min(value = 1)\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"meta\"\u003e@Max(value = 100)\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003eprivate\u003c/span\u003e Integer age;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e（2）在方法参数上声明校验注解\u003c/p\u003e\n\u003cfigure class=\"highlight less\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e26\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e27\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e28\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e29\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e30\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e31\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e32\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e33\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e34\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e35\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e36\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e37\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e38\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e39\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"variable\"\u003e@Slf4j\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"variable\"\u003e@Validated\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"variable\"\u003e@RestController\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"variable\"\u003e@RequestMapping\u003c/span\u003e(\u003cspan class=\"string\"\u003e\u0026#34;validate1\u0026#34;\u003c/span\u003e)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003epublic class ValidatorController {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e/**\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     * {@link RequestBody} 参数校验\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     */\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"variable\"\u003e@PostMapping\u003c/span\u003e(value = \u003cspan class=\"string\"\u003e\u0026#34;save\u0026#34;\u003c/span\u003e)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    public DataResult\u0026lt;Boolean\u0026gt; \u003cspan class=\"built_in\"\u003esave\u003c/span\u003e(\u003cspan class=\"variable\"\u003e@Valid\u003c/span\u003e \u003cspan class=\"variable\"\u003e@RequestBody\u003c/span\u003e User entity) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"selector-tag\"\u003elog\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.info\u003c/span\u003e(\u003cspan class=\"string\"\u003e\u0026#34;保存一条记录：{}\u0026#34;\u003c/span\u003e, JSONUtil.\u003cspan class=\"built_in\"\u003etoJsonStr\u003c/span\u003e(entity));\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"selector-tag\"\u003ereturn\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eDataResult\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.ok\u003c/span\u003e(true);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e/**\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     * {@link RequestParam} 参数校验\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     */\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    @\u003cspan class=\"selector-tag\"\u003eGetMapping\u003c/span\u003e(value = \u003cspan class=\"string\"\u003e\u0026#34;queryByName\u0026#34;\u003c/span\u003e)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"selector-tag\"\u003epublic\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eDataResult\u003c/span\u003e\u0026lt;\u003cspan class=\"selector-tag\"\u003eUser\u003c/span\u003e\u0026gt; \u003cspan class=\"selector-tag\"\u003equeryByName\u003c/span\u003e(\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"variable\"\u003e@RequestParam\u003c/span\u003e(\u003cspan class=\"string\"\u003e\u0026#34;username\u0026#34;\u003c/span\u003e)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"variable\"\u003e@NotBlank\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"variable\"\u003e@Size\u003c/span\u003e(min = \u003cspan class=\"number\"\u003e2\u003c/span\u003e, max = \u003cspan class=\"number\"\u003e10\u003c/span\u003e)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        String name\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    ) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"selector-tag\"\u003eUser\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003euser\u003c/span\u003e = \u003cspan class=\"selector-tag\"\u003enew\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eUser\u003c/span\u003e(\u003cspan class=\"number\"\u003e1\u003c/span\u003eL, name, \u003cspan class=\"number\"\u003e18\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"selector-tag\"\u003ereturn\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eDataResult\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.ok\u003c/span\u003e(user);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e/**\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     * {@link PathVariable} 参数校验\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     */\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    @\u003cspan class=\"selector-tag\"\u003eGetMapping\u003c/span\u003e(value = \u003cspan class=\"string\"\u003e\u0026#34;detail/{id}\u0026#34;\u003c/span\u003e)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"selector-tag\"\u003epublic\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eDataResult\u003c/span\u003e\u0026lt;\u003cspan class=\"selector-tag\"\u003eUser\u003c/span\u003e\u0026gt; \u003cspan class=\"selector-tag\"\u003edetail\u003c/span\u003e(\u003cspan class=\"variable\"\u003e@PathVariable\u003c/span\u003e(\u003cspan class=\"string\"\u003e\u0026#34;id\u0026#34;\u003c/span\u003e) \u003cspan class=\"variable\"\u003e@Min\u003c/span\u003e(\u003cspan class=\"number\"\u003e1\u003c/span\u003eL) Long id) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"selector-tag\"\u003eUser\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003euser\u003c/span\u003e = \u003cspan class=\"selector-tag\"\u003enew\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eUser\u003c/span\u003e(id, \u003cspan class=\"string\"\u003e\u0026#34;李四\u0026#34;\u003c/span\u003e, \u003cspan class=\"number\"\u003e18\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"selector-tag\"\u003ereturn\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eDataResult\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.ok\u003c/span\u003e(user);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e（3）如果请求参数不满足校验规则，则会抛出 \u003ccode\u003eConstraintViolationException\u003c/code\u003e 或 \u003ccode\u003eMethodArgumentNotValidException\u003c/code\u003e 异常。\u003c/p\u003e\n\u003ch3 id=\"统一异常处理\"\u003e\u003ca href=\"#统一异常处理\" class=\"headerlink\" title=\"统一异常处理\"\u003e\u003c/a\u003e统一异常处理\u003c/h3\u003e\u003cp\u003e在实际项目开发中，通常会用统一异常处理来返回一个更友好的提示。\u003c/p\u003e\n\u003cfigure class=\"highlight java\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e26\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e27\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e28\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e29\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e30\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e31\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e32\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e33\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e34\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e35\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e36\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e37\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e38\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e39\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e40\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e41\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e42\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e43\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e44\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e45\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e46\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e47\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e48\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e49\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e50\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e51\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e52\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e53\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e54\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta\"\u003e@Slf4j\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta\"\u003e@ControllerAdvice\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"title class_\"\u003eGlobalExceptionHandler\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e/**\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     * 处理所有不可知的异常\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     */\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"meta\"\u003e@ResponseBody\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"meta\"\u003e@ResponseStatus(HttpStatus.OK)\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"meta\"\u003e@ExceptionHandler(Throwable.class)\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e Result \u003cspan class=\"title function_\"\u003ehandleException\u003c/span\u003e\u003cspan class=\"params\"\u003e(Throwable e)\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        log.error(\u003cspan class=\"string\"\u003e\u0026#34;未知异常\u0026#34;\u003c/span\u003e, e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eResult\u003c/span\u003e(ResultStatus.HTTP_SERVER_ERROR.getCode(), e.getMessage());\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e/**\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     * 统一处理请求参数校验异常(普通传参)\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     *\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     * \u003cspan class=\"doctag\"\u003e@param\u003c/span\u003e e ConstraintViolationException\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     * \u003cspan class=\"doctag\"\u003e@return\u003c/span\u003e {\u003cspan class=\"doctag\"\u003e@link\u003c/span\u003e DataResult}\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     */\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"meta\"\u003e@ResponseBody\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"meta\"\u003e@ResponseStatus(HttpStatus.BAD_REQUEST)\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"meta\"\u003e@ExceptionHandler({ ConstraintViolationException.class })\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e Result \u003cspan class=\"title function_\"\u003ehandleConstraintViolationException\u003c/span\u003e\u003cspan class=\"params\"\u003e(\u003cspan class=\"keyword\"\u003efinal\u003c/span\u003e ConstraintViolationException e)\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        log.error(\u003cspan class=\"string\"\u003e\u0026#34;ConstraintViolationException\u0026#34;\u003c/span\u003e, e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        List\u0026lt;String\u0026gt; errors = \u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eArrayList\u003c/span\u003e\u0026lt;\u0026gt;();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e (ConstraintViolation\u0026lt;?\u0026gt; violation : e.getConstraintViolations()) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"type\"\u003ePath\u003c/span\u003e \u003cspan class=\"variable\"\u003epath\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e violation.getPropertyPath();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            List\u0026lt;String\u0026gt; pathArr = StrUtil.split(path.toString(), \u003cspan class=\"string\"\u003e\u0026#39;,\u0026#39;\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            errors.add(pathArr.get(\u003cspan class=\"number\"\u003e0\u003c/span\u003e) + \u003cspan class=\"string\"\u003e\u0026#34; \u0026#34;\u003c/span\u003e + violation.getMessage());\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eResult\u003c/span\u003e(ResultStatus.REQUEST_ERROR.getCode(), CollectionUtil.join(errors, \u003cspan class=\"string\"\u003e\u0026#34;,\u0026#34;\u003c/span\u003e));\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e/**\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     * 处理参数校验异常\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     *\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     * \u003cspan class=\"doctag\"\u003e@param\u003c/span\u003e e MethodArgumentNotValidException\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     * \u003cspan class=\"doctag\"\u003e@return\u003c/span\u003e {\u003cspan class=\"doctag\"\u003e@link\u003c/span\u003e DataResult}\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     */\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"meta\"\u003e@ResponseBody\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"meta\"\u003e@ResponseStatus(HttpStatus.BAD_REQUEST)\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"meta\"\u003e@ExceptionHandler({ MethodArgumentNotValidException.class })\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003eprivate\u003c/span\u003e Result \u003cspan class=\"title function_\"\u003ehandleMethodArgumentNotValidException\u003c/span\u003e\u003cspan class=\"params\"\u003e(\u003cspan class=\"keyword\"\u003efinal\u003c/span\u003e MethodArgumentNotValidException e)\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        log.error(\u003cspan class=\"string\"\u003e\u0026#34;MethodArgumentNotValidException\u0026#34;\u003c/span\u003e, e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        List\u0026lt;String\u0026gt; errors = \u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eArrayList\u003c/span\u003e\u0026lt;\u0026gt;();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e (ObjectError error : e.getBindingResult().getAllErrors()) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            errors.add(((FieldError) error).getField() + \u003cspan class=\"string\"\u003e\u0026#34; \u0026#34;\u003c/span\u003e + error.getDefaultMessage());\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eResult\u003c/span\u003e(ResultStatus.REQUEST_ERROR.getCode(), CollectionUtil.join(errors, \u003cspan class=\"string\"\u003e\u0026#34;,\u0026#34;\u003c/span\u003e));\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch2 id=\"进阶使用\"\u003e\u003ca href=\"#进阶使用\" class=\"headerlink\" title=\"进阶使用\"\u003e\u003c/a\u003e进阶使用\u003c/h2\u003e\u003ch3 id=\"分组校验\"\u003e\u003ca href=\"#分组校验\" class=\"headerlink\" title=\"分组校验\"\u003e\u003c/a\u003e分组校验\u003c/h3\u003e\u003cp\u003e在实际项目中，可能多个方法需要使用同一个 DTO 类来接收参数，而不同方法的校验规则很可能是不一样的。这个时候，简单地在 DTO 类的字段上加约束注解无法解决这个问题。因此，spring-validation 支持了分组校验的功能，专门用来解决这类问题。\u003c/p\u003e\n\u003cp\u003e（1）定义分组\u003c/p\u003e\n\u003cfigure class=\"highlight java\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta\"\u003e@Target({ ElementType.FIELD, ElementType.PARAMETER })\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta\"\u003e@Retention(RetentionPolicy.RUNTIME)\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"meta\"\u003e@interface\u003c/span\u003e AddCheck { }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta\"\u003e@Target({ ElementType.FIELD, ElementType.PARAMETER })\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta\"\u003e@Retention(RetentionPolicy.RUNTIME)\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"meta\"\u003e@interface\u003c/span\u003e EditCheck { }\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e（2）在实体上标记校验注解\u003c/p\u003e\n\u003cfigure class=\"highlight less\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"variable\"\u003e@Data\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003epublic class User2 {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"variable\"\u003e@NotNull\u003c/span\u003e(groups = EditCheck.class)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    private Long id;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"variable\"\u003e@NotNull\u003c/span\u003e(groups = { AddCheck.class, EditCheck.class })\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"variable\"\u003e@Size\u003c/span\u003e(min = \u003cspan class=\"number\"\u003e2\u003c/span\u003e, max = \u003cspan class=\"number\"\u003e10\u003c/span\u003e, groups = { AddCheck.class, EditCheck.class })\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    private String name;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"variable\"\u003e@IsMobile\u003c/span\u003e(message = \u003cspan class=\"string\"\u003e\u0026#34;不是有效手机号\u0026#34;\u003c/span\u003e, groups = { AddCheck.class, EditCheck.class })\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    private String mobile;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e（3）在方法上根据不同场景进行校验分组\u003c/p\u003e\n\u003cfigure class=\"highlight less\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"variable\"\u003e@Slf4j\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"variable\"\u003e@Validated\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"variable\"\u003e@RestController\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"variable\"\u003e@RequestMapping\u003c/span\u003e(\u003cspan class=\"string\"\u003e\u0026#34;validate2\u0026#34;\u003c/span\u003e)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003epublic class ValidatorController2 {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e/**\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     * {@link RequestBody} 参数校验\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     */\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"variable\"\u003e@PostMapping\u003c/span\u003e(value = \u003cspan class=\"string\"\u003e\u0026#34;add\u0026#34;\u003c/span\u003e)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    public DataResult\u0026lt;Boolean\u0026gt; \u003cspan class=\"built_in\"\u003eadd\u003c/span\u003e(\u003cspan class=\"variable\"\u003e@Validated\u003c/span\u003e(AddCheck.class) \u003cspan class=\"variable\"\u003e@RequestBody\u003c/span\u003e User2 entity) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"selector-tag\"\u003elog\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.info\u003c/span\u003e(\u003cspan class=\"string\"\u003e\u0026#34;添加一条记录：{}\u0026#34;\u003c/span\u003e, JSONUtil.\u003cspan class=\"built_in\"\u003etoJsonStr\u003c/span\u003e(entity));\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"selector-tag\"\u003ereturn\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eDataResult\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.ok\u003c/span\u003e(true);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e/**\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     * {@link RequestBody} 参数校验\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     */\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    @\u003cspan class=\"selector-tag\"\u003ePostMapping\u003c/span\u003e(value = \u003cspan class=\"string\"\u003e\u0026#34;edit\u0026#34;\u003c/span\u003e)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"selector-tag\"\u003epublic\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eDataResult\u003c/span\u003e\u0026lt;\u003cspan class=\"selector-tag\"\u003eBoolean\u003c/span\u003e\u0026gt; \u003cspan class=\"selector-tag\"\u003eedit\u003c/span\u003e(\u003cspan class=\"variable\"\u003e@Validated\u003c/span\u003e(EditCheck.class) \u003cspan class=\"variable\"\u003e@RequestBody\u003c/span\u003e User2 entity) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"selector-tag\"\u003elog\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.info\u003c/span\u003e(\u003cspan class=\"string\"\u003e\u0026#34;编辑一条记录：{}\u0026#34;\u003c/span\u003e, JSONUtil.\u003cspan class=\"built_in\"\u003etoJsonStr\u003c/span\u003e(entity));\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"selector-tag\"\u003ereturn\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eDataResult\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.ok\u003c/span\u003e(true);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"嵌套校验\"\u003e\u003ca href=\"#嵌套校验\" class=\"headerlink\" title=\"嵌套校验\"\u003e\u003c/a\u003e嵌套校验\u003c/h3\u003e\u003cp\u003e前面的示例中，DTO 类里面的字段都是基本数据类型和 String 类型。但是实际场景中，有可能某个字段也是一个对象，这种情况先，可以使用嵌套校验。\u003cbr/\u003epost\u003cbr/\u003e比如，上面保存 User 信息的时候同时还带有 Job 信息。需要注意的是，此时 DTO 类的对应字段必须标记@Valid 注解。\u003c/p\u003e\n\u003cfigure class=\"highlight less\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e26\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e27\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e28\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e29\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e30\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e31\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e32\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e33\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e34\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e35\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e36\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e37\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e38\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e39\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e40\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e41\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e42\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e43\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e44\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e45\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e46\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e47\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e48\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e49\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e50\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"variable\"\u003e@Data\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003epublic class UserDTO {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"variable\"\u003e@Min\u003c/span\u003e(value = \u003cspan class=\"number\"\u003e10000000000000000\u003c/span\u003eL, groups = \u003cspan class=\"attribute\"\u003eUpdate\u003c/span\u003e.class)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    private Long userId;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"variable\"\u003e@NotNull\u003c/span\u003e(groups = {Save.class, \u003cspan class=\"attribute\"\u003eUpdate\u003c/span\u003e.class})\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"variable\"\u003e@Length\u003c/span\u003e(min = \u003cspan class=\"number\"\u003e2\u003c/span\u003e, max = \u003cspan class=\"number\"\u003e10\u003c/span\u003e, groups = {Save.class, \u003cspan class=\"attribute\"\u003eUpdate\u003c/span\u003e.class})\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    private String userName;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"variable\"\u003e@NotNull\u003c/span\u003e(groups = {Save.class, \u003cspan class=\"attribute\"\u003eUpdate\u003c/span\u003e.class})\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"variable\"\u003e@Length\u003c/span\u003e(min = \u003cspan class=\"number\"\u003e6\u003c/span\u003e, max = \u003cspan class=\"number\"\u003e20\u003c/span\u003e, groups = {Save.class, \u003cspan class=\"attribute\"\u003eUpdate\u003c/span\u003e.class})\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    private String account;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"variable\"\u003e@NotNull\u003c/span\u003e(groups = {Save.class, \u003cspan class=\"attribute\"\u003eUpdate\u003c/span\u003e.class})\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"variable\"\u003e@Length\u003c/span\u003e(min = \u003cspan class=\"number\"\u003e6\u003c/span\u003e, max = \u003cspan class=\"number\"\u003e20\u003c/span\u003e, groups = {Save.class, \u003cspan class=\"attribute\"\u003eUpdate\u003c/span\u003e.class})\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    private String password;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"variable\"\u003e@NotNull\u003c/span\u003e(groups = {Save.class, \u003cspan class=\"attribute\"\u003eUpdate\u003c/span\u003e.class})\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"variable\"\u003e@Valid\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    private Job job;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"variable\"\u003e@Data\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    public static class Job {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"variable\"\u003e@Min\u003c/span\u003e(value = \u003cspan class=\"number\"\u003e1\u003c/span\u003e, groups = \u003cspan class=\"attribute\"\u003eUpdate\u003c/span\u003e.class)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        private Long jobId;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"variable\"\u003e@NotNull\u003c/span\u003e(groups = {Save.class, \u003cspan class=\"attribute\"\u003eUpdate\u003c/span\u003e.class})\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"variable\"\u003e@Length\u003c/span\u003e(min = \u003cspan class=\"number\"\u003e2\u003c/span\u003e, max = \u003cspan class=\"number\"\u003e10\u003c/span\u003e, groups = {Save.class, \u003cspan class=\"attribute\"\u003eUpdate\u003c/span\u003e.class})\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        private String jobName;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"variable\"\u003e@NotNull\u003c/span\u003e(groups = {Save.class, \u003cspan class=\"attribute\"\u003eUpdate\u003c/span\u003e.class})\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"variable\"\u003e@Length\u003c/span\u003e(min = \u003cspan class=\"number\"\u003e2\u003c/span\u003e, max = \u003cspan class=\"number\"\u003e10\u003c/span\u003e, groups = {Save.class, \u003cspan class=\"attribute\"\u003eUpdate\u003c/span\u003e.class})\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        private String position;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e/**\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     * 保存的时候校验分组\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     */\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    public interface Save {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e/**\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     * 更新的时候校验分组\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     */\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    public interface Update {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e复制代码\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e嵌套校验可以结合分组校验一起使用。还有就是嵌套集合校验会对集合里面的每一项都进行校验，例如\u003ccode\u003eList\u0026lt;Job\u0026gt;\u003c/code\u003e字段会对这个 list 里面的每一个 Job 对象都进行校验\u003c/p\u003e\n\u003ch3 id=\"自定义校验注解\"\u003e\u003ca href=\"#自定义校验注解\" class=\"headerlink\" title=\"自定义校验注解\"\u003e\u003c/a\u003e自定义校验注解\u003c/h3\u003e\u003cp\u003e（1）自定义校验注解 \u003ccode\u003e@IsMobile\u003c/code\u003e\u003c/p\u003e\n\u003cfigure class=\"highlight less\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"variable\"\u003e@Target\u003c/span\u003e({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR, PARAMETER, TYPE_USE })\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"variable\"\u003e@Retention\u003c/span\u003e(RUNTIME)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"variable\"\u003e@Constraint\u003c/span\u003e(validatedBy = MobileValidator.class)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003epublic \u003cspan class=\"variable\"\u003e@interface\u003c/span\u003e IsMobile {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"selector-tag\"\u003eString\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003emessage\u003c/span\u003e();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"selector-tag\"\u003eClass\u003c/span\u003e\u0026lt;?\u0026gt;\u003cspan class=\"selector-attr\"\u003e[]\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003egroups\u003c/span\u003e() \u003cspan class=\"selector-tag\"\u003edefault\u003c/span\u003e {};\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"selector-tag\"\u003eClass\u003c/span\u003e\u0026lt;? \u003cspan class=\"selector-tag\"\u003eextends\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003ePayload\u003c/span\u003e\u0026gt;\u003cspan class=\"selector-attr\"\u003e[]\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003epayload\u003c/span\u003e() \u003cspan class=\"selector-tag\"\u003edefault\u003c/span\u003e {};\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e（2）实现 \u003ccode\u003eConstraintValidator\u003c/code\u003e 接口，编写 \u003ccode\u003e@IsMobile\u003c/code\u003e 校验注解的解析器\u003c/p\u003e\n\u003cfigure class=\"highlight java\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003eimport\u003c/span\u003e cn.hutool.core.util.StrUtil;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003eimport\u003c/span\u003e io.github.dunwu.spring.core.validation.annotation.IsMobile;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003eimport\u003c/span\u003e io.github.dunwu.tool.util.ValidatorUtil;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003eimport\u003c/span\u003e javax.validation.ConstraintValidator;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003eimport\u003c/span\u003e javax.validation.ConstraintValidatorContext;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"title class_\"\u003eMobileValidator\u003c/span\u003e \u003cspan class=\"keyword\"\u003eimplements\u003c/span\u003e \u003cspan class=\"title class_\"\u003eConstraintValidator\u003c/span\u003e\u0026lt;IsMobile, String\u0026gt; {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"meta\"\u003e@Override\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003einitialize\u003c/span\u003e\u003cspan class=\"params\"\u003e(IsMobile isMobile)\u003c/span\u003e { }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"meta\"\u003e@Override\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"type\"\u003eboolean\u003c/span\u003e \u003cspan class=\"title function_\"\u003eisValid\u003c/span\u003e\u003cspan class=\"params\"\u003e(String s, ConstraintValidatorContext constraintValidatorContext)\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003eif\u003c/span\u003e (StrUtil.isBlank(s)) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"literal\"\u003efalse\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        } \u003cspan class=\"keyword\"\u003eelse\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"keyword\"\u003ereturn\u003c/span\u003e ValidatorUtil.isMobile(s);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"自定义校验\"\u003e\u003ca href=\"#自定义校验\" class=\"headerlink\" title=\"自定义校验\"\u003e\u003c/a\u003e自定义校验\u003c/h3\u003e\u003cp\u003e可以通过实现 \u003ccode\u003eorg.springframework.validation.Validator\u003c/code\u003e 接口来自定义校验。\u003c/p\u003e\n\u003cp\u003e有以下要点\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e实现 \u003ccode\u003esupports\u003c/code\u003e 方法\u003c/li\u003e\n\u003cli\u003e实现 \u003ccode\u003evalidate\u003c/code\u003e 方法\u003cul\u003e\n\u003cli\u003e通过 \u003ccode\u003eErrors\u003c/code\u003e 对象收集错误\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eObjectError\u003c/code\u003e：对象（Bean）错误：\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eFieldError\u003c/code\u003e：对象（Bean）属性（Property）错误\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e通过 \u003ccode\u003eObjectError\u003c/code\u003e 和 \u003ccode\u003eFieldError\u003c/code\u003e 关联 \u003ccode\u003eMessageSource\u003c/code\u003e 实现获取最终的错误文案\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cfigure class=\"highlight less\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e26\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e27\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e28\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e29\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e30\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e31\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e32\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e33\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e34\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e35\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e36\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e37\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e38\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e39\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e40\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e41\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e42\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e43\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e44\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e45\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e46\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e47\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e48\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e49\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e50\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e51\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e52\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e53\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e54\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e55\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e56\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e57\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e58\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e59\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e60\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e61\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e62\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e63\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e64\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e65\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e66\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e67\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e68\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"selector-tag\"\u003epackage\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eio\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.github\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.dunwu\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.spring\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.core\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.validation\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"selector-tag\"\u003eimport\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eio\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.github\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.dunwu\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.spring\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.core\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.validation\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.annotation\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.Valid\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"selector-tag\"\u003eimport\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eio\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.github\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.dunwu\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.spring\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.core\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.validation\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.config\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.CustomValidatorConfig\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"selector-tag\"\u003eimport\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eio\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.github\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.dunwu\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.spring\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.core\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.validation\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.entity\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.Person\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"selector-tag\"\u003eimport\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eorg\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.springframework\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.stereotype\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.Component\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"selector-tag\"\u003eimport\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eorg\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.springframework\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.validation\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.Errors\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"selector-tag\"\u003eimport\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eorg\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.springframework\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.validation\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.ValidationUtils\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"selector-tag\"\u003eimport\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eorg\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.springframework\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.validation\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.Validator\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"selector-tag\"\u003eimport\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003ejava\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.lang\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.annotation\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.Annotation\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"selector-tag\"\u003eimport\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003ejava\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.lang\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.reflect\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.Field\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"selector-tag\"\u003eimport\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003ejava\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.util\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.ArrayList\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"selector-tag\"\u003eimport\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003ejava\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.util\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.Collections\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"selector-tag\"\u003eimport\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003ejava\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.util\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.List\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e@\u003cspan class=\"selector-tag\"\u003eComponent\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"selector-tag\"\u003epublic\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eclass\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eCustomValidator\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eimplements\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eValidator\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"selector-tag\"\u003eprivate\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003efinal\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eCustomValidatorConfig\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003evalidatorConfig\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"selector-tag\"\u003epublic\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eCustomValidator\u003c/span\u003e(CustomValidatorConfig validatorConfig) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"selector-tag\"\u003ethis\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.validatorConfig\u003c/span\u003e = \u003cspan class=\"selector-tag\"\u003evalidatorConfig\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e/**\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     * 本校验器只针对 Person 对象进行校验\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e     */\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    @\u003cspan class=\"selector-tag\"\u003eOverride\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"selector-tag\"\u003epublic\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eboolean\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003esupports\u003c/span\u003e(Class\u0026lt;?\u0026gt; clazz) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"selector-tag\"\u003ereturn\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003ePerson\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.class\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.equals\u003c/span\u003e(clazz);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    @\u003cspan class=\"selector-tag\"\u003eOverride\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"selector-tag\"\u003epublic\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003evoid\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003evalidate\u003c/span\u003e(Object target, Errors errors) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"selector-tag\"\u003eValidationUtils\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.rejectIfEmpty\u003c/span\u003e(errors, \u003cspan class=\"string\"\u003e\u0026#34;name\u0026#34;\u003c/span\u003e, \u003cspan class=\"string\"\u003e\u0026#34;name.empty\u0026#34;\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"selector-tag\"\u003eList\u003c/span\u003e\u0026lt;\u003cspan class=\"selector-tag\"\u003eField\u003c/span\u003e\u0026gt; \u003cspan class=\"selector-tag\"\u003efields\u003c/span\u003e = \u003cspan class=\"selector-tag\"\u003egetFields\u003c/span\u003e(target.\u003cspan class=\"built_in\"\u003egetClass\u003c/span\u003e());\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"selector-tag\"\u003efor\u003c/span\u003e (Field \u003cspan class=\"attribute\"\u003efield \u003c/span\u003e: fields) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"selector-tag\"\u003eAnnotation\u003c/span\u003e\u003cspan class=\"selector-attr\"\u003e[]\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eannotations\u003c/span\u003e = \u003cspan class=\"selector-tag\"\u003efield\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.getAnnotations\u003c/span\u003e();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"selector-tag\"\u003efor\u003c/span\u003e (Annotation \u003cspan class=\"attribute\"\u003eannotation \u003c/span\u003e: annotations) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                \u003cspan class=\"selector-tag\"\u003eif\u003c/span\u003e (annotation.\u003cspan class=\"built_in\"\u003eannotationType\u003c/span\u003e().\u003cspan class=\"built_in\"\u003egetAnnotation\u003c/span\u003e(Valid.class) != null) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                    \u003cspan class=\"selector-tag\"\u003etry\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                        \u003cspan class=\"selector-tag\"\u003eValidatorRule\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003evalidatorRule\u003c/span\u003e = \u003cspan class=\"selector-tag\"\u003evalidatorConfig\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.findRule\u003c/span\u003e(annotation);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                        \u003cspan class=\"selector-tag\"\u003eif\u003c/span\u003e (validatorRule != null) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                            \u003cspan class=\"selector-tag\"\u003evalidatorRule\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.valid\u003c/span\u003e(annotation, target, field, errors);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                    } \u003cspan class=\"selector-tag\"\u003ecatch\u003c/span\u003e (Exception e) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                        \u003cspan class=\"selector-tag\"\u003ee\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.printStackTrace\u003c/span\u003e();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"selector-tag\"\u003eprivate\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eList\u003c/span\u003e\u0026lt;\u003cspan class=\"selector-tag\"\u003eField\u003c/span\u003e\u0026gt; \u003cspan class=\"selector-tag\"\u003egetFields\u003c/span\u003e(Class\u0026lt;?\u0026gt; clazz) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// 声明Field数组\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"selector-tag\"\u003eList\u003c/span\u003e\u0026lt;\u003cspan class=\"selector-tag\"\u003eField\u003c/span\u003e\u0026gt; \u003cspan class=\"selector-tag\"\u003efields\u003c/span\u003e = \u003cspan class=\"selector-tag\"\u003enew\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003eArrayList\u003c/span\u003e\u0026lt;\u0026gt;();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// 如果class类型不为空\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"selector-tag\"\u003ewhile\u003c/span\u003e (clazz != null) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"comment\"\u003e// 添加属性到属性数组\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"selector-tag\"\u003eCollections\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.addAll\u003c/span\u003e(fields, clazz.\u003cspan class=\"built_in\"\u003egetDeclaredFields\u003c/span\u003e());\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"selector-tag\"\u003eclazz\u003c/span\u003e = \u003cspan class=\"selector-tag\"\u003eclazz\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.getSuperclass\u003c/span\u003e();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"selector-tag\"\u003ereturn\u003c/span\u003e \u003cspan class=\"selector-tag\"\u003efields\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"快速失败-Fail-Fast\"\u003e\u003ca href=\"#快速失败-Fail-Fast\" class=\"headerlink\" title=\"快速失败(Fail Fast)\"\u003e\u003c/a\u003e快速失败(Fail Fast)\u003c/h3\u003e\u003cp\u003eSpring Validation 默认会校验完所有字段，然后才抛出异常。可以通过一些简单的配置，开启 Fali Fast 模式，一旦校验失败就立即返回。\u003c/p\u003e\n\u003cfigure class=\"highlight scss\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e@Bean\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003epublic Validator validator() {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    ValidatorFactory validatorFactory = Validation\u003cspan class=\"selector-class\"\u003e.byProvider\u003c/span\u003e(HibernateValidator.class)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"selector-class\"\u003e.configure\u003c/span\u003e()\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"comment\"\u003e// 快速失败模式\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"selector-class\"\u003e.failFast\u003c/span\u003e(true)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"selector-class\"\u003e.buildValidatorFactory\u003c/span\u003e();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    return validatorFactory\u003cspan class=\"selector-class\"\u003e.getValidator\u003c/span\u003e();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch2 id=\"Spring-校验原理\"\u003e\u003ca href=\"#Spring-校验原理\" class=\"headerlink\" title=\"Spring 校验原理\"\u003e\u003c/a\u003eSpring 校验原理\u003c/h2\u003e\u003ch3 id=\"Spring-校验使用场景\"\u003e\u003ca href=\"#Spring-校验使用场景\" class=\"headerlink\" title=\"Spring 校验使用场景\"\u003e\u003c/a\u003eSpring 校验使用场景\u003c/h3\u003e\u003cul\u003e\n\u003cli\u003eSpring 常规校验（Validator）\u003c/li\u003e\n\u003cli\u003eSpring 数据绑定（DataBinder）\u003c/li\u003e\n\u003cli\u003eSpring Web 参数绑定（WebDataBinder）\u003c/li\u003e\n\u003cli\u003eSpring WebMVC/WebFlux 处理方法参数校验\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"Validator-接口设计\"\u003e\u003ca href=\"#Validator-接口设计\" class=\"headerlink\" title=\"Validator 接口设计\"\u003e\u003c/a\u003eValidator 接口设计\u003c/h3\u003e\u003cul\u003e\n\u003cli\u003e接口职责\u003cul\u003e\n\u003cli\u003eSpring 内部校验器接口，通过编程的方式校验目标对象\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e核心方法\u003cul\u003e\n\u003cli\u003e\u003ccode\u003esupports(Class)\u003c/code\u003e：校验目标类能否校验\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003evalidate(Object,Errors)\u003c/code\u003e：校验目标对象，并将校验失败的内容输出至 Errors 对象\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e配套组件\u003cul\u003e\n\u003cli\u003e错误收集器：\u003ccode\u003eorg.springframework.validation.Errors\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eValidator 工具类：\u003ccode\u003eorg.springframework.validation.ValidationUtils\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"Errors-接口设计\"\u003e\u003ca href=\"#Errors-接口设计\" class=\"headerlink\" title=\"Errors 接口设计\"\u003e\u003c/a\u003eErrors 接口设计\u003c/h3\u003e\u003cul\u003e\n\u003cli\u003e接口职责\u003cul\u003e\n\u003cli\u003e数据绑定和校验错误收集接口，与 Java Bean 和其属性有强关联性\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e核心方法\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ereject\u003c/code\u003e 方法（重载）：收集错误文案\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003erejectValue\u003c/code\u003e 方法（重载）：收集对象字段中的错误文案\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e配套组件\u003cul\u003e\n\u003cli\u003eJava Bean 错误描述：\u003ccode\u003eorg.springframework.validation.ObjectError\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eJava Bean 属性错误描述：\u003ccode\u003eorg.springframework.validation.FieldError\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"Errors-文案来源\"\u003e\u003ca href=\"#Errors-文案来源\" class=\"headerlink\" title=\"Errors 文案来源\"\u003e\u003c/a\u003eErrors 文案来源\u003c/h3\u003e\u003cp\u003eErrors 文案生成步骤\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e选择 Errors 实现（如：\u003ccode\u003eorg.springframework.validation.BeanPropertyBindingResult\u003c/code\u003e）\u003c/li\u003e\n\u003cli\u003e调用 reject 或 rejectValue 方法\u003c/li\u003e\n\u003cli\u003e获取 Errors 对象中 ObjectError 或 FieldError\u003c/li\u003e\n\u003cli\u003e将 ObjectError 或 FieldError 中的 code 和 args，关联 MessageSource 实现（如：\u003ccode\u003eResourceBundleMessageSource\u003c/code\u003e）\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"spring-web-校验原理\"\u003e\u003ca href=\"#spring-web-校验原理\" class=\"headerlink\" title=\"spring web 校验原理\"\u003e\u003c/a\u003espring web 校验原理\u003c/h3\u003e\u003ch4 id=\"RequestBody-参数校验实现原理\"\u003e\u003ca href=\"#RequestBody-参数校验实现原理\" class=\"headerlink\" title=\"RequestBody 参数校验实现原理\"\u003e\u003c/a\u003eRequestBody 参数校验实现原理\u003c/h4\u003e\u003cp\u003e在 spring-mvc 中，\u003ccode\u003eRequestResponseBodyMethodProcessor\u003c/code\u003e 是用于解析 \u003ccode\u003e@RequestBody\u003c/code\u003e 标注的参数以及处理\u003ccode\u003e@ResponseBody\u003c/code\u003e 标注方法的返回值的。其中，执行参数校验的逻辑肯定就在解析参数的方法 \u003ccode\u003eresolveArgument()\u003c/code\u003e 中：\u003c/p\u003e\n\u003cfigure class=\"highlight java\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta\"\u003e@Override\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e Object \u003cspan class=\"title function_\"\u003eresolveArgument\u003c/span\u003e\u003cspan class=\"params\"\u003e(MethodParameter parameter, \u003cspan class=\"meta\"\u003e@Nullable\u003c/span\u003e ModelAndViewContainer mavContainer,\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"params\"\u003e    NativeWebRequest webRequest, \u003cspan class=\"meta\"\u003e@Nullable\u003c/span\u003e WebDataBinderFactory binderFactory)\u003c/span\u003e \u003cspan class=\"keyword\"\u003ethrows\u003c/span\u003e Exception {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    parameter = parameter.nestedIfOptional();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"type\"\u003eObject\u003c/span\u003e \u003cspan class=\"variable\"\u003earg\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e readWithMessageConverters(webRequest, parameter, parameter.getNestedGenericParameterType());\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"type\"\u003eString\u003c/span\u003e \u003cspan class=\"variable\"\u003ename\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e Conventions.getVariableNameForParameter(parameter);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003eif\u003c/span\u003e (binderFactory != \u003cspan class=\"literal\"\u003enull\u003c/span\u003e) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"type\"\u003eWebDataBinder\u003c/span\u003e \u003cspan class=\"variable\"\u003ebinder\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e binderFactory.createBinder(webRequest, arg, name);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003eif\u003c/span\u003e (arg != \u003cspan class=\"literal\"\u003enull\u003c/span\u003e) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"comment\"\u003e// 尝试进行参数校验\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            validateIfApplicable(binder, parameter);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"keyword\"\u003eif\u003c/span\u003e (binder.getBindingResult().hasErrors() \u0026amp;\u0026amp; isBindExceptionRequired(binder, parameter)) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                \u003cspan class=\"comment\"\u003e// 如果存在校验错误，则抛出 MethodArgumentNotValidException\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                \u003cspan class=\"keyword\"\u003ethrow\u003c/span\u003e \u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eMethodArgumentNotValidException\u003c/span\u003e(parameter, binder.getBindingResult());\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003eif\u003c/span\u003e (mavContainer != \u003cspan class=\"literal\"\u003enull\u003c/span\u003e) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            mavContainer.addAttribute(BindingResult.MODEL_KEY_PREFIX + name, binder.getBindingResult());\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003ereturn\u003c/span\u003e adaptArgumentIfNecessary(arg, parameter);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e可以看到，resolveArgument()调用了 validateIfApplicable()进行参数校验。\u003c/p\u003e\n\u003cfigure class=\"highlight java\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003eprotected\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003evalidateIfApplicable\u003c/span\u003e\u003cspan class=\"params\"\u003e(WebDataBinder binder, MethodParameter parameter)\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e// 获取参数注解，如 @RequestBody、@Valid、@Validated\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    Annotation[] annotations = parameter.getParameterAnnotations();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e (Annotation ann : annotations) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// 先尝试获取 @Validated 注解\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"type\"\u003eValidated\u003c/span\u003e \u003cspan class=\"variable\"\u003evalidatedAnn\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e AnnotationUtils.getAnnotation(ann, Validated.class);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// 如果标注了 @Validated，直接开始校验。\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// 如果没有，那么判断参数前是否有 Valid 开头的注解。\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003eif\u003c/span\u003e (validatedAnn != \u003cspan class=\"literal\"\u003enull\u003c/span\u003e || ann.annotationType().getSimpleName().startsWith(\u003cspan class=\"string\"\u003e\u0026#34;Valid\u0026#34;\u003c/span\u003e)) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"type\"\u003eObject\u003c/span\u003e \u003cspan class=\"variable\"\u003ehints\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e (validatedAnn != \u003cspan class=\"literal\"\u003enull\u003c/span\u003e ? validatedAnn.value() : AnnotationUtils.getValue(ann));\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            Object[] validationHints = (hints \u003cspan class=\"keyword\"\u003einstanceof\u003c/span\u003e Object[] ? (Object[]) hints : \u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eObject\u003c/span\u003e[] {hints});\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"comment\"\u003e// 执行校验\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            binder.validate(validationHints);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"keyword\"\u003ebreak\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e以上代码，就解释了 Spring 为什么能同时支持 \u003ccode\u003e@Validated\u003c/code\u003e、\u003ccode\u003e@Valid\u003c/code\u003e 两个注解。\u003c/p\u003e\n\u003cp\u003e接下来，看一下 WebDataBinder.validate() 的实现：\u003c/p\u003e\n\u003cfigure class=\"highlight typescript\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta\"\u003e@Override\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"built_in\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003evalidate\u003c/span\u003e(\u003cspan class=\"params\"\u003e\u003cspan class=\"built_in\"\u003eObject\u003c/span\u003e target, Errors errors, \u003cspan class=\"built_in\"\u003eObject\u003c/span\u003e... validationHints\u003c/span\u003e) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"property\"\u003etargetValidator\u003c/span\u003e != \u003cspan class=\"literal\"\u003enull\u003c/span\u003e) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"title function_\"\u003eprocessConstraintViolations\u003c/span\u003e(\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"comment\"\u003e// 此处调用 Hibernate Validator 执行真正的校验\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"variable language_\"\u003ethis\u003c/span\u003e.\u003cspan class=\"property\"\u003etargetValidator\u003c/span\u003e.\u003cspan class=\"title function_\"\u003evalidate\u003c/span\u003e(target, \u003cspan class=\"title function_\"\u003easValidationGroups\u003c/span\u003e(validationHints)), errors);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e通过上面代码，可以看出 Spring 校验实际上是基于 Hibernate Validator 的封装。\u003c/p\u003e\n\u003ch4 id=\"方法级别的参数校验实现原理\"\u003e\u003ca href=\"#方法级别的参数校验实现原理\" class=\"headerlink\" title=\"方法级别的参数校验实现原理\"\u003e\u003c/a\u003e方法级别的参数校验实现原理\u003c/h4\u003e\u003cp\u003eSpring 支持根据方法去进行拦截、校验，原理就在于应用了 AOP 技术。具体来说，是通过 \u003ccode\u003eMethodValidationPostProcessor\u003c/code\u003e 动态注册 AOP 切面，然后使用 \u003ccode\u003eMethodValidationInterceptor\u003c/code\u003e 对切点方法织入增强。\u003c/p\u003e\n\u003cfigure class=\"highlight java\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"title class_\"\u003eMethodValidationPostProcessor\u003c/span\u003e \u003cspan class=\"keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"title class_\"\u003eAbstractBeanFactoryAwareAdvisingPostProcessorimplements\u003c/span\u003e InitializingBean {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"meta\"\u003e@Override\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003eafterPropertiesSet\u003c/span\u003e\u003cspan class=\"params\"\u003e()\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// 为所有 @Validated 标注的 Bean 创建切面\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"type\"\u003ePointcut\u003c/span\u003e \u003cspan class=\"variable\"\u003epointcut\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e \u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eAnnotationMatchingPointcut\u003c/span\u003e(\u003cspan class=\"built_in\"\u003ethis\u003c/span\u003e.validatedAnnotationType, \u003cspan class=\"literal\"\u003etrue\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// 创建 Advisor 进行增强\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"built_in\"\u003ethis\u003c/span\u003e.advisor = \u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eDefaultPointcutAdvisor\u003c/span\u003e(pointcut, createMethodValidationAdvice(\u003cspan class=\"built_in\"\u003ethis\u003c/span\u003e.validator));\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e// 创建 Advice，本质就是一个方法拦截器\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003eprotected\u003c/span\u003e Advice \u003cspan class=\"title function_\"\u003ecreateMethodValidationAdvice\u003c/span\u003e\u003cspan class=\"params\"\u003e(\u003cspan class=\"meta\"\u003e@Nullable\u003c/span\u003e Validator validator)\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003ereturn\u003c/span\u003e (validator != \u003cspan class=\"literal\"\u003enull\u003c/span\u003e ? \u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eMethodValidationInterceptor\u003c/span\u003e(validator) : \u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eMethodValidationInterceptor\u003c/span\u003e());\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e接着看一下 \u003ccode\u003eMethodValidationInterceptor\u003c/code\u003e：\u003c/p\u003e\n\u003cfigure class=\"highlight scss\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e26\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e27\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e28\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e29\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e30\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e31\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e32\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e33\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e34\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e35\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003epublic class MethodValidationInterceptor implements MethodInterceptor {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003e@Override\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    public Object invoke(MethodInvocation invocation) throws Throwable {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// 无需增强的方法，直接跳过\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        if (isFactoryBeanMetadataMethod(invocation.getMethod())) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            return invocation\u003cspan class=\"selector-class\"\u003e.proceed\u003c/span\u003e();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// 获取分组信息\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        Class\u0026lt;?\u0026gt;\u003cspan class=\"selector-attr\"\u003e[]\u003c/span\u003e groups = \u003cspan class=\"built_in\"\u003edetermineValidationGroups\u003c/span\u003e(invocation);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        ExecutableValidator execVal = this\u003cspan class=\"selector-class\"\u003e.validator\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.forExecutables\u003c/span\u003e();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        Method methodToValidate = invocation\u003cspan class=\"selector-class\"\u003e.getMethod\u003c/span\u003e();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        Set\u0026lt;ConstraintViolation\u0026lt;\u003cspan class=\"selector-tag\"\u003eObject\u003c/span\u003e\u0026gt;\u0026gt; result;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        try {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"comment\"\u003e// 方法入参校验，最终还是委托给 Hibernate Validator 来校验\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            result = execVal\u003cspan class=\"selector-class\"\u003e.validateParameters\u003c/span\u003e(\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                invocation.getThis(), methodToValidate, invocation\u003cspan class=\"selector-class\"\u003e.getArguments\u003c/span\u003e(), groups);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        catch (IllegalArgumentException ex) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            ...\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// 有异常直接抛出\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        if (!result.isEmpty()) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            throw new \u003cspan class=\"built_in\"\u003eConstraintViolationException\u003c/span\u003e(result);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// 真正的方法调用\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"selector-tag\"\u003eObject\u003c/span\u003e returnValue = invocation\u003cspan class=\"selector-class\"\u003e.proceed\u003c/span\u003e();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// 对返回值做校验，最终还是委托给Hibernate Validator来校验\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        result = execVal\u003cspan class=\"selector-class\"\u003e.validateReturnValue\u003c/span\u003e(invocation.getThis(), methodToValidate, returnValue, groups);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// 有异常直接抛出\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        if (!result.isEmpty()) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            throw new \u003cspan class=\"built_in\"\u003eConstraintViolationException\u003c/span\u003e(result);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        return returnValue;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e实际上，不管是 requestBody 参数校验还是方法级别的校验，最终都是调用 Hibernate Validator 执行校验，Spring Validation 只是做了一层封装。\u003c/p\u003e\n\u003ch2 id=\"问题\"\u003e\u003ca href=\"#问题\" class=\"headerlink\" title=\"问题\"\u003e\u003c/a\u003e问题\u003c/h2\u003e\u003cp\u003e\u003cstrong\u003eSpring 有哪些校验核心组件\u003c/strong\u003e？\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e检验器：\u003ccode\u003eorg.springframework.validation.Validator\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e错误收集器：\u003ccode\u003eorg.springframework.validation.Errors\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eJava Bean 错误描述：\u003ccode\u003eorg.springframework.validation.ObjectError\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eJava Bean 属性错误描述：\u003ccode\u003eorg.springframework.validation.FieldError\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eBean Validation 适配：\u003ccode\u003eorg.springframework.validation.beanvalidation.LocalValidatorFactoryBean\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"参考资料\"\u003e\u003ca href=\"#参考资料\" class=\"headerlink\" title=\"参考资料\"\u003e\u003c/a\u003e参考资料\u003c/h2\u003e\u003cul\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#beans\"\u003eSpring 官方文档之 Core Technologies\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://time.geekbang.org/course/intro/265\"\u003e《小马哥讲 Spring 核心编程思想》\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://juejin.cn/post/6856541106626363399\"\u003ehttps://juejin.cn/post/6856541106626363399\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n    \u003c/div\u003e",
  "Date": "2022-12-22T09:42:28Z",
  "Author": "钝悟 ◾ Dunwu"
}