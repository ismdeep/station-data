{
  "Source": "dunwu",
  "Title": "Java å†…å­˜ç®¡ç†",
  "Link": "https://dunwu.github.io/blog/pages/db5b69/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\u003ch1 id=\"Java-å†…å­˜ç®¡ç†\"\u003e\u003ca href=\"#Java-å†…å­˜ç®¡ç†\" class=\"headerlink\" title=\"Java å†…å­˜ç®¡ç†\"\u003e\u003c/a\u003eJava å†…å­˜ç®¡ç†\u003c/h1\u003e\u003ch2 id=\"å†…å­˜ç®€ä»‹\"\u003e\u003ca href=\"#å†…å­˜ç®€ä»‹\" class=\"headerlink\" title=\"å†…å­˜ç®€ä»‹\"\u003e\u003c/a\u003eå†…å­˜ç®€ä»‹\u003c/h2\u003e\u003ch3 id=\"ç‰©ç†å†…å­˜å’Œè™šæ‹Ÿå†…å­˜\"\u003e\u003ca href=\"#ç‰©ç†å†…å­˜å’Œè™šæ‹Ÿå†…å­˜\" class=\"headerlink\" title=\"ç‰©ç†å†…å­˜å’Œè™šæ‹Ÿå†…å­˜\"\u003e\u003c/a\u003eç‰©ç†å†…å­˜å’Œè™šæ‹Ÿå†…å­˜\u003c/h3\u003e\u003cp\u003eæ‰€è°“ç‰©ç†å†…å­˜å°±æ˜¯é€šå¸¸æ‰€è¯´çš„ RAMï¼ˆéšæœºå­˜å‚¨å™¨ï¼‰ã€‚\u003c/p\u003e\n\u003cp\u003eè™šæ‹Ÿå†…å­˜ä½¿å¾—å¤šä¸ªè¿›ç¨‹åœ¨åŒæ—¶è¿è¡Œæ—¶å¯ä»¥å…±äº«ç‰©ç†å†…å­˜ï¼Œè¿™é‡Œçš„å…±äº«åªæ˜¯ç©ºé—´ä¸Šå…±äº«ï¼Œåœ¨é€»è¾‘ä¸Šå½¼æ­¤ä»ç„¶æ˜¯éš”ç¦»çš„ã€‚\u003c/p\u003e\n\u003ch3 id=\"å†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´\"\u003e\u003ca href=\"#å†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´\" class=\"headerlink\" title=\"å†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´\"\u003e\u003c/a\u003eå†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´\u003c/h3\u003e\u003cp\u003eä¸€ä¸ªè®¡ç®—é€šå¸¸æœ‰å›ºå®šå¤§å°çš„å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯ç¨‹åºå¹¶ä¸èƒ½ä½¿ç”¨å…¨éƒ¨çš„ç©ºé—´ã€‚å› ä¸ºè¿™äº›ç©ºé—´è¢«åˆ’åˆ†ä¸ºå†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´ï¼Œè€Œç¨‹åºåªèƒ½ä½¿ç”¨ç”¨æˆ·ç©ºé—´çš„å†…å­˜ã€‚\u003c/p\u003e\n\u003ch3 id=\"ä½¿ç”¨å†…å­˜çš„-Java-ç»„ä»¶\"\u003e\u003ca href=\"#ä½¿ç”¨å†…å­˜çš„-Java-ç»„ä»¶\" class=\"headerlink\" title=\"ä½¿ç”¨å†…å­˜çš„ Java ç»„ä»¶\"\u003e\u003c/a\u003eä½¿ç”¨å†…å­˜çš„ Java ç»„ä»¶\u003c/h3\u003e\u003cp\u003eJava å¯åŠ¨åï¼Œä½œä¸ºä¸€ä¸ªè¿›ç¨‹è¿è¡Œåœ¨æ“ä½œç³»ç»Ÿä¸­ã€‚\u003c/p\u003e\n\u003cp\u003eæœ‰å“ªäº› Java ç»„ä»¶éœ€è¦å ç”¨å†…å­˜å‘¢ï¼Ÿ\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå †å†…å­˜ï¼šJava å †ã€ç±»å’Œç±»åŠ è½½å™¨\u003c/li\u003e\n\u003cli\u003eæ ˆå†…å­˜ï¼šçº¿ç¨‹\u003c/li\u003e\n\u003cli\u003eæœ¬åœ°å†…å­˜ï¼šNIOã€JNI\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ\"\u003e\u003ca href=\"#è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ\" class=\"headerlink\" title=\"è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ\"\u003e\u003c/a\u003eè¿è¡Œæ—¶æ•°æ®åŒºåŸŸ\u003c/h2\u003e\u003cp\u003eJVM åœ¨æ‰§è¡Œ Java ç¨‹åºçš„è¿‡ç¨‹ä¸­ä¼šæŠŠå®ƒæ‰€ç®¡ç†çš„å†…å­˜åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªä¸åŒçš„æ•°æ®åŒºåŸŸã€‚è¿™äº›åŒºåŸŸéƒ½æœ‰å„è‡ªçš„ç”¨é€”ï¼Œä»¥åŠåˆ›å»ºå’Œé”€æ¯çš„æ—¶é—´ï¼Œæœ‰çš„åŒºåŸŸéšç€è™šæ‹Ÿæœºè¿›ç¨‹çš„å¯åŠ¨è€Œå­˜åœ¨ï¼Œæœ‰äº›åŒºåŸŸåˆ™ä¾èµ–ç”¨æˆ·çº¿ç¨‹çš„å¯åŠ¨å’Œç»“æŸè€Œå»ºç«‹å’Œé”€æ¯ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/cs/java/javacore/jvm/jvm-memory-runtime-data-area.png\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003ch3 id=\"ç¨‹åºè®¡æ•°å™¨\"\u003e\u003ca href=\"#ç¨‹åºè®¡æ•°å™¨\" class=\"headerlink\" title=\"ç¨‹åºè®¡æ•°å™¨\"\u003e\u003c/a\u003eç¨‹åºè®¡æ•°å™¨\u003c/h3\u003e\u003cp\u003e\u003cstrong\u003e\u003ccode\u003eç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰\u003c/code\u003e\u003c/strong\u003e æ˜¯ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œå®ƒå¯ä»¥çœ‹åšæ˜¯\u003cstrong\u003eå½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨\u003c/strong\u003eã€‚ä¾‹å¦‚ï¼Œåˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸ã€çº¿ç¨‹æ¢å¤ç­‰éƒ½ä¾èµ–äºè®¡æ•°å™¨ã€‚\u003c/p\u003e\n\u003cp\u003eå½“æ‰§è¡Œçš„çº¿ç¨‹æ•°é‡è¶…è¿‡ CPU æ•°é‡æ—¶ï¼Œçº¿ç¨‹ä¹‹é—´ä¼šæ ¹æ®æ—¶é—´ç‰‡è½®è¯¢äº‰å¤º CPU èµ„æºã€‚å¦‚æœä¸€ä¸ªçº¿ç¨‹çš„æ—¶é—´ç‰‡ç”¨å®Œäº†ï¼Œæˆ–è€…æ˜¯å…¶å®ƒåŸå› å¯¼è‡´è¿™ä¸ªçº¿ç¨‹çš„ CPU èµ„æºè¢«æå‰æŠ¢å¤ºï¼Œé‚£ä¹ˆè¿™ä¸ªé€€å‡ºçš„çº¿ç¨‹å°±éœ€è¦å•ç‹¬çš„ä¸€ä¸ªç¨‹åºè®¡æ•°å™¨ï¼Œæ¥è®°å½•ä¸‹ä¸€æ¡è¿è¡Œçš„æŒ‡ä»¤ï¼Œä»è€Œåœ¨çº¿ç¨‹åˆ‡æ¢åèƒ½æ¢å¤åˆ°æ­£ç¡®çš„æ‰§è¡Œä½ç½®ã€‚å„æ¡çº¿ç¨‹é—´çš„è®¡æ•°å™¨äº’ä¸å½±å“ï¼Œç‹¬ç«‹å­˜å‚¨ï¼Œæˆ‘ä»¬ç§°è¿™ç±»å†…å­˜åŒºåŸŸä¸º â€œçº¿ç¨‹ç§æœ‰â€ çš„å†…å­˜ã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå¦‚æœçº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æ˜¯ä¸€ä¸ª Java æ–¹æ³•ï¼Œè¿™ä¸ªè®¡æ•°å™¨è®°å½•çš„æ˜¯æ­£åœ¨æ‰§è¡Œçš„è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼›\u003c/li\u003e\n\u003cli\u003eå¦‚æœæ­£åœ¨æ‰§è¡Œçš„æ˜¯ Native æ–¹æ³•ï¼Œè¿™ä¸ªè®¡æ•°å™¨å€¼åˆ™ä¸ºç©ºï¼ˆUndefinedï¼‰ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eğŸ”” æ³¨æ„ï¼šæ­¤å†…å­˜åŒºåŸŸæ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨ JVM ä¸­æ²¡æœ‰è§„å®šä»»ä½• \u003ccode\u003eOutOfMemoryError\u003c/code\u003e æƒ…å†µçš„åŒºåŸŸã€‚\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"Java-è™šæ‹Ÿæœºæ ˆ\"\u003e\u003ca href=\"#Java-è™šæ‹Ÿæœºæ ˆ\" class=\"headerlink\" title=\"Java è™šæ‹Ÿæœºæ ˆ\"\u003e\u003c/a\u003eJava è™šæ‹Ÿæœºæ ˆ\u003c/h3\u003e\u003cp\u003e\u003cstrong\u003e\u003ccode\u003eJava è™šæ‹Ÿæœºæ ˆï¼ˆJava Virtual Machine Stacksï¼‰\u003c/code\u003e\u003c/strong\u003e ä¹Ÿ\u003cstrong\u003eæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ç›¸åŒ\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cp\u003eæ¯ä¸ª Java æ–¹æ³•åœ¨æ‰§è¡Œçš„åŒæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼ˆStack Frameï¼‰ç”¨äºå­˜å‚¨ \u003cstrong\u003eå±€éƒ¨å˜é‡è¡¨\u003c/strong\u003eã€\u003cstrong\u003eæ“ä½œæ•°æ ˆ\u003c/strong\u003eã€\u003cstrong\u003eå¸¸é‡æ± å¼•ç”¨\u003c/strong\u003e ç­‰ä¿¡æ¯ã€‚æ¯ä¸€ä¸ªæ–¹æ³•ä»è°ƒç”¨ç›´è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹ï¼Œå°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨ Java è™šæ‹Ÿæœºæ ˆä¸­å…¥æ ˆå’Œå‡ºæ ˆçš„è¿‡ç¨‹ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/cs/java/javacore/jvm/jvm-stack.png!w640\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eå±€éƒ¨å˜é‡è¡¨\u003c/strong\u003e - 32 ä½å˜é‡æ§½ï¼Œå­˜æ”¾äº†ç¼–è¯‘æœŸå¯çŸ¥çš„å„ç§åŸºæœ¬æ•°æ®ç±»å‹ã€å¯¹è±¡å¼•ç”¨ã€\u003ccode\u003eReturnAddress\u003c/code\u003e ç±»å‹ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eæ“ä½œæ•°æ ˆ\u003c/strong\u003e - åŸºäºæ ˆçš„æ‰§è¡Œå¼•æ“ï¼Œè™šæ‹ŸæœºæŠŠæ“ä½œæ•°æ ˆä½œä¸ºå®ƒçš„å·¥ä½œåŒºï¼Œå¤§å¤šæ•°æŒ‡ä»¤éƒ½è¦ä»è¿™é‡Œå¼¹å‡ºæ•°æ®ã€æ‰§è¡Œè¿ç®—ï¼Œç„¶åæŠŠç»“æœå‹å›æ“ä½œæ•°æ ˆã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eåŠ¨æ€é“¾æ¥\u003c/strong\u003e - æ¯ä¸ªæ ˆå¸§éƒ½åŒ…å«ä¸€ä¸ªæŒ‡å‘è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆæ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ï¼‰ä¸­è¯¥æ ˆå¸§æ‰€å±æ–¹æ³•çš„å¼•ç”¨ã€‚æŒæœ‰è¿™ä¸ªå¼•ç”¨æ˜¯ä¸ºäº†æ”¯æŒæ–¹æ³•è°ƒç”¨è¿‡ç¨‹ä¸­çš„åŠ¨æ€è¿æ¥ã€‚Class æ–‡ä»¶çš„å¸¸é‡æ± ä¸­æœ‰å¤§é‡çš„ç¬¦å·å¼•ç”¨ï¼Œå­—èŠ‚ç ä¸­çš„æ–¹æ³•è°ƒç”¨æŒ‡ä»¤å°±ä»¥å¸¸é‡æ± ä¸­æŒ‡å‘æ–¹æ³•çš„ç¬¦å·å¼•ç”¨ä¸ºå‚æ•°ã€‚è¿™äº›ç¬¦å·å¼•ç”¨ä¸€éƒ¨åˆ†ä¼šåœ¨ç±»åŠ è½½é˜¶æ®µæˆ–ç¬¬ä¸€æ¬¡ä½¿ç”¨çš„æ—¶å€™è½¬åŒ–ä¸ºç›´æ¥å¼•ç”¨ï¼Œè¿™ç§è½¬åŒ–ç§°ä¸ºé™æ€è§£æã€‚å¦ä¸€éƒ¨åˆ†å°†åœ¨æ¯ä¸€æ¬¡çš„è¿è¡ŒæœŸé—´è½¬åŒ–ä¸ºç›´æ¥åº”ç”¨ï¼Œè¿™éƒ¨åˆ†ç§°ä¸ºåŠ¨æ€é“¾æ¥ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eæ–¹æ³•å‡ºå£\u003c/strong\u003e - è¿”å›æ–¹æ³•è¢«è°ƒç”¨çš„ä½ç½®ï¼Œæ¢å¤ä¸Šå±‚æ–¹æ³•çš„å±€éƒ¨å˜é‡å’Œæ“ä½œæ•°æ ˆï¼Œå¦‚æœæ— è¿”å›å€¼ï¼Œåˆ™æŠŠå®ƒå‹å…¥è°ƒç”¨è€…çš„æ“ä½œæ•°æ ˆã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003eğŸ”” æ³¨æ„ï¼š\u003c/p\u003e\n\u003cp\u003eè¯¥åŒºåŸŸå¯èƒ½æŠ›å‡ºä»¥ä¸‹å¼‚å¸¸ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦è¶…è¿‡æœ€å¤§å€¼ï¼Œå°±ä¼šæŠ›å‡º \u003ccode\u003eStackOverflowError\u003c/code\u003e å¼‚å¸¸ï¼›\u003c/li\u003e\n\u003cli\u003eå¦‚æœè™šæ‹Ÿæœºæ ˆè¿›è¡ŒåŠ¨æ€æ‰©å±•æ—¶ï¼Œæ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿå†…å­˜ï¼Œå°±ä¼šæŠ›å‡º \u003ccode\u003eOutOfMemoryError\u003c/code\u003e å¼‚å¸¸ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eğŸ’¡ æç¤ºï¼š\u003c/p\u003e\n\u003cp\u003eå¯ä»¥é€šè¿‡ \u003ccode\u003e-Xss\u003c/code\u003e è¿™ä¸ªè™šæ‹Ÿæœºå‚æ•°æ¥æŒ‡å®šä¸€ä¸ªç¨‹åºçš„ Java è™šæ‹Ÿæœºæ ˆå†…å­˜å¤§å°ï¼š\u003c/p\u003e\n\u003cfigure class=\"highlight java\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003ejava -Xss=512M HackTheJava\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"æœ¬åœ°æ–¹æ³•æ ˆ\"\u003e\u003ca href=\"#æœ¬åœ°æ–¹æ³•æ ˆ\" class=\"headerlink\" title=\"æœ¬åœ°æ–¹æ³•æ ˆ\"\u003e\u003c/a\u003eæœ¬åœ°æ–¹æ³•æ ˆ\u003c/h3\u003e\u003cp\u003e\u003cstrong\u003e\u003ccode\u003eæœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰\u003c/code\u003e\u003c/strong\u003e ä¸è™šæ‹Ÿæœºæ ˆçš„ä½œç”¨ç›¸ä¼¼ã€‚\u003c/p\u003e\n\u003cp\u003eäºŒè€…çš„åŒºåˆ«åœ¨äºï¼š\u003cstrong\u003eè™šæ‹Ÿæœºæ ˆä¸º Java æ–¹æ³•æœåŠ¡ï¼›æœ¬åœ°æ–¹æ³•æ ˆä¸º Native æ–¹æ³•æœåŠ¡\u003c/strong\u003eã€‚æœ¬åœ°æ–¹æ³•å¹¶ä¸æ˜¯ç”¨ Java å®ç°çš„ï¼Œè€Œæ˜¯ç”± C è¯­è¨€å®ç°çš„ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/cs/java/javacore/jvm/jvm-native-method-stack.gif!w640\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eğŸ”” æ³¨æ„ï¼šæœ¬åœ°æ–¹æ³•æ ˆä¹Ÿä¼šæŠ›å‡º \u003ccode\u003eStackOverflowError\u003c/code\u003e å¼‚å¸¸å’Œ \u003ccode\u003eOutOfMemoryError\u003c/code\u003e å¼‚å¸¸ã€‚\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"Java-å †\"\u003e\u003ca href=\"#Java-å †\" class=\"headerlink\" title=\"Java å †\"\u003e\u003c/a\u003eJava å †\u003c/h3\u003e\u003cp\u003e\u003cstrong\u003e\u003ccode\u003eJava å †ï¼ˆJava Heapï¼‰\u003c/code\u003e çš„ä½œç”¨å°±æ˜¯å­˜æ”¾å¯¹è±¡å®ä¾‹ï¼Œå‡ ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹éƒ½æ˜¯åœ¨è¿™é‡Œåˆ†é…å†…å­˜\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cp\u003eJava å †æ˜¯åƒåœ¾æ”¶é›†çš„ä¸»è¦åŒºåŸŸï¼ˆå› æ­¤ä¹Ÿè¢«å«åšâ€GC å †â€ï¼‰ã€‚ç°ä»£çš„åƒåœ¾æ”¶é›†å™¨åŸºæœ¬éƒ½æ˜¯é‡‡ç”¨\u003cstrong\u003eåˆ†ä»£æ”¶é›†ç®—æ³•\u003c/strong\u003eï¼Œè¯¥ç®—æ³•çš„æ€æƒ³æ˜¯é’ˆå¯¹ä¸åŒçš„å¯¹è±¡é‡‡å–ä¸åŒçš„åƒåœ¾å›æ”¶ç®—æ³•ã€‚\u003c/p\u003e\n\u003cp\u003eå› æ­¤è™šæ‹ŸæœºæŠŠ Java å †åˆ†æˆä»¥ä¸‹ä¸‰å—ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003eæ–°ç”Ÿä»£ï¼ˆYoung Generationï¼‰\u003c/code\u003e\u003c/strong\u003e\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eEden\u003c/code\u003e - Eden å’Œ Survivor çš„æ¯”ä¾‹ä¸º 8:1\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eFrom Survivor\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eTo Survivor\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003eè€å¹´ä»£ï¼ˆOld Generationï¼‰\u003c/code\u003e\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003eæ°¸ä¹…ä»£ï¼ˆPermanent Generationï¼‰\u003c/code\u003e\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eå½“ä¸€ä¸ªå¯¹è±¡è¢«åˆ›å»ºæ—¶ï¼Œå®ƒé¦–å…ˆè¿›å…¥æ–°ç”Ÿä»£ï¼Œä¹‹åæœ‰å¯èƒ½è¢«è½¬ç§»åˆ°è€å¹´ä»£ä¸­ã€‚æ–°ç”Ÿä»£å­˜æ”¾ç€å¤§é‡çš„ç”Ÿå‘½å¾ˆçŸ­çš„å¯¹è±¡ï¼Œå› æ­¤æ–°ç”Ÿä»£åœ¨ä¸‰ä¸ªåŒºåŸŸä¸­åƒåœ¾å›æ”¶çš„é¢‘ç‡æœ€é«˜ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/cs/java/javacore/jvm/jvm-heap.gif!w640\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eğŸ”” æ³¨æ„ï¼šJava å †ä¸éœ€è¦è¿ç»­å†…å­˜ï¼Œå¹¶ä¸”å¯ä»¥åŠ¨æ€æ‰©å±•å…¶å†…å­˜ï¼Œæ‰©å±•å¤±è´¥ä¼šæŠ›å‡º \u003ccode\u003eOutOfMemoryError\u003c/code\u003e å¼‚å¸¸ã€‚\u003c/p\u003e\n\u003cp\u003eğŸ’¡ æç¤ºï¼šå¯ä»¥é€šè¿‡ \u003ccode\u003e-Xms\u003c/code\u003e å’Œ \u003ccode\u003e-Xmx\u003c/code\u003e ä¸¤ä¸ªè™šæ‹Ÿæœºå‚æ•°æ¥æŒ‡å®šä¸€ä¸ªç¨‹åºçš„ Java å †å†…å­˜å¤§å°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°è®¾ç½®åˆå§‹å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°è®¾ç½®æœ€å¤§å€¼ã€‚\u003c/p\u003e\n\u003cfigure class=\"highlight java\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003ejava -Xms=1M -Xmx=2M HackTheJava\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"æ–¹æ³•åŒº\"\u003e\u003ca href=\"#æ–¹æ³•åŒº\" class=\"headerlink\" title=\"æ–¹æ³•åŒº\"\u003e\u003c/a\u003eæ–¹æ³•åŒº\u003c/h3\u003e\u003cp\u003eæ–¹æ³•åŒºï¼ˆMethod Areaï¼‰ä¹Ÿè¢«ç§°ä¸ºæ°¸ä¹…ä»£ã€‚\u003cstrong\u003eæ–¹æ³•åŒºç”¨äºå­˜æ”¾å·²è¢«åŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cp\u003eå¯¹è¿™å—åŒºåŸŸè¿›è¡Œåƒåœ¾å›æ”¶çš„ä¸»è¦ç›®æ ‡æ˜¯å¯¹å¸¸é‡æ± çš„å›æ”¶å’Œå¯¹ç±»çš„å¸è½½ï¼Œä½†æ˜¯ä¸€èˆ¬æ¯”è¾ƒéš¾å®ç°ã€‚\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eğŸ”” æ³¨æ„ï¼šå’Œ Java å †ä¸€æ ·ä¸éœ€è¦è¿ç»­çš„å†…å­˜ï¼Œå¹¶ä¸”å¯ä»¥åŠ¨æ€æ‰©å±•ï¼ŒåŠ¨æ€æ‰©å±•å¤±è´¥ä¸€æ ·ä¼šæŠ›å‡º \u003ccode\u003eOutOfMemoryError\u003c/code\u003e å¼‚å¸¸ã€‚\u003c/p\u003e\n\u003cp\u003eğŸ’¡ æç¤ºï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eJDK 1.7 ä¹‹å‰ï¼ŒHotSpot è™šæ‹ŸæœºæŠŠå®ƒå½“æˆæ°¸ä¹…ä»£æ¥è¿›è¡Œåƒåœ¾å›æ”¶ã€‚å¯é€šè¿‡å‚æ•° \u003ccode\u003e-XX:PermSize\u003c/code\u003e å’Œ \u003ccode\u003e-XX:MaxPermSize\u003c/code\u003e è®¾ç½®ã€‚\u003c/li\u003e\n\u003cli\u003eJDK 1.8 ä¹‹åï¼Œå–æ¶ˆäº†æ°¸ä¹…ä»£ï¼Œç”¨ **\u003ccode\u003emetaspaceï¼ˆå…ƒæ•°æ®ï¼‰\u003c/code\u003e**åŒºæ›¿ä»£ã€‚å¯é€šè¿‡å‚æ•° \u003ccode\u003e-XX:MaxMetaspaceSize\u003c/code\u003e è®¾ç½®ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"è¿è¡Œæ—¶å¸¸é‡æ± \"\u003e\u003ca href=\"#è¿è¡Œæ—¶å¸¸é‡æ± \" class=\"headerlink\" title=\"è¿è¡Œæ—¶å¸¸é‡æ± \"\u003e\u003c/a\u003eè¿è¡Œæ—¶å¸¸é‡æ± \u003c/h3\u003e\u003cp\u003e\u003cstrong\u003e\u003ccode\u003eè¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰\u003c/code\u003e æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†\u003c/strong\u003eï¼ŒClass æ–‡ä»¶ä¸­é™¤äº†æœ‰ç±»çš„ç‰ˆæœ¬ã€å­—æ®µã€æ–¹æ³•ã€æ¥å£ç­‰æè¿°ä¿¡æ¯ï¼Œè¿˜æœ‰ä¸€é¡¹ä¿¡æ¯æ˜¯å¸¸é‡æ± ï¼ˆConstant Pool Tableï¼‰ï¼Œ\u003cstrong\u003eç”¨äºå­˜æ”¾ç¼–è¯‘å™¨ç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨\u003c/strong\u003eï¼Œè¿™éƒ¨åˆ†å†…å®¹ä¼šåœ¨ç±»åŠ è½½åè¢«æ”¾å…¥è¿™ä¸ªåŒºåŸŸã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eå­—é¢é‡\u003c/strong\u003e - æ–‡æœ¬å­—ç¬¦ä¸²ã€å£°æ˜ä¸º \u003ccode\u003efinal\u003c/code\u003e çš„å¸¸é‡å€¼ç­‰ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eç¬¦å·å¼•ç”¨\u003c/strong\u003e - ç±»å’Œæ¥å£çš„å®Œå…¨é™å®šåï¼ˆFully Qualified Nameï¼‰ã€å­—æ®µçš„åç§°å’Œæè¿°ç¬¦ï¼ˆDescriptorï¼‰ã€æ–¹æ³•çš„åç§°å’Œæè¿°ç¬¦ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eé™¤äº†åœ¨ç¼–è¯‘æœŸç”Ÿæˆçš„å¸¸é‡ï¼Œè¿˜å…è®¸åŠ¨æ€ç”Ÿæˆï¼Œä¾‹å¦‚ \u003ccode\u003eString\u003c/code\u003e ç±»çš„ \u003ccode\u003eintern()\u003c/code\u003eã€‚è¿™éƒ¨åˆ†å¸¸é‡ä¹Ÿä¼šè¢«æ”¾å…¥è¿è¡Œæ—¶å¸¸é‡æ± ã€‚\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eğŸ”” æ³¨æ„ï¼šå½“å¸¸é‡æ± æ— æ³•å†ç”³è¯·åˆ°å†…å­˜æ—¶ä¼šæŠ›å‡º \u003ccode\u003eOutOfMemoryError\u003c/code\u003e å¼‚å¸¸ã€‚\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"ç›´æ¥å†…å­˜\"\u003e\u003ca href=\"#ç›´æ¥å†…å­˜\" class=\"headerlink\" title=\"ç›´æ¥å†…å­˜\"\u003e\u003c/a\u003eç›´æ¥å†…å­˜\u003c/h3\u003e\u003cp\u003eç›´æ¥å†…å­˜ï¼ˆDirect Memoryï¼‰å¹¶ä¸æ˜¯è™šæ‹Ÿæœºè¿è¡Œæ—¶æ•°æ®åŒºçš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿä¸æ˜¯ JVM è§„èŒƒä¸­å®šä¹‰çš„å†…å­˜åŒºåŸŸã€‚\u003c/p\u003e\n\u003cp\u003eåœ¨ JDK 1.4 ä¸­æ–°åŠ å…¥äº† NIO ç±»ï¼Œå®ƒå¯ä»¥ä½¿ç”¨ Native å‡½æ•°åº“ç›´æ¥åˆ†é…å †å¤–å†…å­˜ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªå­˜å‚¨åœ¨ Java å †é‡Œçš„ \u003ccode\u003eDirectByteBuffer\u003c/code\u003e å¯¹è±¡ä½œä¸ºè¿™å—å†…å­˜çš„å¼•ç”¨è¿›è¡Œæ“ä½œã€‚è¿™æ ·èƒ½åœ¨ä¸€äº›åœºæ™¯ä¸­æ˜¾è‘—æé«˜æ€§èƒ½ï¼Œå› ä¸ºé¿å…äº†åœ¨ Java å †å’Œ Native å †ä¸­æ¥å›å¤åˆ¶æ•°æ®ã€‚\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eğŸ”” æ³¨æ„ï¼šç›´æ¥å†…å­˜è¿™éƒ¨åˆ†ä¹Ÿè¢«é¢‘ç¹çš„ä½¿ç”¨ï¼Œä¸”ä¹Ÿå¯èƒ½å¯¼è‡´ \u003ccode\u003eOutOfMemoryError\u003c/code\u003e å¼‚å¸¸ã€‚\u003c/p\u003e\n\u003cp\u003eğŸ’¡ æç¤ºï¼šç›´æ¥å†…å­˜å®¹é‡å¯é€šè¿‡ \u003ccode\u003e-XX:MaxDirectMemorySize\u003c/code\u003e æŒ‡å®šï¼Œå¦‚æœä¸æŒ‡å®šï¼Œåˆ™é»˜è®¤ä¸ Java å †æœ€å¤§å€¼ï¼ˆ\u003ccode\u003e-Xmx\u003c/code\u003e æŒ‡å®šï¼‰ä¸€æ ·ã€‚\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"Java-å†…å­˜åŒºåŸŸå¯¹æ¯”\"\u003e\u003ca href=\"#Java-å†…å­˜åŒºåŸŸå¯¹æ¯”\" class=\"headerlink\" title=\"Java å†…å­˜åŒºåŸŸå¯¹æ¯”\"\u003e\u003c/a\u003eJava å†…å­˜åŒºåŸŸå¯¹æ¯”\u003c/h3\u003e\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eå†…å­˜åŒºåŸŸ\u003c/th\u003e\n\u003cth\u003eå†…å­˜ä½œç”¨èŒƒå›´\u003c/th\u003e\n\u003cth\u003eå¼‚å¸¸\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\u003ctr\u003e\n\u003ctd\u003eç¨‹åºè®¡æ•°å™¨\u003c/td\u003e\n\u003ctd\u003eçº¿ç¨‹ç§æœ‰\u003c/td\u003e\n\u003ctd\u003eæ— \u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eJava è™šæ‹Ÿæœºæ ˆ\u003c/td\u003e\n\u003ctd\u003eçº¿ç¨‹ç§æœ‰\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003eStackOverflowError\u003c/code\u003e å’Œ \u003ccode\u003eOutOfMemoryError\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eæœ¬åœ°æ–¹æ³•æ ˆ\u003c/td\u003e\n\u003ctd\u003eçº¿ç¨‹ç§æœ‰\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003eStackOverflowError\u003c/code\u003e å’Œ \u003ccode\u003eOutOfMemoryError\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eJava å †\u003c/td\u003e\n\u003ctd\u003eçº¿ç¨‹å…±äº«\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003eOutOfMemoryError\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eæ–¹æ³•åŒº\u003c/td\u003e\n\u003ctd\u003eçº¿ç¨‹å…±äº«\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003eOutOfMemoryError\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eè¿è¡Œæ—¶å¸¸é‡æ± \u003c/td\u003e\n\u003ctd\u003eçº¿ç¨‹å…±äº«\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003eOutOfMemoryError\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eç›´æ¥å†…å­˜\u003c/td\u003e\n\u003ctd\u003eéè¿è¡Œæ—¶æ•°æ®åŒº\u003c/td\u003e\n\u003ctd\u003e\u003ccode\u003eOutOfMemoryError\u003c/code\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\u003c/table\u003e\n\u003ch2 id=\"JVM-è¿è¡ŒåŸç†\"\u003e\u003ca href=\"#JVM-è¿è¡ŒåŸç†\" class=\"headerlink\" title=\"JVM è¿è¡ŒåŸç†\"\u003e\u003c/a\u003eJVM è¿è¡ŒåŸç†\u003c/h2\u003e\u003cfigure class=\"highlight java\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e26\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e27\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e28\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e29\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e30\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e31\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e32\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e33\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e34\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e35\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e36\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e37\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e38\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e39\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e40\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e41\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e42\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e43\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e44\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e45\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e46\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e47\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e48\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e49\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e50\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e51\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e52\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e53\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e54\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e55\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e56\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e57\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e58\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e59\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e60\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e61\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"title class_\"\u003eJVMCase\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\u003cspan class=\"comment\"\u003e// å¸¸é‡\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003efinal\u003c/span\u003e \u003cspan class=\"keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"type\"\u003eString\u003c/span\u003e \u003cspan class=\"variable\"\u003eMAN_SEX_TYPE\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;man\u0026#34;\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\u003cspan class=\"comment\"\u003e// é™æ€å˜é‡\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"type\"\u003eString\u003c/span\u003e \u003cspan class=\"variable\"\u003eWOMAN_SEX_TYPE\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;woman\u0026#34;\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003emain\u003c/span\u003e\u003cspan class=\"params\"\u003e(String[] args)\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\t\u003cspan class=\"type\"\u003eStudent\u003c/span\u003e \u003cspan class=\"variable\"\u003estu\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e \u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eStudent\u003c/span\u003e();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\tstu.setName(\u003cspan class=\"string\"\u003e\u0026#34;nick\u0026#34;\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\tstu.setSexType(MAN_SEX_TYPE);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\tstu.setAge(\u003cspan class=\"number\"\u003e20\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\t\u003cspan class=\"type\"\u003eJVMCase\u003c/span\u003e \u003cspan class=\"variable\"\u003ejvmcase\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e \u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eJVMCase\u003c/span\u003e();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\t\u003cspan class=\"comment\"\u003e// è°ƒç”¨é™æ€æ–¹æ³•\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\tprint(stu);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\t\u003cspan class=\"comment\"\u003e// è°ƒç”¨éé™æ€æ–¹æ³•\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\tjvmcase.sayHello(stu);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\u003cspan class=\"comment\"\u003e// å¸¸è§„é™æ€æ–¹æ³•\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003eprint\u003c/span\u003e\u003cspan class=\"params\"\u003e(Student stu)\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\tSystem.out.println(\u003cspan class=\"string\"\u003e\u0026#34;name: \u0026#34;\u003c/span\u003e + stu.getName() + \u003cspan class=\"string\"\u003e\u0026#34;; sex:\u0026#34;\u003c/span\u003e + stu.getSexType() + \u003cspan class=\"string\"\u003e\u0026#34;; age:\u0026#34;\u003c/span\u003e + stu.getAge());\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\u003cspan class=\"comment\"\u003e// éé™æ€æ–¹æ³•\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003esayHello\u003c/span\u003e\u003cspan class=\"params\"\u003e(Student stu)\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\tSystem.out.println(stu.getName() + \u003cspan class=\"string\"\u003e\u0026#34;say: hello\u0026#34;\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"title class_\"\u003eStudent\u003c/span\u003e{\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\tString name;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\tString sexType;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\u003cspan class=\"type\"\u003eint\u003c/span\u003e age;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e String \u003cspan class=\"title function_\"\u003egetName\u003c/span\u003e\u003cspan class=\"params\"\u003e()\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\t\u003cspan class=\"keyword\"\u003ereturn\u003c/span\u003e name;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003esetName\u003c/span\u003e\u003cspan class=\"params\"\u003e(String name)\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\t\u003cspan class=\"built_in\"\u003ethis\u003c/span\u003e.name = name;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e String \u003cspan class=\"title function_\"\u003egetSexType\u003c/span\u003e\u003cspan class=\"params\"\u003e()\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\t\u003cspan class=\"keyword\"\u003ereturn\u003c/span\u003e sexType;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003esetSexType\u003c/span\u003e\u003cspan class=\"params\"\u003e(String sexType)\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\t\u003cspan class=\"built_in\"\u003ethis\u003c/span\u003e.sexType = sexType;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"type\"\u003eint\u003c/span\u003e \u003cspan class=\"title function_\"\u003egetAge\u003c/span\u003e\u003cspan class=\"params\"\u003e()\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\t\u003cspan class=\"keyword\"\u003ereturn\u003c/span\u003e age;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003esetAge\u003c/span\u003e\u003cspan class=\"params\"\u003e(\u003cspan class=\"type\"\u003eint\u003c/span\u003e age)\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t\t\u003cspan class=\"built_in\"\u003ethis\u003c/span\u003e.age = age;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\t}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003eè¿è¡Œä»¥ä¸Šä»£ç æ—¶ï¼ŒJVM å¤„ç†è¿‡ç¨‹å¦‚ä¸‹ï¼š\u003c/p\u003e\n\u003cp\u003eï¼ˆ1ï¼‰JVM å‘æ“ä½œç³»ç»Ÿç”³è¯·å†…å­˜ï¼ŒJVM ç¬¬ä¸€æ­¥å°±æ˜¯é€šè¿‡é…ç½®å‚æ•°æˆ–è€…é»˜è®¤é…ç½®å‚æ•°å‘æ“ä½œç³»ç»Ÿç”³è¯·å†…å­˜ç©ºé—´ï¼Œæ ¹æ®å†…å­˜å¤§å°æ‰¾åˆ°å…·ä½“çš„å†…å­˜åˆ†é…è¡¨ï¼Œç„¶åæŠŠå†…å­˜æ®µçš„èµ·å§‹åœ°å€å’Œç»ˆæ­¢åœ°å€åˆ†é…ç»™ JVMï¼Œæ¥ä¸‹æ¥ JVM å°±è¿›è¡Œå†…éƒ¨åˆ†é…ã€‚\u003c/p\u003e\n\u003cp\u003eï¼ˆ2ï¼‰JVM è·å¾—å†…å­˜ç©ºé—´åï¼Œä¼šæ ¹æ®é…ç½®å‚æ•°åˆ†é…å †ã€æ ˆä»¥åŠæ–¹æ³•åŒºçš„å†…å­˜å¤§å°ã€‚\u003c/p\u003e\n\u003cp\u003eï¼ˆ3ï¼‰class æ–‡ä»¶åŠ è½½ã€éªŒè¯ã€å‡†å¤‡ä»¥åŠè§£æï¼Œå…¶ä¸­å‡†å¤‡é˜¶æ®µä¼šä¸ºç±»çš„é™æ€å˜é‡åˆ†é…å†…å­˜ï¼Œåˆå§‹åŒ–ä¸ºç³»ç»Ÿçš„åˆå§‹å€¼ï¼ˆè¿™éƒ¨åˆ†æˆ‘åœ¨ç¬¬ 21 è®²è¿˜ä¼šè¯¦ç»†ä»‹ç»ï¼‰ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/snap/20200630094250.png\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003cp\u003eï¼ˆ4ï¼‰å®Œæˆä¸Šä¸€ä¸ªæ­¥éª¤åï¼Œå°†ä¼šè¿›è¡Œæœ€åä¸€ä¸ªåˆå§‹åŒ–é˜¶æ®µã€‚åœ¨è¿™ä¸ªé˜¶æ®µä¸­ï¼ŒJVM é¦–å…ˆä¼šæ‰§è¡Œæ„é€ å™¨ \u003ccode\u003e\u0026lt;clinit\u0026gt;\u003c/code\u003e æ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¼šåœ¨ \u003ccode\u003e.java\u003c/code\u003e æ–‡ä»¶è¢«ç¼–è¯‘æˆ \u003ccode\u003e.class\u003c/code\u003e æ–‡ä»¶æ—¶ï¼Œæ”¶é›†æ‰€æœ‰ç±»çš„åˆå§‹åŒ–ä»£ç ï¼ŒåŒ…æ‹¬é™æ€å˜é‡èµ‹å€¼è¯­å¥ã€é™æ€ä»£ç å—ã€é™æ€æ–¹æ³•ï¼Œæ”¶é›†åœ¨ä¸€èµ·æˆä¸º \u003ccode\u003e\u0026lt;clinit\u0026gt;()\u003c/code\u003e æ–¹æ³•ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/snap/20200630094329.png\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003cp\u003eï¼ˆ5ï¼‰æ‰§è¡Œæ–¹æ³•ã€‚å¯åŠ¨ main çº¿ç¨‹ï¼Œæ‰§è¡Œ main æ–¹æ³•ï¼Œå¼€å§‹æ‰§è¡Œç¬¬ä¸€è¡Œä»£ç ã€‚æ­¤æ—¶å †å†…å­˜ä¸­ä¼šåˆ›å»ºä¸€ä¸ª student å¯¹è±¡ï¼Œå¯¹è±¡å¼•ç”¨ student å°±å­˜æ”¾åœ¨æ ˆä¸­ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/snap/20200630094651.png\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003cp\u003eï¼ˆ6ï¼‰æ­¤æ—¶å†æ¬¡åˆ›å»ºä¸€ä¸ª JVMCase å¯¹è±¡ï¼Œè°ƒç”¨ sayHello éé™æ€æ–¹æ³•ï¼ŒsayHello æ–¹æ³•å±äºå¯¹è±¡ JVMCaseï¼Œæ­¤æ—¶ sayHello æ–¹æ³•å…¥æ ˆï¼Œå¹¶é€šè¿‡æ ˆä¸­çš„ student å¼•ç”¨è°ƒç”¨å †ä¸­çš„ Student å¯¹è±¡ï¼›ä¹‹åï¼Œè°ƒç”¨é™æ€æ–¹æ³• printï¼Œprint é™æ€æ–¹æ³•å±äº JVMCase ç±»ï¼Œæ˜¯ä»é™æ€æ–¹æ³•ä¸­è·å–ï¼Œä¹‹åæ”¾å…¥åˆ°æ ˆä¸­ï¼Œä¹Ÿæ˜¯é€šè¿‡ student å¼•ç”¨è°ƒç”¨å †ä¸­çš„ student å¯¹è±¡ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/snap/20200630094714.png\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003ch2 id=\"OutOfMemoryError\"\u003e\u003ca href=\"#OutOfMemoryError\" class=\"headerlink\" title=\"OutOfMemoryError\"\u003e\u003c/a\u003eOutOfMemoryError\u003c/h2\u003e\u003ch3 id=\"ä»€ä¹ˆæ˜¯-OutOfMemoryError\"\u003e\u003ca href=\"#ä»€ä¹ˆæ˜¯-OutOfMemoryError\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ OutOfMemoryError\"\u003e\u003c/a\u003eä»€ä¹ˆæ˜¯ OutOfMemoryError\u003c/h3\u003e\u003cp\u003e\u003ccode\u003eOutOfMemoryError\u003c/code\u003e ç®€ç§°ä¸º OOMã€‚Java ä¸­å¯¹ OOM çš„è§£é‡Šæ˜¯ï¼Œæ²¡æœ‰ç©ºé—²å†…å­˜ï¼Œå¹¶ä¸”åƒåœ¾æ”¶é›†å™¨ä¹Ÿæ— æ³•æä¾›æ›´å¤šå†…å­˜ã€‚é€šä¿—çš„è§£é‡Šæ˜¯ï¼šJVM å†…å­˜ä¸è¶³äº†ã€‚\u003c/p\u003e\n\u003cp\u003eåœ¨ JVM è§„èŒƒä¸­ï¼Œ\u003cstrong\u003eé™¤äº†ç¨‹åºè®¡æ•°å™¨åŒºåŸŸå¤–ï¼Œå…¶ä»–è¿è¡Œæ—¶åŒºåŸŸéƒ½å¯èƒ½å‘ç”Ÿ \u003ccode\u003eOutOfMemoryError\u003c/code\u003e å¼‚å¸¸ï¼ˆç®€ç§° OOMï¼‰\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cp\u003eä¸‹é¢é€ä¸€ä»‹ç» OOM å‘ç”Ÿåœºæ™¯ã€‚\u003c/p\u003e\n\u003ch3 id=\"å †ç©ºé—´æº¢å‡º\"\u003e\u003ca href=\"#å †ç©ºé—´æº¢å‡º\" class=\"headerlink\" title=\"å †ç©ºé—´æº¢å‡º\"\u003e\u003c/a\u003eå †ç©ºé—´æº¢å‡º\u003c/h3\u003e\u003cp\u003e\u003ccode\u003ejava.lang.OutOfMemoryError: Java heap space\u003c/code\u003e è¿™ä¸ªé”™è¯¯æ„å‘³ç€ï¼š\u003cstrong\u003eå †ç©ºé—´æº¢å‡º\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cp\u003eæ›´ç»†è‡´çš„è¯´æ³•æ˜¯ï¼šJava å †å†…å­˜å·²ç»è¾¾åˆ° \u003ccode\u003e-Xmx\u003c/code\u003e è®¾ç½®çš„æœ€å¤§å€¼ã€‚Java å †ç”¨äºå­˜å‚¨å¯¹è±¡å®ä¾‹ï¼Œåªè¦ä¸æ–­åœ°åˆ›å»ºå¯¹è±¡ï¼Œå¹¶ä¸”ä¿è¯ GC Roots åˆ°å¯¹è±¡ä¹‹é—´æœ‰å¯è¾¾è·¯å¾„æ¥é¿å…åƒåœ¾æ”¶é›†å™¨å›æ”¶è¿™äº›å¯¹è±¡ï¼Œé‚£ä¹ˆå½“å †ç©ºé—´åˆ°è¾¾æœ€å¤§å®¹é‡é™åˆ¶åå°±ä¼šäº§ç”Ÿ OOMã€‚\u003c/p\u003e\n\u003cp\u003eå †ç©ºé—´æº¢å‡ºæœ‰å¯èƒ½æ˜¯**\u003ccode\u003eå†…å­˜æ³„æ¼ï¼ˆMemory Leakï¼‰\u003c/code\u003e** æˆ– \u003cstrong\u003e\u003ccode\u003eå†…å­˜æº¢å‡ºï¼ˆMemory Overflowï¼‰\u003c/code\u003e\u003c/strong\u003e ã€‚éœ€è¦ä½¿ç”¨ jstack å’Œ jmap ç”Ÿæˆ threaddump å’Œ heapdumpï¼Œç„¶åç”¨å†…å­˜åˆ†æå·¥å…·ï¼ˆå¦‚ï¼šMATï¼‰è¿›è¡Œåˆ†æã€‚\u003c/p\u003e\n\u003ch4 id=\"Java-heap-space-åˆ†ææ­¥éª¤\"\u003e\u003ca href=\"#Java-heap-space-åˆ†ææ­¥éª¤\" class=\"headerlink\" title=\"Java heap space åˆ†ææ­¥éª¤\"\u003e\u003c/a\u003eJava heap space åˆ†ææ­¥éª¤\u003c/h4\u003e\u003col\u003e\n\u003cli\u003eä½¿ç”¨ \u003ccode\u003ejmap\u003c/code\u003e æˆ– \u003ccode\u003e-XX:+HeapDumpOnOutOfMemoryError\u003c/code\u003e è·å–å †å¿«ç…§ã€‚\u003c/li\u003e\n\u003cli\u003eä½¿ç”¨å†…å­˜åˆ†æå·¥å…·ï¼ˆvisualvmã€matã€jProfile ç­‰ï¼‰å¯¹å †å¿«ç…§æ–‡ä»¶è¿›è¡Œåˆ†æã€‚\u003c/li\u003e\n\u003cli\u003eæ ¹æ®åˆ†æå›¾ï¼Œé‡ç‚¹æ˜¯ç¡®è®¤å†…å­˜ä¸­çš„å¯¹è±¡æ˜¯å¦æ˜¯å¿…è¦çš„ï¼Œåˆ†æ¸…ç©¶ç«Ÿæ˜¯æ˜¯å†…å­˜æ³„æ¼ï¼ˆMemory Leakï¼‰è¿˜æ˜¯å†…å­˜æº¢å‡ºï¼ˆMemory Overflowï¼‰ã€‚\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch4 id=\"å†…å­˜æ³„æ¼\"\u003e\u003ca href=\"#å†…å­˜æ³„æ¼\" class=\"headerlink\" title=\"å†…å­˜æ³„æ¼\"\u003e\u003c/a\u003eå†…å­˜æ³„æ¼\u003c/h4\u003e\u003cp\u003e\u003cstrong\u003eå†…å­˜æ³„æ¼æ˜¯æŒ‡ç”±äºç–å¿½æˆ–é”™è¯¯é€ æˆç¨‹åºæœªèƒ½é‡Šæ”¾å·²ç»ä¸å†ä½¿ç”¨çš„å†…å­˜çš„æƒ…å†µ\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cp\u003eå†…å­˜æ³„æ¼å¹¶éæŒ‡å†…å­˜åœ¨ç‰©ç†ä¸Šçš„æ¶ˆå¤±ï¼Œè€Œæ˜¯åº”ç”¨ç¨‹åºåˆ†é…æŸæ®µå†…å­˜åï¼Œç”±äºè®¾è®¡é”™è¯¯ï¼Œå¤±å»äº†å¯¹è¯¥æ®µå†…å­˜çš„æ§åˆ¶ï¼Œå› è€Œé€ æˆäº†å†…å­˜çš„æµªè´¹ã€‚å†…å­˜æ³„æ¼éšç€è¢«æ‰§è¡Œçš„æ¬¡æ•°ä¸æ–­å¢åŠ ï¼Œæœ€ç»ˆä¼šå¯¼è‡´å†…å­˜æº¢å‡ºã€‚\u003c/p\u003e\n\u003cp\u003eå†…å­˜æ³„æ¼å¸¸è§åœºæ™¯ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eé™æ€å®¹å™¨\u003cul\u003e\n\u003cli\u003eå£°æ˜ä¸ºé™æ€ï¼ˆ\u003ccode\u003estatic\u003c/code\u003eï¼‰çš„ \u003ccode\u003eHashMap\u003c/code\u003eã€\u003ccode\u003eVector\u003c/code\u003e ç­‰é›†åˆ\u003c/li\u003e\n\u003cli\u003eé€šä¿—æ¥è®² A ä¸­æœ‰ Bï¼Œå½“å‰åªæŠŠ B è®¾ç½®ä¸ºç©ºï¼ŒA æ²¡æœ‰è®¾ç½®ä¸ºç©ºï¼Œå›æ”¶æ—¶ B æ— æ³•å›æ”¶ã€‚å› ä¸ºè¢« A å¼•ç”¨ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eç›‘å¬å™¨\u003cul\u003e\n\u003cli\u003eç›‘å¬å™¨è¢«æ³¨å†Œåé‡Šæ”¾å¯¹è±¡æ—¶æ²¡æœ‰åˆ é™¤ç›‘å¬å™¨\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eç‰©ç†è¿æ¥\u003cul\u003e\n\u003cli\u003eå„ç§è¿æ¥æ± å»ºç«‹äº†è¿æ¥ï¼Œå¿…é¡»é€šè¿‡ \u003ccode\u003eclose()\u003c/code\u003e å…³é—­é“¾æ¥\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eå†…éƒ¨ç±»å’Œå¤–éƒ¨æ¨¡å—ç­‰çš„å¼•ç”¨\u003cul\u003e\n\u003cli\u003eå‘ç°å®ƒçš„æ–¹å¼åŒå†…å­˜æº¢å‡ºï¼Œå¯å†åŠ ä¸ªå®æ—¶è§‚å¯Ÿ\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ejstat -gcutil 7362 2500 70\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eé‡ç‚¹å…³æ³¨ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eFGC\u003c/code\u003e â€” ä»åº”ç”¨ç¨‹åºå¯åŠ¨åˆ°é‡‡æ ·æ—¶å‘ç”Ÿ Full GC çš„æ¬¡æ•°ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eFGCT\u003c/code\u003e â€” ä»åº”ç”¨ç¨‹åºå¯åŠ¨åˆ°é‡‡æ ·æ—¶ Full GC æ‰€ç”¨çš„æ—¶é—´ï¼ˆå•ä½ç§’ï¼‰ã€‚\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eFGC\u003c/code\u003e æ¬¡æ•°è¶Šå¤šï¼Œ\u003ccode\u003eFGCT\u003c/code\u003e æ‰€éœ€æ—¶é—´è¶Šå¤šï¼Œè¶Šæœ‰å¯èƒ½å­˜åœ¨å†…å­˜æ³„æ¼ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eå¦‚æœæ˜¯å†…å­˜æ³„æ¼ï¼Œå¯ä»¥è¿›ä¸€æ­¥æŸ¥çœ‹æ³„æ¼å¯¹è±¡åˆ° GC Roots çš„å¯¹è±¡å¼•ç”¨é“¾ã€‚è¿™æ ·å°±èƒ½æ‰¾åˆ°æ³„æ¼å¯¹è±¡æ˜¯æ€æ ·ä¸ GC Roots å…³è”å¹¶å¯¼è‡´ GC æ— æ³•å›æ”¶å®ƒä»¬çš„ã€‚æŒæ¡äº†è¿™äº›åŸå› ï¼Œå°±å¯ä»¥è¾ƒå‡†ç¡®çš„å®šä½å‡ºå¼•èµ·å†…å­˜æ³„æ¼çš„ä»£ç ã€‚\u003c/p\u003e\n\u003cp\u003eå¯¼è‡´å†…å­˜æ³„æ¼çš„å¸¸è§åŸå› æ˜¯ä½¿ç”¨å®¹å™¨ï¼Œä¸”ä¸æ–­å‘å®¹å™¨ä¸­æ·»åŠ å…ƒç´ ï¼Œä½†æ²¡æœ‰æ¸…ç†ï¼Œå¯¼è‡´å®¹å™¨å†…å­˜ä¸æ–­è†¨èƒ€ã€‚\u003c/p\u003e\n\u003cp\u003eã€ç¤ºä¾‹ã€‘\u003c/p\u003e\n\u003cfigure class=\"highlight java\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e/**\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * å†…å­˜æ³„æ¼ç¤ºä¾‹\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * é”™è¯¯ç°è±¡ï¼šjava.lang.OutOfMemoryError: Java heap space\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * VM Argsï¼š-verbose:gc -Xms10M -Xmx10M -XX:+HeapDumpOnOutOfMemoryError\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e */\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"title class_\"\u003eHeapOutOfMemoryDemo\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003emain\u003c/span\u003e\u003cspan class=\"params\"\u003e(String[] args)\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        List\u0026lt;OomObject\u0026gt; list = \u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eArrayList\u003c/span\u003e\u0026lt;\u0026gt;();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003ewhile\u003c/span\u003e (\u003cspan class=\"literal\"\u003etrue\u003c/span\u003e) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            list.add(\u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eOomObject\u003c/span\u003e());\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"title class_\"\u003eOomObject\u003c/span\u003e {}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch4 id=\"å†…å­˜æº¢å‡º\"\u003e\u003ca href=\"#å†…å­˜æº¢å‡º\" class=\"headerlink\" title=\"å†…å­˜æº¢å‡º\"\u003e\u003c/a\u003eå†…å­˜æº¢å‡º\u003c/h4\u003e\u003cp\u003eå¦‚æœä¸å­˜åœ¨å†…å­˜æ³„æ¼ï¼Œå³å†…å­˜ä¸­çš„å¯¹è±¡ç¡®å®éƒ½å¿…é¡»å­˜æ´»ç€ï¼Œåˆ™åº”å½“æ£€æŸ¥è™šæ‹Ÿæœºçš„å †å‚æ•°ï¼ˆ\u003ccode\u003e-Xmx\u003c/code\u003e å’Œ \u003ccode\u003e-Xms\u003c/code\u003eï¼‰ï¼Œä¸æœºå™¨ç‰©ç†å†…å­˜è¿›è¡Œå¯¹æ¯”ï¼Œçœ‹çœ‹æ˜¯å¦å¯ä»¥è°ƒå¤§ã€‚å¹¶ä»ä»£ç ä¸Šæ£€æŸ¥æ˜¯å¦å­˜åœ¨æŸäº›å¯¹è±¡ç”Ÿå‘½å‘¨æœŸè¿‡é•¿ã€æŒæœ‰æ—¶é—´è¿‡é•¿çš„æƒ…å†µï¼Œå°è¯•å‡å°‘ç¨‹åºè¿è¡ŒæœŸçš„å†…å­˜æ¶ˆè€—ã€‚\u003c/p\u003e\n\u003cp\u003eã€ç¤ºä¾‹ã€‘\u003c/p\u003e\n\u003cfigure class=\"highlight java\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e/**\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * å †æº¢å‡ºç¤ºä¾‹\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * \u0026lt;p\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * é”™è¯¯ç°è±¡ï¼šjava.lang.OutOfMemoryError: Java heap space\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * \u0026lt;p\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * VM Argsï¼š-verbose:gc -Xms10M -Xmx10M\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e *\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * \u003cspan class=\"doctag\"\u003e@author\u003c/span\u003e \u0026lt;a href=\u0026#34;mailto:forbreak@163.com\u0026#34;\u0026gt;Zhang Peng\u0026lt;/a\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * \u003cspan class=\"doctag\"\u003e@since\u003c/span\u003e 2019-06-25\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e */\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"title class_\"\u003eHeapOutOfMemoryDemo\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003emain\u003c/span\u003e\u003cspan class=\"params\"\u003e(String[] args)\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        Double[] array = \u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eDouble\u003c/span\u003e[\u003cspan class=\"number\"\u003e999999999\u003c/span\u003e];\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        System.out.println(\u003cspan class=\"string\"\u003e\u0026#34;array length = [\u0026#34;\u003c/span\u003e + array.length + \u003cspan class=\"string\"\u003e\u0026#34;]\u0026#34;\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003eæ‰§è¡Œ \u003ccode\u003ejava -verbose:gc -Xms10M -Xmx10M -XX:+HeapDumpOnOutOfMemoryError io.github.dunwu.javacore.jvm.memory.HeapMemoryLeakMemoryErrorDemo\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eä¸Šé¢çš„ä¾‹å­æ˜¯ä¸€ä¸ªæç«¯çš„ä¾‹å­ï¼Œè¯•å›¾åˆ›å»ºä¸€ä¸ªç»´åº¦å¾ˆå¤§çš„æ•°ç»„ï¼Œå †å†…å­˜æ— æ³•åˆ†é…è¿™ä¹ˆå¤§çš„å†…å­˜ï¼Œä»è€ŒæŠ¥é”™ï¼š\u003ccode\u003eJava heap space\u003c/code\u003eã€‚\u003c/p\u003e\n\u003cp\u003eä½†å¦‚æœåœ¨ç°å®ä¸­ï¼Œä»£ç å¹¶æ²¡æœ‰é—®é¢˜ï¼Œä»…ä»…æ˜¯å› ä¸ºå †å†…å­˜ä¸è¶³ï¼Œå¯ä»¥é€šè¿‡ \u003ccode\u003e-Xms\u003c/code\u003e å’Œ \u003ccode\u003e-Xmx\u003c/code\u003e é€‚å½“è°ƒæ•´å †å†…å­˜å¤§å°ã€‚\u003c/p\u003e\n\u003ch3 id=\"GC-å¼€é”€è¶…è¿‡é™åˆ¶\"\u003e\u003ca href=\"#GC-å¼€é”€è¶…è¿‡é™åˆ¶\" class=\"headerlink\" title=\"GC å¼€é”€è¶…è¿‡é™åˆ¶\"\u003e\u003c/a\u003eGC å¼€é”€è¶…è¿‡é™åˆ¶\u003c/h3\u003e\u003cp\u003e\u003ccode\u003ejava.lang.OutOfMemoryError: GC overhead limit exceeded\u003c/code\u003e è¿™ä¸ªé”™è¯¯ï¼Œå®˜æ–¹ç»™å‡ºçš„å®šä¹‰æ˜¯ï¼š\u003cstrong\u003eè¶…è¿‡ \u003ccode\u003e98%\u003c/code\u003e çš„æ—¶é—´ç”¨æ¥åš GC å¹¶ä¸”å›æ”¶äº†ä¸åˆ° \u003ccode\u003e2%\u003c/code\u003e çš„å †å†…å­˜æ—¶ä¼šæŠ›å‡ºæ­¤å¼‚å¸¸\u003c/strong\u003eã€‚è¿™æ„å‘³ç€ï¼Œå‘ç”Ÿåœ¨ GC å ç”¨å¤§é‡æ—¶é—´ä¸ºé‡Šæ”¾å¾ˆå°ç©ºé—´çš„æ—¶å€™å‘ç”Ÿçš„ï¼Œæ˜¯ä¸€ç§ä¿æŠ¤æœºåˆ¶ã€‚å¯¼è‡´å¼‚å¸¸çš„åŸå› ï¼šä¸€èˆ¬æ˜¯å› ä¸ºå †å¤ªå°ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜ã€‚\u003c/p\u003e\n\u003cp\u003eã€ç¤ºä¾‹ã€‘\u003c/p\u003e\n\u003cfigure class=\"highlight java\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e/**\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * GC overhead limit exceeded ç¤ºä¾‹\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * é”™è¯¯ç°è±¡ï¼šjava.lang.OutOfMemoryError: GC overhead limit exceeded\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * å‘ç”Ÿåœ¨GCå ç”¨å¤§é‡æ—¶é—´ä¸ºé‡Šæ”¾å¾ˆå°ç©ºé—´çš„æ—¶å€™å‘ç”Ÿçš„ï¼Œæ˜¯ä¸€ç§ä¿æŠ¤æœºåˆ¶ã€‚å¯¼è‡´å¼‚å¸¸çš„åŸå› ï¼šä¸€èˆ¬æ˜¯å› ä¸ºå †å¤ªå°ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜ã€‚\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * å®˜æ–¹å¯¹æ­¤çš„å®šä¹‰ï¼šè¶…è¿‡98%çš„æ—¶é—´ç”¨æ¥åšGCå¹¶ä¸”å›æ”¶äº†ä¸åˆ°2%çš„å †å†…å­˜æ—¶ä¼šæŠ›å‡ºæ­¤å¼‚å¸¸ã€‚\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * VM Args: -Xms10M -Xmx10M\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e */\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"title class_\"\u003eGcOverheadLimitExceededDemo\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003emain\u003c/span\u003e\u003cspan class=\"params\"\u003e(String[] args)\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        List\u0026lt;Double\u0026gt; list = \u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eArrayList\u003c/span\u003e\u0026lt;\u0026gt;();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"type\"\u003edouble\u003c/span\u003e \u003cspan class=\"variable\"\u003ed\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e \u003cspan class=\"number\"\u003e0.0\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003ewhile\u003c/span\u003e (\u003cspan class=\"literal\"\u003etrue\u003c/span\u003e) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            list.add(d++);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003eã€å¤„ç†ã€‘\u003c/p\u003e\n\u003cp\u003eä¸ \u003cstrong\u003eJava heap space\u003c/strong\u003e é”™è¯¯å¤„ç†æ–¹æ³•ç±»ä¼¼ï¼Œå…ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨å†…å­˜æ³„æ¼ã€‚å¦‚æœæœ‰ï¼Œåˆ™ä¿®æ­£ä»£ç ï¼›å¦‚æœæ²¡æœ‰ï¼Œåˆ™é€šè¿‡ \u003ccode\u003e-Xms\u003c/code\u003e å’Œ \u003ccode\u003e-Xmx\u003c/code\u003e é€‚å½“è°ƒæ•´å †å†…å­˜å¤§å°ã€‚\u003c/p\u003e\n\u003ch3 id=\"æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³\"\u003e\u003ca href=\"#æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³\" class=\"headerlink\" title=\"æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³\"\u003e\u003c/a\u003eæ°¸ä¹…ä»£ç©ºé—´ä¸è¶³\u003c/h3\u003e\u003cp\u003eã€é”™è¯¯ã€‘\u003c/p\u003e\n\u003cfigure class=\"highlight stylus\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003ejava\u003cspan class=\"selector-class\"\u003e.lang\u003c/span\u003e\u003cspan class=\"selector-class\"\u003e.OutOfMemoryError\u003c/span\u003e: PermGen space\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003eã€åŸå› ã€‘\u003c/p\u003e\n\u003cp\u003ePerm ï¼ˆæ°¸ä¹…ä»£ï¼‰ç©ºé—´ä¸»è¦ç”¨äºå­˜æ”¾ \u003ccode\u003eClass\u003c/code\u003e å’Œ Meta ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç±»çš„åç§°å’Œå­—æ®µï¼Œå¸¦æœ‰æ–¹æ³•å­—èŠ‚ç çš„æ–¹æ³•ï¼Œå¸¸é‡æ± ä¿¡æ¯ï¼Œä¸ç±»å…³è”çš„å¯¹è±¡æ•°ç»„å’Œç±»å‹æ•°ç»„ä»¥åŠå³æ—¶ç¼–è¯‘å™¨ä¼˜åŒ–ã€‚GC åœ¨ä¸»ç¨‹åºè¿è¡ŒæœŸé—´ä¸ä¼šå¯¹æ°¸ä¹…ä»£ç©ºé—´è¿›è¡Œæ¸…ç†ï¼Œé»˜è®¤æ˜¯ 64M å¤§å°ã€‚\u003c/p\u003e\n\u003cp\u003eæ ¹æ®ä¸Šé¢çš„å®šä¹‰ï¼Œå¯ä»¥å¾—å‡º \u003cstrong\u003ePermGen å¤§å°è¦æ±‚å–å†³äºåŠ è½½çš„ç±»çš„æ•°é‡ä»¥åŠæ­¤ç±»å£°æ˜çš„å¤§å°\u003c/strong\u003eã€‚å› æ­¤ï¼Œå¯ä»¥è¯´é€ æˆè¯¥é”™è¯¯çš„ä¸»è¦åŸå› æ˜¯æ°¸ä¹…ä»£ä¸­è£…å…¥äº†å¤ªå¤šçš„ç±»æˆ–å¤ªå¤§çš„ç±»ã€‚\u003c/p\u003e\n\u003cp\u003eåœ¨ JDK8 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œå¯ä»¥é€šè¿‡ \u003ccode\u003e-XX:PermSize\u003c/code\u003e å’Œ \u003ccode\u003e-XX:MaxPermSize\u003c/code\u003e è®¾ç½®æ°¸ä¹…ä»£ç©ºé—´å¤§å°ï¼Œä»è€Œé™åˆ¶æ–¹æ³•åŒºå¤§å°ï¼Œå¹¶é—´æ¥é™åˆ¶å…¶ä¸­å¸¸é‡æ± çš„å®¹é‡ã€‚\u003c/p\u003e\n\u003ch4 id=\"åˆå§‹åŒ–æ—¶æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³\"\u003e\u003ca href=\"#åˆå§‹åŒ–æ—¶æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³\" class=\"headerlink\" title=\"åˆå§‹åŒ–æ—¶æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³\"\u003e\u003c/a\u003eåˆå§‹åŒ–æ—¶æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³\u003c/h4\u003e\u003cp\u003eã€ç¤ºä¾‹ã€‘\u003c/p\u003e\n\u003cfigure class=\"highlight java\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e26\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e27\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e28\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e/**\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * æ°¸ä¹…ä»£å†…å­˜ç©ºé—´ä¸è¶³ç¤ºä¾‹\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * \u0026lt;p\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * é”™è¯¯ç°è±¡ï¼š\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * \u0026lt;ul\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * \u0026lt;li\u0026gt;java.lang.OutOfMemoryError: PermGen space (JDK8 ä»¥å‰ç‰ˆæœ¬)\u0026lt;/li\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * \u0026lt;li\u0026gt;java.lang.OutOfMemoryError: Metaspace (JDK8 åŠä»¥åç‰ˆæœ¬)\u0026lt;/li\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * \u0026lt;/ul\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * VM Args:\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * \u0026lt;ul\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * \u0026lt;li\u0026gt;-Xmx100M -XX:MaxPermSize=16M (JDK8 ä»¥å‰ç‰ˆæœ¬)\u0026lt;/li\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * \u0026lt;li\u0026gt;-Xmx100M -XX:MaxMetaspaceSize=16M (JDK8 åŠä»¥åç‰ˆæœ¬)\u0026lt;/li\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * \u0026lt;/ul\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e */\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"title class_\"\u003ePermOutOfMemoryErrorDemo\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003emain\u003c/span\u003e\u003cspan class=\"params\"\u003e(String[] args)\u003c/span\u003e \u003cspan class=\"keyword\"\u003ethrows\u003c/span\u003e Exception {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e (\u003cspan class=\"type\"\u003eint\u003c/span\u003e \u003cspan class=\"variable\"\u003ei\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e \u003cspan class=\"number\"\u003e0\u003c/span\u003e; i \u0026lt; \u003cspan class=\"number\"\u003e100_000_000\u003c/span\u003e; i++) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            generate(\u003cspan class=\"string\"\u003e\u0026#34;eu.plumbr.demo.Generated\u0026#34;\u003c/span\u003e + i);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003estatic\u003c/span\u003e Class \u003cspan class=\"title function_\"\u003egenerate\u003c/span\u003e\u003cspan class=\"params\"\u003e(String name)\u003c/span\u003e \u003cspan class=\"keyword\"\u003ethrows\u003c/span\u003e Exception {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"type\"\u003eClassPool\u003c/span\u003e \u003cspan class=\"variable\"\u003epool\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e ClassPool.getDefault();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003ereturn\u003c/span\u003e pool.makeClass(name).toClass();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003eåœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæºä»£ç éå†å¾ªç¯å¹¶åœ¨è¿è¡Œæ—¶ç”Ÿæˆç±»ã€‚javassist åº“æ­£åœ¨å¤„ç†ç±»ç”Ÿæˆçš„å¤æ‚æ€§ã€‚\u003c/p\u003e\n\u003ch4 id=\"é‡éƒ¨ç½²æ—¶æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³\"\u003e\u003ca href=\"#é‡éƒ¨ç½²æ—¶æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³\" class=\"headerlink\" title=\"é‡éƒ¨ç½²æ—¶æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³\"\u003e\u003c/a\u003eé‡éƒ¨ç½²æ—¶æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³\u003c/h4\u003e\u003cp\u003eå¯¹äºæ›´å¤æ‚ï¼Œæ›´å®é™…çš„ç¤ºä¾‹ï¼Œè®©æˆ‘ä»¬é€æ­¥ä»‹ç»ä¸€ä¸‹åœ¨åº”ç”¨ç¨‹åºé‡æ–°éƒ¨ç½²æœŸé—´å‘ç”Ÿçš„ Permgen ç©ºé—´é”™è¯¯ã€‚é‡æ–°éƒ¨ç½²åº”ç”¨ç¨‹åºæ—¶ï¼Œä½ å¸Œæœ›åƒåœ¾å›æ”¶ä¼šæ‘†è„±å¼•ç”¨æ‰€æœ‰å…ˆå‰åŠ è½½çš„ç±»çš„åŠ è½½å™¨ï¼Œå¹¶è¢«åŠ è½½æ–°ç±»çš„ç±»åŠ è½½å™¨å–ä»£ã€‚\u003c/p\u003e\n\u003cp\u003eä¸å¹¸çš„æ˜¯ï¼Œè®¸å¤šç¬¬ä¸‰æ–¹åº“ä»¥åŠå¯¹çº¿ç¨‹ï¼ŒJDBC é©±åŠ¨ç¨‹åºæˆ–æ–‡ä»¶ç³»ç»Ÿå¥æŸ„ç­‰èµ„æºçš„ä¸è‰¯å¤„ç†ä½¿å¾—æ— æ³•å¸è½½ä»¥å‰ä½¿ç”¨çš„ç±»åŠ è½½å™¨ã€‚åè¿‡æ¥ï¼Œè¿™æ„å‘³ç€åœ¨æ¯æ¬¡é‡æ–°éƒ¨ç½²æœŸé—´ï¼Œæ‰€æœ‰å…ˆå‰ç‰ˆæœ¬çš„ç±»ä»å°†é©»ç•™åœ¨ PermGen ä¸­ï¼Œä»è€Œåœ¨æ¯æ¬¡é‡æ–°éƒ¨ç½²æœŸé—´ç”Ÿæˆæ•°åå…†çš„åƒåœ¾ã€‚\u003c/p\u003e\n\u003cp\u003eè®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸ªä½¿ç”¨ JDBC é©±åŠ¨ç¨‹åºè¿æ¥åˆ°å…³ç³»æ•°æ®åº“çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºã€‚å¯åŠ¨åº”ç”¨ç¨‹åºæ—¶ï¼Œåˆå§‹åŒ–ä»£ç å°†åŠ è½½ JDBC é©±åŠ¨ç¨‹åºä»¥è¿æ¥åˆ°æ•°æ®åº“ã€‚å¯¹åº”äºè§„èŒƒï¼ŒJDBC é©±åŠ¨ç¨‹åºå‘ java.sql.DriverManager è¿›è¡Œæ³¨å†Œã€‚è¯¥æ³¨å†ŒåŒ…æ‹¬å°†å¯¹é©±åŠ¨ç¨‹åºå®ä¾‹çš„å¼•ç”¨å­˜å‚¨åœ¨ DriverManager çš„é™æ€å­—æ®µä¸­ã€‚\u003c/p\u003e\n\u003cp\u003eç°åœ¨ï¼Œå½“ä»åº”ç”¨ç¨‹åºæœåŠ¡å™¨å–æ¶ˆéƒ¨ç½²åº”ç”¨ç¨‹åºæ—¶ï¼Œjava.sql.DriverManager ä»å°†ä¿ç•™è¯¥å¼•ç”¨ã€‚æˆ‘ä»¬æœ€ç»ˆè·å¾—äº†å¯¹é©±åŠ¨ç¨‹åºç±»çš„å®æ—¶å¼•ç”¨ï¼Œè€Œé©±åŠ¨ç¨‹åºç±»åˆä¿ç•™äº†ç”¨äºåŠ è½½åº”ç”¨ç¨‹åºçš„ java.lang.Classloader å®ä¾‹çš„å¼•ç”¨ã€‚åè¿‡æ¥ï¼Œè¿™æ„å‘³ç€åƒåœ¾å›æ”¶ç®—æ³•æ— æ³•å›æ”¶ç©ºé—´ã€‚\u003c/p\u003e\n\u003cp\u003eè€Œä¸”è¯¥ java.lang.ClassLoader å®ä¾‹ä»å¼•ç”¨åº”ç”¨ç¨‹åºçš„æ‰€æœ‰ç±»ï¼Œé€šå¸¸åœ¨ PermGen ä¸­å æ®æ•°åå…†å­—èŠ‚ã€‚è¿™æ„å‘³ç€åªéœ€å°‘é‡é‡æ–°éƒ¨ç½²å³å¯å¡«å……é€šå¸¸å¤§å°çš„ PermGenã€‚\u003c/p\u003e\n\u003ch4 id=\"PermGen-space-è§£å†³æ–¹æ¡ˆ\"\u003e\u003ca href=\"#PermGen-space-è§£å†³æ–¹æ¡ˆ\" class=\"headerlink\" title=\"PermGen space è§£å†³æ–¹æ¡ˆ\"\u003e\u003c/a\u003ePermGen space è§£å†³æ–¹æ¡ˆ\u003c/h4\u003e\u003cp\u003eï¼ˆ1ï¼‰è§£å†³åˆå§‹åŒ–æ—¶çš„ \u003ccode\u003eOutOfMemoryError\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eåœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æœŸé—´è§¦å‘ç”±äº PermGen è€—å°½å¯¼è‡´çš„ \u003ccode\u003eOutOfMemoryError\u003c/code\u003e æ—¶ï¼Œè§£å†³æ–¹æ¡ˆå¾ˆç®€å•ã€‚è¯¥åº”ç”¨ç¨‹åºä»…éœ€è¦æ›´å¤šç©ºé—´æ‰èƒ½å°†æ‰€æœ‰ç±»åŠ è½½åˆ° PermGen åŒºåŸŸï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦å¢åŠ å…¶å¤§å°å³å¯ã€‚ä¸ºæ­¤ï¼Œæ›´æ”¹ä½ çš„åº”ç”¨ç¨‹åºå¯åŠ¨é…ç½®å¹¶æ·»åŠ ï¼ˆæˆ–å¢åŠ ï¼Œå¦‚æœå­˜åœ¨ï¼‰\u003ccode\u003e-XX:MaxPermSize\u003c/code\u003e å‚æ•°ï¼Œç±»ä¼¼äºä»¥ä¸‹ç¤ºä¾‹ï¼š\u003c/p\u003e\n\u003cfigure class=\"highlight routeros\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003ejava -XX:\u003cspan class=\"attribute\"\u003eMaxPermSize\u003c/span\u003e=512m com.yourcompany.YourClass\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003eä¸Šé¢çš„é…ç½®å°†å‘Šè¯‰ JVMï¼ŒPermGen å¯ä»¥å¢é•¿åˆ° 512MBã€‚\u003c/p\u003e\n\u003cp\u003eæ¸…ç†åº”ç”¨ç¨‹åºä¸­ \u003ccode\u003eWEB-INF/lib\u003c/code\u003e ä¸‹çš„ jarï¼Œç”¨ä¸ä¸Šçš„ jar åˆ é™¤æ‰ï¼Œå¤šä¸ªåº”ç”¨å…¬å…±çš„ jar ç§»åŠ¨åˆ° Tomcat çš„ lib ç›®å½•ï¼Œå‡å°‘é‡å¤åŠ è½½ã€‚\u003c/p\u003e\n\u003cp\u003eğŸ”” æ³¨æ„ï¼š\u003ccode\u003e-XX:PermSize\u003c/code\u003e ä¸€èˆ¬è®¾ä¸º 64M\u003c/p\u003e\n\u003cp\u003eï¼ˆ2ï¼‰è§£å†³é‡æ–°éƒ¨ç½²æ—¶çš„ \u003ccode\u003eOutOfMemoryError\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eé‡æ–°éƒ¨ç½²åº”ç”¨ç¨‹åºåç«‹å³å‘ç”Ÿ OutOfMemoryError æ—¶ï¼Œåº”ç”¨ç¨‹åºä¼šé­å—ç±»åŠ è½½å™¨æ³„æ¼çš„å›°æ‰°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè§£å†³é—®é¢˜çš„æœ€ç®€å•ï¼Œç»§ç»­è¿›è¡Œå †è½¬å‚¨åˆ†æâ€“ä½¿ç”¨ç±»ä¼¼äºä»¥ä¸‹å‘½ä»¤çš„é‡æ–°éƒ¨ç½²åè¿›è¡Œå †è½¬å‚¨ï¼š\u003c/p\u003e\n\u003cfigure class=\"highlight gradle\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003ejmap -\u003cspan class=\"keyword\"\u003edump\u003c/span\u003e:format=b,\u003cspan class=\"keyword\"\u003efile\u003c/span\u003e=\u003cspan class=\"keyword\"\u003edump\u003c/span\u003e.hprof \u0026lt;process-id\u0026gt;\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003eç„¶åä½¿ç”¨ä½ æœ€å–œæ¬¢çš„å †è½¬å‚¨åˆ†æå™¨æ‰“å¼€è½¬å‚¨ï¼ˆEclipse MAT æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å·¥å…·ï¼‰ã€‚åœ¨åˆ†æå™¨ä¸­å¯ä»¥æŸ¥æ‰¾é‡å¤çš„ç±»ï¼Œå°¤å…¶æ˜¯é‚£äº›æ­£åœ¨åŠ è½½åº”ç”¨ç¨‹åºç±»çš„ç±»ã€‚ä»é‚£é‡Œï¼Œä½ éœ€è¦è¿›è¡Œæ‰€æœ‰ç±»åŠ è½½å™¨çš„æŸ¥æ‰¾ï¼Œä»¥æ‰¾åˆ°å½“å‰æ´»åŠ¨çš„ç±»åŠ è½½å™¨ã€‚\u003c/p\u003e\n\u003cp\u003eå¯¹äºéæ´»åŠ¨ç±»åŠ è½½å™¨ï¼Œä½ éœ€è¦é€šè¿‡ä»éæ´»åŠ¨ç±»åŠ è½½å™¨æ”¶é›†åˆ° GC æ ¹çš„æœ€çŸ­è·¯å¾„æ¥ç¡®å®šé˜»æ­¢å®ƒä»¬è¢«åƒåœ¾æ”¶é›†çš„å¼•ç”¨ã€‚æœ‰äº†æ­¤ä¿¡æ¯ï¼Œä½ å°†æ‰¾åˆ°æ ¹æœ¬åŸå› ã€‚å¦‚æœæ ¹æœ¬åŸå› æ˜¯åœ¨ç¬¬ä¸‰æ–¹åº“ä¸­ï¼Œåˆ™å¯ä»¥è¿›å…¥ Google/StackOverflow æŸ¥çœ‹æ˜¯å¦æ˜¯å·²çŸ¥é—®é¢˜ä»¥è·å–è¡¥ä¸/è§£å†³æ–¹æ³•ã€‚\u003c/p\u003e\n\u003cp\u003eï¼ˆ3ï¼‰è§£å†³è¿è¡Œæ—¶ \u003ccode\u003eOutOfMemoryError\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eç¬¬ä¸€æ­¥æ˜¯æ£€æŸ¥æ˜¯å¦å…è®¸ GC ä» PermGen å¸è½½ç±»ã€‚åœ¨è¿™æ–¹é¢ï¼Œæ ‡å‡†çš„ JVM ç›¸å½“ä¿å®ˆ-ç±»æ˜¯å¤©ç”Ÿçš„ã€‚å› æ­¤ï¼Œä¸€æ—¦åŠ è½½ï¼Œå³ä½¿æ²¡æœ‰ä»£ç åœ¨ä½¿ç”¨å®ƒä»¬ï¼Œç±»ä¹Ÿä¼šä¿ç•™åœ¨å†…å­˜ä¸­ã€‚å½“åº”ç”¨ç¨‹åºåŠ¨æ€åˆ›å»ºè®¸å¤šç±»å¹¶ä¸”é•¿æ—¶é—´ä¸éœ€è¦ç”Ÿæˆçš„ç±»æ—¶ï¼Œè¿™å¯èƒ½ä¼šæˆä¸ºé—®é¢˜ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå…è®¸ JVM å¸è½½ç±»å®šä¹‰å¯èƒ½ä¼šæœ‰æ‰€å¸®åŠ©ã€‚è¿™å¯ä»¥é€šè¿‡åœ¨å¯åŠ¨è„šæœ¬ä¸­ä»…æ·»åŠ ä¸€ä¸ªé…ç½®å‚æ•°æ¥å®ç°ï¼š\u003c/p\u003e\n\u003cfigure class=\"highlight ruby\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e-\u003cspan class=\"variable constant_\"\u003eXX\u003c/span\u003e\u003cspan class=\"symbol\"\u003e:+CMSClassUnloadingEnabled\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003eé»˜è®¤æƒ…å†µä¸‹ï¼Œæ­¤é€‰é¡¹è®¾ç½®ä¸º falseï¼Œå› æ­¤è¦å¯ç”¨æ­¤åŠŸèƒ½ï¼Œä½ éœ€è¦åœ¨ Java é€‰é¡¹ä¸­æ˜¾å¼è®¾ç½®ã€‚å¦‚æœå¯ç”¨ CMSClassUnloadingEnabledï¼ŒGC ä¹Ÿä¼šæ‰«æ PermGen å¹¶åˆ é™¤ä¸å†ä½¿ç”¨çš„ç±»ã€‚è¯·è®°ä½ï¼Œåªæœ‰åŒæ—¶ä½¿ç”¨ UseConcMarkSweepGC æ—¶æ­¤é€‰é¡¹æ‰èµ·ä½œç”¨ã€‚\u003c/p\u003e\n\u003cfigure class=\"highlight ruby\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e-\u003cspan class=\"variable constant_\"\u003eXX\u003c/span\u003e\u003cspan class=\"symbol\"\u003e:+UseConcMarkSweepGC\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003eåœ¨ç¡®ä¿å¯ä»¥å¸è½½ç±»å¹¶ä¸”é—®é¢˜ä»ç„¶å­˜åœ¨ä¹‹åï¼Œä½ åº”è¯¥ç»§ç»­è¿›è¡Œå †è½¬å‚¨åˆ†æâ€“ä½¿ç”¨ç±»ä¼¼äºä»¥ä¸‹å‘½ä»¤çš„æ–¹æ³•è¿›è¡Œå †è½¬å‚¨ï¼š\u003c/p\u003e\n\u003cfigure class=\"highlight gradle\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003ejmap -\u003cspan class=\"keyword\"\u003edump\u003c/span\u003e:\u003cspan class=\"keyword\"\u003efile\u003c/span\u003e=\u003cspan class=\"keyword\"\u003edump\u003c/span\u003e.hprof,format=b \u0026lt;process-id\u0026gt;\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003eç„¶åï¼Œä½¿ç”¨ä½ æœ€å–œæ¬¢çš„å †è½¬å‚¨åˆ†æå™¨ï¼ˆä¾‹å¦‚ Eclipse MATï¼‰æ‰“å¼€è½¬å‚¨ï¼Œç„¶åæ ¹æ®å·²åŠ è½½çš„ç±»æ•°æŸ¥æ‰¾æœ€æ˜‚è´µçš„ç±»åŠ è½½å™¨ã€‚ä»æ­¤ç±»åŠ è½½å™¨ä¸­ï¼Œä½ å¯ä»¥ç»§ç»­æå–å·²åŠ è½½çš„ç±»ï¼Œå¹¶æŒ‰å®ä¾‹å¯¹æ­¤ç±»è¿›è¡Œæ’åºï¼Œä»¥ä½¿å¯ç–‘å¯¹è±¡æ’åœ¨é¦–ä½ã€‚\u003c/p\u003e\n\u003cp\u003eç„¶åï¼Œå¯¹äºæ¯ä¸ªå¯ç–‘è€…ï¼Œå°±éœ€è¦ä½ æ‰‹åŠ¨å°†æ ¹æœ¬åŸå› è¿½æº¯åˆ°ç”Ÿæˆæ­¤ç±»çš„åº”ç”¨ç¨‹åºä»£ç ã€‚\u003c/p\u003e\n\u003ch3 id=\"å…ƒæ•°æ®åŒºç©ºé—´ä¸è¶³\"\u003e\u003ca href=\"#å…ƒæ•°æ®åŒºç©ºé—´ä¸è¶³\" class=\"headerlink\" title=\"å…ƒæ•°æ®åŒºç©ºé—´ä¸è¶³\"\u003e\u003c/a\u003eå…ƒæ•°æ®åŒºç©ºé—´ä¸è¶³\u003c/h3\u003e\u003cp\u003eã€é”™è¯¯ã€‘\u003c/p\u003e\n\u003cfigure class=\"highlight julia\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003eException\u003c/span\u003e \u003cspan class=\"keyword\"\u003ein\u003c/span\u003e thread \u003cspan class=\"string\"\u003e\u0026#34;main\u0026#34;\u003c/span\u003e java.lang.\u003cspan class=\"built_in\"\u003eOutOfMemoryError\u003c/span\u003e: Metaspace\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003eã€åŸå› ã€‘\u003c/p\u003e\n\u003cp\u003eJava8 ä»¥åï¼ŒJVM å†…å­˜ç©ºé—´å‘ç”Ÿäº†å¾ˆå¤§çš„å˜åŒ–ã€‚å–æ¶ˆäº†æ°¸ä¹…ä»£ï¼Œè½¬è€Œå˜ä¸ºå…ƒæ•°æ®åŒºã€‚\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eå…ƒæ•°æ®åŒºçš„å†…å­˜ä¸è¶³ï¼Œå³æ–¹æ³•åŒºå’Œè¿è¡Œæ—¶å¸¸é‡æ± çš„ç©ºé—´ä¸è¶³\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cp\u003eæ–¹æ³•åŒºç”¨äºå­˜æ”¾ Class çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚ç±»åã€è®¿é—®ä¿®é¥°ç¬¦ã€å¸¸é‡æ± ã€å­—æ®µæè¿°ã€æ–¹æ³•æè¿°ç­‰ã€‚\u003c/p\u003e\n\u003cp\u003eä¸€ä¸ªç±»è¦è¢«åƒåœ¾æ”¶é›†å™¨å›æ”¶ï¼Œåˆ¤å®šæ¡ä»¶æ˜¯æ¯”è¾ƒè‹›åˆ»çš„ã€‚åœ¨ç»å¸¸åŠ¨æ€ç”Ÿæˆå¤§é‡ Class çš„åº”ç”¨ä¸­ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„ç±»çš„å›æ”¶çŠ¶å†µã€‚è¿™ç±»å¸¸è§é™¤äº† CGLib å­—èŠ‚ç å¢å¼ºå’ŒåŠ¨æ€è¯­è¨€ä»¥å¤–ï¼Œå¸¸è§çš„è¿˜æœ‰ï¼šå¤§é‡ JSP æˆ–åŠ¨æ€äº§ç”Ÿ JSP æ–‡ä»¶çš„åº”ç”¨ï¼ˆJSP ç¬¬ä¸€æ¬¡è¿è¡Œæ—¶éœ€è¦ç¼–è¯‘ä¸º Java ç±»ï¼‰ã€åŸºäº OSGi çš„åº”ç”¨ï¼ˆå³ä½¿æ˜¯åŒä¸€ä¸ªç±»æ–‡ä»¶ï¼Œè¢«ä¸åŒçš„åŠ è½½å™¨åŠ è½½ä¹Ÿä¼šè§†ä¸ºä¸åŒçš„ç±»ï¼‰ç­‰ã€‚\u003c/p\u003e\n\u003cp\u003eã€ç¤ºä¾‹ã€‘æ–¹æ³•åŒºå‡ºç° \u003ccode\u003eOutOfMemoryError\u003c/code\u003e\u003c/p\u003e\n\u003cfigure class=\"highlight java\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"title class_\"\u003eMethodAreaOutOfMemoryDemo\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003emain\u003c/span\u003e\u003cspan class=\"params\"\u003e(String[] args)\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003ewhile\u003c/span\u003e (\u003cspan class=\"literal\"\u003etrue\u003c/span\u003e) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"type\"\u003eEnhancer\u003c/span\u003e \u003cspan class=\"variable\"\u003eenhancer\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e \u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eEnhancer\u003c/span\u003e();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            enhancer.setSuperclass(Bean.class);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            enhancer.setUseCache(\u003cspan class=\"literal\"\u003efalse\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            enhancer.setCallback(\u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eMethodInterceptor\u003c/span\u003e() {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                \u003cspan class=\"meta\"\u003e@Override\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                \u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e Object \u003cspan class=\"title function_\"\u003eintercept\u003c/span\u003e\u003cspan class=\"params\"\u003e(Object obj, Method method, Object[] args, MethodProxy proxy)\u003c/span\u003e \u003cspan class=\"keyword\"\u003ethrows\u003c/span\u003e Throwable {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                    \u003cspan class=\"keyword\"\u003ereturn\u003c/span\u003e proxy.invokeSuper(obj, args);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            });\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            enhancer.create();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"title class_\"\u003eBean\u003c/span\u003e {}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003eã€è§£å†³ã€‘\u003c/p\u003e\n\u003cp\u003eå½“ç”±äºå…ƒç©ºé—´è€Œé¢ä¸´ \u003ccode\u003eOutOfMemoryError\u003c/code\u003e æ—¶ï¼Œç¬¬ä¸€ä¸ªè§£å†³æ–¹æ¡ˆåº”è¯¥æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚å¦‚æœåº”ç”¨ç¨‹åºè€—å°½äº†å†…å­˜ä¸­çš„ Metaspace åŒºåŸŸï¼Œåˆ™åº”å¢åŠ  Metaspace çš„å¤§å°ã€‚æ›´æ”¹åº”ç”¨ç¨‹åºå¯åŠ¨é…ç½®å¹¶å¢åŠ ä»¥ä¸‹å†…å®¹ï¼š\u003c/p\u003e\n\u003cfigure class=\"highlight routeros\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e-XX:\u003cspan class=\"attribute\"\u003eMaxMetaspaceSize\u003c/span\u003e=512m\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003eä¸Šé¢çš„é…ç½®ç¤ºä¾‹å‘Šè¯‰ JVMï¼Œå…è®¸ Metaspace å¢é•¿åˆ° 512 MBã€‚\u003c/p\u003e\n\u003cp\u003eå¦ä¸€ç§è§£å†³æ–¹æ¡ˆç”šè‡³æ›´ç®€å•ã€‚ä½ å¯ä»¥é€šè¿‡åˆ é™¤æ­¤å‚æ•°æ¥å®Œå…¨è§£é™¤å¯¹ Metaspace å¤§å°çš„é™åˆ¶ï¼ŒJVM é»˜è®¤å¯¹ Metaspace çš„å¤§å°æ²¡æœ‰é™åˆ¶ã€‚ä½†æ˜¯è¯·æ³¨æ„ä»¥ä¸‹äº‹å®ï¼šè¿™æ ·åšå¯èƒ½ä¼šå¯¼è‡´å¤§é‡äº¤æ¢æˆ–è¾¾åˆ°æœ¬æœºç‰©ç†å†…å­˜è€Œåˆ†é…å¤±è´¥ã€‚\u003c/p\u003e\n\u003ch3 id=\"æ— æ³•æ–°å»ºæœ¬åœ°çº¿ç¨‹\"\u003e\u003ca href=\"#æ— æ³•æ–°å»ºæœ¬åœ°çº¿ç¨‹\" class=\"headerlink\" title=\"æ— æ³•æ–°å»ºæœ¬åœ°çº¿ç¨‹\"\u003e\u003c/a\u003eæ— æ³•æ–°å»ºæœ¬åœ°çº¿ç¨‹\u003c/h3\u003e\u003cp\u003e\u003ccode\u003ejava.lang.OutOfMemoryError: Unable to create new native thread\u003c/code\u003e è¿™ä¸ªé”™è¯¯æ„å‘³ç€ï¼š\u003cstrong\u003eJava åº”ç”¨ç¨‹åºå·²è¾¾åˆ°å…¶å¯ä»¥å¯åŠ¨çº¿ç¨‹æ•°çš„é™åˆ¶\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cp\u003eã€åŸå› ã€‘\u003c/p\u003e\n\u003cp\u003eå½“å‘èµ·ä¸€ä¸ªçº¿ç¨‹çš„åˆ›å»ºæ—¶ï¼Œè™šæ‹Ÿæœºä¼šåœ¨ JVM å†…å­˜åˆ›å»ºä¸€ä¸ª \u003ccode\u003eThread\u003c/code\u003e å¯¹è±¡åŒæ—¶åˆ›å»ºä¸€ä¸ªæ“ä½œç³»ç»Ÿçº¿ç¨‹ï¼Œè€Œè¿™ä¸ªç³»ç»Ÿçº¿ç¨‹çš„å†…å­˜ç”¨çš„ä¸æ˜¯ JVM å†…å­˜ï¼Œè€Œæ˜¯ç³»ç»Ÿä¸­å‰©ä¸‹çš„å†…å­˜ã€‚\u003c/p\u003e\n\u003cp\u003eé‚£ä¹ˆï¼Œç©¶ç«Ÿèƒ½åˆ›å»ºå¤šå°‘çº¿ç¨‹å‘¢ï¼Ÿè¿™é‡Œæœ‰ä¸€ä¸ªå…¬å¼ï¼š\u003c/p\u003e\n\u003cfigure class=\"highlight gcode\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eçº¿ç¨‹æ•° = \u003cspan class=\"comment\"\u003e(MaxProcessMemory - JVMMemory - ReservedOsMemory)\u003c/span\u003e / \u003cspan class=\"comment\"\u003e(ThreadStackSize)\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003eã€å‚æ•°ã€‘\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eMaxProcessMemory\u003c/code\u003e - ä¸€ä¸ªè¿›ç¨‹çš„æœ€å¤§å†…å­˜\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eJVMMemory\u003c/code\u003e - JVM å†…å­˜\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eReservedOsMemory\u003c/code\u003e - ä¿ç•™çš„æ“ä½œç³»ç»Ÿå†…å­˜\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eThreadStackSize\u003c/code\u003e - çº¿ç¨‹æ ˆçš„å¤§å°\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e**ç»™ JVM åˆ†é…çš„å†…å­˜è¶Šå¤šï¼Œé‚£ä¹ˆèƒ½ç”¨æ¥åˆ›å»ºç³»ç»Ÿçº¿ç¨‹çš„å†…å­˜å°±ä¼šè¶Šå°‘ï¼Œè¶Šå®¹æ˜“å‘ç”Ÿ \u003ccode\u003eunable to create new native thread\u003c/code\u003e**ã€‚æ‰€ä»¥ï¼ŒJVM å†…å­˜ä¸æ˜¯åˆ†é…çš„è¶Šå¤§è¶Šå¥½ã€‚\u003c/p\u003e\n\u003cp\u003eä½†æ˜¯ï¼Œé€šå¸¸å¯¼è‡´ \u003ccode\u003ejava.lang.OutOfMemoryError\u003c/code\u003e çš„æƒ…å†µï¼šæ— æ³•åˆ›å»ºæ–°çš„æœ¬æœºçº¿ç¨‹éœ€è¦ç»å†ä»¥ä¸‹é˜¶æ®µï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eJVM å†…éƒ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºè¯·æ±‚æ–°çš„ Java çº¿ç¨‹\u003c/li\u003e\n\u003cli\u003eJVM æœ¬æœºä»£ç ä»£ç†ä¸ºæ“ä½œç³»ç»Ÿåˆ›å»ºæ–°æœ¬æœºçº¿ç¨‹çš„è¯·æ±‚\u003c/li\u003e\n\u003cli\u003eæ“ä½œç³»ç»Ÿå°è¯•åˆ›å»ºä¸€ä¸ªæ–°çš„æœ¬æœºçº¿ç¨‹ï¼Œè¯¥çº¿ç¨‹éœ€è¦å°†å†…å­˜åˆ†é…ç»™è¯¥çº¿ç¨‹\u003c/li\u003e\n\u003cli\u003eæ“ä½œç³»ç»Ÿå°†æ‹’ç»æœ¬æœºå†…å­˜åˆ†é…ï¼ŒåŸå› æ˜¯ 32 ä½ Java è¿›ç¨‹å¤§å°å·²è€—å°½å…¶å†…å­˜åœ°å€ç©ºé—´ï¼ˆä¾‹å¦‚ï¼Œå·²è¾¾åˆ°ï¼ˆ2-4ï¼‰GB è¿›ç¨‹å¤§å°é™åˆ¶ï¼‰æˆ–æ“ä½œç³»ç»Ÿçš„è™šæ‹Ÿå†…å­˜å·²å®Œå…¨è€—å°½\u003c/li\u003e\n\u003cli\u003eå¼•å‘ \u003ccode\u003ejava.lang.OutOfMemoryError: Unable to create new native thread\u003c/code\u003e é”™è¯¯ã€‚\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eã€ç¤ºä¾‹ã€‘\u003c/p\u003e\n\u003cfigure class=\"highlight java\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"title class_\"\u003eUnableCreateNativeThreadErrorDemo\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003emain\u003c/span\u003e\u003cspan class=\"params\"\u003e(String[] args)\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003ewhile\u003c/span\u003e (\u003cspan class=\"literal\"\u003etrue\u003c/span\u003e) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eThread\u003c/span\u003e(\u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eRunnable\u003c/span\u003e() {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                \u003cspan class=\"meta\"\u003e@Override\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                \u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003erun\u003c/span\u003e\u003cspan class=\"params\"\u003e()\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                    \u003cspan class=\"keyword\"\u003etry\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                        TimeUnit.MINUTES.sleep(\u003cspan class=\"number\"\u003e5\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                    } \u003cspan class=\"keyword\"\u003ecatch\u003c/span\u003e (InterruptedException e) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                        e.printStackTrace();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            }).start();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003eã€å¤„ç†ã€‘\u003c/p\u003e\n\u003cp\u003eå¯ä»¥é€šè¿‡å¢åŠ æ“ä½œç³»ç»Ÿçº§åˆ«çš„é™åˆ¶æ¥ç»•è¿‡æ— æ³•åˆ›å»ºæ–°çš„æœ¬æœºçº¿ç¨‹é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå¦‚æœé™åˆ¶äº† JVM å¯åœ¨ç”¨æˆ·ç©ºé—´ä¸­äº§ç”Ÿçš„è¿›ç¨‹æ•°ï¼Œåˆ™åº”æ£€æŸ¥å‡ºå¹¶å¯èƒ½å¢åŠ è¯¥é™åˆ¶ï¼š\u003c/p\u003e\n\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e[root@dev ~]# ulimit -a\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003ecore file size          (blocks, -c) 0\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e--- cut for brevity ---\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003emax user processes              (-u) 1800\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003eé€šå¸¸ï¼Œ\u003ccode\u003eOutOfMemoryError\u003c/code\u003e å¯¹æ–°çš„æœ¬æœºçº¿ç¨‹çš„é™åˆ¶è¡¨ç¤ºç¼–ç¨‹é”™è¯¯ã€‚å½“åº”ç”¨ç¨‹åºäº§ç”Ÿæ•°åƒä¸ªçº¿ç¨‹æ—¶ï¼Œå¾ˆå¯èƒ½å‡ºäº†ä¸€äº›é—®é¢˜â€”å¾ˆå°‘æœ‰åº”ç”¨ç¨‹åºå¯ä»¥ä»å¦‚æ­¤å¤§é‡çš„çº¿ç¨‹ä¸­å—ç›Šã€‚\u003c/p\u003e\n\u003cp\u003eè§£å†³é—®é¢˜çš„ä¸€ç§æ–¹æ³•æ˜¯å¼€å§‹è¿›è¡Œçº¿ç¨‹è½¬å‚¨ä»¥äº†è§£æƒ…å†µã€‚\u003c/p\u003e\n\u003ch3 id=\"ç›´æ¥å†…å­˜æº¢å‡º\"\u003e\u003ca href=\"#ç›´æ¥å†…å­˜æº¢å‡º\" class=\"headerlink\" title=\"ç›´æ¥å†…å­˜æº¢å‡º\"\u003e\u003c/a\u003eç›´æ¥å†…å­˜æº¢å‡º\u003c/h3\u003e\u003cp\u003eç”±ç›´æ¥å†…å­˜å¯¼è‡´çš„å†…å­˜æº¢å‡ºï¼Œä¸€ä¸ªæ˜æ˜¾çš„ç‰¹å¾æ˜¯åœ¨ Head Dump æ–‡ä»¶ä¸­ä¸ä¼šçœ‹è§æ˜æ˜¾çš„å¼‚å¸¸ï¼Œå¦‚æœå‘ç° OOM ä¹‹å Dump æ–‡ä»¶å¾ˆå°ï¼Œè€Œç¨‹åºä¸­åˆç›´æ¥æˆ–é—´æ¥ä½¿ç”¨äº† NIOï¼Œå°±å¯ä»¥è€ƒè™‘æ£€æŸ¥ä¸€ä¸‹æ˜¯ä¸æ˜¯è¿™æ–¹é¢çš„åŸå› ã€‚\u003c/p\u003e\n\u003cp\u003eã€ç¤ºä¾‹ã€‘ç›´æ¥å†…å­˜ \u003ccode\u003eOutOfMemoryError\u003c/code\u003e\u003c/p\u003e\n\u003cfigure class=\"highlight java\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e/**\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * æœ¬æœºç›´æ¥å†…å­˜æº¢å‡ºç¤ºä¾‹\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * é”™è¯¯ç°è±¡ï¼šjava.lang.OutOfMemoryError\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e * VM Argsï¼š-Xmx20M -XX:MaxDirectMemorySize=10M\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e */\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"title class_\"\u003eDirectOutOfMemoryDemo\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003eprivate\u003c/span\u003e \u003cspan class=\"keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"keyword\"\u003efinal\u003c/span\u003e \u003cspan class=\"type\"\u003eint\u003c/span\u003e \u003cspan class=\"variable\"\u003e_1MB\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e \u003cspan class=\"number\"\u003e1024\u003c/span\u003e * \u003cspan class=\"number\"\u003e1024\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003emain\u003c/span\u003e\u003cspan class=\"params\"\u003e(String[] args)\u003c/span\u003e \u003cspan class=\"keyword\"\u003ethrows\u003c/span\u003e IllegalAccessException {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"type\"\u003eField\u003c/span\u003e \u003cspan class=\"variable\"\u003eunsafeField\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e Unsafe.class.getDeclaredFields()[\u003cspan class=\"number\"\u003e0\u003c/span\u003e];\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        unsafeField.setAccessible(\u003cspan class=\"literal\"\u003etrue\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"type\"\u003eUnsafe\u003c/span\u003e \u003cspan class=\"variable\"\u003eunsafe\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e (Unsafe) unsafeField.get(\u003cspan class=\"literal\"\u003enull\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003ewhile\u003c/span\u003e (\u003cspan class=\"literal\"\u003etrue\u003c/span\u003e) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            unsafe.allocateMemory(_1MB);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch2 id=\"StackOverflowError\"\u003e\u003ca href=\"#StackOverflowError\" class=\"headerlink\" title=\"StackOverflowError\"\u003e\u003c/a\u003eStackOverflowError\u003c/h2\u003e\u003cp\u003eå¯¹äº HotSpot è™šæ‹Ÿæœºæ¥è¯´ï¼Œæ ˆå®¹é‡åªç”± \u003ccode\u003e-Xss\u003c/code\u003e å‚æ•°æ¥å†³å®šå¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ‰€å…è®¸çš„æœ€å¤§æ·±åº¦ï¼Œå°†æŠ›å‡º \u003ccode\u003eStackOverflowError\u003c/code\u003e å¼‚å¸¸ã€‚\u003c/p\u003e\n\u003cp\u003eä»å®æˆ˜æ¥è¯´ï¼Œæ ˆæº¢å‡ºçš„å¸¸è§åŸå› ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eé€’å½’å‡½æ•°è°ƒç”¨å±‚æ•°å¤ªæ·±\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå¤§é‡å¾ªç¯æˆ–æ­»å¾ªç¯\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eã€ç¤ºä¾‹ã€‘é€’å½’å‡½æ•°è°ƒç”¨å±‚æ•°å¤ªæ·±å¯¼è‡´ \u003ccode\u003eStackOverflowError\u003c/code\u003e\u003c/p\u003e\n\u003cfigure class=\"highlight java\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"title class_\"\u003eStackOverflowDemo\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003eprivate\u003c/span\u003e \u003cspan class=\"type\"\u003eint\u003c/span\u003e \u003cspan class=\"variable\"\u003estackLength\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e \u003cspan class=\"number\"\u003e1\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003erecursion\u003c/span\u003e\u003cspan class=\"params\"\u003e()\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        stackLength++;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        recursion();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003emain\u003c/span\u003e\u003cspan class=\"params\"\u003e(String[] args)\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"type\"\u003eStackOverflowDemo\u003c/span\u003e \u003cspan class=\"variable\"\u003eobj\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e \u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eStackOverflowDemo\u003c/span\u003e();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003etry\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            obj.recursion();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        } \u003cspan class=\"keyword\"\u003ecatch\u003c/span\u003e (Throwable e) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            System.out.println(\u003cspan class=\"string\"\u003e\u0026#34;æ ˆæ·±åº¦ï¼š\u0026#34;\u003c/span\u003e + obj.stackLength);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            e.printStackTrace();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch2 id=\"å‚è€ƒèµ„æ–™\"\u003e\u003ca href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"\u003e\u003c/a\u003eå‚è€ƒèµ„æ–™\u003c/h2\u003e\u003cul\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://book.douban.com/subject/34907497/\"\u003eã€Šæ·±å…¥ç†è§£ Java è™šæ‹Ÿæœºã€‹\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://time.geekbang.org/column/intro/100028001\"\u003eã€ŠJava æ€§èƒ½è°ƒä¼˜å®æˆ˜ã€‹\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://www.douban.com/doulist/2545443/\"\u003eä»è¡¨åˆ°é‡Œå­¦ä¹  JVM å®ç°\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://www.jianshu.com/p/28935cbfbae0\"\u003eä½œä¸ºæµ‹è¯•ä½ åº”è¯¥çŸ¥é“çš„ JAVA OOM åŠå®šä½åˆ†æ\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://blog.csdn.net/sinat_29912455/article/details/51125748\"\u003eå¼‚å¸¸ã€å †å†…å­˜æº¢å‡ºã€OOM çš„å‡ ç§æƒ…å†µ\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://tianmingxing.com/2019/11/17/%E4%BB%8B%E7%BB%8DJVM%E4%B8%ADOOM%E7%9A%848%E7%A7%8D%E7%B1%BB%E5%9E%8B/\"\u003eä»‹ç» JVM ä¸­ OOM çš„ 8 ç§ç±»å‹\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n    \u003c/div\u003e",
  "Date": "2020-06-28T08:19:00Z",
  "Author": "é’æ‚Ÿ â—¾ Dunwu"
}