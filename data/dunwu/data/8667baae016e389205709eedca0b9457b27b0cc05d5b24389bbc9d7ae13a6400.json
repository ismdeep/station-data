{
  "Source": "dunwu",
  "Title": "ZooKeeper运维",
  "Link": "https://dunwu.github.io/blog/pages/bb5e61/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\u003ch1 id=\"ZooKeeper-运维指南\"\u003e\u003ca href=\"#ZooKeeper-运维指南\" class=\"headerlink\" title=\"ZooKeeper 运维指南\"\u003e\u003c/a\u003eZooKeeper 运维指南\u003c/h1\u003e\u003ch2 id=\"单点服务部署\"\u003e\u003ca href=\"#单点服务部署\" class=\"headerlink\" title=\"单点服务部署\"\u003e\u003c/a\u003e单点服务部署\u003c/h2\u003e\u003cp\u003e在安装 ZooKeeper 之前，请确保你的系统是在以下任一操作系统上运行：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e任意 Linux OS\u003c/strong\u003e - 支持开发和部署。适合演示应用程序。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eWindows OS\u003c/strong\u003e - 仅支持开发。\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMac OS\u003c/strong\u003e - 仅支持开发。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e安装步骤如下：\u003c/p\u003e\n\u003ch3 id=\"下载解压\"\u003e\u003ca href=\"#下载解压\" class=\"headerlink\" title=\"下载解压\"\u003e\u003c/a\u003e下载解压\u003c/h3\u003e\u003cp\u003e进入官方下载地址：\u003ca target=\"_blank\" rel=\"noopener\" href=\"http://zookeeper.apache.org/releases.html#download\"\u003ehttp://zookeeper.apache.org/releases.html#download\u003c/a\u003e ，选择合适版本。\u003c/p\u003e\n\u003cp\u003e解压到本地：\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003etar -zxf zookeeper-3.4.6.tar.gz\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003ecd\u003c/span\u003e zookeeper-3.4.6\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"环境变量\"\u003e\u003ca href=\"#环境变量\" class=\"headerlink\" title=\"环境变量\"\u003e\u003c/a\u003e环境变量\u003c/h3\u003e\u003cp\u003e执行 \u003ccode\u003evim /etc/profile\u003c/code\u003e，添加环境变量：\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003eexport\u003c/span\u003e ZOOKEEPER_HOME=/usr/app/zookeeper-3.4.14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003eexport\u003c/span\u003e PATH=\u003cspan class=\"variable\"\u003e$ZOOKEEPER_HOME\u003c/span\u003e/bin:\u003cspan class=\"variable\"\u003e$PATH\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e再执行 \u003ccode\u003esource /etc/profile\u003c/code\u003e ， 使得配置的环境变量生效。\u003c/p\u003e\n\u003ch3 id=\"修改配置\"\u003e\u003ca href=\"#修改配置\" class=\"headerlink\" title=\"修改配置\"\u003e\u003c/a\u003e修改配置\u003c/h3\u003e\u003cp\u003e你必须创建 \u003ccode\u003econf/zoo.cfg\u003c/code\u003e 文件，否则启动时会提示你没有此文件。\u003c/p\u003e\n\u003cp\u003e初次尝试，不妨直接使用 Kafka 提供的模板配置文件 \u003ccode\u003econf/zoo_sample.cfg\u003c/code\u003e：\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003ecp\u003c/span\u003e conf/zoo_sample.cfg conf/zoo.cfg\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e修改后完整配置如下：\u003c/p\u003e\n\u003cfigure class=\"highlight properties\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e26\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e27\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e28\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e29\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# The number of milliseconds of each tick\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attr\"\u003etickTime\u003c/span\u003e=\u003cspan class=\"string\"\u003e2000\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# The number of ticks that the initial\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# synchronization phase can take\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attr\"\u003einitLimit\u003c/span\u003e=\u003cspan class=\"string\"\u003e10\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# The number of ticks that can pass between\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# sending a request and getting an acknowledgement\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attr\"\u003esyncLimit\u003c/span\u003e=\u003cspan class=\"string\"\u003e5\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# the directory where the snapshot is stored.\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# do not use /tmp for storage, /tmp here is just\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# example sakes.\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attr\"\u003edataDir\u003c/span\u003e=\u003cspan class=\"string\"\u003e/usr/local/zookeeper/data\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attr\"\u003edataLogDir\u003c/span\u003e=\u003cspan class=\"string\"\u003e/usr/local/zookeeper/log\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# the port at which the clients will connect\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attr\"\u003eclientPort\u003c/span\u003e=\u003cspan class=\"string\"\u003e2181\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# the maximum number of client connections.\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# increase this if you need to handle more clients\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e#maxClientCnxns=60\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e#\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# Be sure to read the maintenance section of the\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# administrator guide before turning on autopurge.\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e#\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# http://zookeeper.apache.org/doc/current/zookeeperAdmin.html#sc_maintenance\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e#\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# The number of snapshots to retain in dataDir\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e#autopurge.snapRetainCount=3\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# Purge task interval in hours\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# Set to \u0026#34;0\u0026#34; to disable auto purge feature\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e#autopurge.purgeInterval=1\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e配置参数说明：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003etickTime\u003c/strong\u003e：用于计算的基础时间单元。比如 session 超时：N*tickTime；\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003einitLimit\u003c/strong\u003e：用于集群，允许从节点连接并同步到 master 节点的初始化连接时间，以 tickTime 的倍数来表示；\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003esyncLimit\u003c/strong\u003e：用于集群， master 主节点与从节点之间发送消息，请求和应答时间长度（心跳机制）；\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003edataDir\u003c/strong\u003e：数据存储位置；\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003edataLogDir\u003c/strong\u003e：日志目录；\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eclientPort\u003c/strong\u003e：用于客户端连接的端口，默认 2181\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"启动服务\"\u003e\u003ca href=\"#启动服务\" class=\"headerlink\" title=\"启动服务\"\u003e\u003c/a\u003e启动服务\u003c/h3\u003e\u003cp\u003e执行以下命令\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003ebin/zkServer.sh start\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e执行此命令后，你将收到以下响应\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eJMX enabled by default\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eUsing config: /Users/../zookeeper-3.4.6/bin/../conf/zoo.cfg\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eStarting zookeeper ... STARTED\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"停止服务\"\u003e\u003ca href=\"#停止服务\" class=\"headerlink\" title=\"停止服务\"\u003e\u003c/a\u003e停止服务\u003c/h3\u003e\u003cp\u003e可以使用以下命令停止 zookeeper 服务器。\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003ebin/zkServer.sh stop\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch2 id=\"集群服务部署\"\u003e\u003ca href=\"#集群服务部署\" class=\"headerlink\" title=\"集群服务部署\"\u003e\u003c/a\u003e集群服务部署\u003c/h2\u003e\u003cp\u003e分布式系统节点数一般都要求是奇数，且最少为 3 个节点，Zookeeper 也不例外。\u003c/p\u003e\n\u003cp\u003e这里，规划一个含 3 个节点的最小 ZooKeeper 集群，主机名分别为 hadoop001，hadoop002，hadoop003 。\u003c/p\u003e\n\u003ch3 id=\"修改配置-1\"\u003e\u003ca href=\"#修改配置-1\" class=\"headerlink\" title=\"修改配置\"\u003e\u003c/a\u003e修改配置\u003c/h3\u003e\u003cp\u003e修改配置文件 \u003ccode\u003ezoo.cfg\u003c/code\u003e，内容如下：\u003c/p\u003e\n\u003cfigure class=\"highlight properties\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attr\"\u003etickTime\u003c/span\u003e=\u003cspan class=\"string\"\u003e2000\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attr\"\u003einitLimit\u003c/span\u003e=\u003cspan class=\"string\"\u003e10\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attr\"\u003esyncLimit\u003c/span\u003e=\u003cspan class=\"string\"\u003e5\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attr\"\u003edataDir\u003c/span\u003e=\u003cspan class=\"string\"\u003e/usr/local/zookeeper-cluster/data/\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attr\"\u003edataLogDir\u003c/span\u003e=\u003cspan class=\"string\"\u003e/usr/local/zookeeper-cluster/log/\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attr\"\u003eclientPort\u003c/span\u003e=\u003cspan class=\"string\"\u003e2181\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# server.1 这个1是服务器的标识，可以是任意有效数字，标识这是第几个服务器节点，这个标识要写到dataDir目录下面myid文件里\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# 指名集群间通讯端口和选举端口\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attr\"\u003eserver.1\u003c/span\u003e=\u003cspan class=\"string\"\u003ehadoop001:2287:3387\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attr\"\u003eserver.2\u003c/span\u003e=\u003cspan class=\"string\"\u003ehadoop002:2287:3387\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attr\"\u003eserver.3\u003c/span\u003e=\u003cspan class=\"string\"\u003ehadoop003:2287:3387\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"标识节点\"\u003e\u003ca href=\"#标识节点\" class=\"headerlink\" title=\"标识节点\"\u003e\u003c/a\u003e标识节点\u003c/h3\u003e\u003cp\u003e分别在三台主机的 \u003ccode\u003edataDir\u003c/code\u003e 目录下新建 \u003ccode\u003emyid\u003c/code\u003e 文件,并写入对应的节点标识。Zookeeper 集群通过 \u003ccode\u003emyid\u003c/code\u003e 文件识别集群节点，并通过上文配置的节点通信端口和选举端口来进行节点通信，选举出 Leader 节点。\u003c/p\u003e\n\u003cp\u003e创建存储目录：\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# 三台主机均执行该命令\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003emkdir\u003c/span\u003e -vp  /usr/local/zookeeper-cluster/data/\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e创建并写入节点标识到 \u003ccode\u003emyid\u003c/code\u003e 文件：\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# hadoop001主机\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;1\u0026#34;\u003c/span\u003e \u0026gt; /usr/local/zookeeper-cluster/data/myid\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# hadoop002主机\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;2\u0026#34;\u003c/span\u003e \u0026gt; /usr/local/zookeeper-cluster/data/myid\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# hadoop003主机\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;3\u0026#34;\u003c/span\u003e \u0026gt; /usr/local/zookeeper-cluster/data/myid\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"启动集群\"\u003e\u003ca href=\"#启动集群\" class=\"headerlink\" title=\"启动集群\"\u003e\u003c/a\u003e启动集群\u003c/h3\u003e\u003cp\u003e分别在三台主机上，执行如下命令启动服务：\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e/usr/app/zookeeper-cluster/zookeeper/bin/zkServer.sh start\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"集群验证\"\u003e\u003ca href=\"#集群验证\" class=\"headerlink\" title=\"集群验证\"\u003e\u003c/a\u003e集群验证\u003c/h3\u003e\u003cp\u003e启动后使用 \u003ccode\u003ezkServer.sh status\u003c/code\u003e 查看集群各个节点状态。\u003c/p\u003e\n\u003ch2 id=\"参考资料\"\u003e\u003ca href=\"#参考资料\" class=\"headerlink\" title=\"参考资料\"\u003e\u003c/a\u003e参考资料\u003c/h2\u003e\u003cul\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://www.w3cschool.cn/zookeeper/zookeeper_installation.html\"\u003eZookeeper 安装\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/heibaiying/BigData-Notes/blob/master/notes/installation/Zookeeper%E5%8D%95%E6%9C%BA%E7%8E%AF%E5%A2%83%E5%92%8C%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA.md\"\u003eZookeeper 单机环境和集群环境搭建\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://www.runoob.com/w3cnote/zookeeper-bs-command.html\"\u003eZookeeper 客户端基础命令使用\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n    \u003c/div\u003e",
  "Date": "2020-06-02T14:28:38Z",
  "Author": "钝悟 ◾ Dunwu"
}