{
  "Source": "dunwu",
  "Title": "ã€Šåˆ†å¸ƒå¼åè®®ä¸ç®—æ³•å®æˆ˜ã€‹ç¬”è®°",
  "Link": "https://dunwu.github.io/blog/pages/53d3f7/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\u003ch1 id=\"ã€Šåˆ†å¸ƒå¼åè®®ä¸ç®—æ³•å®æˆ˜ã€‹ç¬”è®°\"\u003e\u003ca href=\"#ã€Šåˆ†å¸ƒå¼åè®®ä¸ç®—æ³•å®æˆ˜ã€‹ç¬”è®°\" class=\"headerlink\" title=\"ã€Šåˆ†å¸ƒå¼åè®®ä¸ç®—æ³•å®æˆ˜ã€‹ç¬”è®°\"\u003e\u003c/a\u003eã€Šåˆ†å¸ƒå¼åè®®ä¸ç®—æ³•å®æˆ˜ã€‹ç¬”è®°\u003c/h1\u003e\u003ch2 id=\"æ‹œå åº­å°†å†›é—®é¢˜\"\u003e\u003ca href=\"#æ‹œå åº­å°†å†›é—®é¢˜\" class=\"headerlink\" title=\"æ‹œå åº­å°†å†›é—®é¢˜\"\u003e\u003c/a\u003eæ‹œå åº­å°†å†›é—®é¢˜\u003c/h2\u003e\u003cblockquote\u003e\n\u003cp\u003eæ‹œå åº­å°†å†›é—®é¢˜æ˜¯ç”±\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://zh.wikipedia.org/wiki/%E8%8E%B1%E6%96%AF%E5%88%A9%C2%B7%E5%85%B0%E6%B3%A2%E7%89%B9\"\u003eè±æ–¯åˆ©Â·å…°æ³¢ç‰¹\u003c/a\u003eåœ¨å…¶åŒåè®ºæ–‡ä¸­æå‡ºçš„\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://zh.wikipedia.org/wiki/%E5%AF%B9%E7%AD%89%E7%BD%91%E7%BB%9C\"\u003eåˆ†å¸ƒå¼å¯¹ç­‰ç½‘ç»œ\u003c/a\u003eé€šä¿¡å®¹é”™é—®é¢˜ã€‚å…¶å®æ˜¯å€Ÿæ‹œå åº­å°†å†›çš„ä¾‹å­ï¼ŒæŠ›å‡ºäº†åˆ†å¸ƒå¼å…±è¯†æ€§é—®é¢˜ï¼Œå¹¶æ¢è®¨å’Œè®ºè¯äº†è§£å†³çš„æ–¹æ³•ã€‚\u003c/p\u003e\n\u003cp\u003eåœ¨\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://zh.wikipedia.org/wiki/%E5%88%86%E5%B8%83%E5%BC%8F%E8%A8%88%E7%AE%97\"\u003eåˆ†å¸ƒå¼è®¡ç®—\u003c/a\u003eä¸­ï¼Œä¸åŒçš„èŠ‚ç‚¹é€šè¿‡é€šè®¯äº¤æ¢ä¿¡æ¯è¾¾æˆå…±è¯†è€ŒæŒ‰ç…§åŒä¸€å¥—åä½œç­–ç•¥è¡ŒåŠ¨ã€‚ä½†æœ‰æ—¶å€™ï¼Œç³»ç»Ÿä¸­çš„èŠ‚ç‚¹å¯èƒ½å‡ºé”™è€Œå‘é€é”™è¯¯çš„ä¿¡æ¯ï¼Œç”¨äºä¼ é€’ä¿¡æ¯çš„é€šè®¯ç½‘ç»œä¹Ÿå¯èƒ½å¯¼è‡´ä¿¡æ¯æŸåï¼Œä½¿å¾—ç½‘ç»œä¸­ä¸åŒçš„æˆå‘˜å…³äºå…¨ä½“åä½œçš„ç­–ç•¥å¾—å‡ºä¸åŒç»“è®ºï¼Œä»è€Œç ´åç³»ç»Ÿä¸€è‡´æ€§ã€‚æ‹œå åº­å°†å†›é—®é¢˜è¢«è®¤ä¸ºæ˜¯å®¹é”™æ€§é—®é¢˜ä¸­æœ€éš¾çš„é—®é¢˜ç±»å‹ä¹‹ä¸€ã€‚\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"é—®é¢˜æè¿°\"\u003e\u003ca href=\"#é—®é¢˜æè¿°\" class=\"headerlink\" title=\"é—®é¢˜æè¿°\"\u003e\u003c/a\u003eé—®é¢˜æè¿°\u003c/h3\u003e\u003cp\u003eä¸€ç¾¤æ‹œå åº­å°†å†›å„é¢†ä¸€æ”¯å†›é˜Ÿå…±åŒå›´å›°ä¸€åº§åŸå¸‚ã€‚\u003c/p\u003e\n\u003cp\u003eä¸ºäº†ç®€åŒ–é—®é¢˜ï¼Œå†›é˜Ÿçš„è¡ŒåŠ¨ç­–ç•¥åªæœ‰ä¸¤ç§ï¼š\u003cstrong\u003eè¿›æ”»\u003c/strong\u003eï¼ˆAttackï¼Œåé¢ç®€ç§° Aï¼‰æˆ– \u003cstrong\u003eæ’¤é€€\u003c/strong\u003eï¼ˆRetreatï¼Œåé¢ç®€ç§° Rï¼‰ã€‚å¦‚æœè¿™äº›å†›é˜Ÿä¸æ˜¯ç»Ÿä¸€è¿›æ”»æˆ–æ’¤é€€ï¼Œå°±å¯èƒ½å› å…µåŠ›ä¸è¶³å¯¼è‡´å¤±è´¥ã€‚å› æ­¤ï¼Œ\u003cstrong\u003eå°†å†›ä»¬é€šè¿‡æŠ•ç¥¨æ¥è¾¾æˆä¸€è‡´ç­–ç•¥ï¼šåŒè¿›æˆ–åŒé€€\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cp\u003eå› ä¸ºå°†å†›ä»¬åˆ†åˆ«åœ¨åŸå¸‚çš„ä¸åŒæ–¹ä½ï¼Œæ‰€ä»¥ä»–ä»¬åªèƒ½\u003cstrong\u003eé€šè¿‡ä¿¡ä½¿äº’ç›¸è”ç³»\u003c/strong\u003eã€‚åœ¨æŠ•ç¥¨è¿‡ç¨‹ä¸­ï¼Œ\u003cstrong\u003eæ¯ä½å°†å†›éƒ½å°†è‡ªå·±çš„æŠ•ç¥¨ä¿¡æ¯ï¼ˆA æˆ– Rï¼‰é€šçŸ¥å…¶ä»–æ‰€æœ‰å°†å†›\u003c/strong\u003eï¼Œè¿™æ ·ä¸€æ¥æ¯ä½å°†å†›æ ¹æ®è‡ªå·±çš„æŠ•ç¥¨å’Œå…¶ä»–æ‰€æœ‰å°†å†›é€æ¥çš„ä¿¡æ¯å°±å¯ä»¥åˆ†æå‡ºå…±åŒçš„æŠ•ç¥¨ç»“æœè€Œå†³å®šè¡ŒåŠ¨ç­–ç•¥ã€‚\u003c/p\u003e\n\u003cp\u003eè¿™ä¸ªæŠ½è±¡æ¨¡å‹çš„é—®é¢˜åœ¨äºï¼š\u003cstrong\u003eå°†å†›ä¸­å¯èƒ½å­˜åœ¨å›å¾’ï¼Œä»–ä»¬ä¸ä»…ä¼šå‘å‡ºè¯¯å¯¼æ€§æŠ•ç¥¨ï¼Œè¿˜å¯èƒ½é€‰æ‹©æ€§åœ°å‘é€æŠ•ç¥¨ä¿¡æ¯\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cp\u003eç”±äºå°†å†›ä¹‹é—´éœ€è¦é€šè¿‡ä¿¡ä½¿é€šè®¯ï¼Œå›å˜å°†å†›å¯èƒ½é€šè¿‡ä¼ªé€ ä¿¡ä»¶æ¥ä»¥å…¶ä»–å°†å†›çš„èº«ä»½å‘é€å‡æŠ•ç¥¨ã€‚è€Œå³ä½¿åœ¨ä¿è¯æ‰€æœ‰å°†å†›å¿ è¯šçš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¸èƒ½æ’é™¤ä¿¡ä½¿è¢«æ•Œäººæˆªæ€ï¼Œç”šè‡³è¢«æ•Œäººé—´è°æ›¿æ¢ç­‰æƒ…å†µã€‚å› æ­¤å¾ˆéš¾é€šè¿‡ä¿è¯äººå‘˜å¯é æ€§åŠé€šè®¯å¯é æ€§æ¥è§£å†³é—®é¢˜ã€‚\u003c/p\u003e\n\u003cp\u003eå‡ä½¿é‚£äº›å¿ è¯šï¼ˆæˆ–æ˜¯æ²¡æœ‰å‡ºé”™ï¼‰çš„å°†å†›ä»ç„¶èƒ½é€šè¿‡å¤šæ•°å†³å®šæ¥å†³å®šä»–ä»¬çš„æˆ˜ç•¥ï¼Œä¾¿ç§°è¾¾åˆ°äº†æ‹œå åº­å®¹é”™ã€‚åœ¨æ­¤ï¼Œç¥¨éƒ½ä¼šæœ‰ä¸€ä¸ªé»˜è®¤å€¼ï¼Œè‹¥æ¶ˆæ¯ï¼ˆç¥¨ï¼‰æ²¡æœ‰è¢«æ”¶åˆ°ï¼Œåˆ™ä½¿ç”¨æ­¤é»˜è®¤å€¼æ¥æŠ•ç¥¨ã€‚\u003c/p\u003e\n\u003cp\u003eä¸Šè¿°çš„æ•…äº‹å¯ä»¥æ˜ å°„åˆ°åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œ_å°†å†›ä»£è¡¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„èŠ‚ç‚¹ï¼›ä¿¡ä½¿ä»£è¡¨é€šä¿¡ç³»ç»Ÿï¼›å›å¾’ä»£è¡¨æ•…éšœæˆ–å¼‚å¸¸_ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/snap/20210704104211.png\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003ch3 id=\"é—®é¢˜åˆ†æ\"\u003e\u003ca href=\"#é—®é¢˜åˆ†æ\" class=\"headerlink\" title=\"é—®é¢˜åˆ†æ\"\u003e\u003c/a\u003eé—®é¢˜åˆ†æ\u003c/h3\u003e\u003cblockquote\u003e\n\u003cp\u003eå…°ä¼¯ç‰¹é’ˆå¯¹æ‹œå åº­å°†å†›é—®é¢˜ï¼Œç»™å‡ºäº†ä¸¤ä¸ªè§£å†³æ–¹æ¡ˆï¼šå£å¤´åè®®å’Œä¹¦é¢åè®®ã€‚\u003c/p\u003e\n\u003cp\u003eæœ¬æ–‡ä»‹ç»ä¸€ä¸‹å£å¤´åè®®ã€‚\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eåœ¨å£å¤´åè®®ä¸­ï¼Œæ‹œå åº­å°†å†›é—®é¢˜è¢«ç®€åŒ–ä¸º\u003cstrong\u003eå°†å†› - å‰¯å®˜\u003c/strong\u003eæ¨¡å‹ï¼Œå…¶æ ¸å¿ƒè§„åˆ™å¦‚ä¸‹ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå¿ è¯šçš„å‰¯å®˜éµå®ˆåŒä¸€å‘½ä»¤ã€‚\u003c/li\u003e\n\u003cli\u003eè‹¥å°†å†›æ˜¯å¿ è¯šçš„ï¼Œæ‰€æœ‰å¿ è¯šçš„å‰¯å®˜éƒ½æ‰§è¡Œä»–çš„å‘½ä»¤ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå¦‚æœå›å¾’äººæ•°ä¸º mï¼Œå°†å†›äººæ•°ä¸èƒ½å°‘äº 3m + 1\u003c/strong\u003e ï¼Œé‚£ä¹ˆæ‹œå åº­å°†å†›é—®é¢˜å°±èƒ½è§£å†³äº†ã€‚â€”â€”å…³äºè¿™ä¸ªå…¬å¼ï¼Œå¯ä»¥ä¸å¿…æ·±ç©¶ï¼Œå¦‚æœå¯¹æ¨å¯¼è¿‡ç¨‹æ„Ÿå…´è¶£ï¼Œå¯ä»¥å‚è€ƒè®ºæ–‡ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eç¤ºä¾‹ä¸€ã€å›å¾’äººæ•°ä¸º 1ï¼Œå°†å†›äººæ•°ä¸º 3\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/snap/20210704112012.png\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003cp\u003eè¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå°†å†›äººæ•°ä¸æ»¡è¶³ 3m + 1ï¼Œæ— æ³•ä¿è¯å¿ è¯šçš„å‰¯å®˜éƒ½æ‰§è¡Œå°†å†›çš„å‘½ä»¤ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eç¤ºä¾‹äºŒã€å›å¾’äººæ•°ä¸º 1ï¼Œå°†å†›äººæ•°ä¸º 4\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/snap/20210704194815.png\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003cp\u003eè¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå°†å†›äººæ•°æ»¡è¶³ 3m + 1ï¼Œæ— è®ºæ˜¯å‰¯å®˜ä¸­æœ‰å›å¾’ï¼Œè¿˜æ˜¯å°†å†›æ˜¯å›å¾’ï¼Œéƒ½èƒ½ä¿è¯å¿ è¯šçš„å‰¯å®˜æ‰§è¡Œå°†å†›çš„å‘½ä»¤ã€‚\u003c/p\u003e\n\u003ch2 id=\"CAP-ç†è®º\"\u003e\u003ca href=\"#CAP-ç†è®º\" class=\"headerlink\" title=\"CAP ç†è®º\"\u003e\u003c/a\u003eCAP ç†è®º\u003c/h2\u003e\u003cp\u003eCAP æ˜¯æŒ‡ï¼šåœ¨ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œ ä¸€è‡´æ€§ã€å¯ç”¨æ€§å’Œåˆ†åŒºå®¹å¿æ€§ï¼Œæœ€å¤šåªèƒ½åŒæ—¶æ»¡è¶³å…¶ä¸­ä¸¤é¡¹ã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eä¸€è‡´æ€§ï¼ˆCï¼šConsistencyï¼‰\u003c/strong\u003eï¼šå¤šä¸ªæ•°æ®å‰¯æœ¬æ˜¯å¦èƒ½ä¿æŒä¸€è‡´\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå¯ç”¨æ€§ï¼ˆAï¼šAvailabilityï¼‰\u003c/strong\u003eï¼šåˆ†å¸ƒå¼ç³»ç»Ÿåœ¨é¢å¯¹å„ç§å¼‚å¸¸æ—¶å¯ä»¥æä¾›æ­£å¸¸æœåŠ¡çš„èƒ½åŠ›\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eåˆ†åŒºå®¹å¿æ€§ï¼ˆPï¼šPartition Toleranceï¼‰\u003c/strong\u003eï¼šåˆ†å¸ƒå¼ç³»ç»Ÿåœ¨é‡åˆ°ä»»ä½•ç½‘ç»œåˆ†åŒºæ•…éšœçš„æ—¶å€™ï¼Œä»ç„¶éœ€è¦èƒ½å¯¹å¤–æä¾›ä¸€è‡´æ€§å’Œå¯ç”¨æ€§çš„æœåŠ¡ï¼Œé™¤éæ˜¯æ•´ä¸ªç½‘ç»œç¯å¢ƒéƒ½å‘ç”Ÿäº†æ•…éšœ\u003c/li\u003e\n\u003c/ul\u003e\n\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/snap/20211102191636.png\" style=\"width: 400px\"/\u003e\n\n\u003cp\u003eCAP æƒè¡¡\u003c/p\u003e\n\u003cp\u003eåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œåˆ†åŒºå®¹å¿æ€§å¿…ä¸å¯å°‘ï¼Œå› ä¸ºéœ€è¦æ€»æ˜¯å‡è®¾ç½‘ç»œæ˜¯ä¸å¯é çš„ï¼›CAP ç†è®ºå®é™…åœ¨æ˜¯è¦åœ¨å¯ç”¨æ€§å’Œä¸€è‡´æ€§ä¹‹é—´åšæƒè¡¡ã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eCP\u003c/strong\u003eï¼šéœ€è¦è®©æ‰€æœ‰èŠ‚ç‚¹ä¸‹çº¿æˆä¸ºä¸å¯ç”¨çš„çŠ¶æ€ï¼Œç­‰å¾…åŒæ­¥å®Œæˆã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAP\u003c/strong\u003eï¼šåœ¨åŒæ­¥è¿‡ç¨‹ä¸­å…è®¸è¯»å–æ‰€æœ‰èŠ‚ç‚¹çš„æ•°æ®ï¼Œä½†æ˜¯æ•°æ®å¯èƒ½ä¸ä¸€è‡´ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"ACID-ç†è®º\"\u003e\u003ca href=\"#ACID-ç†è®º\" class=\"headerlink\" title=\"ACID ç†è®º\"\u003e\u003c/a\u003eACID ç†è®º\u003c/h2\u003e\u003cp\u003eACID ç‰¹æ€§ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eåŸå­æ€§ï¼ˆAtomicityï¼‰\u003c/strong\u003e\u003cul\u003e\n\u003cli\u003eäº‹åŠ¡è¢«è§†ä¸ºä¸å¯åˆ†å‰²çš„æœ€å°å•å…ƒï¼Œäº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨æäº¤æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥å›æ»šã€‚\u003c/li\u003e\n\u003cli\u003eå›æ»šå¯ä»¥ç”¨æ—¥å¿—æ¥å®ç°ï¼Œæ—¥å¿—è®°å½•ç€äº‹åŠ¡æ‰€æ‰§è¡Œçš„ä¿®æ”¹æ“ä½œï¼Œåœ¨å›æ»šæ—¶åå‘æ‰§è¡Œè¿™äº›ä¿®æ”¹æ“ä½œå³å¯ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eä¸€è‡´æ€§ï¼ˆConsistencyï¼‰\u003c/strong\u003e\u003cul\u003e\n\u003cli\u003eæ•°æ®åº“åœ¨äº‹åŠ¡æ‰§è¡Œå‰åéƒ½ä¿æŒä¸€è‡´æ€§çŠ¶æ€ã€‚\u003c/li\u003e\n\u003cli\u003eåœ¨ä¸€è‡´æ€§çŠ¶æ€ä¸‹ï¼Œæ‰€æœ‰äº‹åŠ¡å¯¹ä¸€ä¸ªæ•°æ®çš„è¯»å–ç»“æœéƒ½æ˜¯ç›¸åŒçš„ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eéš”ç¦»æ€§ï¼ˆIsolationï¼‰\u003c/strong\u003e\u003cul\u003e\n\u003cli\u003eä¸€ä¸ªäº‹åŠ¡æ‰€åšçš„ä¿®æ”¹åœ¨æœ€ç»ˆæäº¤ä»¥å‰ï¼Œå¯¹å…¶å®ƒäº‹åŠ¡æ˜¯ä¸å¯è§çš„ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eæŒä¹…æ€§ï¼ˆDurabilityï¼‰\u003c/strong\u003e\u003cul\u003e\n\u003cli\u003eä¸€æ—¦äº‹åŠ¡æäº¤ï¼Œåˆ™å…¶æ‰€åšçš„ä¿®æ”¹å°†ä¼šæ°¸è¿œä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚å³ä½¿ç³»ç»Ÿå‘ç”Ÿå´©æºƒï¼Œäº‹åŠ¡æ‰§è¡Œçš„ç»“æœä¹Ÿä¸èƒ½ä¸¢å¤±ã€‚\u003c/li\u003e\n\u003cli\u003eå¯ä»¥é€šè¿‡æ•°æ®åº“å¤‡ä»½å’Œæ¢å¤æ¥å®ç°ï¼Œåœ¨ç³»ç»Ÿå‘ç”Ÿå¥”æºƒæ—¶ï¼Œä½¿ç”¨å¤‡ä»½çš„æ•°æ®åº“è¿›è¡Œæ•°æ®æ¢å¤ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/cs/database/RDB/%E6%95%B0%E6%8D%AE%E5%BA%93ACID.png\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003cp\u003eåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å®ç° ACID æ¯”å•æœºå¤æ‚çš„å¤šã€‚\u003c/p\u003e\n\u003cp\u003eåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å®ç° ACIDï¼Œå³å®ç°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå…·ä½“çš„æ–¹æ¡ˆæœ‰å¦‚ä¸‹å‡ ç§ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eä¸¤é˜¶æ®µæäº¤ï¼ˆ2PCï¼‰\u003c/li\u003e\n\u003cli\u003eä¸‰é˜¶æ®µæäº¤ï¼ˆ3PCï¼‰\u003c/li\u003e\n\u003cli\u003eè¡¥å¿äº‹åŠ¡ï¼ˆTCCï¼‰\u003c/li\u003e\n\u003cli\u003eæœ¬åœ°æ¶ˆæ¯è¡¨ï¼ˆå¼‚æ­¥ç¡®ä¿ï¼‰\u003c/li\u003e\n\u003cli\u003eMQ äº‹åŠ¡æ¶ˆæ¯\u003c/li\u003e\n\u003cli\u003eSagas äº‹åŠ¡æ¨¡å‹\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"BASE-ç†è®º\"\u003e\u003ca href=\"#BASE-ç†è®º\" class=\"headerlink\" title=\"BASE ç†è®º\"\u003e\u003c/a\u003eBASE ç†è®º\u003c/h2\u003e\u003cp\u003eBASE ç†è®ºæ˜¯å¯¹ CAP ä¸­ä¸€è‡´æ€§å’Œå¯ç”¨æ€§æƒè¡¡çš„ç»“æœã€‚\u003c/p\u003e\n\u003cp\u003eBASE æ˜¯æŒ‡ï¼šå³ä½¿æ— æ³•åšåˆ°å¼ºä¸€è‡´æ€§ï¼Œä½†æ¯ä¸ªåº”ç”¨éƒ½å¯ä»¥æ ¹æ®è‡ªèº«ä¸šåŠ¡ç‰¹ç‚¹ï¼Œé‡‡ç”¨é€‚å½“çš„æ–¹å¼æ¥ä½¿ç³»ç»Ÿè¾¾åˆ°æœ€ç»ˆä¸€è‡´æ€§ã€‚\u003c/p\u003e\n\u003cp\u003eBASE ç‰¹æ€§\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eåŸºæœ¬å¯ç”¨ï¼ˆBasically Availableï¼‰\u003c/strong\u003eï¼šæŒ‡åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨å‡ºç°æ•…éšœçš„æ—¶å€™ï¼Œä¿è¯æ ¸å¿ƒå¯ç”¨ï¼Œå…è®¸æŸå¤±éƒ¨åˆ†å¯ç”¨æ€§ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eè½¯çŠ¶æ€ï¼ˆSoft Stateï¼‰\u003c/strong\u003eï¼šæŒ‡å…è®¸ç³»ç»Ÿä¸­çš„æ•°æ®å­˜åœ¨ä¸­é—´çŠ¶æ€ï¼Œå¹¶è®¤ä¸ºè¯¥ä¸­é—´çŠ¶æ€ä¸ä¼šå½±å“ç³»ç»Ÿæ•´ä½“å¯ç”¨æ€§ï¼Œå³å…è®¸ç³»ç»Ÿä¸åŒèŠ‚ç‚¹çš„æ•°æ®å‰¯æœ¬ä¹‹é—´è¿›è¡ŒåŒæ­¥çš„è¿‡ç¨‹å­˜åœ¨å»¶æ—¶ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eæœ€ç»ˆä¸€è‡´æ€§ï¼ˆEventually Consistentï¼‰\u003c/strong\u003eï¼šæœ€ç»ˆä¸€è‡´æ€§å¼ºè°ƒçš„æ˜¯ç³»ç»Ÿä¸­æ‰€æœ‰çš„æ•°æ®å‰¯æœ¬ï¼Œåœ¨ç»è¿‡ä¸€æ®µæ—¶é—´çš„åŒæ­¥åï¼Œæœ€ç»ˆèƒ½è¾¾åˆ°ä¸€è‡´çš„çŠ¶æ€ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/cs/design/architecture/%E5%88%86%E5%B8%83%E5%BC%8F%E7%90%86%E8%AE%BA-BASE.png\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003ch2 id=\"Paxos-ç®—æ³•\"\u003e\u003ca href=\"#Paxos-ç®—æ³•\" class=\"headerlink\" title=\"Paxos ç®—æ³•\"\u003e\u003c/a\u003ePaxos ç®—æ³•\u003c/h2\u003e\u003cp\u003ePaxos æ˜¯ Leslie Lamport äº 1990 å¹´æå‡ºçš„ä¸€ç§åŸºäºæ¶ˆæ¯ä¼ é€’ä¸”å…·æœ‰é«˜åº¦å®¹é”™ç‰¹æ€§çš„å…±è¯†ï¼ˆconsensusï¼‰ç®—æ³•ã€‚\u003c/p\u003e\n\u003cp\u003ePaxos ç®—æ³•åŒ…å« 2 ä¸ªéƒ¨åˆ†ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eBasic Paxos ç®—æ³•\u003c/strong\u003eï¼šæè¿°çš„å¤šèŠ‚ç‚¹ä¹‹é—´å¦‚ä½•å°±æŸä¸ªå€¼è¾¾æˆå…±è¯†ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMulti Paxos æ€æƒ³\u003c/strong\u003eï¼šæè¿°çš„æ˜¯æ‰§è¡Œå¤šä¸ª Basic Paxos å®ä¾‹ï¼Œå°±ä¸€ç³»åˆ—å€¼è¾¾æˆå…±è¯†ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ePaxos ç®—æ³•è§£å†³çš„é—®é¢˜æ­£æ˜¯åˆ†å¸ƒå¼å…±è¯†æ€§é—®é¢˜ï¼Œå³ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å„ä¸ªè¿›ç¨‹å¦‚ä½•å°±æŸä¸ªå€¼ï¼ˆå†³è®®ï¼‰è¾¾æˆä¸€è‡´ã€‚\u003c/p\u003e\n\u003cp\u003ePaxos ç®—æ³•è¿è¡Œåœ¨å…è®¸å®•æœºæ•…éšœçš„å¼‚æ­¥ç³»ç»Ÿä¸­ï¼Œä¸è¦æ±‚å¯é çš„æ¶ˆæ¯ä¼ é€’ï¼Œå¯å®¹å¿æ¶ˆæ¯ä¸¢å¤±ã€å»¶è¿Ÿã€ä¹±åºä»¥åŠé‡å¤ã€‚å®ƒåˆ©ç”¨å¤§å¤šæ•° (Majority) æœºåˆ¶ä¿è¯äº† 2N+1 çš„å®¹é”™èƒ½åŠ›ï¼Œå³ 2N+1 ä¸ªèŠ‚ç‚¹çš„ç³»ç»Ÿæœ€å¤šå…è®¸ N ä¸ªèŠ‚ç‚¹åŒæ—¶å‡ºç°æ•…éšœã€‚\u003c/p\u003e\n\u003ch3 id=\"Basic-Paxos-ç®—æ³•\"\u003e\u003ca href=\"#Basic-Paxos-ç®—æ³•\" class=\"headerlink\" title=\"Basic Paxos ç®—æ³•\"\u003e\u003c/a\u003eBasic Paxos ç®—æ³•\u003c/h3\u003e\u003ch4 id=\"è§’è‰²\"\u003e\u003ca href=\"#è§’è‰²\" class=\"headerlink\" title=\"è§’è‰²\"\u003e\u003c/a\u003eè§’è‰²\u003c/h4\u003e\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/snap/20210528150700.png\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eæè®®è€…ï¼ˆProposerï¼‰\u003c/strong\u003eï¼šå‘å‡ºææ¡ˆï¼ˆProposalï¼‰ï¼Œç”¨äºæŠ•ç¥¨è¡¨å†³ã€‚Proposal ä¿¡æ¯åŒ…æ‹¬ææ¡ˆç¼–å· (Proposal ID) å’Œæè®®çš„å€¼ (Value)ã€‚åœ¨ç»å¤§å¤šæ•°åœºæ™¯ä¸­ï¼Œé›†ç¾¤ä¸­æ”¶åˆ°å®¢æˆ·ç«¯è¯·æ±‚çš„èŠ‚ç‚¹ï¼Œæ‰æ˜¯æè®®è€…ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œå¯¹ä¸šåŠ¡ä»£ç æ²¡æœ‰å…¥ä¾µæ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä¸éœ€è¦åœ¨ä¸šåŠ¡ä»£ç ä¸­å®ç°ç®—æ³•é€»è¾‘ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå†³ç­–è€…ï¼ˆAcceptorï¼‰\u003c/strong\u003eï¼šå¯¹æ¯ä¸ª Proposal è¿›è¡ŒæŠ•ç¥¨ï¼Œè‹¥ Proposal è·å¾—å¤šæ•° Acceptor çš„æ¥å—ï¼Œåˆ™ç§°è¯¥ Proposal è¢«æ‰¹å‡†ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œé›†ç¾¤ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½åœ¨æ‰®æ¼”å†³ç­–è€…çš„è§’è‰²ï¼Œå‚ä¸å…±è¯†åå•†ï¼Œå¹¶æ¥å—å’Œå­˜å‚¨æ•°æ®ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå­¦ä¹ è€…ï¼ˆLearnerï¼‰\u003c/strong\u003eï¼šä¸å‚ä¸å†³ç­–ï¼Œä» Proposers/Acceptors å­¦ä¹ ã€è®°å½•æœ€æ–°è¾¾æˆå…±è¯†çš„ææ¡ˆï¼ˆValueï¼‰ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå­¦ä¹ è€…æ˜¯æ•°æ®å¤‡ä»½èŠ‚ç‚¹ï¼Œæ¯”å¦‚ä¸»ä»æ¶æ„ä¸­çš„ä»èŠ‚ç‚¹ï¼Œè¢«åŠ¨åœ°æ¥å—æ•°æ®ï¼Œå®¹ç¾å¤‡ä»½ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eåœ¨å¤šå‰¯æœ¬çŠ¶æ€æœºä¸­ï¼Œæ¯ä¸ªå‰¯æœ¬éƒ½åŒæ—¶å…·æœ‰ Proposerã€Acceptorã€Learner ä¸‰ç§è§’è‰²ã€‚\u003c/p\u003e\n\u003cp\u003eè¿™ä¸‰ç§è§’è‰²ï¼Œåœ¨æœ¬è´¨ä¸Šä»£è¡¨çš„æ˜¯ä¸‰ç§åŠŸèƒ½ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eæè®®è€…ä»£è¡¨çš„æ˜¯æ¥å…¥å’Œåè°ƒåŠŸèƒ½ï¼Œæ”¶åˆ°å®¢æˆ·ç«¯è¯·æ±‚åï¼Œå‘èµ·äºŒé˜¶æ®µæäº¤ï¼Œè¿›è¡Œå…±è¯†åå•†ï¼›\u003c/li\u003e\n\u003cli\u003eæ¥å—è€…ä»£è¡¨æŠ•ç¥¨åå•†å’Œå­˜å‚¨æ•°æ®ï¼Œå¯¹æè®®çš„å€¼è¿›è¡ŒæŠ•ç¥¨ï¼Œå¹¶æ¥å—è¾¾æˆå…±è¯†çš„å€¼ï¼Œå­˜å‚¨ä¿å­˜ï¼›\u003c/li\u003e\n\u003cli\u003eå­¦ä¹ è€…ä»£è¡¨å­˜å‚¨æ•°æ®ï¼Œä¸å‚ä¸å…±è¯†åå•†ï¼Œåªæ¥å—è¾¾æˆå…±è¯†çš„å€¼ï¼Œå­˜å‚¨ä¿å­˜ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"ç®—æ³•\"\u003e\u003ca href=\"#ç®—æ³•\" class=\"headerlink\" title=\"ç®—æ³•\"\u003e\u003c/a\u003eç®—æ³•\u003c/h4\u003e\u003cp\u003ePaxos ç®—æ³•é€šè¿‡ä¸€ä¸ªå†³è®®åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼ˆLearn é˜¶æ®µä¹‹å‰å†³è®®å·²ç»å½¢æˆï¼‰ï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003ePrepare é˜¶æ®µ\u003c/strong\u003eï¼šProposer å‘ Acceptors å‘å‡º Prepare è¯·æ±‚ï¼ŒAcceptors é’ˆå¯¹æ”¶åˆ°çš„ Prepare è¯·æ±‚è¿›è¡Œ Promise æ‰¿è¯ºã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eAccept é˜¶æ®µ\u003c/strong\u003eï¼šProposer æ”¶åˆ°å¤šæ•° Acceptors æ‰¿è¯ºçš„ Promise åï¼Œå‘ Acceptors å‘å‡º Propose è¯·æ±‚ï¼ŒAcceptors é’ˆå¯¹æ”¶åˆ°çš„ Propose è¯·æ±‚è¿›è¡Œ Accept å¤„ç†ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eLearn é˜¶æ®µ\u003c/strong\u003eï¼šProposer åœ¨æ”¶åˆ°å¤šæ•° Acceptors çš„ Accept ä¹‹åï¼Œæ ‡å¿—ç€æœ¬æ¬¡ Accept æˆåŠŸï¼Œå†³è®®å½¢æˆï¼Œå°†å½¢æˆçš„å†³è®®å‘é€ç»™æ‰€æœ‰ Learnersã€‚\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003ePaxos ç®—æ³•æµç¨‹ä¸­çš„æ¯æ¡æ¶ˆæ¯æè¿°å¦‚ä¸‹ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003e\u003cstrong\u003ePrepare\u003c/strong\u003e: Proposer ç”Ÿæˆå…¨å±€å”¯ä¸€ä¸”é€’å¢çš„ Proposal ID (å¯ä½¿ç”¨æ—¶é—´æˆ³åŠ  Server ID)ï¼Œå‘æ‰€æœ‰ Acceptors å‘é€ Prepare è¯·æ±‚ï¼Œè¿™é‡Œæ— éœ€æºå¸¦ææ¡ˆå†…å®¹ï¼Œåªæºå¸¦ Proposal ID å³å¯ã€‚\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003cstrong\u003ePromise\u003c/strong\u003e: Acceptors æ”¶åˆ° Prepare è¯·æ±‚åï¼Œåšå‡ºâ€œä¸¤ä¸ªæ‰¿è¯ºï¼Œä¸€ä¸ªåº”ç­”â€ã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003eä¸¤ä¸ªæ‰¿è¯ºï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eä¸å†æ¥å— Proposal ID å°äºç­‰äºå½“å‰è¯·æ±‚çš„ Prepare è¯·æ±‚ã€‚\u003c/li\u003e\n\u003cli\u003eä¸å†æ¥å— Proposal ID å°äºå½“å‰è¯·æ±‚çš„ Propose è¯·æ±‚ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eä¸€ä¸ªåº”ç­”ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eä¸è¿èƒŒä»¥å‰ä½œå‡ºçš„æ‰¿è¯ºä¸‹ï¼Œå›å¤å·²ç» Accept è¿‡çš„ææ¡ˆä¸­ Proposal ID æœ€å¤§çš„é‚£ä¸ªææ¡ˆçš„ Value å’Œ Proposal IDï¼Œæ²¡æœ‰åˆ™è¿”å›ç©ºå€¼ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003cstrong\u003ePropose\u003c/strong\u003e: Proposer æ”¶åˆ°å¤šæ•° Acceptors çš„ Promise åº”ç­”åï¼Œä»åº”ç­”ä¸­é€‰æ‹© Proposal ID æœ€å¤§çš„ææ¡ˆçš„ Valueï¼Œä½œä¸ºæœ¬æ¬¡è¦å‘èµ·çš„ææ¡ˆã€‚å¦‚æœæ‰€æœ‰åº”ç­”çš„ææ¡ˆ Value å‡ä¸ºç©ºå€¼ï¼Œåˆ™å¯ä»¥è‡ªå·±éšæ„å†³å®šææ¡ˆ Valueã€‚ç„¶åæºå¸¦å½“å‰ Proposal IDï¼Œå‘æ‰€æœ‰ Acceptors å‘é€ Propose è¯·æ±‚ã€‚\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003cstrong\u003eAccept\u003c/strong\u003e: Acceptor æ”¶åˆ° Propose è¯·æ±‚åï¼Œåœ¨ä¸è¿èƒŒè‡ªå·±ä¹‹å‰ä½œå‡ºçš„æ‰¿è¯ºä¸‹ï¼Œæ¥å—å¹¶æŒä¹…åŒ–å½“å‰ Proposal ID å’Œææ¡ˆ Valueã€‚\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003cstrong\u003eLearn\u003c/strong\u003e: Proposer æ”¶åˆ°å¤šæ•° Acceptors çš„ Accept åï¼Œå†³è®®å½¢æˆï¼Œå°†å½¢æˆçš„å†³è®®å‘é€ç»™æ‰€æœ‰ Learnersã€‚\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"Multi-Paxos-æ€æƒ³\"\u003e\u003ca href=\"#Multi-Paxos-æ€æƒ³\" class=\"headerlink\" title=\"Multi Paxos æ€æƒ³\"\u003e\u003c/a\u003eMulti Paxos æ€æƒ³\u003c/h3\u003e\u003ch4 id=\"Basic-Paxos-çš„é—®é¢˜\"\u003e\u003ca href=\"#Basic-Paxos-çš„é—®é¢˜\" class=\"headerlink\" title=\"Basic Paxos çš„é—®é¢˜\"\u003e\u003c/a\u003eBasic Paxos çš„é—®é¢˜\u003c/h4\u003e\u003cp\u003eBasic Paxos æœ‰ä»¥ä¸‹é—®é¢˜ï¼Œå¯¼è‡´å®ƒä¸èƒ½åº”ç”¨äºå®é™…ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eBasic Paxos ç®—æ³•åªèƒ½å¯¹ä¸€ä¸ªå€¼å½¢æˆå†³è®®\u003c/strong\u003eã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eBasic Paxos ç®—æ³•ä¼šæ¶ˆè€—å¤§é‡ç½‘ç»œå¸¦å®½\u003c/strong\u003eã€‚Basic Paxos ä¸­ï¼Œå†³è®®çš„å½¢æˆè‡³å°‘éœ€è¦ä¸¤æ¬¡ç½‘ç»œé€šä¿¡ï¼Œåœ¨é«˜å¹¶å‘æƒ…å†µä¸‹å¯èƒ½éœ€è¦æ›´å¤šçš„ç½‘ç»œé€šä¿¡ï¼Œæç«¯æƒ…å†µä¸‹ç”šè‡³å¯èƒ½å½¢æˆæ´»é”ã€‚å¦‚æœæƒ³è¿ç»­ç¡®å®šå¤šä¸ªå€¼ï¼ŒBasic Paxos æä¸å®šäº†ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"Multi-Paxos-çš„æ”¹è¿›\"\u003e\u003ca href=\"#Multi-Paxos-çš„æ”¹è¿›\" class=\"headerlink\" title=\"Multi Paxos çš„æ”¹è¿›\"\u003e\u003c/a\u003eMulti Paxos çš„æ”¹è¿›\u003c/h4\u003e\u003cp\u003eMulti Paxos æ­£æ˜¯ä¸ºè§£å†³ä»¥ä¸Šé—®é¢˜è€Œæå‡ºã€‚Multi Paxos åŸºäº Basic Paxos åšäº†ä¸¤ç‚¹æ”¹è¿›ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eé’ˆå¯¹æ¯ä¸€ä¸ªè¦ç¡®å®šçš„å€¼ï¼Œè¿è¡Œä¸€æ¬¡ Paxos ç®—æ³•å®ä¾‹ï¼ˆInstanceï¼‰ï¼Œå½¢æˆå†³è®®ã€‚æ¯ä¸€ä¸ª Paxos å®ä¾‹ä½¿ç”¨å”¯ä¸€çš„ Instance ID æ ‡è¯†ã€‚\u003c/li\u003e\n\u003cli\u003eåœ¨æ‰€æœ‰ Proposer ä¸­é€‰ä¸¾ä¸€ä¸ª Leaderï¼Œç”± Leader å”¯ä¸€åœ°æäº¤ Proposal ç»™ Acceptor è¿›è¡Œè¡¨å†³ã€‚è¿™æ ·æ²¡æœ‰ Proposer ç«äº‰ï¼Œè§£å†³äº†æ´»é”é—®é¢˜ã€‚åœ¨ç³»ç»Ÿä¸­ä»…æœ‰ä¸€ä¸ª Leader è¿›è¡Œ Value æäº¤çš„æƒ…å†µä¸‹ï¼ŒPrepare é˜¶æ®µå°±å¯ä»¥è·³è¿‡ï¼Œä»è€Œå°†ä¸¤é˜¶æ®µå˜ä¸ºä¸€é˜¶æ®µï¼Œæé«˜æ•ˆç‡ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eMulti Paxos é¦–å…ˆéœ€è¦é€‰ä¸¾ Leaderï¼ŒLeader çš„ç¡®å®šä¹Ÿæ˜¯ä¸€æ¬¡å†³è®®çš„å½¢æˆï¼Œæ‰€ä»¥å¯æ‰§è¡Œä¸€æ¬¡ Basic Paxos å®ä¾‹æ¥é€‰ä¸¾å‡ºä¸€ä¸ª Leaderã€‚é€‰å‡º Leader ä¹‹ååªèƒ½ç”± Leader æäº¤ Proposalï¼Œåœ¨ Leader å®•æœºä¹‹åæœåŠ¡ä¸´æ—¶ä¸å¯ç”¨ï¼Œéœ€è¦é‡æ–°é€‰ä¸¾ Leader ç»§ç»­æœåŠ¡ã€‚åœ¨ç³»ç»Ÿä¸­ä»…æœ‰ä¸€ä¸ª Leader è¿›è¡Œ Proposal æäº¤çš„æƒ…å†µä¸‹ï¼ŒPrepare é˜¶æ®µå¯ä»¥è·³è¿‡ã€‚\u003c/p\u003e\n\u003cp\u003eMulti Paxos é€šè¿‡æ”¹å˜ Prepare é˜¶æ®µçš„ä½œç”¨èŒƒå›´è‡³åé¢ Leader æäº¤çš„æ‰€æœ‰å®ä¾‹ï¼Œä»è€Œä½¿å¾— Leader çš„è¿ç»­æäº¤åªéœ€è¦æ‰§è¡Œä¸€æ¬¡ Prepare é˜¶æ®µï¼Œåç»­åªéœ€è¦æ‰§è¡Œ Accept é˜¶æ®µï¼Œå°†ä¸¤é˜¶æ®µå˜ä¸ºä¸€é˜¶æ®µï¼Œæé«˜äº†æ•ˆç‡ã€‚ä¸ºäº†åŒºåˆ†è¿ç»­æäº¤çš„å¤šä¸ªå®ä¾‹ï¼Œæ¯ä¸ªå®ä¾‹ä½¿ç”¨ä¸€ä¸ª Instance ID æ ‡è¯†ï¼ŒInstance ID ç”± Leader æœ¬åœ°é€’å¢ç”Ÿæˆå³å¯ã€‚\u003c/p\u003e\n\u003cp\u003eMulti Paxos å…è®¸æœ‰å¤šä¸ªè‡ªè®¤ä¸ºæ˜¯ Leader çš„èŠ‚ç‚¹å¹¶å‘æäº¤ Proposal è€Œä¸å½±å“å…¶å®‰å…¨æ€§ï¼Œè¿™æ ·çš„åœºæ™¯å³é€€åŒ–ä¸º Basic Paxosã€‚\u003c/p\u003e\n\u003cp\u003eChubby å’Œ Boxwood å‡ä½¿ç”¨ Multi Paxosã€‚ZooKeeper ä½¿ç”¨çš„ Zab ä¹Ÿæ˜¯ Multi Paxos çš„å˜å½¢ã€‚\u003c/p\u003e\n\u003ch2 id=\"Raft-ç®—æ³•\"\u003e\u003ca href=\"#Raft-ç®—æ³•\" class=\"headerlink\" title=\"Raft ç®—æ³•\"\u003e\u003c/a\u003eRaft ç®—æ³•\u003c/h2\u003e\u003ch3 id=\"Raft-åŸºç¡€\"\u003e\u003ca href=\"#Raft-åŸºç¡€\" class=\"headerlink\" title=\"Raft åŸºç¡€\"\u003e\u003c/a\u003eRaft åŸºç¡€\u003c/h3\u003e\u003cp\u003eRaft å°†ä¸€è‡´æ€§é—®é¢˜åˆ†è§£æˆäº†ä¸‰ä¸ªå­é—®é¢˜ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eé€‰ä¸¾ Leader\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eæ—¥å¿—å¤åˆ¶\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå®‰å…¨æ€§\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"æœåŠ¡å™¨è§’è‰²\"\u003e\u003ca href=\"#æœåŠ¡å™¨è§’è‰²\" class=\"headerlink\" title=\"æœåŠ¡å™¨è§’è‰²\"\u003e\u003c/a\u003eæœåŠ¡å™¨è§’è‰²\u003c/h4\u003e\u003cp\u003eåœ¨ Raft ä¸­ï¼Œä»»ä½•æ—¶åˆ»ï¼Œæ¯ä¸ªæœåŠ¡å™¨éƒ½å¤„äºè¿™ä¸‰ä¸ªè§’è‰²ä¹‹ä¸€ ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003eLeader\u003c/code\u003e\u003c/strong\u003e - é¢†å¯¼è€…ï¼Œé€šå¸¸ä¸€ä¸ªç³»ç»Ÿä¸­æ˜¯\u003cstrong\u003eä¸€ä¸»ï¼ˆLeaderï¼‰å¤šä»ï¼ˆFollowerï¼‰\u003c/strong\u003eã€‚Leader \u003cstrong\u003eè´Ÿè´£å¤„ç†æ‰€æœ‰çš„å®¢æˆ·ç«¯è¯·æ±‚\u003c/strong\u003eã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003eFollower\u003c/code\u003e\u003c/strong\u003e - è·Ÿéšè€…ï¼Œ\u003cstrong\u003eä¸ä¼šå‘é€ä»»ä½•è¯·æ±‚\u003c/strong\u003eï¼Œåªæ˜¯ç®€å•çš„ \u003cstrong\u003eå“åº”æ¥è‡ª Leader æˆ–è€… Candidate çš„è¯·æ±‚\u003c/strong\u003eã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003eCandidate\u003c/code\u003e\u003c/strong\u003e - å‚é€‰è€…ï¼Œé€‰ä¸¾æ–° Leader æ—¶çš„ä¸´æ—¶è§’è‰²ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/snap/20200131215742.png\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e:bulb: å›¾ç¤ºè¯´æ˜ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eFollower åªå“åº”æ¥è‡ªå…¶ä»–æœåŠ¡å™¨çš„è¯·æ±‚ã€‚åœ¨ä¸€å®šæ—¶é™å†…ï¼Œå¦‚æœ Follower æ¥æ”¶ä¸åˆ°æ¶ˆæ¯ï¼Œå°±ä¼šè½¬å˜æˆ Candidateï¼Œå¹¶å‘èµ·é€‰ä¸¾ã€‚\u003c/li\u003e\n\u003cli\u003eCandidate å‘ Follower å‘èµ·æŠ•ç¥¨è¯·æ±‚ï¼Œå¦‚æœè·å¾—é›†ç¾¤ä¸­åŠæ•°ä»¥ä¸Šçš„é€‰ç¥¨ï¼Œå°±ä¼šè½¬å˜ä¸º Leaderã€‚\u003c/li\u003e\n\u003cli\u003eåœ¨ä¸€ä¸ª Term å†…ï¼ŒLeader å§‹ç»ˆä¿æŒä¸å˜ï¼Œç›´åˆ°ä¸‹çº¿äº†ã€‚Leader éœ€è¦å‘¨æœŸæ€§å‘æ‰€æœ‰ Follower å‘é€å¿ƒè·³æ¶ˆæ¯ï¼Œä»¥é˜»æ­¢ Follower è½¬å˜ä¸º Candidateã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"ä»»æœŸ\"\u003e\u003ca href=\"#ä»»æœŸ\" class=\"headerlink\" title=\"ä»»æœŸ\"\u003e\u003c/a\u003eä»»æœŸ\u003c/h4\u003e\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/snap/20200131220742.png\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003cp\u003eRaft æŠŠæ—¶é—´åˆ†å‰²æˆä»»æ„é•¿åº¦çš„ \u003cstrong\u003e\u003cem\u003e\u003ccode\u003eä»»æœŸï¼ˆTermï¼‰\u003c/code\u003e\u003c/em\u003e\u003cstrong\u003eï¼Œä»»æœŸç”¨è¿ç»­çš„æ•´æ•°æ ‡è®°ã€‚æ¯ä¸€æ®µä»»æœŸä»ä¸€æ¬¡\u003c/strong\u003eé€‰ä¸¾\u003c/strong\u003eå¼€å§‹ã€‚\u003cstrong\u003eRaft ä¿è¯äº†åœ¨ä¸€ä¸ªç»™å®šçš„ä»»æœŸå†…ï¼Œæœ€å¤šåªæœ‰ä¸€ä¸ªé¢†å¯¼è€…\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå¦‚æœé€‰ä¸¾æˆåŠŸï¼ŒLeader ä¼šç®¡ç†æ•´ä¸ªé›†ç¾¤ç›´åˆ°ä»»æœŸç»“æŸã€‚\u003c/li\u003e\n\u003cli\u003eå¦‚æœé€‰ä¸¾å¤±è´¥ï¼Œé‚£ä¹ˆè¿™ä¸ªä»»æœŸå°±ä¼šå› ä¸ºæ²¡æœ‰ Leader è€Œç»“æŸã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eä¸åŒæœåŠ¡å™¨èŠ‚ç‚¹è§‚å¯Ÿåˆ°çš„ä»»æœŸè½¬æ¢çŠ¶æ€å¯èƒ½ä¸ä¸€æ ·\u003c/strong\u003eï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eæœåŠ¡å™¨èŠ‚ç‚¹å¯èƒ½è§‚å¯Ÿåˆ°å¤šæ¬¡çš„ä»»æœŸè½¬æ¢ã€‚\u003c/li\u003e\n\u003cli\u003eæœåŠ¡å™¨èŠ‚ç‚¹ä¹Ÿå¯èƒ½è§‚å¯Ÿä¸åˆ°ä»»ä½•ä¸€æ¬¡ä»»æœŸè½¬æ¢ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eä»»æœŸåœ¨ Raft ç®—æ³•ä¸­å……å½“é€»è¾‘æ—¶é’Ÿçš„ä½œç”¨ï¼Œä½¿å¾—æœåŠ¡å™¨èŠ‚ç‚¹å¯ä»¥æŸ¥æ˜ä¸€äº›è¿‡æœŸçš„ä¿¡æ¯ï¼ˆæ¯”å¦‚è¿‡æœŸçš„ Leaderï¼‰ã€‚æ¯ä¸ªæœåŠ¡å™¨èŠ‚ç‚¹éƒ½ä¼šå­˜å‚¨ä¸€ä¸ªå½“å‰ä»»æœŸå·ï¼Œè¿™ä¸€ç¼–å·åœ¨æ•´ä¸ªæ—¶æœŸå†…å•è°ƒçš„å¢é•¿ã€‚å½“æœåŠ¡å™¨ä¹‹é—´é€šä¿¡çš„æ—¶å€™ä¼šäº¤æ¢å½“å‰ä»»æœŸå·ã€‚\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå¦‚æœä¸€ä¸ªæœåŠ¡å™¨çš„å½“å‰ä»»æœŸå·æ¯”å…¶ä»–äººå°ï¼Œé‚£ä¹ˆä»–ä¼šæ›´æ–°è‡ªå·±çš„ç¼–å·åˆ°è¾ƒå¤§çš„ç¼–å·å€¼ã€‚\u003c/li\u003e\n\u003cli\u003eå¦‚æœä¸€ä¸ª Candidate æˆ–è€… Leader å‘ç°è‡ªå·±çš„ä»»æœŸå·è¿‡æœŸäº†ï¼Œé‚£ä¹ˆä»–ä¼šç«‹å³æ¢å¤æˆè·Ÿéšè€…çŠ¶æ€ã€‚\u003c/li\u003e\n\u003cli\u003eå¦‚æœä¸€ä¸ªèŠ‚ç‚¹æ¥æ”¶åˆ°ä¸€ä¸ªåŒ…å«è¿‡æœŸçš„ä»»æœŸå·çš„è¯·æ±‚ï¼Œé‚£ä¹ˆä»–ä¼šç›´æ¥æ‹’ç»è¿™ä¸ªè¯·æ±‚ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"RPC\"\u003e\u003ca href=\"#RPC\" class=\"headerlink\" title=\"RPC\"\u003e\u003c/a\u003eRPC\u003c/h4\u003e\u003cp\u003eRaft ç®—æ³•ä¸­æœåŠ¡å™¨èŠ‚ç‚¹ä¹‹é—´çš„é€šä¿¡ä½¿ç”¨ **_\u003ccode\u003eè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰\u003c/code\u003e_**ã€‚\u003c/p\u003e\n\u003cp\u003eåŸºæœ¬çš„ä¸€è‡´æ€§ç®—æ³•åªéœ€è¦ä¸¤ç§ RPCï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003eRequestVote RPC\u003c/code\u003e\u003c/strong\u003e - è¯·æ±‚æŠ•ç¥¨ RPCï¼Œç”± Candidate åœ¨é€‰ä¸¾æœŸé—´å‘èµ·ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003eAppendEntries RPC\u003c/code\u003e\u003c/strong\u003e - é™„åŠ æ¡ç›® RPCï¼Œç”± Leader å‘èµ·ï¼Œç”¨æ¥å¤åˆ¶æ—¥å¿—å’Œæä¾›ä¸€ç§å¿ƒè·³æœºåˆ¶ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"é€‰ä¸¾-Leader\"\u003e\u003ca href=\"#é€‰ä¸¾-Leader\" class=\"headerlink\" title=\"é€‰ä¸¾ Leader\"\u003e\u003c/a\u003eé€‰ä¸¾ Leader\u003c/h3\u003e\u003ch4 id=\"é€‰ä¸¾è§„åˆ™\"\u003e\u003ca href=\"#é€‰ä¸¾è§„åˆ™\" class=\"headerlink\" title=\"é€‰ä¸¾è§„åˆ™\"\u003e\u003c/a\u003eé€‰ä¸¾è§„åˆ™\u003c/h4\u003e\u003cp\u003e\u003cstrong\u003eRaft ä½¿ç”¨ä¸€ç§å¿ƒè·³æœºåˆ¶æ¥è§¦å‘ Leader é€‰ä¸¾\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eLeader éœ€è¦å‘¨æœŸæ€§çš„å‘æ‰€æœ‰ Follower å‘é€å¿ƒè·³æ¶ˆæ¯\u003c/strong\u003eï¼Œä»¥æ­¤ç»´æŒè‡ªå·±çš„æƒå¨å¹¶é˜»æ­¢æ–° Leader çš„äº§ç”Ÿã€‚\u003c/p\u003e\n\u003cp\u003eæ¯ä¸ª Follower éƒ½è®¾ç½®äº†ä¸€ä¸ª\u003cstrong\u003eéšæœºçš„ç«é€‰è¶…æ—¶æ—¶é—´\u003c/strong\u003eï¼Œä¸€èˆ¬ä¸º \u003ccode\u003e150ms ~ 300ms\u003c/code\u003eï¼Œå¦‚æœåœ¨ç«é€‰è¶…æ—¶æ—¶é—´å†…æ²¡æœ‰æ”¶åˆ° Leader çš„å¿ƒè·³æ¶ˆæ¯ï¼Œå°±ä¼šè®¤ä¸ºå½“å‰ Term æ²¡æœ‰å¯ç”¨çš„ Leaderï¼Œå¹¶å‘èµ·é€‰ä¸¾æ¥é€‰å‡ºæ–°çš„ Leaderã€‚å¼€å§‹ä¸€æ¬¡é€‰ä¸¾è¿‡ç¨‹ï¼ŒFollower å…ˆè¦å¢åŠ è‡ªå·±çš„å½“å‰ Term å·ï¼Œå¹¶\u003cstrong\u003eè½¬æ¢ä¸º Candidate\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cp\u003eCandidate ä¼šå¹¶è¡Œçš„\u003cstrong\u003eå‘é›†ç¾¤ä¸­çš„æ‰€æœ‰æœåŠ¡å™¨èŠ‚ç‚¹å‘é€æŠ•ç¥¨è¯·æ±‚ï¼ˆ\u003ccode\u003eRequestVote RPC\u003c/code\u003eï¼‰\u003c/strong\u003eï¼Œå®ƒä¼šä¿æŒå½“å‰çŠ¶æ€ç›´åˆ°ä»¥ä¸‹ä¸‰ä»¶äº‹æƒ…ä¹‹ä¸€å‘ç”Ÿï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eè‡ªå·±æˆä¸º Leader\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå…¶ä»–çš„æœåŠ¡å™¨æˆä¸º Leader\u003c/strong\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eæ²¡æœ‰ä»»ä½•æœåŠ¡å™¨æˆä¸º Leader\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"è‡ªå·±æˆä¸º-Leader\"\u003e\u003ca href=\"#è‡ªå·±æˆä¸º-Leader\" class=\"headerlink\" title=\"è‡ªå·±æˆä¸º Leader\"\u003e\u003c/a\u003eè‡ªå·±æˆä¸º Leader\u003c/h5\u003e\u003cul\u003e\n\u003cli\u003eå½“ä¸€ä¸ª Candidate ä»æ•´ä¸ªé›†ç¾¤\u003cstrong\u003eåŠæ•°ä»¥ä¸Š\u003c/strong\u003eçš„æœåŠ¡å™¨èŠ‚ç‚¹è·å¾—äº†é’ˆå¯¹åŒä¸€ä¸ª Term çš„é€‰ç¥¨ï¼Œé‚£ä¹ˆå®ƒå°±èµ¢å¾—äº†è¿™æ¬¡é€‰ä¸¾å¹¶æˆä¸º Leaderã€‚æ¯ä¸ªæœåŠ¡å™¨æœ€å¤šä¼šå¯¹ä¸€ä¸ª Term æŠ•å‡ºä¸€å¼ é€‰ç¥¨ï¼ŒæŒ‰ç…§å…ˆæ¥å…ˆæœåŠ¡ï¼ˆFIFOï¼‰çš„åŸåˆ™ã€‚_è¦æ±‚åŠæ•°ä»¥ä¸Šé€‰ç¥¨çš„è§„åˆ™ç¡®ä¿äº†æœ€å¤šåªä¼šæœ‰ä¸€ä¸ª Candidate èµ¢å¾—æ­¤æ¬¡é€‰ä¸¾_ã€‚\u003c/li\u003e\n\u003cli\u003eä¸€æ—¦ Candidate èµ¢å¾—é€‰ä¸¾ï¼Œå°±ç«‹å³æˆä¸º Leaderã€‚ç„¶åå®ƒä¼šå‘å…¶ä»–çš„æœåŠ¡å™¨å‘é€å¿ƒè·³æ¶ˆæ¯æ¥å»ºç«‹è‡ªå·±çš„æƒå¨å¹¶ä¸”é˜»æ­¢æ–°çš„é¢†å¯¼äººçš„äº§ç”Ÿã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"å…¶ä»–çš„æœåŠ¡å™¨æˆä¸º-Leader\"\u003e\u003ca href=\"#å…¶ä»–çš„æœåŠ¡å™¨æˆä¸º-Leader\" class=\"headerlink\" title=\"å…¶ä»–çš„æœåŠ¡å™¨æˆä¸º Leader\"\u003e\u003c/a\u003eå…¶ä»–çš„æœåŠ¡å™¨æˆä¸º Leader\u003c/h5\u003e\u003cp\u003eç­‰å¾…æŠ•ç¥¨æœŸé—´ï¼ŒCandidate å¯èƒ½ä¼šä»å…¶ä»–çš„æœåŠ¡å™¨æ¥æ”¶åˆ°å£°æ˜å®ƒæ˜¯ Leader çš„ \u003ccode\u003eAppendEntries RPC\u003c/code\u003eã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå¦‚æœè¿™ä¸ª Leader çš„ Term å·ï¼ˆåŒ…å«åœ¨æ­¤æ¬¡çš„ RPC ä¸­ï¼‰ä¸å°äº Candidate å½“å‰çš„ Termï¼Œé‚£ä¹ˆ Candidate ä¼šæ‰¿è®¤ Leader åˆæ³•å¹¶å›åˆ° Follower çŠ¶æ€ã€‚\u003c/li\u003e\n\u003cli\u003eå¦‚æœæ­¤æ¬¡ RPC ä¸­çš„ Term å·æ¯”è‡ªå·±å°ï¼Œé‚£ä¹ˆ Candidate å°±ä¼šæ‹’ç»è¿™ä¸ªæ¶ˆæ¯å¹¶ç»§ç»­ä¿æŒ Candidate çŠ¶æ€ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch5 id=\"æ²¡æœ‰ä»»ä½•æœåŠ¡å™¨æˆä¸º-Leader\"\u003e\u003ca href=\"#æ²¡æœ‰ä»»ä½•æœåŠ¡å™¨æˆä¸º-Leader\" class=\"headerlink\" title=\"æ²¡æœ‰ä»»ä½•æœåŠ¡å™¨æˆä¸º Leader\"\u003e\u003c/a\u003eæ²¡æœ‰ä»»ä½•æœåŠ¡å™¨æˆä¸º Leader\u003c/h5\u003e\u003cp\u003eå¦‚æœæœ‰å¤šä¸ª Follower åŒæ—¶æˆä¸º Candidateï¼Œé‚£ä¹ˆé€‰ç¥¨å¯èƒ½ä¼šè¢«ç“œåˆ†ä»¥è‡³äºæ²¡æœ‰ Candidate å¯ä»¥èµ¢å¾—åŠæ•°ä»¥ä¸Šçš„æŠ•ç¥¨ã€‚å½“è¿™ç§æƒ…å†µå‘ç”Ÿçš„æ—¶å€™ï¼Œæ¯ä¸€ä¸ª Candidate éƒ½ä¼šç«é€‰è¶…æ—¶ï¼Œç„¶åé€šè¿‡å¢åŠ å½“å‰ Term å·æ¥å¼€å§‹ä¸€è½®æ–°çš„é€‰ä¸¾ã€‚ç„¶è€Œï¼Œæ²¡æœ‰å…¶ä»–æœºåˆ¶çš„è¯ï¼Œé€‰ç¥¨å¯èƒ½ä¼šè¢«æ— é™çš„é‡å¤ç“œåˆ†ã€‚\u003c/p\u003e\n\u003cp\u003eRaft ç®—æ³•ä½¿ç”¨éšæœºé€‰ä¸¾è¶…æ—¶æ—¶é—´çš„æ–¹æ³•æ¥ç¡®ä¿å¾ˆå°‘ä¼šå‘ç”Ÿé€‰ç¥¨ç“œåˆ†çš„æƒ…å†µï¼Œå°±ç®—å‘ç”Ÿä¹Ÿèƒ½å¾ˆå¿«çš„è§£å†³ã€‚ä¸ºäº†é˜»æ­¢é€‰ç¥¨èµ·åˆå°±è¢«ç“œåˆ†ï¼Œç«é€‰è¶…æ—¶æ—¶é—´æ˜¯ä¸€ä¸ª\u003cstrong\u003eéšæœºçš„æ—¶é—´\u003c/strong\u003eï¼Œåœ¨ä¸€ä¸ªå›ºå®šçš„åŒºé—´ï¼ˆä¾‹å¦‚ 150-300 æ¯«ç§’ï¼‰éšæœºé€‰æ‹©ï¼Œè¿™æ ·å¯ä»¥æŠŠé€‰ä¸¾éƒ½åˆ†æ•£å¼€ã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eä»¥è‡³äºåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåªæœ‰ä¸€ä¸ªæœåŠ¡å™¨ä¼šè¶…æ—¶ï¼Œç„¶åå®ƒèµ¢å¾—é€‰ä¸¾ï¼Œæˆä¸º Leaderï¼Œå¹¶åœ¨å…¶ä»–æœåŠ¡å™¨è¶…æ—¶ä¹‹å‰å‘é€å¿ƒè·³åŒ…ã€‚\u003c/li\u003e\n\u003cli\u003eåŒæ ·çš„æœºåˆ¶ä¹Ÿè¢«ç”¨åœ¨é€‰ç¥¨ç“œåˆ†çš„æƒ…å†µä¸‹ï¼šæ¯ä¸€ä¸ª Candidate åœ¨å¼€å§‹ä¸€æ¬¡é€‰ä¸¾çš„æ—¶å€™ä¼šé‡ç½®ä¸€ä¸ªéšæœºçš„é€‰ä¸¾è¶…æ—¶æ—¶é—´ï¼Œç„¶ååœ¨è¶…æ—¶æ—¶é—´å†…ç­‰å¾…æŠ•ç¥¨çš„ç»“æœï¼›è¿™æ ·å‡å°‘äº†åœ¨æ–°çš„é€‰ä¸¾ä¸­å¦å¤–çš„é€‰ç¥¨ç“œåˆ†çš„å¯èƒ½æ€§ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr/\u003e\n\u003cp\u003eç†è§£äº†ä¸Šé¢çš„é€‰ä¸¾è§„åˆ™åï¼Œæˆ‘ä»¬é€šè¿‡åŠ¨å›¾æ¥åŠ æ·±è®¤è¯†ã€‚\u003c/p\u003e\n\u003ch3 id=\"æ—¥å¿—å¤åˆ¶\"\u003e\u003ca href=\"#æ—¥å¿—å¤åˆ¶\" class=\"headerlink\" title=\"æ—¥å¿—å¤åˆ¶\"\u003e\u003c/a\u003eæ—¥å¿—å¤åˆ¶\u003c/h3\u003e\u003ch4 id=\"æ—¥å¿—æ ¼å¼\"\u003e\u003ca href=\"#æ—¥å¿—æ ¼å¼\" class=\"headerlink\" title=\"æ—¥å¿—æ ¼å¼\"\u003e\u003c/a\u003eæ—¥å¿—æ ¼å¼\u003c/h4\u003e\u003cp\u003e\u003cstrong\u003eæ—¥å¿—ç”±å«æ—¥å¿—ç´¢å¼•ï¼ˆlog indexï¼‰çš„æ—¥å¿—æ¡ç›®ï¼ˆlog entryï¼‰ç»„æˆ\u003c/strong\u003eã€‚æ¯ä¸ªæ—¥å¿—æ¡ç›®åŒ…å«å®ƒè¢«åˆ›å»ºæ—¶çš„ Term å·ï¼ˆä¸‹å›¾ä¸­æ–¹æ¡†ä¸­çš„æ•°å­—ï¼‰ï¼Œå’Œä¸€ä¸ªå¤åˆ¶çŠ¶æ€æœºéœ€è¦æ‰§è¡Œçš„æŒ‡ä»¤ã€‚å¦‚æœä¸€ä¸ªæ—¥å¿—æ¡ç›®è¢«å¤åˆ¶åˆ°åŠæ•°ä»¥ä¸Šçš„æœåŠ¡å™¨ä¸Šï¼Œå°±è¢«è®¤ä¸ºå¯ä»¥æäº¤ï¼ˆCommitï¼‰äº†ã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eæ—¥å¿—æ¡ç›®ä¸­çš„ Term å·è¢«ç”¨æ¥æ£€æŸ¥æ˜¯å¦å‡ºç°ä¸ä¸€è‡´çš„æƒ…å†µã€‚\u003c/li\u003e\n\u003cli\u003eæ—¥å¿—æ¡ç›®ä¸­çš„æ—¥å¿—ç´¢å¼•ï¼ˆä¸€ä¸ªæ•´æ•°å€¼ï¼‰ç”¨æ¥è¡¨æ˜å®ƒåœ¨æ—¥å¿—ä¸­çš„ä½ç½®ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"https://pic3.zhimg.com/80/v2-ee29a89e4eb63468e142bb6103dbe4de_hd.jpg\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003cp\u003eRaft æ—¥å¿—åŒæ­¥ä¿è¯å¦‚ä¸‹ä¸¤ç‚¹ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå¦‚æœä¸åŒæ—¥å¿—ä¸­çš„ä¸¤ä¸ªæ—¥å¿—æ¡ç›®æœ‰ç€ç›¸åŒçš„æ—¥å¿—ç´¢å¼•å’Œ Termï¼Œåˆ™\u003cstrong\u003eå®ƒä»¬æ‰€å­˜å‚¨çš„å‘½ä»¤æ˜¯ç›¸åŒçš„\u003c/strong\u003eã€‚\u003cul\u003e\n\u003cli\u003eè¿™ä¸ªç‰¹æ€§åŸºäºè¿™æ¡åŸåˆ™ï¼šLeader æœ€å¤šåœ¨ä¸€ä¸ª Term å†…ã€åœ¨æŒ‡å®šçš„ä¸€ä¸ªæ—¥å¿—ç´¢å¼•ä¸Šåˆ›å»ºä¸€æ¡æ—¥å¿—æ¡ç›®ï¼ŒåŒæ—¶æ—¥å¿—æ¡ç›®åœ¨æ—¥å¿—ä¸­çš„ä½ç½®ä¹Ÿä»æ¥ä¸ä¼šæ”¹å˜ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003eå¦‚æœä¸åŒæ—¥å¿—ä¸­çš„ä¸¤ä¸ªæ—¥å¿—æ¡ç›®æœ‰ç€ç›¸åŒçš„æ—¥å¿—ç´¢å¼•å’Œ Termï¼Œåˆ™\u003cstrong\u003eå®ƒä»¬ä¹‹å‰çš„æ‰€æœ‰æ¡ç›®éƒ½æ˜¯å®Œå…¨ä¸€æ ·çš„\u003c/strong\u003eã€‚\u003cul\u003e\n\u003cli\u003eè¿™ä¸ªç‰¹æ€§ç”± \u003ccode\u003eAppendEntries RPC\u003c/code\u003e çš„ä¸€ä¸ªç®€å•çš„ä¸€è‡´æ€§æ£€æŸ¥æ‰€ä¿è¯ã€‚åœ¨å‘é€ \u003ccode\u003eAppendEntries RPC\u003c/code\u003e æ—¶ï¼ŒLeader ä¼šæŠŠæ–°æ—¥å¿—æ¡ç›®ä¹‹å‰çš„æ—¥å¿—æ¡ç›®çš„æ—¥å¿—ç´¢å¼•å’Œ Term å·ä¸€èµ·å‘é€ã€‚å¦‚æœ Follower åœ¨å®ƒçš„æ—¥å¿—ä¸­æ‰¾ä¸åˆ°åŒ…å«ç›¸åŒæ—¥å¿—ç´¢å¼•å’Œ Term å·çš„æ—¥å¿—æ¡ç›®ï¼Œå®ƒå°±ä¼šæ‹’ç»æ¥æ”¶æ–°çš„æ—¥å¿—æ¡ç›®ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"æ—¥å¿—å¤åˆ¶æµç¨‹\"\u003e\u003ca href=\"#æ—¥å¿—å¤åˆ¶æµç¨‹\" class=\"headerlink\" title=\"æ—¥å¿—å¤åˆ¶æµç¨‹\"\u003e\u003c/a\u003eæ—¥å¿—å¤åˆ¶æµç¨‹\u003c/h4\u003e\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/snap/20200201115848.png\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eLeader è´Ÿè´£å¤„ç†æ‰€æœ‰å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚\u003c/li\u003e\n\u003cli\u003eLeader æŠŠè¯·æ±‚ä½œä¸ºæ—¥å¿—æ¡ç›®åŠ å…¥åˆ°å®ƒçš„æ—¥å¿—ä¸­ï¼Œç„¶åå¹¶è¡Œçš„å‘å…¶ä»–æœåŠ¡å™¨å‘é€ \u003ccode\u003eAppendEntries RPC\u003c/code\u003e è¯·æ±‚ï¼Œè¦æ±‚ Follower å¤åˆ¶æ—¥å¿—æ¡ç›®ã€‚\u003c/li\u003e\n\u003cli\u003eFollower å¤åˆ¶æˆåŠŸåï¼Œè¿”å›ç¡®è®¤æ¶ˆæ¯ã€‚\u003c/li\u003e\n\u003cli\u003eå½“è¿™ä¸ªæ—¥å¿—æ¡ç›®è¢«åŠæ•°ä»¥ä¸Šçš„æœåŠ¡å™¨å¤åˆ¶åï¼ŒLeader æäº¤è¿™ä¸ªæ—¥å¿—æ¡ç›®åˆ°å®ƒçš„å¤åˆ¶çŠ¶æ€æœºï¼Œå¹¶å‘å®¢æˆ·ç«¯è¿”å›æ‰§è¡Œç»“æœã€‚\u003c/li\u003e\n\u003c/ol\u003e\n\u003cblockquote\u003e\n\u003cp\u003eæ³¨æ„ï¼šå¦‚æœ Follower å´©æºƒæˆ–è€…è¿è¡Œç¼“æ…¢ï¼Œå†æˆ–è€…ç½‘ç»œä¸¢åŒ…ï¼ŒLeader ä¼šä¸æ–­çš„é‡å¤å°è¯•å‘é€ \u003ccode\u003eAppendEntries RPC\u003c/code\u003e è¯·æ±‚ ï¼ˆå°½ç®¡å·²ç»å›å¤äº†å®¢æˆ·ç«¯ï¼‰ï¼Œç›´åˆ°æ‰€æœ‰çš„è·Ÿéšè€…éƒ½æœ€ç»ˆå¤åˆ¶äº†æ‰€æœ‰çš„æ—¥å¿—æ¡ç›®ã€‚\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"æ—¥å¿—ä¸€è‡´æ€§\"\u003e\u003ca href=\"#æ—¥å¿—ä¸€è‡´æ€§\" class=\"headerlink\" title=\"æ—¥å¿—ä¸€è‡´æ€§\"\u003e\u003c/a\u003eæ—¥å¿—ä¸€è‡´æ€§\u003c/h4\u003e\u003cp\u003eä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒLeader å’Œ Followers çš„æ—¥å¿—ä¿æŒä¸€è‡´ï¼Œå› æ­¤æ—¥å¿—æ¡ç›®ä¸€è‡´æ€§æ£€æŸ¥é€šå¸¸ä¸ä¼šå¤±è´¥ã€‚ç„¶è€Œï¼ŒLeader å´©æºƒå¯èƒ½ä¼šå¯¼è‡´æ—¥å¿—ä¸ä¸€è‡´ï¼šæ—§çš„ Leader å¯èƒ½æ²¡æœ‰å®Œå…¨å¤åˆ¶å®Œæ—¥å¿—ä¸­çš„æ‰€æœ‰æ¡ç›®ã€‚\u003c/p\u003e\n\u003ch5 id=\"Leader-å’Œ-Follower-æ—¥å¿—ä¸ä¸€è‡´çš„å¯èƒ½\"\u003e\u003ca href=\"#Leader-å’Œ-Follower-æ—¥å¿—ä¸ä¸€è‡´çš„å¯èƒ½\" class=\"headerlink\" title=\"Leader å’Œ Follower æ—¥å¿—ä¸ä¸€è‡´çš„å¯èƒ½\"\u003e\u003c/a\u003eLeader å’Œ Follower æ—¥å¿—ä¸ä¸€è‡´çš„å¯èƒ½\u003c/h5\u003e\u003cp\u003eLeader å’Œ Follower å¯èƒ½å­˜åœ¨å¤šç§æ—¥å¿—ä¸ä¸€è‡´çš„å¯èƒ½ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://pic4.zhimg.com/80/v2-d36c587901391cae50788061f568d24f_hd.jpg\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e:bulb: å›¾ç¤ºè¯´æ˜ï¼š\u003c/p\u003e\n\u003cp\u003eä¸Šå›¾é˜è¿°äº† Leader å’Œ Follower å¯èƒ½å­˜åœ¨å¤šç§æ—¥å¿—ä¸ä¸€è‡´çš„å¯èƒ½ï¼Œæ¯ä¸€ä¸ªæ–¹æ¡†è¡¨ç¤ºä¸€ä¸ªæ—¥å¿—æ¡ç›®ï¼Œé‡Œé¢çš„æ•°å­—è¡¨ç¤ºä»»æœŸå· ã€‚\u003c/p\u003e\n\u003cp\u003eå½“ä¸€ä¸ª Leader æˆåŠŸå½“é€‰æ—¶ï¼ŒFollower å¯èƒ½å‡ºç°ä»¥ä¸‹æƒ…å†µï¼ˆa-fï¼‰ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eå­˜åœ¨æœªæ›´æ–°æ—¥å¿—æ¡ç›®\u003c/strong\u003eï¼Œå¦‚ï¼ˆaã€bï¼‰ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå­˜åœ¨æœªæäº¤æ—¥å¿—æ¡ç›®\u003c/strong\u003eï¼Œå¦‚ï¼ˆcã€dï¼‰ã€‚\u003c/li\u003e\n\u003cli\u003eæˆ–\u003cstrong\u003eä¸¤ç§æƒ…å†µéƒ½å­˜åœ¨\u003c/strong\u003eï¼Œå¦‚ï¼ˆeã€fï¼‰ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e_ä¾‹å¦‚ï¼Œåœºæ™¯ f å¯èƒ½ä¼šè¿™æ ·å‘ç”Ÿï¼ŒæŸæœåŠ¡å™¨åœ¨ Term2 çš„æ—¶å€™æ˜¯ Leaderï¼Œå·²é™„åŠ äº†ä¸€äº›æ—¥å¿—æ¡ç›®åˆ°è‡ªå·±çš„æ—¥å¿—ä¸­ï¼Œä½†åœ¨æäº¤ä¹‹å‰å°±å´©æºƒäº†ï¼›å¾ˆå¿«è¿™ä¸ªæœºå™¨å°±è¢«é‡å¯äº†ï¼Œåœ¨ Term3 é‡æ–°è¢«é€‰ä¸º Leaderï¼Œå¹¶ä¸”åˆå¢åŠ äº†ä¸€äº›æ—¥å¿—æ¡ç›®åˆ°è‡ªå·±çš„æ—¥å¿—ä¸­ï¼›åœ¨ Term 2 å’Œ Term 3 çš„æ—¥å¿—è¢«æäº¤ä¹‹å‰ï¼Œè¿™ä¸ªæœåŠ¡å™¨åˆå®•æœºäº†ï¼Œå¹¶ä¸”åœ¨æ¥ä¸‹æ¥çš„å‡ ä¸ªä»»æœŸé‡Œä¸€ç›´å¤„äºå®•æœºçŠ¶æ€_ã€‚\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch5 id=\"Leader-å’Œ-Follower-æ—¥å¿—ä¸€è‡´çš„ä¿è¯\"\u003e\u003ca href=\"#Leader-å’Œ-Follower-æ—¥å¿—ä¸€è‡´çš„ä¿è¯\" class=\"headerlink\" title=\"Leader å’Œ Follower æ—¥å¿—ä¸€è‡´çš„ä¿è¯\"\u003e\u003c/a\u003eLeader å’Œ Follower æ—¥å¿—ä¸€è‡´çš„ä¿è¯\u003c/h5\u003e\u003cp\u003eLeader é€šè¿‡å¼ºåˆ¶ Followers å¤åˆ¶å®ƒçš„æ—¥å¿—æ¥å¤„ç†æ—¥å¿—çš„ä¸ä¸€è‡´ï¼Œ\u003cstrong\u003eFollowers ä¸Šçš„ä¸ä¸€è‡´çš„æ—¥å¿—ä¼šè¢« Leader çš„æ—¥å¿—è¦†ç›–\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eLeader ä¸ºäº†ä½¿ Followers çš„æ—¥å¿—åŒè‡ªå·±çš„ä¸€è‡´ï¼ŒLeader éœ€è¦æ‰¾åˆ° Followers åŒå®ƒçš„æ—¥å¿—ä¸€è‡´çš„åœ°æ–¹ï¼Œç„¶åè¦†ç›– Followers åœ¨è¯¥ä½ç½®ä¹‹åçš„æ¡ç›®ã€‚\u003c/li\u003e\n\u003cli\u003eLeader ä¼šä»åå¾€å‰è¯•ï¼Œæ¯æ¬¡æ—¥å¿—æ¡ç›®å¤±è´¥åå°è¯•å‰ä¸€ä¸ªæ—¥å¿—æ¡ç›®ï¼Œç›´åˆ°æˆåŠŸæ‰¾åˆ°æ¯ä¸ª Follower çš„æ—¥å¿—ä¸€è‡´ä½ç‚¹ï¼Œç„¶åå‘åé€æ¡è¦†ç›– Followers åœ¨è¯¥ä½ç½®ä¹‹åçš„æ¡ç›®ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"å®‰å…¨æ€§\"\u003e\u003ca href=\"#å®‰å…¨æ€§\" class=\"headerlink\" title=\"å®‰å…¨æ€§\"\u003e\u003c/a\u003eå®‰å…¨æ€§\u003c/h3\u003e\u003cp\u003eå‰é¢æè¿°äº† Raft ç®—æ³•æ˜¯å¦‚ä½•é€‰ä¸¾ Leader å’Œå¤åˆ¶æ—¥å¿—çš„ã€‚\u003c/p\u003e\n\u003cp\u003eRaft è¿˜å¢åŠ äº†ä¸€äº›é™åˆ¶æ¥å®Œå–„ Raft ç®—æ³•ï¼Œä»¥ä¿è¯å®‰å…¨æ€§ï¼šä¿è¯äº†ä»»æ„ Leader å¯¹äºç»™å®šçš„ Termï¼Œéƒ½æ‹¥æœ‰äº†ä¹‹å‰ Term çš„æ‰€æœ‰è¢«æäº¤çš„æ—¥å¿—æ¡ç›®ã€‚\u003c/p\u003e\n\u003ch4 id=\"é€‰ä¸¾é™åˆ¶\"\u003e\u003ca href=\"#é€‰ä¸¾é™åˆ¶\" class=\"headerlink\" title=\"é€‰ä¸¾é™åˆ¶\"\u003e\u003c/a\u003eé€‰ä¸¾é™åˆ¶\u003c/h4\u003e\u003cp\u003eæ‹¥æœ‰æœ€æ–°çš„å·²æäº¤çš„æ—¥å¿—æ¡ç›®çš„ Follower æ‰æœ‰èµ„æ ¼æˆä¸º Leaderã€‚\u003c/p\u003e\n\u003cp\u003eRaft ä½¿ç”¨æŠ•ç¥¨çš„æ–¹å¼æ¥é˜»æ­¢ä¸€ä¸ª Candidate èµ¢å¾—é€‰ä¸¾é™¤éè¿™ä¸ª Candidate åŒ…å«äº†æ‰€æœ‰å·²ç»æäº¤çš„æ—¥å¿—æ¡ç›®ã€‚ Candidate ä¸ºäº†èµ¢å¾—é€‰ä¸¾å¿…é¡»è”ç³»é›†ç¾¤ä¸­çš„å¤§éƒ¨åˆ†èŠ‚ç‚¹ï¼Œè¿™æ„å‘³ç€æ¯ä¸€ä¸ªå·²ç»æäº¤çš„æ—¥å¿—æ¡ç›®åœ¨è¿™äº›æœåŠ¡å™¨èŠ‚ç‚¹ä¸­è‚¯å®šå­˜åœ¨äºè‡³å°‘ä¸€ä¸ªèŠ‚ç‚¹ä¸Šã€‚å¦‚æœ Candidate çš„æ—¥å¿—è‡³å°‘å’Œå¤§å¤šæ•°çš„æœåŠ¡å™¨èŠ‚ç‚¹ä¸€æ ·æ–°ï¼ˆè¿™ä¸ªæ–°çš„å®šä¹‰ä¼šåœ¨ä¸‹é¢è®¨è®ºï¼‰ï¼Œé‚£ä¹ˆä»–ä¸€å®šæŒæœ‰äº†æ‰€æœ‰å·²ç»æäº¤çš„æ—¥å¿—æ¡ç›®ã€‚\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003eRequestVote RPC\u003c/code\u003e å®ç°äº†è¿™æ ·çš„é™åˆ¶ï¼š\u003cstrong\u003eRequestVote RPC ä¸­åŒ…å«äº† Candidate çš„æ—¥å¿—ä¿¡æ¯ï¼Œ Follower ä¼šæ‹’ç»æ‰é‚£äº›æ—¥å¿—æ²¡æœ‰è‡ªå·±æ–°çš„æŠ•ç¥¨è¯·æ±‚\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cp\u003eå¦‚ä½•åˆ¤æ–­å“ªä¸ªæ—¥å¿—æ¡ç›®æ¯”è¾ƒæ–°ï¼Ÿ\u003c/p\u003e\n\u003cp\u003eRaft é€šè¿‡æ¯”è¾ƒä¸¤ä»½æ—¥å¿—ä¸­æœ€åä¸€æ¡æ—¥å¿—æ¡ç›®çš„æ—¥å¿—ç´¢å¼•å’Œ Term æ¥åˆ¤æ–­å“ªä¸ªæ—¥å¿—æ¯”è¾ƒæ–°ã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå…ˆåˆ¤æ–­ Termï¼Œå“ªä¸ªæ•°å€¼å¤§å³ä»£è¡¨å“ªä¸ªæ—¥å¿—æ¯”è¾ƒæ–°ã€‚\u003c/li\u003e\n\u003cli\u003eå¦‚æœ Term ç›¸åŒï¼Œå†æ¯”è¾ƒ æ—¥å¿—ç´¢å¼•ï¼Œå“ªä¸ªæ•°å€¼å¤§å³ä»£è¡¨å“ªä¸ªæ—¥å¿—æ¯”è¾ƒæ–°ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"æäº¤æ—§ä»»æœŸçš„æ—¥å¿—æ¡ç›®\"\u003e\u003ca href=\"#æäº¤æ—§ä»»æœŸçš„æ—¥å¿—æ¡ç›®\" class=\"headerlink\" title=\"æäº¤æ—§ä»»æœŸçš„æ—¥å¿—æ¡ç›®\"\u003e\u003c/a\u003eæäº¤æ—§ä»»æœŸçš„æ—¥å¿—æ¡ç›®\u003c/h4\u003e\u003cp\u003eä¸€ä¸ªå½“å‰ Term çš„æ—¥å¿—æ¡ç›®è¢«å¤åˆ¶åˆ°äº†åŠæ•°ä»¥ä¸Šçš„æœåŠ¡å™¨ä¸Šï¼ŒLeader å°±è®¤ä¸ºå®ƒæ˜¯å¯ä»¥è¢«æäº¤çš„ã€‚å¦‚æœè¿™ä¸ª Leader åœ¨æäº¤æ—¥å¿—æ¡ç›®å‰å°±ä¸‹çº¿äº†ï¼Œåç»­çš„ Leader å¯èƒ½ä¼šè¦†ç›–æ‰è¿™ä¸ªæ—¥å¿—æ¡ç›®ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://pic4.zhimg.com/80/v2-12a5ebab63781f9ec49e14e331775537_hd.jpg\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eğŸ’¡ å›¾ç¤ºè¯´æ˜ï¼š\u003c/p\u003e\n\u003cp\u003eä¸Šå›¾è§£é‡Šäº†ä¸ºä»€ä¹ˆ Leader æ— æ³•å¯¹æ—§ Term çš„æ—¥å¿—æ¡ç›®è¿›è¡Œæäº¤ã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eé˜¶æ®µ (a) ï¼ŒS1 æ˜¯ Leaderï¼Œä¸” S1 å†™å…¥æ—¥å¿—æ¡ç›®ä¸º (Term 2ï¼Œæ—¥å¿—ç´¢å¼• 2ï¼‰ï¼Œåªæœ‰ S2 å¤åˆ¶äº†è¿™ä¸ªæ—¥å¿—æ¡ç›®ã€‚\u003c/li\u003e\n\u003cli\u003eé˜¶æ®µ (b)ï¼ŒS1 ä¸‹çº¿ï¼ŒS5 è¢«é€‰ä¸¾ä¸º Term3 çš„ Leaderã€‚S5 å†™å…¥æ—¥å¿—æ¡ç›®ä¸º (Term 3ï¼Œæ—¥å¿—ç´¢å¼• 2ï¼‰ã€‚\u003c/li\u003e\n\u003cli\u003eé˜¶æ®µ (c)ï¼ŒS5 ä¸‹çº¿ï¼ŒS1 é‡æ–°ä¸Šçº¿ï¼Œå¹¶è¢«é€‰ä¸¾ä¸º Term4 çš„ Leaderã€‚æ­¤æ—¶ï¼ŒTerm 2 çš„é‚£æ¡æ—¥å¿—æ¡ç›®å·²ç»è¢«å¤åˆ¶åˆ°äº†é›†ç¾¤ä¸­çš„å¤§å¤šæ•°èŠ‚ç‚¹ä¸Šï¼Œä½†æ˜¯è¿˜æ²¡æœ‰è¢«æäº¤ã€‚\u003c/li\u003e\n\u003cli\u003eé˜¶æ®µ (d)ï¼ŒS1 å†æ¬¡ä¸‹çº¿ï¼ŒS5 é‡æ–°ä¸Šçº¿ï¼Œå¹¶è¢«é‡æ–°é€‰ä¸¾ä¸º Term3 çš„ Leaderã€‚ç„¶å S5 è¦†ç›–äº†æ—¥å¿—ç´¢å¼• 2 å¤„çš„æ—¥å¿—ã€‚\u003c/li\u003e\n\u003cli\u003eé˜¶æ®µ (e)ï¼Œå¦‚æœé˜¶æ®µ (d) è¿˜æœªå‘ç”Ÿï¼Œå³ S1 å†æ¬¡ä¸‹çº¿ä¹‹å‰ï¼ŒS1 æŠŠè‡ªå·±ä¸»å¯¼çš„æ—¥å¿—æ¡ç›®å¤åˆ¶åˆ°äº†å¤§å¤šæ•°èŠ‚ç‚¹ä¸Šï¼Œé‚£ä¹ˆåœ¨åç»­ Term é‡Œé¢è¿™äº›æ–°æ—¥å¿—æ¡ç›®å°±ä¼šè¢«æäº¤ã€‚è¿™æ ·åœ¨åŒä¸€æ—¶åˆ»å°±åŒæ—¶ä¿è¯äº†ï¼Œä¹‹å‰çš„æ‰€æœ‰æ—§æ—¥å¿—æ¡ç›®å°±ä¼šè¢«æäº¤ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cstrong\u003eRaft æ°¸è¿œä¸ä¼šé€šè¿‡è®¡ç®—å‰¯æœ¬æ•°ç›®çš„æ–¹å¼å»æäº¤ä¸€ä¸ªä¹‹å‰ Term å†…çš„æ—¥å¿—æ¡ç›®\u003c/strong\u003eã€‚åªæœ‰ Leader å½“å‰ Term é‡Œçš„æ—¥å¿—æ¡ç›®é€šè¿‡è®¡ç®—å‰¯æœ¬æ•°ç›®å¯ä»¥è¢«æäº¤ï¼›ä¸€æ—¦å½“å‰ Term çš„æ—¥å¿—æ¡ç›®ä»¥è¿™ç§æ–¹å¼è¢«æäº¤ï¼Œé‚£ä¹ˆç”±äºæ—¥å¿—åŒ¹é…ç‰¹æ€§ï¼Œä¹‹å‰çš„æ—¥å¿—æ¡ç›®ä¹Ÿéƒ½ä¼šè¢«é—´æ¥çš„æäº¤ã€‚\u003c/p\u003e\n\u003cp\u003eå½“ Leader å¤åˆ¶ä¹‹å‰ä»»æœŸé‡Œçš„æ—¥å¿—æ—¶ï¼ŒRaft ä¼šä¸ºæ‰€æœ‰æ—¥å¿—ä¿ç•™åŸå§‹çš„ Termï¼Œè¿™åœ¨æäº¤è§„åˆ™ä¸Šäº§ç”Ÿäº†é¢å¤–çš„å¤æ‚æ€§ã€‚åœ¨å…¶ä»–çš„ä¸€è‡´æ€§ç®—æ³•ä¸­ï¼Œå¦‚æœä¸€ä¸ªæ–°çš„é¢†å¯¼äººè¦é‡æ–°å¤åˆ¶ä¹‹å‰çš„ä»»æœŸé‡Œçš„æ—¥å¿—æ—¶ï¼Œå®ƒå¿…é¡»ä½¿ç”¨å½“å‰æ–°çš„ä»»æœŸå·ã€‚Raft ä½¿ç”¨çš„æ–¹æ³•æ›´åŠ å®¹æ˜“è¾¨åˆ«å‡ºæ—¥å¿—ï¼Œå› ä¸ºå®ƒå¯ä»¥éšç€æ—¶é—´å’Œæ—¥å¿—çš„å˜åŒ–å¯¹æ—¥å¿—ç»´æŠ¤ç€åŒä¸€ä¸ªä»»æœŸç¼–å·ã€‚å¦å¤–ï¼Œå’Œå…¶ä»–çš„ç®—æ³•ç›¸æ¯”ï¼ŒRaft ä¸­çš„æ–°é¢†å¯¼äººåªéœ€è¦å‘é€æ›´å°‘æ—¥å¿—æ¡ç›®ï¼ˆå…¶ä»–ç®—æ³•ä¸­å¿…é¡»åœ¨ä»–ä»¬è¢«æäº¤ä¹‹å‰å‘é€æ›´å¤šçš„å†—ä½™æ—¥å¿—æ¡ç›®æ¥ä¸ºä»–ä»¬é‡æ–°ç¼–å·ï¼‰ã€‚\u003c/p\u003e\n\u003ch3 id=\"æ—¥å¿—å‹ç¼©\"\u003e\u003ca href=\"#æ—¥å¿—å‹ç¼©\" class=\"headerlink\" title=\"æ—¥å¿—å‹ç¼©\"\u003e\u003c/a\u003eæ—¥å¿—å‹ç¼©\u003c/h3\u003e\u003cp\u003eåœ¨å®é™…çš„ç³»ç»Ÿä¸­ï¼Œä¸èƒ½è®©æ—¥å¿—æ— é™è†¨èƒ€ï¼Œå¦åˆ™ç³»ç»Ÿé‡å¯æ—¶éœ€è¦èŠ±å¾ˆé•¿çš„æ—¶é—´è¿›è¡Œæ¢å¤ï¼Œä»è€Œå½±å“å¯ç”¨æ€§ã€‚Raft é‡‡ç”¨å¯¹æ•´ä¸ªç³»ç»Ÿè¿›è¡Œå¿«ç…§æ¥è§£å†³ï¼Œå¿«ç…§ä¹‹å‰çš„æ—¥å¿—éƒ½å¯ä»¥ä¸¢å¼ƒã€‚\u003c/p\u003e\n\u003cp\u003eæ¯ä¸ªå‰¯æœ¬ç‹¬ç«‹çš„å¯¹è‡ªå·±çš„ç³»ç»ŸçŠ¶æ€ç”Ÿæˆå¿«ç…§ï¼Œå¹¶ä¸”åªèƒ½å¯¹å·²ç»æäº¤çš„æ—¥å¿—æ¡ç›®ç”Ÿæˆå¿«ç…§ã€‚\u003c/p\u003e\n\u003cp\u003eå¿«ç…§åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eæ—¥å¿—å…ƒæ•°æ®ã€‚æœ€åä¸€æ¡å·²æäº¤çš„æ—¥å¿—æ¡ç›®çš„æ—¥å¿—ç´¢å¼•å’Œ Termã€‚è¿™ä¸¤ä¸ªå€¼åœ¨å¿«ç…§ä¹‹åçš„ç¬¬ä¸€æ¡æ—¥å¿—æ¡ç›®çš„ \u003ccode\u003eAppendEntries RPC\u003c/code\u003e çš„å®Œæ•´æ€§æ£€æŸ¥çš„æ—¶å€™ä¼šè¢«ç”¨ä¸Šã€‚\u003c/li\u003e\n\u003cli\u003eç³»ç»Ÿå½“å‰çŠ¶æ€ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eå½“ Leader è¦å‘é€æŸä¸ªæ—¥å¿—æ¡ç›®ï¼Œè½åå¤ªå¤šçš„ Follower çš„æ—¥å¿—æ¡ç›®ä¼šè¢«ä¸¢å¼ƒï¼ŒLeader ä¼šå°†å¿«ç…§å‘ç»™ Followerã€‚æˆ–è€…æ–°ä¸Šçº¿ä¸€å°æœºå™¨æ—¶ï¼Œä¹Ÿä¼šå‘é€å¿«ç…§ç»™å®ƒã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/snap/20200201220628.png\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eç”Ÿæˆå¿«ç…§çš„é¢‘ç‡è¦é€‚ä¸­\u003c/strong\u003eï¼Œé¢‘ç‡è¿‡é«˜ä¼šæ¶ˆè€—å¤§é‡ I/O å¸¦å®½ï¼›é¢‘ç‡è¿‡ä½ï¼Œä¸€æ—¦éœ€è¦æ‰§è¡Œæ¢å¤æ“ä½œï¼Œä¼šä¸¢å¤±å¤§é‡æ•°æ®ï¼Œå½±å“å¯ç”¨æ€§ã€‚æ¨èå½“æ—¥å¿—è¾¾åˆ°æŸä¸ªå›ºå®šçš„å¤§å°æ—¶ç”Ÿæˆå¿«ç…§ã€‚\u003c/p\u003e\n\u003cp\u003eç”Ÿæˆä¸€æ¬¡å¿«ç…§å¯èƒ½è€—æ—¶è¿‡é•¿ï¼Œå½±å“æ­£å¸¸æ—¥å¿—åŒæ­¥ã€‚å¯ä»¥é€šè¿‡ä½¿ç”¨ copy-on-write æŠ€æœ¯é¿å…å¿«ç…§è¿‡ç¨‹å½±å“æ­£å¸¸æ—¥å¿—åŒæ­¥ã€‚\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eè¯´æ˜ï¼šæœ¬æ–‡ä»…é˜è¿° Raft ç®—æ³•çš„æ ¸å¿ƒå†…å®¹ï¼Œä¸åŒ…æ‹¬ç®—æ³•è®ºè¯ã€è¯„ä¼°ç­‰\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2 id=\"ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•\"\u003e\u003ca href=\"#ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•\" class=\"headerlink\" title=\"ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•\"\u003e\u003c/a\u003eä¸€è‡´æ€§å“ˆå¸Œç®—æ³•\u003c/h2\u003e\u003cp\u003e\u003cstrong\u003e\u003ccode\u003eä¸€è‡´æ€§å“ˆå¸Œï¼ˆConsistent Hashï¼‰\u003c/code\u003e\u003cstrong\u003eç®—æ³•çš„ç›®æ ‡æ˜¯ï¼š\u003c/strong\u003eç›¸åŒçš„è¯·æ±‚å°½å¯èƒ½è½åˆ°åŒä¸€ä¸ªæœåŠ¡å™¨ä¸Š\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eä¸€è‡´æ€§å“ˆå¸Œ\u003c/strong\u003e å¯ä»¥å¾ˆå¥½çš„è§£å†³ \u003cstrong\u003eç¨³å®šæ€§é—®é¢˜\u003c/strong\u003eï¼Œå¯ä»¥å°†æ‰€æœ‰çš„ \u003cstrong\u003eå­˜å‚¨èŠ‚ç‚¹\u003c/strong\u003e æ’åˆ—åœ¨ \u003cstrong\u003eé¦–å°¾ç›¸æ¥\u003c/strong\u003e çš„ \u003ccode\u003eHash\u003c/code\u003e ç¯ä¸Šï¼Œæ¯ä¸ª \u003ccode\u003ekey\u003c/code\u003e åœ¨è®¡ç®— \u003ccode\u003eHash\u003c/code\u003e åä¼š \u003cstrong\u003eé¡ºæ—¶é’ˆ\u003c/strong\u003e æ‰¾åˆ° \u003cstrong\u003eä¸´æ¥\u003c/strong\u003e çš„ \u003cstrong\u003eå­˜å‚¨èŠ‚ç‚¹\u003c/strong\u003e å­˜æ”¾ã€‚è€Œå½“æœ‰èŠ‚ç‚¹ \u003cstrong\u003eåŠ å…¥\u003c/strong\u003e æˆ– \u003cstrong\u003eé€€å‡º\u003c/strong\u003e æ—¶ï¼Œä»…å½±å“è¯¥èŠ‚ç‚¹åœ¨ \u003ccode\u003eHash\u003c/code\u003e ç¯ä¸Š \u003cstrong\u003eé¡ºæ—¶é’ˆç›¸é‚»\u003c/strong\u003e çš„ \u003cstrong\u003eåç»­èŠ‚ç‚¹\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/cs/design/architecture/partition-consistent-hash.png\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eç›¸åŒçš„è¯·æ±‚\u003c/strong\u003eæ˜¯æŒ‡ï¼šä¸€èˆ¬åœ¨ä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œæ—¶ï¼Œéœ€è¦æŒ‡å®šä¸€ä¸ª key ç”¨äº hash è®¡ç®—ï¼Œå¯èƒ½æ˜¯ï¼š\u003cul\u003e\n\u003cli\u003eç”¨æˆ· ID\u003c/li\u003e\n\u003cli\u003eè¯·æ±‚æ–¹ IP\u003c/li\u003e\n\u003cli\u003eè¯·æ±‚æœåŠ¡åç§°ï¼Œå‚æ•°åˆ—è¡¨æ„æˆçš„ä¸²\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå°½å¯èƒ½\u003c/strong\u003eæ˜¯æŒ‡ï¼šæœåŠ¡å™¨å¯èƒ½å‘ç”Ÿä¸Šä¸‹çº¿ï¼Œå°‘æ•°æœåŠ¡å™¨çš„å˜åŒ–ä¸åº”è¯¥å½±å“å¤§å¤šæ•°çš„è¯·æ±‚ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eå½“æŸå°å€™é€‰æœåŠ¡å™¨å®•æœºæ—¶ï¼ŒåŸæœ¬å‘å¾€è¯¥æœåŠ¡å™¨çš„è¯·æ±‚ï¼Œä¼šåŸºäºè™šæ‹ŸèŠ‚ç‚¹ï¼Œå¹³æ‘Šåˆ°å…¶å®ƒå€™é€‰æœåŠ¡å™¨ï¼Œä¸ä¼šå¼•èµ·å‰§çƒˆå˜åŠ¨ã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eä¼˜ç‚¹\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eåŠ å…¥\u003c/strong\u003e å’Œ \u003cstrong\u003eåˆ é™¤\u003c/strong\u003e èŠ‚ç‚¹åªå½±å“ \u003cstrong\u003eå“ˆå¸Œç¯\u003c/strong\u003e ä¸­ \u003cstrong\u003eé¡ºæ—¶é’ˆæ–¹å‘\u003c/strong\u003e çš„ \u003cstrong\u003eç›¸é‚»çš„èŠ‚ç‚¹\u003c/strong\u003eï¼Œå¯¹å…¶ä»–èŠ‚ç‚¹æ— å½±å“ã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eç¼ºç‚¹\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eåŠ å‡èŠ‚ç‚¹\u003c/strong\u003e ä¼šé€ æˆ \u003cstrong\u003eå“ˆå¸Œç¯\u003c/strong\u003e ä¸­éƒ¨åˆ†æ•°æ® \u003cstrong\u003eæ— æ³•å‘½ä¸­\u003c/strong\u003eã€‚å½“ä½¿ç”¨ \u003cstrong\u003eå°‘é‡èŠ‚ç‚¹\u003c/strong\u003e æ—¶ï¼Œ\u003cstrong\u003eèŠ‚ç‚¹å˜åŒ–\u003c/strong\u003e å°†å¤§èŒƒå›´å½±å“ \u003cstrong\u003eå“ˆå¸Œç¯\u003c/strong\u003e ä¸­ \u003cstrong\u003eæ•°æ®æ˜ å°„\u003c/strong\u003eï¼Œä¸é€‚åˆ \u003cstrong\u003eå°‘é‡æ•°æ®èŠ‚ç‚¹\u003c/strong\u003e çš„åˆ†å¸ƒå¼æ–¹æ¡ˆã€‚\u003cstrong\u003eæ™®é€š\u003c/strong\u003e çš„ \u003cstrong\u003eä¸€è‡´æ€§å“ˆå¸Œåˆ†åŒº\u003c/strong\u003e åœ¨å¢å‡èŠ‚ç‚¹æ—¶éœ€è¦ \u003cstrong\u003eå¢åŠ ä¸€å€\u003c/strong\u003e æˆ– \u003cstrong\u003eå‡å»ä¸€åŠ\u003c/strong\u003e èŠ‚ç‚¹æ‰èƒ½ä¿è¯ \u003cstrong\u003eæ•°æ®\u003c/strong\u003e å’Œ \u003cstrong\u003eè´Ÿè½½çš„å‡è¡¡\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eæ³¨æ„\u003c/strong\u003eï¼šå› ä¸º \u003cstrong\u003eä¸€è‡´æ€§å“ˆå¸Œåˆ†åŒº\u003c/strong\u003e çš„è¿™äº›ç¼ºç‚¹ï¼Œä¸€äº›åˆ†å¸ƒå¼ç³»ç»Ÿé‡‡ç”¨ \u003cstrong\u003eè™šæ‹Ÿæ§½\u003c/strong\u003e å¯¹ \u003cstrong\u003eä¸€è‡´æ€§å“ˆå¸Œ\u003c/strong\u003e è¿›è¡Œæ”¹è¿›ï¼Œæ¯”å¦‚ \u003ccode\u003eDynamo\u003c/code\u003e ç³»ç»Ÿã€‚\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2 id=\"Gossip-åè®®\"\u003e\u003ca href=\"#Gossip-åè®®\" class=\"headerlink\" title=\"Gossip åè®®\"\u003e\u003c/a\u003eGossip åè®®\u003c/h2\u003e\u003cp\u003eGossip åè®®æ˜¯é›†ç¾¤ä¸­èŠ‚ç‚¹ç›¸äº’é€šä¿¡çš„å†…éƒ¨é€šä¿¡æŠ€æœ¯ã€‚ Gossip æ˜¯ä¸€ç§é«˜æ•ˆã€è½»é‡çº§ã€å¯é çš„èŠ‚ç‚¹é—´å¹¿æ’­åè®®ï¼Œç”¨äºä¼ æ’­æ•°æ®ã€‚å®ƒæ˜¯å»ä¸­å¿ƒåŒ–çš„ã€â€œæµè¡Œç—…â€çš„ã€å®¹é”™çš„å’Œç‚¹å¯¹ç‚¹é€šä¿¡åè®®ã€‚\u003c/p\u003e\n\u003cp\u003eGoosip åè®®çš„ä¿¡æ¯ä¼ æ’­å’Œæ‰©æ•£é€šå¸¸éœ€è¦ç”±ç§å­èŠ‚ç‚¹å‘èµ·ã€‚æ•´ä¸ªä¼ æ’­è¿‡ç¨‹å¯èƒ½éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œç”±äºä¸èƒ½ä¿è¯æŸä¸ªæ—¶åˆ»æ‰€æœ‰èŠ‚ç‚¹éƒ½æ”¶åˆ°æ¶ˆæ¯ï¼Œä½†æ˜¯ç†è®ºä¸Šæœ€ç»ˆæ‰€æœ‰èŠ‚ç‚¹éƒ½ä¼šæ”¶åˆ°æ¶ˆæ¯ï¼Œå› æ­¤å®ƒæ˜¯ä¸€ä¸ª\u003cstrong\u003eæœ€ç»ˆä¸€è‡´æ€§\u003c/strong\u003eåè®®ã€‚\u003c/p\u003e\n\u003ch3 id=\"Gossip-çš„æ‰§è¡Œè¿‡ç¨‹\"\u003e\u003ca href=\"#Gossip-çš„æ‰§è¡Œè¿‡ç¨‹\" class=\"headerlink\" title=\"Gossip çš„æ‰§è¡Œè¿‡ç¨‹\"\u003e\u003c/a\u003eGossip çš„æ‰§è¡Œè¿‡ç¨‹\u003c/h3\u003e\u003cp\u003eGossip åè®®çš„æ‰§è¡Œè¿‡ç¨‹ï¼šGossip è¿‡ç¨‹æ˜¯ç”±ç§å­èŠ‚ç‚¹å‘èµ·ï¼Œå½“ä¸€ä¸ªç§å­èŠ‚ç‚¹æœ‰çŠ¶æ€éœ€è¦æ›´æ–°åˆ°ç½‘ç»œä¸­çš„å…¶ä»–èŠ‚ç‚¹æ—¶ï¼Œå®ƒä¼šéšæœºçš„é€‰æ‹©å‘¨å›´å‡ ä¸ªèŠ‚ç‚¹æ•£æ’­æ¶ˆæ¯ï¼Œæ”¶åˆ°æ¶ˆæ¯çš„èŠ‚ç‚¹ä¹Ÿä¼šé‡å¤è¯¥è¿‡ç¨‹ï¼Œç›´è‡³æœ€ç»ˆç½‘ç»œä¸­æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½æ”¶åˆ°äº†æ¶ˆæ¯ã€‚è¿™ä¸ªè¿‡ç¨‹å¯èƒ½éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œç”±äºä¸èƒ½ä¿è¯æŸä¸ªæ—¶åˆ»æ‰€æœ‰èŠ‚ç‚¹éƒ½æ”¶åˆ°æ¶ˆæ¯ï¼Œä½†æ˜¯ç†è®ºä¸Šæœ€ç»ˆæ‰€æœ‰èŠ‚ç‚¹éƒ½ä¼šæ”¶åˆ°æ¶ˆæ¯ï¼Œå› æ­¤å®ƒæ˜¯ä¸€ä¸ªæœ€ç»ˆä¸€è‡´æ€§åè®®ã€‚\u003c/p\u003e\n\u003ch3 id=\"Gossip-ç±»å‹\"\u003e\u003ca href=\"#Gossip-ç±»å‹\" class=\"headerlink\" title=\"Gossip ç±»å‹\"\u003e\u003c/a\u003eGossip ç±»å‹\u003c/h3\u003e\u003cp\u003eGossip æœ‰ä¸¤ç§ç±»å‹ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e**Anti-Entropy(åç†µ)**ï¼šä»¥å›ºå®šçš„æ¦‚ç‡ä¼ æ’­æ‰€æœ‰çš„æ•°æ®ã€‚Anti-Entropy æ˜¯ SI modelï¼ŒèŠ‚ç‚¹åªæœ‰ä¸¤ç§çŠ¶æ€ï¼ŒSuspective å’Œ Infectiveï¼Œå«åš simple epidemicsã€‚\u003c/li\u003e\n\u003cli\u003e**Rumor-Mongering(è°£è¨€ä¼ æ’­)**ï¼šä»…ä¼ æ’­æ–°åˆ°è¾¾çš„æ•°æ®ã€‚Rumor-Mongering æ˜¯ SIR modelï¼ŒèŠ‚ç‚¹æœ‰ä¸‰ç§çŠ¶æ€ï¼ŒSuspectiveï¼ŒInfective å’Œ Removedï¼Œå«åš complex epidemicsã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eç†µæ˜¯ç‰©ç†å­¦ä¸Šçš„ä¸€ä¸ªæ¦‚å¿µï¼Œä»£è¡¨æ‚ä¹±æ— ç« ï¼Œè€Œåç†µå°±æ˜¯åœ¨æ‚ä¹±æ— ç« ä¸­å¯»æ±‚ä¸€è‡´ã€‚æœ¬è´¨ä¸Šï¼Œ\u003cstrong\u003eåç†µæ˜¯ä¸€ç§é€šè¿‡å¼‚æ­¥ä¿®å¤å®ç°æœ€ç»ˆä¸€è‡´æ€§çš„æ–¹æ³•\u003c/strong\u003eã€‚åç†µæŒ‡çš„æ˜¯é›†ç¾¤ä¸­çš„èŠ‚ç‚¹ï¼Œæ¯éš”æ®µæ—¶é—´å°±éšæœºé€‰æ‹©æŸä¸ªå…¶ä»–èŠ‚ç‚¹ï¼Œç„¶åé€šè¿‡äº’ç›¸äº¤æ¢è‡ªå·±çš„æ‰€æœ‰æ•°æ®æ¥æ¶ˆé™¤ä¸¤è€…ä¹‹é—´çš„å·®å¼‚ï¼Œå®ç°æ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ã€‚ç”±äºæ¶ˆæ¯ä¼šä¸æ–­åå¤çš„äº¤æ¢ï¼Œå› æ­¤æ¶ˆæ¯æ•°é‡æ˜¯éå¸¸åºå¤§çš„ï¼Œæ— é™åˆ¶çš„ï¼ˆunboundedï¼‰ï¼Œè¿™å¯¹ä¸€ä¸ªç³»ç»Ÿæ¥è¯´æ˜¯ä¸€ä¸ªå·¨å¤§çš„å¼€é”€ã€‚æ‰€ä»¥ï¼Œ\u003cstrong\u003eåç†µä¸é€‚åˆåŠ¨æ€å˜åŒ–æˆ–èŠ‚ç‚¹æ•°æ¯”è¾ƒå¤šçš„åˆ†å¸ƒå¼ç¯å¢ƒ\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cp\u003eè°£è¨€ä¼ æ’­æ¨¡å‹æŒ‡çš„æ˜¯å½“ä¸€ä¸ªèŠ‚ç‚¹æœ‰äº†æ–°æ•°æ®åï¼Œè¿™ä¸ªèŠ‚ç‚¹å˜æˆæ´»è·ƒçŠ¶æ€ï¼Œå¹¶å‘¨æœŸæ€§åœ°è”ç³»å…¶ä»–èŠ‚ç‚¹å‘å…¶å‘é€æ–°æ•°æ®ï¼Œç›´åˆ°æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½å­˜å‚¨äº†è¯¥æ–°æ•°æ®ã€‚åœ¨è°£è¨€ä¼ æ’­æ¨¡å‹ä¸‹ï¼Œæ¶ˆæ¯å¯ä»¥å‘é€å¾—æ›´é¢‘ç¹ï¼Œå› ä¸ºæ¶ˆæ¯åªåŒ…å«æœ€æ–° updateï¼Œä½“ç§¯æ›´å°ã€‚è€Œä¸”ï¼Œä¸€ä¸ªè°£è¨€æ¶ˆæ¯åœ¨æŸä¸ªæ—¶é—´ç‚¹ä¹‹åä¼šè¢«æ ‡è®°ä¸º removedï¼Œå¹¶ä¸”ä¸å†è¢«ä¼ æ’­ï¼Œå› æ­¤ï¼Œè°£è¨€ä¼ æ’­æ¨¡å‹ä¸‹ï¼Œç³»ç»Ÿæœ‰ä¸€å®šçš„æ¦‚ç‡ä¼šä¸ä¸€è‡´ã€‚è€Œç”±äºï¼Œè°£è¨€ä¼ æ’­æ¨¡å‹ä¸‹æŸä¸ªæ—¶é—´ç‚¹ä¹‹åæ¶ˆæ¯ä¸å†ä¼ æ’­ï¼Œå› æ­¤æ¶ˆæ¯æ˜¯æœ‰é™çš„ï¼Œç³»ç»Ÿå¼€é”€å°ã€‚\u003c/p\u003e\n\u003cp\u003eä¸€èˆ¬æ¥è¯´ï¼Œä¸ºäº†åœ¨é€šä¿¡ä»£ä»·å’Œå¯é æ€§ä¹‹é—´å–å¾—æŠ˜ä¸­ï¼Œéœ€è¦å°†è¿™ä¸¤ç§æ–¹æ³•ç»“åˆä½¿ç”¨ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eGossip ä¸­çš„é€šä¿¡æ¨¡å¼\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eåœ¨ Gossip åè®®ä¸‹ï¼Œç½‘ç»œä¸­ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´æœ‰ä¸‰ç§é€šä¿¡æ–¹å¼:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ePush: èŠ‚ç‚¹ A å°†æ•°æ® (key,value,version) åŠå¯¹åº”çš„ç‰ˆæœ¬å·æ¨é€ç»™ B èŠ‚ç‚¹ï¼ŒB èŠ‚ç‚¹æ›´æ–° A ä¸­æ¯”è‡ªå·±æ–°çš„æ•°æ®\u003c/li\u003e\n\u003cli\u003ePullï¼šA ä»…å°†æ•°æ® key, version æ¨é€ç»™ Bï¼ŒB å°†æœ¬åœ°æ¯” A æ–°çš„æ•°æ®ï¼ˆKey, value, versionï¼‰æ¨é€ç»™ Aï¼ŒA æ›´æ–°æœ¬åœ°\u003c/li\u003e\n\u003cli\u003ePush/Pullï¼šä¸ Pull ç±»ä¼¼ï¼Œåªæ˜¯å¤šäº†ä¸€æ­¥ï¼ŒA å†å°†æœ¬åœ°æ¯” B æ–°çš„æ•°æ®æ¨é€ç»™ Bï¼ŒB åˆ™æ›´æ–°æœ¬åœ°\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eå¦‚æœæŠŠä¸¤ä¸ªèŠ‚ç‚¹æ•°æ®åŒæ­¥ä¸€æ¬¡å®šä¹‰ä¸ºä¸€ä¸ªå‘¨æœŸï¼Œåˆ™åœ¨ä¸€ä¸ªå‘¨æœŸå†…ï¼ŒPush éœ€é€šä¿¡ 1 æ¬¡ï¼ŒPull éœ€ 2 æ¬¡ï¼ŒPush/Pull åˆ™éœ€ 3 æ¬¡ã€‚è™½ç„¶æ¶ˆæ¯æ•°å¢åŠ äº†ï¼Œä½†ä»æ•ˆæœä¸Šæ¥è®²ï¼ŒPush/Pull æœ€å¥½ï¼Œç†è®ºä¸Šä¸€ä¸ªå‘¨æœŸå†…å¯ä»¥ä½¿ä¸¤ä¸ªèŠ‚ç‚¹å®Œå…¨ä¸€è‡´ã€‚ç›´è§‚ä¸Šï¼ŒPush/Pull çš„æ”¶æ•›é€Ÿåº¦ä¹Ÿæ˜¯æœ€å¿«çš„ã€‚\u003c/p\u003e\n\u003ch3 id=\"Gossip-çš„ä¼˜ç‚¹\"\u003e\u003ca href=\"#Gossip-çš„ä¼˜ç‚¹\" class=\"headerlink\" title=\"Gossip çš„ä¼˜ç‚¹\"\u003e\u003c/a\u003eGossip çš„ä¼˜ç‚¹\u003c/h3\u003e\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eæ‰©å±•æ€§\u003c/strong\u003eï¼šç½‘ç»œå¯ä»¥å…è®¸èŠ‚ç‚¹çš„ä»»æ„å¢åŠ å’Œå‡å°‘ï¼Œæ–°å¢åŠ çš„èŠ‚ç‚¹çš„çŠ¶æ€æœ€ç»ˆä¼šä¸å…¶ä»–èŠ‚ç‚¹ä¸€è‡´ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå®¹é”™\u003c/strong\u003eï¼šç½‘ç»œä¸­ä»»ä½•èŠ‚ç‚¹çš„å®•æœºå’Œé‡å¯éƒ½ä¸ä¼šå½±å“ Gossip æ¶ˆæ¯çš„ä¼ æ’­ï¼ŒGossip åè®®å…·æœ‰å¤©ç„¶çš„åˆ†å¸ƒå¼ç³»ç»Ÿå®¹é”™ç‰¹æ€§ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå»ä¸­å¿ƒåŒ–\u003c/strong\u003eï¼šGossip åè®®ä¸è¦æ±‚ä»»ä½•ä¸­å¿ƒèŠ‚ç‚¹ï¼Œæ‰€æœ‰èŠ‚ç‚¹éƒ½å¯ä»¥æ˜¯å¯¹ç­‰çš„ï¼Œä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹æ— éœ€çŸ¥é“æ•´ä¸ªç½‘ç»œçŠ¶å†µï¼Œåªè¦ç½‘ç»œæ˜¯è¿é€šçš„ï¼Œä»»æ„ä¸€ä¸ªèŠ‚ç‚¹å°±å¯ä»¥æŠŠæ¶ˆæ¯æ•£æ’­åˆ°å…¨ç½‘ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eä¸€è‡´æ€§æ”¶æ•›\u003c/strong\u003eï¼šGossip åè®®ä¸­çš„æ¶ˆæ¯ä¼šä»¥ä¸€ä¼ åã€åä¼ ç™¾ä¸€æ ·çš„æŒ‡æ•°çº§é€Ÿåº¦åœ¨ç½‘ç»œä¸­å¿«é€Ÿä¼ æ’­ï¼Œå› æ­¤ç³»ç»ŸçŠ¶æ€çš„ä¸ä¸€è‡´å¯ä»¥åœ¨å¾ˆå¿«çš„æ—¶é—´å†…æ”¶æ•›åˆ°ä¸€è‡´ã€‚æ¶ˆæ¯ä¼ æ’­é€Ÿåº¦è¾¾åˆ°äº† logNã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eç®€å•\u003c/strong\u003eï¼šGossip åè®®çš„è¿‡ç¨‹æå…¶ç®€å•ï¼Œå®ç°èµ·æ¥å‡ ä¹æ²¡æœ‰å¤ªå¤šå¤æ‚æ€§ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"Gossip-çš„ç¼ºé™·\"\u003e\u003ca href=\"#Gossip-çš„ç¼ºé™·\" class=\"headerlink\" title=\"Gossip çš„ç¼ºé™·\"\u003e\u003c/a\u003eGossip çš„ç¼ºé™·\u003c/h3\u003e\u003cp\u003eåˆ†å¸ƒå¼ç½‘ç»œä¸­ï¼Œæ²¡æœ‰ä¸€ç§å®Œç¾çš„è§£å†³æ–¹æ¡ˆï¼ŒGossip åè®®è·Ÿå…¶ä»–åè®®ä¸€æ ·ï¼Œä¹Ÿæœ‰ä¸€äº›ä¸å¯é¿å…çš„ç¼ºé™·ï¼Œä¸»è¦æ˜¯ä¸¤ä¸ªï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eæ¶ˆæ¯çš„å»¶è¿Ÿ\u003c/strong\u003eï¼šç”±äº Gossip åè®®ä¸­ï¼ŒèŠ‚ç‚¹åªä¼šéšæœºå‘å°‘æ•°å‡ ä¸ªèŠ‚ç‚¹å‘é€æ¶ˆæ¯ï¼Œæ¶ˆæ¯æœ€ç»ˆæ˜¯é€šè¿‡å¤šä¸ªè½®æ¬¡çš„æ•£æ’­è€Œåˆ°è¾¾å…¨ç½‘çš„ï¼Œå› æ­¤ä½¿ç”¨ Gossip åè®®ä¼šé€ æˆä¸å¯é¿å…çš„æ¶ˆæ¯å»¶è¿Ÿã€‚ä¸é€‚åˆç”¨åœ¨å¯¹å®æ—¶æ€§è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ä¸‹ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eæ¶ˆæ¯å†—ä½™\u003c/strong\u003eï¼šGossip åè®®è§„å®šï¼ŒèŠ‚ç‚¹ä¼šå®šæœŸéšæœºé€‰æ‹©å‘¨å›´èŠ‚ç‚¹å‘é€æ¶ˆæ¯ï¼Œè€Œæ”¶åˆ°æ¶ˆæ¯çš„èŠ‚ç‚¹ä¹Ÿä¼šé‡å¤è¯¥æ­¥éª¤ï¼Œå› æ­¤å°±ä¸å¯é¿å…çš„å­˜åœ¨æ¶ˆæ¯é‡å¤å‘é€ç»™åŒä¸€èŠ‚ç‚¹çš„æƒ…å†µï¼Œé€ æˆäº†æ¶ˆæ¯çš„å†—ä½™ï¼ŒåŒæ—¶ä¹Ÿå¢åŠ äº†æ”¶åˆ°æ¶ˆæ¯çš„èŠ‚ç‚¹çš„å¤„ç†å‹åŠ›ã€‚è€Œä¸”ï¼Œç”±äºæ˜¯å®šæœŸå‘é€ï¼Œå› æ­¤ï¼Œå³ä½¿æ”¶åˆ°äº†æ¶ˆæ¯çš„èŠ‚ç‚¹è¿˜ä¼šåå¤æ”¶åˆ°é‡å¤æ¶ˆæ¯ï¼ŒåŠ é‡äº†æ¶ˆæ¯çš„å†—ä½™ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"QuorumNWR-ç®—æ³•\"\u003e\u003ca href=\"#QuorumNWR-ç®—æ³•\" class=\"headerlink\" title=\"QuorumNWR ç®—æ³•\"\u003e\u003c/a\u003eQuorumNWR ç®—æ³•\u003c/h2\u003e\u003cp\u003eé€šè¿‡ Quorum NWRï¼Œä½ å¯ä»¥è‡ªå®šä¹‰ä¸€è‡´æ€§çº§åˆ«ï¼Œé€šè¿‡ä¸´æ—¶è°ƒæ•´å†™å…¥æˆ–è€…æŸ¥è¯¢çš„æ–¹å¼ï¼Œå½“ \u003ccode\u003eW + R \u0026gt; N\u003c/code\u003e æ—¶ï¼Œå°±å¯ä»¥å®ç°å¼ºä¸€è‡´æ€§äº†ã€‚\u003c/p\u003e\n\u003ch3 id=\"Quorum-NWR-çš„ä¸‰è¦ç´ \"\u003e\u003ca href=\"#Quorum-NWR-çš„ä¸‰è¦ç´ \" class=\"headerlink\" title=\"Quorum NWR çš„ä¸‰è¦ç´ \"\u003e\u003c/a\u003eQuorum NWR çš„ä¸‰è¦ç´ \u003c/h3\u003e\u003cul\u003e\n\u003cli\u003e**\u003ccode\u003eN\u003c/code\u003e**ï¼šè¡¨ç¤ºå‰¯æœ¬æ•°ï¼Œåˆå«åšå¤åˆ¶å› å­ï¼ˆReplication Factorï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒN è¡¨ç¤ºé›†ç¾¤ä¸­åŒä¸€ä»½æ•°æ®æœ‰å¤šå°‘ä¸ªå‰¯æœ¬ã€‚åœ¨å®ç° Quorum NWR çš„æ—¶å€™ï¼Œä½ éœ€è¦å®ç°è‡ªå®šä¹‰å‰¯æœ¬çš„åŠŸèƒ½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰æŒ‡å®šæ•°æ®çš„å‰¯æœ¬æ•°ã€‚\u003c/li\u003e\n\u003cli\u003e**\u003ccode\u003eW\u003c/code\u003e**ï¼šåˆç§°å†™ä¸€è‡´æ€§çº§åˆ«ï¼ˆWrite Consistency Levelï¼‰ï¼Œè¡¨ç¤ºæˆåŠŸå®Œæˆ W ä¸ªå‰¯æœ¬æ›´æ–°ï¼Œæ‰å®Œæˆå†™æ“ä½œ\u003c/li\u003e\n\u003cli\u003e**\u003ccode\u003eR\u003c/code\u003e**ï¼šåˆç§°è¯»ä¸€è‡´æ€§çº§åˆ«ï¼ˆRead Consistency Levelï¼‰ï¼Œè¡¨ç¤ºè¯»å–ä¸€ä¸ªæ•°æ®å¯¹è±¡æ—¶éœ€è¦è¯» R ä¸ªå‰¯æœ¬ã€‚ä½ å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œè¯»å–æŒ‡å®šæ•°æ®æ—¶ï¼Œè¦è¯» R å‰¯æœ¬ï¼Œç„¶åè¿”å› R ä¸ªå‰¯æœ¬ä¸­æœ€æ–°çš„é‚£ä»½æ•°æ®ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eNã€Wã€R å€¼çš„ä¸åŒç»„åˆï¼Œä¼šäº§ç”Ÿä¸åŒçš„ä¸€è‡´æ€§æ•ˆæœï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå½“ \u003ccode\u003eW + R \u0026gt; N\u003c/code\u003e çš„æ—¶å€™ï¼Œå¯¹äºå®¢æˆ·ç«¯æ¥è®²ï¼Œæ•´ä¸ªç³»ç»Ÿèƒ½ä¿è¯å¼ºä¸€è‡´æ€§ï¼Œä¸€å®šèƒ½è¿”å›æ›´æ–°åçš„é‚£ä»½æ•°æ®ã€‚\u003c/li\u003e\n\u003cli\u003eå½“ \u003ccode\u003eW + R \u0026lt; N\u003c/code\u003e çš„æ—¶å€™ï¼Œå¯¹äºå®¢æˆ·ç«¯æ¥è®²ï¼Œæ•´ä¸ªç³»ç»Ÿåªèƒ½ä¿è¯æœ€ç»ˆä¸€è‡´æ€§ï¼Œå¯èƒ½ä¼šè¿”å›æ—§æ•°æ®ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå‰¯æœ¬æ•°ä¸èƒ½è¶…è¿‡èŠ‚ç‚¹æ•°ï¼šå¤šå‰¯æœ¬çš„æ„ä¹‰åœ¨äºå†—ä½™å¤‡ä»½ï¼Œå¦‚æœå‰¯æœ¬æ•°è¶…è¿‡èŠ‚ç‚¹æ•°ï¼Œå°±æ„å‘³ç€åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šä¼šå­˜åœ¨å¤šä¸ªå‰¯æœ¬ï¼Œé‚£ä¹ˆå†—ä½™å¤‡ä»½çš„æ„ä¹‰å°±ä¸å¤§äº†ã€‚\u003c/p\u003e\n\u003ch2 id=\"PBFT-ç®—æ³•\"\u003e\u003ca href=\"#PBFT-ç®—æ³•\" class=\"headerlink\" title=\"PBFT ç®—æ³•\"\u003e\u003c/a\u003ePBFT ç®—æ³•\u003c/h2\u003e\u003cp\u003eç•¥\u003c/p\u003e\n\u003ch2 id=\"PoW-ç®—æ³•\"\u003e\u003ca href=\"#PoW-ç®—æ³•\" class=\"headerlink\" title=\"PoW ç®—æ³•\"\u003e\u003c/a\u003ePoW ç®—æ³•\u003c/h2\u003e\u003cp\u003eç•¥\u003c/p\u003e\n\u003ch2 id=\"ZAB-åè®®\"\u003e\u003ca href=\"#ZAB-åè®®\" class=\"headerlink\" title=\"ZAB åè®®\"\u003e\u003c/a\u003eZAB åè®®\u003c/h2\u003e\u003cblockquote\u003e\n\u003cp\u003eZooKeeper å¹¶æ²¡æœ‰ç›´æ¥é‡‡ç”¨ Paxos ç®—æ³•ï¼Œè€Œæ˜¯é‡‡ç”¨äº†åä¸º ZAB çš„ä¸€è‡´æ€§åè®®ã€‚**\u003cem\u003eZAB åè®®ä¸æ˜¯ Paxos ç®—æ³•\u003c/em\u003e**ï¼Œåªæ˜¯æ¯”è¾ƒç±»ä¼¼ï¼ŒäºŒè€…åœ¨æ“ä½œä¸Šå¹¶ä¸ç›¸åŒã€‚\u003c/p\u003e\n\u003cp\u003eZAB åè®®æ˜¯ Zookeeper ä¸“é—¨è®¾è®¡çš„ä¸€ç§\u003cstrong\u003eæ”¯æŒå´©æºƒæ¢å¤çš„åŸå­å¹¿æ’­åè®®\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cp\u003eZAB åè®®æ˜¯ ZooKeeper çš„æ•°æ®ä¸€è‡´æ€§å’Œé«˜å¯ç”¨è§£å†³æ–¹æ¡ˆã€‚\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eZAB åè®®å®šä¹‰äº†ä¸¤ä¸ªå¯ä»¥\u003cstrong\u003eæ— é™å¾ªç¯\u003c/strong\u003eçš„æµç¨‹ï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003eé€‰ä¸¾ Leader\u003c/code\u003e\u003c/strong\u003e - ç”¨äºæ•…éšœæ¢å¤ï¼Œä»è€Œä¿è¯é«˜å¯ç”¨ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003ccode\u003eåŸå­å¹¿æ’­\u003c/code\u003e\u003c/strong\u003e - ç”¨äºä¸»ä»åŒæ­¥ï¼Œä»è€Œä¿è¯æ•°æ®ä¸€è‡´æ€§ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"é€‰ä¸¾-Leader-1\"\u003e\u003ca href=\"#é€‰ä¸¾-Leader-1\" class=\"headerlink\" title=\"é€‰ä¸¾ Leader\"\u003e\u003c/a\u003eé€‰ä¸¾ Leader\u003c/h3\u003e\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003eZooKeeper çš„æ•…éšœæ¢å¤\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eZooKeeper é›†ç¾¤é‡‡ç”¨ä¸€ä¸»ï¼ˆç§°ä¸º Leaderï¼‰å¤šä»ï¼ˆç§°ä¸º Followerï¼‰æ¨¡å¼ï¼Œä¸»ä»èŠ‚ç‚¹é€šè¿‡å‰¯æœ¬æœºåˆ¶ä¿è¯æ•°æ®ä¸€è‡´ã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eå¦‚æœ Follower èŠ‚ç‚¹æŒ‚äº†\u003c/strong\u003e - ZooKeeper é›†ç¾¤ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šå•ç‹¬åœ¨å†…å­˜ä¸­ç»´æŠ¤è‡ªèº«çš„çŠ¶æ€ï¼Œå¹¶ä¸”å„èŠ‚ç‚¹ä¹‹é—´éƒ½ä¿æŒç€é€šè®¯ï¼Œ\u003cstrong\u003eåªè¦é›†ç¾¤ä¸­æœ‰åŠæ•°æœºå™¨èƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼Œé‚£ä¹ˆæ•´ä¸ªé›†ç¾¤å°±å¯ä»¥æ­£å¸¸æä¾›æœåŠ¡\u003c/strong\u003eã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eå¦‚æœ Leader èŠ‚ç‚¹æŒ‚äº†\u003c/strong\u003e - å¦‚æœ Leader èŠ‚ç‚¹æŒ‚äº†ï¼Œç³»ç»Ÿå°±ä¸èƒ½æ­£å¸¸å·¥ä½œäº†ã€‚æ­¤æ—¶ï¼Œéœ€è¦é€šè¿‡ ZAB åè®®çš„é€‰ä¸¾ Leader æœºåˆ¶æ¥è¿›è¡Œæ•…éšœæ¢å¤ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eZAB åè®®çš„é€‰ä¸¾ Leader æœºåˆ¶ç®€å•æ¥è¯´ï¼Œå°±æ˜¯ï¼šåŸºäºè¿‡åŠé€‰ä¸¾æœºåˆ¶äº§ç”Ÿæ–°çš„ Leaderï¼Œä¹‹åå…¶ä»–æœºå™¨å°†ä»æ–°çš„ Leader ä¸ŠåŒæ­¥çŠ¶æ€ï¼Œå½“æœ‰è¿‡åŠæœºå™¨å®ŒæˆçŠ¶æ€åŒæ­¥åï¼Œå°±é€€å‡ºé€‰ä¸¾ Leader æ¨¡å¼ï¼Œè¿›å…¥åŸå­å¹¿æ’­æ¨¡å¼ã€‚\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"æœ¯è¯­\"\u003e\u003ca href=\"#æœ¯è¯­\" class=\"headerlink\" title=\"æœ¯è¯­\"\u003e\u003c/a\u003eæœ¯è¯­\u003c/h4\u003e\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003emyid\u003c/strong\u003e - æ¯ä¸ª Zookeeper æœåŠ¡å™¨ï¼Œéƒ½éœ€è¦åœ¨æ•°æ®æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º myid çš„æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«æ•´ä¸ª Zookeeper é›†ç¾¤å”¯ä¸€çš„ IDï¼ˆæ•´æ•°ï¼‰ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ezxid\u003c/strong\u003e - ç±»ä¼¼äº RDBMS ä¸­çš„äº‹åŠ¡ IDï¼Œç”¨äºæ ‡è¯†ä¸€æ¬¡æ›´æ–°æ“ä½œçš„ Proposal IDã€‚ä¸ºäº†ä¿è¯é¡ºåºæ€§ï¼Œè¯¥ zkid å¿…é¡»å•è°ƒé€’å¢ã€‚å› æ­¤ Zookeeper ä½¿ç”¨ä¸€ä¸ª 64 ä½çš„æ•°æ¥è¡¨ç¤ºï¼Œé«˜ 32 ä½æ˜¯ Leader çš„ epochï¼Œä» 1 å¼€å§‹ï¼Œæ¯æ¬¡é€‰å‡ºæ–°çš„ Leaderï¼Œepoch åŠ ä¸€ã€‚ä½ 32 ä½ä¸ºè¯¥ epoch å†…çš„åºå·ï¼Œæ¯æ¬¡ epoch å˜åŒ–ï¼Œéƒ½å°†ä½ 32 ä½çš„åºå·é‡ç½®ã€‚è¿™æ ·ä¿è¯äº† zkid çš„å…¨å±€é€’å¢æ€§ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"æœåŠ¡å™¨çŠ¶æ€\"\u003e\u003ca href=\"#æœåŠ¡å™¨çŠ¶æ€\" class=\"headerlink\" title=\"æœåŠ¡å™¨çŠ¶æ€\"\u003e\u003c/a\u003eæœåŠ¡å™¨çŠ¶æ€\u003c/h4\u003e\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e\u003cem\u003eLOOKING\u003c/em\u003e\u003c/strong\u003e - ä¸ç¡®å®š Leader çŠ¶æ€ã€‚è¯¥çŠ¶æ€ä¸‹çš„æœåŠ¡å™¨è®¤ä¸ºå½“å‰é›†ç¾¤ä¸­æ²¡æœ‰ Leaderï¼Œä¼šå‘èµ· Leader é€‰ä¸¾\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003cem\u003eFOLLOWING\u003c/em\u003e\u003c/strong\u003e - è·Ÿéšè€…çŠ¶æ€ã€‚è¡¨æ˜å½“å‰æœåŠ¡å™¨è§’è‰²æ˜¯ Followerï¼Œå¹¶ä¸”å®ƒçŸ¥é“ Leader æ˜¯è°\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003cem\u003eLEADING\u003c/em\u003e\u003c/strong\u003e - é¢†å¯¼è€…çŠ¶æ€ã€‚è¡¨æ˜å½“å‰æœåŠ¡å™¨è§’è‰²æ˜¯ Leaderï¼Œå®ƒä¼šç»´æŠ¤ä¸ Follower é—´çš„å¿ƒè·³\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003cem\u003eOBSERVING\u003c/em\u003e\u003c/strong\u003e - è§‚å¯Ÿè€…çŠ¶æ€ã€‚è¡¨æ˜å½“å‰æœåŠ¡å™¨è§’è‰²æ˜¯ Observerï¼Œä¸ Folower å”¯ä¸€çš„ä¸åŒåœ¨äºä¸å‚ä¸é€‰ä¸¾ï¼Œä¹Ÿä¸å‚ä¸é›†ç¾¤å†™æ“ä½œæ—¶çš„æŠ•ç¥¨\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"é€‰ç¥¨æ•°æ®ç»“æ„\"\u003e\u003ca href=\"#é€‰ç¥¨æ•°æ®ç»“æ„\" class=\"headerlink\" title=\"é€‰ç¥¨æ•°æ®ç»“æ„\"\u003e\u003c/a\u003eé€‰ç¥¨æ•°æ®ç»“æ„\u003c/h4\u003e\u003cp\u003eæ¯ä¸ªæœåŠ¡å™¨åœ¨è¿›è¡Œé¢†å¯¼é€‰ä¸¾æ—¶ï¼Œä¼šå‘é€å¦‚ä¸‹å…³é”®ä¿¡æ¯\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e\u003cem\u003elogicClock\u003c/em\u003e\u003c/strong\u003e - æ¯ä¸ªæœåŠ¡å™¨ä¼šç»´æŠ¤ä¸€ä¸ªè‡ªå¢çš„æ•´æ•°ï¼Œåä¸º logicClockï¼Œå®ƒè¡¨ç¤ºè¿™æ˜¯è¯¥æœåŠ¡å™¨å‘èµ·çš„ç¬¬å¤šå°‘è½®æŠ•ç¥¨\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003cem\u003estate\u003c/em\u003e\u003c/strong\u003e - å½“å‰æœåŠ¡å™¨çš„çŠ¶æ€\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003cem\u003eself_id\u003c/em\u003e\u003c/strong\u003e - å½“å‰æœåŠ¡å™¨çš„ myid\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003cem\u003eself_zxid\u003c/em\u003e\u003c/strong\u003e - å½“å‰æœåŠ¡å™¨ä¸Šæ‰€ä¿å­˜çš„æ•°æ®çš„æœ€å¤§ zxid\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003cem\u003evote_id\u003c/em\u003e\u003c/strong\u003e - è¢«æ¨ä¸¾çš„æœåŠ¡å™¨çš„ myid\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e\u003cem\u003evote_zxid\u003c/em\u003e\u003c/strong\u003e - è¢«æ¨ä¸¾çš„æœåŠ¡å™¨ä¸Šæ‰€ä¿å­˜çš„æ•°æ®çš„æœ€å¤§ zxid\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"æŠ•ç¥¨æµç¨‹\"\u003e\u003ca href=\"#æŠ•ç¥¨æµç¨‹\" class=\"headerlink\" title=\"æŠ•ç¥¨æµç¨‹\"\u003e\u003c/a\u003eæŠ•ç¥¨æµç¨‹\u003c/h4\u003e\u003cp\u003eï¼ˆ1ï¼‰\u003cstrong\u003eè‡ªå¢é€‰ä¸¾è½®æ¬¡\u003c/strong\u003e - Zookeeper è§„å®šæ‰€æœ‰æœ‰æ•ˆçš„æŠ•ç¥¨éƒ½å¿…é¡»åœ¨åŒä¸€è½®æ¬¡ä¸­ã€‚æ¯ä¸ªæœåŠ¡å™¨åœ¨å¼€å§‹æ–°ä¸€è½®æŠ•ç¥¨æ—¶ï¼Œä¼šå…ˆå¯¹è‡ªå·±ç»´æŠ¤çš„ logicClock è¿›è¡Œè‡ªå¢æ“ä½œã€‚\u003c/p\u003e\n\u003cp\u003eï¼ˆ2ï¼‰\u003cstrong\u003eåˆå§‹åŒ–é€‰ç¥¨\u003c/strong\u003e - æ¯ä¸ªæœåŠ¡å™¨åœ¨å¹¿æ’­è‡ªå·±çš„é€‰ç¥¨å‰ï¼Œä¼šå°†è‡ªå·±çš„æŠ•ç¥¨ç®±æ¸…ç©ºã€‚è¯¥æŠ•ç¥¨ç®±è®°å½•äº†æ‰€æ”¶åˆ°çš„é€‰ç¥¨ã€‚ä¾‹ï¼šæœåŠ¡å™¨ 2 æŠ•ç¥¨ç»™æœåŠ¡å™¨ 3ï¼ŒæœåŠ¡å™¨ 3 æŠ•ç¥¨ç»™æœåŠ¡å™¨ 1ï¼Œåˆ™æœåŠ¡å™¨ 1 çš„æŠ•ç¥¨ç®±ä¸º(2, 3), (3, 1), (1, 1)ã€‚ç¥¨ç®±ä¸­åªä¼šè®°å½•æ¯ä¸€æŠ•ç¥¨è€…çš„æœ€åä¸€ç¥¨ï¼Œå¦‚æŠ•ç¥¨è€…æ›´æ–°è‡ªå·±çš„é€‰ç¥¨ï¼Œåˆ™å…¶å®ƒæœåŠ¡å™¨æ”¶åˆ°è¯¥æ–°é€‰ç¥¨åä¼šåœ¨è‡ªå·±ç¥¨ç®±ä¸­æ›´æ–°è¯¥æœåŠ¡å™¨çš„é€‰ç¥¨ã€‚\u003c/p\u003e\n\u003cp\u003eï¼ˆ3ï¼‰\u003cstrong\u003eå‘é€åˆå§‹åŒ–é€‰ç¥¨\u003c/strong\u003e - æ¯ä¸ªæœåŠ¡å™¨æœ€å¼€å§‹éƒ½æ˜¯é€šè¿‡å¹¿æ’­æŠŠç¥¨æŠ•ç»™è‡ªå·±ã€‚\u003c/p\u003e\n\u003cp\u003eï¼ˆ4ï¼‰\u003cstrong\u003eæ¥æ”¶å¤–éƒ¨æŠ•ç¥¨\u003c/strong\u003e - æœåŠ¡å™¨ä¼šå°è¯•ä»å…¶å®ƒæœåŠ¡å™¨è·å–æŠ•ç¥¨ï¼Œå¹¶è®°å…¥è‡ªå·±çš„æŠ•ç¥¨ç®±å†…ã€‚å¦‚æœæ— æ³•è·å–ä»»ä½•å¤–éƒ¨æŠ•ç¥¨ï¼Œåˆ™ä¼šç¡®è®¤è‡ªå·±æ˜¯å¦ä¸é›†ç¾¤ä¸­å…¶å®ƒæœåŠ¡å™¨ä¿æŒç€æœ‰æ•ˆè¿æ¥ã€‚å¦‚æœæ˜¯ï¼Œåˆ™å†æ¬¡å‘é€è‡ªå·±çš„æŠ•ç¥¨ï¼›å¦‚æœå¦ï¼Œåˆ™é©¬ä¸Šä¸ä¹‹å»ºç«‹è¿æ¥ã€‚\u003c/p\u003e\n\u003cp\u003eï¼ˆ5ï¼‰\u003cstrong\u003eåˆ¤æ–­é€‰ä¸¾è½®æ¬¡\u003c/strong\u003e - æ”¶åˆ°å¤–éƒ¨æŠ•ç¥¨åï¼Œé¦–å…ˆä¼šæ ¹æ®æŠ•ç¥¨ä¿¡æ¯ä¸­æ‰€åŒ…å«çš„ logicClock æ¥è¿›è¡Œä¸åŒå¤„ç†\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå¤–éƒ¨æŠ•ç¥¨çš„ logicClock å¤§äºè‡ªå·±çš„ logicClockã€‚è¯´æ˜è¯¥æœåŠ¡å™¨çš„é€‰ä¸¾è½®æ¬¡è½åäºå…¶å®ƒæœåŠ¡å™¨çš„é€‰ä¸¾è½®æ¬¡ï¼Œç«‹å³æ¸…ç©ºè‡ªå·±çš„æŠ•ç¥¨ç®±å¹¶å°†è‡ªå·±çš„ logicClock æ›´æ–°ä¸ºæ”¶åˆ°çš„ logicClockï¼Œç„¶åå†å¯¹æ¯”è‡ªå·±ä¹‹å‰çš„æŠ•ç¥¨ä¸æ”¶åˆ°çš„æŠ•ç¥¨ä»¥ç¡®å®šæ˜¯å¦éœ€è¦å˜æ›´è‡ªå·±çš„æŠ•ç¥¨ï¼Œæœ€ç»ˆå†æ¬¡å°†è‡ªå·±çš„æŠ•ç¥¨å¹¿æ’­å‡ºå»ã€‚\u003c/li\u003e\n\u003cli\u003eå¤–éƒ¨æŠ•ç¥¨çš„ logicClock å°äºè‡ªå·±çš„ logicClockã€‚å½“å‰æœåŠ¡å™¨ç›´æ¥å¿½ç•¥è¯¥æŠ•ç¥¨ï¼Œç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ªæŠ•ç¥¨ã€‚\u003c/li\u003e\n\u003cli\u003eå¤–éƒ¨æŠ•ç¥¨çš„ logickClock ä¸è‡ªå·±çš„ç›¸ç­‰ã€‚å½“æ—¶è¿›è¡Œé€‰ç¥¨ PKã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eï¼ˆ6ï¼‰\u003cstrong\u003eé€‰ç¥¨ PK\u003c/strong\u003e - é€‰ç¥¨ PK æ˜¯åŸºäº\u003ccode\u003e(self_id, self_zxid)\u003c/code\u003e ä¸ \u003ccode\u003e(vote_id, vote_zxid)\u003c/code\u003e çš„å¯¹æ¯”\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eå¤–éƒ¨æŠ•ç¥¨çš„ logicClock å¤§äºè‡ªå·±çš„ logicClockï¼Œåˆ™å°†è‡ªå·±çš„ logicClock åŠè‡ªå·±çš„é€‰ç¥¨çš„ logicClock å˜æ›´ä¸ºæ”¶åˆ°çš„ logicClock\u003c/li\u003e\n\u003cli\u003eè‹¥ logicClock ä¸€è‡´ï¼Œåˆ™å¯¹æ¯”äºŒè€…çš„ vote_zxidï¼Œè‹¥å¤–éƒ¨æŠ•ç¥¨çš„ vote_zxid æ¯”è¾ƒå¤§ï¼Œåˆ™å°†è‡ªå·±çš„ç¥¨ä¸­çš„ vote_zxid ä¸ vote_myid æ›´æ–°ä¸ºæ”¶åˆ°çš„ç¥¨ä¸­çš„ vote_zxid ä¸ vote_myid å¹¶å¹¿æ’­å‡ºå»ï¼Œå¦å¤–å°†æ”¶åˆ°çš„ç¥¨åŠè‡ªå·±æ›´æ–°åçš„ç¥¨æ”¾å…¥è‡ªå·±çš„ç¥¨ç®±ã€‚å¦‚æœç¥¨ç®±å†…å·²å­˜åœ¨(self_myid, self_zxid)ç›¸åŒçš„é€‰ç¥¨ï¼Œåˆ™ç›´æ¥è¦†ç›–\u003c/li\u003e\n\u003cli\u003eè‹¥äºŒè€… vote_zxid ä¸€è‡´ï¼Œåˆ™æ¯”è¾ƒäºŒè€…çš„ vote_myidï¼Œè‹¥å¤–éƒ¨æŠ•ç¥¨çš„ vote_myid æ¯”è¾ƒå¤§ï¼Œåˆ™å°†è‡ªå·±çš„ç¥¨ä¸­çš„ vote_myid æ›´æ–°ä¸ºæ”¶åˆ°çš„ç¥¨ä¸­çš„ vote_myid å¹¶å¹¿æ’­å‡ºå»ï¼Œå¦å¤–å°†æ”¶åˆ°çš„ç¥¨åŠè‡ªå·±æ›´æ–°åçš„ç¥¨æ”¾å…¥è‡ªå·±çš„ç¥¨ç®±\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eï¼ˆ7ï¼‰\u003cstrong\u003eç»Ÿè®¡é€‰ç¥¨\u003c/strong\u003e - å¦‚æœå·²ç»ç¡®å®šæœ‰è¿‡åŠæœåŠ¡å™¨è®¤å¯äº†è‡ªå·±çš„æŠ•ç¥¨ï¼ˆå¯èƒ½æ˜¯æ›´æ–°åçš„æŠ•ç¥¨ï¼‰ï¼Œåˆ™ç»ˆæ­¢æŠ•ç¥¨ã€‚å¦åˆ™ç»§ç»­æ¥æ”¶å…¶å®ƒæœåŠ¡å™¨çš„æŠ•ç¥¨ã€‚\u003c/p\u003e\n\u003cp\u003eï¼ˆ8ï¼‰\u003cstrong\u003eæ›´æ–°æœåŠ¡å™¨çŠ¶æ€\u003c/strong\u003e - æŠ•ç¥¨ç»ˆæ­¢åï¼ŒæœåŠ¡å™¨å¼€å§‹æ›´æ–°è‡ªèº«çŠ¶æ€ã€‚è‹¥è¿‡åŠçš„ç¥¨æŠ•ç»™äº†è‡ªå·±ï¼Œåˆ™å°†è‡ªå·±çš„æœåŠ¡å™¨çŠ¶æ€æ›´æ–°ä¸º LEADINGï¼Œå¦åˆ™å°†è‡ªå·±çš„çŠ¶æ€æ›´æ–°ä¸º FOLLOWING\u003c/p\u003e\n\u003cp\u003eé€šè¿‡ä»¥ä¸Šæµç¨‹åˆ†æï¼Œæˆ‘ä»¬ä¸éš¾çœ‹å‡ºï¼šè¦ä½¿ Leader è·å¾—å¤šæ•° Server çš„æ”¯æŒï¼Œåˆ™ \u003cstrong\u003eZooKeeper é›†ç¾¤èŠ‚ç‚¹æ•°å¿…é¡»æ˜¯å¥‡æ•°ã€‚ä¸”å­˜æ´»çš„èŠ‚ç‚¹æ•°ç›®ä¸å¾—å°‘äº \u003ccode\u003eN + 1\u003c/code\u003e\u003c/strong\u003e ã€‚\u003c/p\u003e\n\u003cp\u003eæ¯ä¸ª Server å¯åŠ¨åéƒ½ä¼šé‡å¤ä»¥ä¸Šæµç¨‹ã€‚åœ¨æ¢å¤æ¨¡å¼ä¸‹ï¼Œå¦‚æœæ˜¯åˆšä»å´©æºƒçŠ¶æ€æ¢å¤çš„æˆ–è€…åˆšå¯åŠ¨çš„ server è¿˜ä¼šä»ç£ç›˜å¿«ç…§ä¸­æ¢å¤æ•°æ®å’Œä¼šè¯ä¿¡æ¯ï¼Œzk ä¼šè®°å½•äº‹åŠ¡æ—¥å¿—å¹¶å®šæœŸè¿›è¡Œå¿«ç…§ï¼Œæ–¹ä¾¿åœ¨æ¢å¤æ—¶è¿›è¡ŒçŠ¶æ€æ¢å¤ã€‚\u003c/p\u003e\n\u003ch3 id=\"åŸå­å¹¿æ’­ï¼ˆAtomic-Broadcastï¼‰\"\u003e\u003ca href=\"#åŸå­å¹¿æ’­ï¼ˆAtomic-Broadcastï¼‰\" class=\"headerlink\" title=\"åŸå­å¹¿æ’­ï¼ˆAtomic Broadcastï¼‰\"\u003e\u003c/a\u003eåŸå­å¹¿æ’­ï¼ˆAtomic Broadcastï¼‰\u003c/h3\u003e\u003cp\u003e\u003cstrong\u003eZooKeeper é€šè¿‡å‰¯æœ¬æœºåˆ¶æ¥å®ç°é«˜å¯ç”¨\u003c/strong\u003eã€‚\u003c/p\u003e\n\u003cp\u003eé‚£ä¹ˆï¼ŒZooKeeper æ˜¯å¦‚ä½•å®ç°å‰¯æœ¬æœºåˆ¶çš„å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼šZAB åè®®çš„åŸå­å¹¿æ’­ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/cs/java/javaweb/distributed/rpc/zookeeper/zookeeper_3.png\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003cp\u003eZAB åè®®çš„åŸå­å¹¿æ’­è¦æ±‚ï¼š\u003c/p\u003e\n\u003cp\u003e**\u003cem\u003eæ‰€æœ‰çš„å†™è¯·æ±‚éƒ½ä¼šè¢«è½¬å‘ç»™ Leaderï¼ŒLeader ä¼šä»¥åŸå­å¹¿æ’­çš„æ–¹å¼é€šçŸ¥ Followã€‚å½“åŠæ•°ä»¥ä¸Šçš„ Follow å·²ç»æ›´æ–°çŠ¶æ€æŒä¹…åŒ–åï¼ŒLeader æ‰ä¼šæäº¤è¿™ä¸ªæ›´æ–°ï¼Œç„¶åå®¢æˆ·ç«¯æ‰ä¼šæ”¶åˆ°ä¸€ä¸ªæ›´æ–°æˆåŠŸçš„å“åº”\u003c/em\u003e**ã€‚è¿™æœ‰äº›ç±»ä¼¼æ•°æ®åº“ä¸­çš„ä¸¤é˜¶æ®µæäº¤åè®®ã€‚\u003c/p\u003e\n\u003cp\u003eåœ¨æ•´ä¸ªæ¶ˆæ¯çš„å¹¿æ’­è¿‡ç¨‹ä¸­ï¼ŒLeader æœåŠ¡å™¨ä¼šæ¯ä¸ªäº‹åŠ¡è¯·æ±‚ç”Ÿæˆå¯¹åº”çš„ Proposalï¼Œå¹¶ä¸ºå…¶åˆ†é…ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„é€’å¢çš„äº‹åŠ¡ ID(ZXID)ï¼Œä¹‹åå†å¯¹å…¶è¿›è¡Œå¹¿æ’­ã€‚\u003c/p\u003e\n\u003ch2 id=\"InfluxDB-ä¼ä¸šç‰ˆä¸€è‡´æ€§å®ç°å‰–æ\"\u003e\u003ca href=\"#InfluxDB-ä¼ä¸šç‰ˆä¸€è‡´æ€§å®ç°å‰–æ\" class=\"headerlink\" title=\"InfluxDB ä¼ä¸šç‰ˆä¸€è‡´æ€§å®ç°å‰–æ\"\u003e\u003c/a\u003eInfluxDB ä¼ä¸šç‰ˆä¸€è‡´æ€§å®ç°å‰–æ\u003c/h2\u003e\u003cp\u003eç•¥\u003c/p\u003e\n\u003ch2 id=\"Hashicorp-Raft\"\u003e\u003ca href=\"#Hashicorp-Raft\" class=\"headerlink\" title=\"Hashicorp Raft\"\u003e\u003c/a\u003eHashicorp Raft\u003c/h2\u003e\u003cp\u003eç•¥\u003c/p\u003e\n\u003ch2 id=\"åŸºäº-Raft-çš„åˆ†å¸ƒå¼-KV-ç³»ç»Ÿå¼€å‘å®æˆ˜\"\u003e\u003ca href=\"#åŸºäº-Raft-çš„åˆ†å¸ƒå¼-KV-ç³»ç»Ÿå¼€å‘å®æˆ˜\" class=\"headerlink\" title=\"åŸºäº Raft çš„åˆ†å¸ƒå¼ KV ç³»ç»Ÿå¼€å‘å®æˆ˜\"\u003e\u003c/a\u003eåŸºäº Raft çš„åˆ†å¸ƒå¼ KV ç³»ç»Ÿå¼€å‘å®æˆ˜\u003c/h2\u003e\u003cp\u003eç•¥\u003c/p\u003e\n\u003ch2 id=\"å‚è€ƒèµ„æ–™\"\u003e\u003ca href=\"#å‚è€ƒèµ„æ–™\" class=\"headerlink\" title=\"å‚è€ƒèµ„æ–™\"\u003e\u003c/a\u003eå‚è€ƒèµ„æ–™\u003c/h2\u003e\u003cul\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://time.geekbang.org/column/intro/100046101\"\u003eåˆ†å¸ƒå¼åè®®ä¸ç®—æ³•å®æˆ˜\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n    \u003c/div\u003e",
  "Date": "2022-06-27T03:49:01Z",
  "Author": "é’æ‚Ÿ â—¾ Dunwu"
}