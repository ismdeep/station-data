{
  "Source": "dunwu",
  "Title": "Elastic 技术栈之 Kibana",
  "Link": "https://dunwu.github.io/blog/pages/002159/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\u003ch1 id=\"Elastic-技术栈之-Kibana\"\u003e\u003ca href=\"#Elastic-技术栈之-Kibana\" class=\"headerlink\" title=\"Elastic 技术栈之 Kibana\"\u003e\u003c/a\u003eElastic 技术栈之 Kibana\u003c/h1\u003e\u003ch2 id=\"Discover\"\u003e\u003ca href=\"#Discover\" class=\"headerlink\" title=\"Discover\"\u003e\u003c/a\u003eDiscover\u003c/h2\u003e\u003cp\u003e单击侧面导航栏中的 \u003ccode\u003eDiscover\u003c/code\u003e ，可以显示 \u003ccode\u003eKibana\u003c/code\u003e 的数据查询功能功能。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://www.elastic.co/guide/en/kibana/current/images/tutorial-discover.png\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003cp\u003e在搜索栏中，您可以输入 Elasticsearch 查询条件来搜索您的数据。您可以在 \u003ccode\u003eDiscover\u003c/code\u003e 页面中浏览结果并在 \u003ccode\u003eVisualize\u003c/code\u003e 页面中创建已保存搜索条件的可视化。\u003c/p\u003e\n\u003cp\u003e当前索引模式显示在查询栏下方。索引模式确定提交查询时搜索哪些索引。要搜索一组不同的索引，请从下拉菜单中选择不同的模式。要添加索引模式（index pattern），请转至 \u003ccode\u003eManagement/Kibana/Index Patterns\u003c/code\u003e 并单击 \u003ccode\u003eAdd New\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e您可以使用字段名称和您感兴趣的值构建搜索。对于数字字段，可以使用比较运算符，如大于（\u0026gt;），小于（\u0026lt;）或等于（=）。您可以将元素与逻辑运算符 \u003ccode\u003eAND\u003c/code\u003e，\u003ccode\u003eOR\u003c/code\u003e 和 \u003ccode\u003eNOT\u003c/code\u003e 链接，全部使用大写。\u003c/p\u003e\n\u003cp\u003e默认情况下，每个匹配文档都显示所有字段。要选择要显示的文档字段，请将鼠标悬停在“可用字段”列表上，然后单击要包含的每个字段旁边的添加按钮。例如，如果只添加 account_number，则显示将更改为包含五个帐号的简单列表：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-discover-3.png\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003ch3 id=\"查询语义\"\u003e\u003ca href=\"#查询语义\" class=\"headerlink\" title=\"查询语义\"\u003e\u003c/a\u003e查询语义\u003c/h3\u003e\u003cp\u003ekibana 的搜索栏遵循 \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html#query-string-syntax\"\u003equery-string-syntax\u003c/a\u003e 文档中所说明的查询语义。\u003c/p\u003e\n\u003cp\u003e这里说明一些最基本的查询语义。\u003c/p\u003e\n\u003cp\u003e查询字符串会被解析为一系列的术语和运算符。一个术语可以是一个单词（如：quick、brown）或用双引号包围的短语（如”quick brown”）。\u003c/p\u003e\n\u003cp\u003e查询操作允许您自定义搜索 - 下面介绍了可用的选项。\u003c/p\u003e\n\u003ch4 id=\"字段名称\"\u003e\u003ca href=\"#字段名称\" class=\"headerlink\" title=\"字段名称\"\u003e\u003c/a\u003e字段名称\u003c/h4\u003e\u003cp\u003e正如查询字符串查询中所述，将在搜索条件中搜索 default_field，但可以在查询语法中指定其他字段：\u003c/p\u003e\n\u003cp\u003e例如：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e查询 \u003ccode\u003estatus\u003c/code\u003e 字段中包含 \u003ccode\u003eactive\u003c/code\u003e 关键字\u003c/li\u003e\n\u003c/ul\u003e\n\u003cfigure class=\"highlight avrasm\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"symbol\"\u003estatus:\u003c/span\u003eactive\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003etitle\u003c/code\u003e 字段包含 \u003ccode\u003equick\u003c/code\u003e 或 \u003ccode\u003ebrown\u003c/code\u003e 关键字。如果您省略 \u003ccode\u003eOR\u003c/code\u003e 运算符，则将使用默认运算符\u003c/li\u003e\n\u003c/ul\u003e\n\u003cfigure class=\"highlight avrasm\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"symbol\"\u003etitle:\u003c/span\u003e(quick \u003cspan class=\"keyword\"\u003eOR\u003c/span\u003e brown)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"symbol\"\u003etitle:\u003c/span\u003e(quick brown)\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cul\u003e\n\u003cli\u003eauthor 字段查找精确的短语 “john smith”，即精确查找。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cfigure class=\"highlight avrasm\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"symbol\"\u003eauthor:\u003c/span\u003e\u003cspan class=\"string\"\u003e\u0026#34;John Smith\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cul\u003e\n\u003cli\u003e任意字段 \u003ccode\u003ebook.title\u003c/code\u003e，\u003ccode\u003ebook.content\u003c/code\u003e 或 \u003ccode\u003ebook.date\u003c/code\u003e 都包含 \u003ccode\u003equick\u003c/code\u003e 或 \u003ccode\u003ebrown\u003c/code\u003e（注意我们需要如何使用 \u003ccode\u003e\\*\u003c/code\u003e 表示通配符）\u003c/li\u003e\n\u003c/ul\u003e\n\u003cfigure class=\"highlight asciidoc\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003ebook.\\*:(quick brown)\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cul\u003e\n\u003cli\u003etitle 字段包含任意非 null 值\u003c/li\u003e\n\u003c/ul\u003e\n\u003cfigure class=\"highlight asciidoc\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"emphasis\"\u003e_exists_\u003c/span\u003e:title\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch4 id=\"通配符\"\u003e\u003ca href=\"#通配符\" class=\"headerlink\" title=\"通配符\"\u003e\u003c/a\u003e通配符\u003c/h4\u003e\u003cp\u003eELK 提供了 ? 和 * 两个通配符。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e?\u003c/code\u003e 表示任意单个字符；\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e*\u003c/code\u003e 表示任意零个或多个字符。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cfigure class=\"highlight stata\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003equ\u003c/span\u003e?ck \u003cspan class=\"keyword\"\u003ebro\u003c/span\u003e*\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003e注意：通配符查询会使用大量的内存并且执行性能较为糟糕，所以请慎用。\u003c/strong\u003e \u0026gt; \u003cstrong\u003e提示\u003c/strong\u003e：纯通配符 \u003ccode\u003e*\u003c/code\u003e 被写入 \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-exists-query.html\"\u003eexsits\u003c/a\u003e 查询，从而提高了查询效率。因此，通配符 \u003ccode\u003efield：*\u003c/code\u003e 将匹配包含空值的文档，如：\u003ccode\u003e{“field”：“”}\u003c/code\u003e，但是如果字段丢失或显示将值置为 null 则不匹配，如：\u003ccode\u003e“field”：null}\u003c/code\u003e \u0026gt; \u003cstrong\u003e提示\u003c/strong\u003e：在一个单词的开头（例如：\u003ccode\u003e*ing\u003c/code\u003e）使用通配符这种方式的查询量特别大，因为索引中的所有术语都需要检查，以防万一匹配。通过将 \u003ccode\u003eallow_leading_wildcard\u003c/code\u003e 设置为 \u003ccode\u003efalse\u003c/code\u003e，可以禁用。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"正则表达式\"\u003e\u003ca href=\"#正则表达式\" class=\"headerlink\" title=\"正则表达式\"\u003e\u003c/a\u003e正则表达式\u003c/h4\u003e\u003cp\u003e可以通过 \u003ccode\u003e/\u003c/code\u003e 将正则表达式包裹在查询字符串中进行查询\u003c/p\u003e\n\u003cp\u003e例：\u003c/p\u003e\n\u003cfigure class=\"highlight excel\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003ena\u003c/span\u003e\u003cspan class=\"symbol\"\u003eme:\u003c/span\u003e/joh?\u003cspan class=\"built_in\"\u003en\u003c/span\u003e(\u003cspan class=\"comment\"\u003eath[oa]n\u003c/span\u003e)/\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e支持的正则表达式语义可以参考：\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-regexp-query.html#regexp-syntax\"\u003eRegular expression syntax\u003c/a\u003e\u003c/p\u003e\n\u003ch4 id=\"模糊查询\"\u003e\u003ca href=\"#模糊查询\" class=\"headerlink\" title=\"模糊查询\"\u003e\u003c/a\u003e模糊查询\u003c/h4\u003e\u003cp\u003e我们可以使用 \u003ccode\u003e~\u003c/code\u003e 运算符来进行模糊查询。\u003c/p\u003e\n\u003cp\u003e例：\u003c/p\u003e\n\u003cp\u003e假设我们实际想查询\u003c/p\u003e\n\u003cfigure class=\"highlight ebnf\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attribute\"\u003equick brown forks\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e但是，由于拼写错误，我们的查询关键字变成如下情况，依然可以查到想要的结果。\u003c/p\u003e\n\u003cfigure class=\"highlight livescript\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003equikc\u003cspan class=\"string\"\u003e\\~\u003c/span\u003e brwn\u003cspan class=\"string\"\u003e\\~\u003c/span\u003e foks\u003cspan class=\"string\"\u003e\\~\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e这种模糊查询使用 Damerau-Levenshtein 距离来查找所有匹配最多两个更改的项。所谓的更改是指单个字符的插入，删除或替换，或者两个相邻字符的换位。\u003c/p\u003e\n\u003cp\u003e默认编辑距离为 \u003ccode\u003e2\u003c/code\u003e，但编辑距离为 \u003ccode\u003e1\u003c/code\u003e 应足以捕捉所有人类拼写错误的 80％。它可以被指定为：\u003c/p\u003e\n\u003cfigure class=\"highlight apache\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attribute\"\u003equikc\u003c/span\u003e\\~\u003cspan class=\"number\"\u003e1\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch4 id=\"近似检索\"\u003e\u003ca href=\"#近似检索\" class=\"headerlink\" title=\"近似检索\"\u003e\u003c/a\u003e近似检索\u003c/h4\u003e\u003cp\u003e尽管短语查询（例如，\u003ccode\u003ejohn smith\u003c/code\u003e）期望所有的词条都是完全相同的顺序，但是近似查询允许指定的单词进一步分开或以不同的顺序排列。与模糊查询可以为单词中的字符指定最大编辑距离一样，近似搜索也允许我们指定短语中单词的最大编辑距离：\u003c/p\u003e\n\u003cp\u003e例\u003c/p\u003e\n\u003cfigure class=\"highlight livescript\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"string\"\u003e\u0026#34;fox quick\u0026#34;\u003c/span\u003e\u003cspan class=\"string\"\u003e\\~5\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e字段中的文本越接近查询字符串中指定的原始顺序，该文档就越被认为是相关的。当与上面的示例查询相比时，短语 \u003ccode\u003e\u0026#34;quick fox\u0026#34;\u003c/code\u003e 将被认为比 \u003ccode\u003e\u0026#34;quick brown fox\u0026#34;\u003c/code\u003e 更近似查询条件。\u003c/p\u003e\n\u003ch4 id=\"范围\"\u003e\u003ca href=\"#范围\" class=\"headerlink\" title=\"范围\"\u003e\u003c/a\u003e范围\u003c/h4\u003e\u003cp\u003e可以为日期，数字或字符串字段指定范围。闭区间范围用方括号 \u003ccode\u003e[min TO max]\u003c/code\u003e 和开区间范围用花括号 \u003ccode\u003e{min TO max}\u003c/code\u003e 来指定。\u003c/p\u003e\n\u003cp\u003e我们不妨来看一些示例。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e2012 年的所有日子\u003c/li\u003e\n\u003c/ul\u003e\n\u003cfigure class=\"highlight apache\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attribute\"\u003edate\u003c/span\u003e:[\u003cspan class=\"number\"\u003e2012\u003c/span\u003e-\u003cspan class=\"number\"\u003e01\u003c/span\u003e-\u003cspan class=\"number\"\u003e01\u003c/span\u003e TO \u003cspan class=\"number\"\u003e2012\u003c/span\u003e-\u003cspan class=\"number\"\u003e12\u003c/span\u003e-\u003cspan class=\"number\"\u003e31\u003c/span\u003e]\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cul\u003e\n\u003cli\u003e数字 1 到 5\u003c/li\u003e\n\u003c/ul\u003e\n\u003cfigure class=\"highlight apache\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attribute\"\u003ecount\u003c/span\u003e:[\u003cspan class=\"number\"\u003e1\u003c/span\u003e TO \u003cspan class=\"number\"\u003e5\u003c/span\u003e]\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cul\u003e\n\u003cli\u003e在 \u003ccode\u003ealpha\u003c/code\u003e 和 \u003ccode\u003eomega\u003c/code\u003e 之间的标签，不包括 \u003ccode\u003ealpha\u003c/code\u003e 和 \u003ccode\u003eomega\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cfigure class=\"highlight subunit\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003etags:\u003c/span\u003e{alpha TO omega}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cul\u003e\n\u003cli\u003e10 以上的数字\u003c/li\u003e\n\u003c/ul\u003e\n\u003cfigure class=\"highlight sqf\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003ecount\u003c/span\u003e:[\u003cspan class=\"number\"\u003e10\u003c/span\u003e \u003cspan class=\"keyword\"\u003eTO\u003c/span\u003e *]\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cul\u003e\n\u003cli\u003e2012 年以前的所有日期\u003c/li\u003e\n\u003c/ul\u003e\n\u003cfigure class=\"highlight apache\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attribute\"\u003edate\u003c/span\u003e:{* TO \u003cspan class=\"number\"\u003e2012\u003c/span\u003e-\u003cspan class=\"number\"\u003e01\u003c/span\u003e-\u003cspan class=\"number\"\u003e01\u003c/span\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e此外，开区间和闭区间也可以组合使用\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e数组 1 到 5，但不包括 5\u003c/li\u003e\n\u003c/ul\u003e\n\u003cfigure class=\"highlight apache\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attribute\"\u003ecount\u003c/span\u003e:[\u003cspan class=\"number\"\u003e1\u003c/span\u003e TO \u003cspan class=\"number\"\u003e5\u003c/span\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e一边无界的范围也可以使用以下语法：\u003c/p\u003e\n\u003cfigure class=\"highlight apache\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attribute\"\u003eage\u003c/span\u003e:\u0026gt;\u003cspan class=\"number\"\u003e10\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attribute\"\u003eage\u003c/span\u003e:\u0026gt;=\u003cspan class=\"number\"\u003e10\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attribute\"\u003eage\u003c/span\u003e:\u0026lt;\u003cspan class=\"number\"\u003e10\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attribute\"\u003eage\u003c/span\u003e:\u0026lt;=\u003cspan class=\"number\"\u003e10\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e当然，你也可以使用 AND 运算符来得到连个查询结果的交集\u003c/p\u003e\n\u003cfigure class=\"highlight apache\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attribute\"\u003eage\u003c/span\u003e:(\u0026gt;=\u003cspan class=\"number\"\u003e10\u003c/span\u003e AND \u0026lt;\u003cspan class=\"number\"\u003e20\u003c/span\u003e)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attribute\"\u003eage\u003c/span\u003e:(+\u0026gt;=\u003cspan class=\"number\"\u003e10\u003c/span\u003e +\u0026lt;\u003cspan class=\"number\"\u003e20\u003c/span\u003e)\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch4 id=\"Boosting\"\u003e\u003ca href=\"#Boosting\" class=\"headerlink\" title=\"Boosting\"\u003e\u003c/a\u003eBoosting\u003c/h4\u003e\u003cp\u003e使用操作符 \u003ccode\u003e^\u003c/code\u003e 使一个术语比另一个术语更相关。例如，如果我们想查找所有有关狐狸的文档，但我们对狐狸特别感兴趣：\u003c/p\u003e\n\u003cfigure class=\"highlight apache\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attribute\"\u003equick\u003c/span\u003e^\u003cspan class=\"number\"\u003e2\u003c/span\u003e fox\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e默认提升值是 1，但可以是任何正浮点数。 0 到 1 之间的提升减少了相关性。\u003c/p\u003e\n\u003cp\u003e增强也可以应用于短语或组：\u003c/p\u003e\n\u003cfigure class=\"highlight gcode\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"string\"\u003e\u0026#34;john smith\u0026#34;\u003c/span\u003e^\u003cspan class=\"number\"\u003e2\u003c/span\u003e   \u003cspan class=\"comment\"\u003e(foo bar)\u003c/span\u003e^\u003cspan class=\"number\"\u003e4\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch4 id=\"布尔操作\"\u003e\u003ca href=\"#布尔操作\" class=\"headerlink\" title=\"布尔操作\"\u003e\u003c/a\u003e布尔操作\u003c/h4\u003e\u003cp\u003e默认情况下，只要一个词匹配，所有词都是可选的。搜索 \u003ccode\u003efoo bar baz\u003c/code\u003e 将查找包含 \u003ccode\u003efoo\u003c/code\u003e 或 \u003ccode\u003ebar\u003c/code\u003e 或 \u003ccode\u003ebaz\u003c/code\u003e 中的一个或多个的任何文档。我们已经讨论了上面的\u003ccode\u003edefault_operator\u003c/code\u003e，它允许你强制要求所有的项，但也有布尔运算符可以在查询字符串本身中使用，以提供更多的控制。\u003c/p\u003e\n\u003cp\u003e首选的操作符是 \u003ccode\u003e+\u003c/code\u003e（此术语必须存在）和 \u003ccode\u003e-\u003c/code\u003e （此术语不得存在）。所有其他条款是可选的。例如，这个查询：\u003c/p\u003e\n\u003cfigure class=\"highlight haxe\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003equick brown +fox -\u003cspan class=\"keyword\"\u003enew\u003c/span\u003e\u003cspan class=\"type\"\u003es\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e这条查询意味着：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003efox 必须存在\u003c/li\u003e\n\u003cli\u003enews 必须不存在\u003c/li\u003e\n\u003cli\u003equick 和 brown 是可有可无的\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e熟悉的运算符 \u003ccode\u003eAND\u003c/code\u003e，\u003ccode\u003eOR\u003c/code\u003e 和 \u003ccode\u003eNOT\u003c/code\u003e（也写成 \u003ccode\u003e\u0026amp;\u0026amp;\u003c/code\u003e，\u003ccode\u003e||\u003c/code\u003e 和 \u003ccode\u003e!\u003c/code\u003e）也被支持。然而，这些操作符有一定的优先级：\u003ccode\u003eNOT\u003c/code\u003e 优先于 \u003ccode\u003eAND\u003c/code\u003e，\u003ccode\u003eAND\u003c/code\u003e 优先于 \u003ccode\u003eOR\u003c/code\u003e。虽然 \u003ccode\u003e+\u003c/code\u003e 和 \u003ccode\u003e-\u003c/code\u003e 仅影响运算符右侧的术语，但 \u003ccode\u003eAND\u003c/code\u003e 和 \u003ccode\u003eOR\u003c/code\u003e 会影响左侧和右侧的术语。\u003c/p\u003e\n\u003ch4 id=\"分组\"\u003e\u003ca href=\"#分组\" class=\"headerlink\" title=\"分组\"\u003e\u003c/a\u003e分组\u003c/h4\u003e\u003cp\u003e多个术语或子句可以用圆括号组合在一起，形成子查询\u003c/p\u003e\n\u003cfigure class=\"highlight mipsasm\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e(quick \u003cspan class=\"keyword\"\u003eOR \u003c/span\u003e\u003cspan class=\"keyword\"\u003ebrown) \u003c/span\u003e\u003cspan class=\"keyword\"\u003eAND \u003c/span\u003efox\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e可以使用组来定位特定的字段，或者增强子查询的结果：\u003c/p\u003e\n\u003cfigure class=\"highlight excel\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003estat\u003cspan class=\"symbol\"\u003eus:\u003c/span\u003e(active \u003cspan class=\"built_in\"\u003eOR\u003c/span\u003e pending) tit\u003cspan class=\"symbol\"\u003ele:\u003c/span\u003e(full \u003cspan class=\"built_in\"\u003etext\u003c/span\u003e \u003cspan class=\"built_in\"\u003esearch\u003c/span\u003e)^\u003cspan class=\"number\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch4 id=\"保留字\"\u003e\u003ca href=\"#保留字\" class=\"headerlink\" title=\"保留字\"\u003e\u003c/a\u003e保留字\u003c/h4\u003e\u003cp\u003e如果你需要使用任何在你的查询本身中作为操作符的字符（而不是作为操作符），那么你应该用一个反斜杠来转义它们。例如，要搜索（1 + 1）= 2，您需要将查询写为 \u003ccode\u003e\\(1\\+1\\)\\=2\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e保留字符是：\u003ccode\u003e+ - = \u0026amp;\u0026amp; || \u0026gt; \u0026lt; ! ( ) { } [ ] ^ \u0026#34; ~ * ? : \\ /\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e无法正确地转义这些特殊字符可能会导致语法错误，从而阻止您的查询运行。\u003c/p\u003e\n\u003ch4 id=\"空查询\"\u003e\u003ca href=\"#空查询\" class=\"headerlink\" title=\"空查询\"\u003e\u003c/a\u003e空查询\u003c/h4\u003e\u003cp\u003e如果查询字符串为空或仅包含空格，则查询将生成一个空的结果集。\u003c/p\u003e\n\u003ch2 id=\"Visualize\"\u003e\u003ca href=\"#Visualize\" class=\"headerlink\" title=\"Visualize\"\u003e\u003c/a\u003eVisualize\u003c/h2\u003e\u003cp\u003e要想使用可视化的方式展示您的数据，请单击侧面导航栏中的 \u003ccode\u003eVisualize\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003eVisualize 工具使您能够以多种方式（如饼图、柱状图、曲线图、分布图等）查看数据。要开始使用，请点击蓝色的 \u003ccode\u003eCreate a visualization\u003c/code\u003e 或 \u003ccode\u003e+\u003c/code\u003e 按钮。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-landing.png\" alt=\"https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-landing.png\"/\u003e\u003c/p\u003e\n\u003cp\u003e有许多可视化类型可供选择。\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-wizard-step-1.png\" alt=\"https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-wizard-step-1.png\"/\u003e\u003c/p\u003e\n\u003cp\u003e下面，我们来看创建几个图标示例：\u003c/p\u003e\n\u003ch3 id=\"Pie\"\u003e\u003ca href=\"#Pie\" class=\"headerlink\" title=\"Pie\"\u003e\u003c/a\u003ePie\u003c/h3\u003e\u003cp\u003e您可以从保存的搜索中构建可视化文件，也可以输入新的搜索条件。要输入新的搜索条件，首先需要选择一个索引模式来指定要搜索的索引。\u003c/p\u003e\n\u003cp\u003e默认搜索匹配所有文档。最初，一个“切片”包含整个饼图：\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-pie-1.png\" alt=\"https://www.elastic.co/guide/en/kibana/6.1/images/tutorial-visualize-pie-1.png\"/\u003e\u003c/p\u003e\n\u003cp\u003e要指定在图表中展示哪些数据，请使用 Elasticsearch 存储桶聚合。分组汇总只是将与您的搜索条件相匹配的文档分类到不同的分类中，也称为分组。\u003c/p\u003e\n\u003cp\u003e为每个范围定义一个存储桶：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e单击 \u003ccode\u003eSplit Slices\u003c/code\u003e。\u003c/li\u003e\n\u003cli\u003e在 \u003ccode\u003eAggregation\u003c/code\u003e 列表中选择 \u003ccode\u003eTerms\u003c/code\u003e。_注意：这里的 Terms 是 Elk 采集数据时定义好的字段或标签_。\u003c/li\u003e\n\u003cli\u003e在 \u003ccode\u003eField\u003c/code\u003e 列表中选择 \u003ccode\u003elevel.keyword\u003c/code\u003e。\u003c/li\u003e\n\u003cli\u003e点击 \u003cimg src=\"https://www.elastic.co/guide/en/kibana/6.1/images/apply-changes-button.png\" alt=\"images/apply-changes-button.png\"/\u003e 按钮来更新图表。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/3101171-7fb2042dc6d59520.png\" alt=\"image.png\"/\u003e\u003c/p\u003e\n\u003cp\u003e完成后，如果想要保存这个图表，可以点击页面最上方一栏中的 \u003ccode\u003eSave\u003c/code\u003e 按钮。\u003c/p\u003e\n\u003ch3 id=\"Vertical-Bar\"\u003e\u003ca href=\"#Vertical-Bar\" class=\"headerlink\" title=\"Vertical Bar\"\u003e\u003c/a\u003eVertical Bar\u003c/h3\u003e\u003cp\u003e我们在展示一下如何创建柱状图。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e点击蓝色的 \u003ccode\u003eCreate a visualization\u003c/code\u003e 或 \u003ccode\u003e+\u003c/code\u003e 按钮。选择 \u003ccode\u003eVertical Bar\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e选择索引模式。由于您尚未定义任何 bucket ，因此您会看到一个大栏，显示与默认通配符查询匹配的文档总数。\u003c/li\u003e\n\u003cli\u003e指定 Y 轴所代表的字段\u003c/li\u003e\n\u003cli\u003e指定 X 轴所代表的字段\u003c/li\u003e\n\u003cli\u003e点击 \u003cimg src=\"https://www.elastic.co/guide/en/kibana/6.1/images/apply-changes-button.png\" alt=\"images/apply-changes-button.png\"/\u003e 按钮来更新图表。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cimg src=\"https://upload-images.jianshu.io/upload_images/3101171-5aa7627284c19a56.png\" alt=\"image.png\"/\u003e\u003c/p\u003e\n\u003cp\u003e完成后，如果想要保存这个图表，可以点击页面最上方一栏中的 \u003ccode\u003eSave\u003c/code\u003e 按钮。\u003c/p\u003e\n\u003ch2 id=\"Dashboard\"\u003e\u003ca href=\"#Dashboard\" class=\"headerlink\" title=\"Dashboard\"\u003e\u003c/a\u003eDashboard\u003c/h2\u003e\u003cp\u003e\u003ccode\u003eDashboard\u003c/code\u003e 可以整合和共享 \u003ccode\u003eVisualize\u003c/code\u003e 集合。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e点击侧面导航栏中的 Dashboard。\u003c/li\u003e\n\u003cli\u003e点击添加显示保存的可视化列表。\u003c/li\u003e\n\u003cli\u003e点击之前保存的 \u003ccode\u003eVisualize\u003c/code\u003e，然后点击列表底部的小向上箭头关闭可视化列表。\u003c/li\u003e\n\u003cli\u003e将鼠标悬停在可视化对象上会显示允许您编辑，移动，删除和调整可视化对象大小的容器控件。\u003c/li\u003e\n\u003c/ol\u003e\n\n    \u003c/div\u003e",
  "Date": "2020-06-15T23:10:44Z",
  "Author": "钝悟 ◾ Dunwu"
}