{
  "Source": "dunwu",
  "Title": "ActiveMQ 快速入门",
  "Link": "https://dunwu.github.io/blog/pages/5aee88/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\u003ch1 id=\"ActiveMQ-快速入门\"\u003e\u003ca href=\"#ActiveMQ-快速入门\" class=\"headerlink\" title=\"ActiveMQ 快速入门\"\u003e\u003c/a\u003eActiveMQ 快速入门\u003c/h1\u003e\u003ch2 id=\"JMS-基本概念\"\u003e\u003ca href=\"#JMS-基本概念\" class=\"headerlink\" title=\"JMS 基本概念\"\u003e\u003c/a\u003eJMS 基本概念\u003c/h2\u003e\u003cp\u003e\u003ccode\u003eJMS\u003c/code\u003e 即 \u003cstrong\u003eJava 消息服务（Java Message Service）API\u003c/strong\u003e，是一个 Java 平台中关于面向消息中间件的 API。它用于在两个应用程序之间，或分布式系统中发送消息，进行异步通信。Java 消息服务是一个与具体平台无关的 API，绝大多数 MOM 提供商都对 JMS 提供支持。\u003c/p\u003e\n\u003ch3 id=\"消息模型\"\u003e\u003ca href=\"#消息模型\" class=\"headerlink\" title=\"消息模型\"\u003e\u003c/a\u003e消息模型\u003c/h3\u003e\u003cp\u003eJMS 有两种消息模型：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ePoint-to-Point(P2P)\u003c/li\u003e\n\u003cli\u003ePublish/Subscribe(Pub/Sub)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"P2P-的特点\"\u003e\u003ca href=\"#P2P-的特点\" class=\"headerlink\" title=\"P2P 的特点\"\u003e\u003c/a\u003eP2P 的特点\u003c/h4\u003e\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/cs/java/javalib/jms/jms-pointToPoint.gif\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003cp\u003e在点对点的消息系统中，消息分发给一个单独的使用者。点对点消息往往与队列 \u003ccode\u003ejavax.jms.Queue\u003c/code\u003e 相关联。\u003c/p\u003e\n\u003cp\u003e每个消息只有一个消费者（Consumer）(即一旦被消费，消息就不再在消息队列中)。\u003c/p\u003e\n\u003cp\u003e发送者和接收者之间在时间上没有依赖性，也就是说当发送者发送了消息之后，不管接收者有没有正在运行，它不会影响到消息被发送到队列。\u003c/p\u003e\n\u003cp\u003e接收者在成功接收消息之后需向队列应答成功。\u003c/p\u003e\n\u003cp\u003e如果你希望发送的每个消息都应该被成功处理的话，那么你需要 P2P 模式。\u003c/p\u003e\n\u003ch4 id=\"Pub-Sub-的特点\"\u003e\u003ca href=\"#Pub-Sub-的特点\" class=\"headerlink\" title=\"Pub/Sub 的特点\"\u003e\u003c/a\u003ePub/Sub 的特点\u003c/h4\u003e\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/cs/java/javalib/jms/jms-publishSubscribe.gif\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003cp\u003e发布/订阅消息系统支持一个事件驱动模型，消息生产者和消费者都参与消息的传递。生产者发布事件，而使用者订阅感兴趣的事件，并使用事件。该类型消息一般与特定的主题 \u003ccode\u003ejavax.jms.Topic\u003c/code\u003e 关联。\u003c/p\u003e\n\u003cp\u003e每个消息可以有多个消费者。\u003c/p\u003e\n\u003cp\u003e发布者和订阅者之间有时间上的依赖性。针对某个主题（Topic）的订阅者，它必须创建一个订阅者之后，才能消费发布者的消息，而且为了消费消息，订阅者必须保持运行的状态。\u003c/p\u003e\n\u003cp\u003e为了缓和这样严格的时间相关性，JMS 允许订阅者创建一个可持久化的订阅。这样，即使订阅者没有被激活（运行），它也能接收到发布者的消息。\u003c/p\u003e\n\u003cp\u003e如果你希望发送的消息可以不被做任何处理、或者被一个消息者处理、或者可以被多个消费者处理的话，那么可以采用 Pub/Sub 模型。\u003c/p\u003e\n\u003ch3 id=\"JMS-编程模型\"\u003e\u003ca href=\"#JMS-编程模型\" class=\"headerlink\" title=\"JMS 编程模型\"\u003e\u003c/a\u003eJMS 编程模型\u003c/h3\u003e\u003cp\u003e\u003cimg src=\"https://raw.githubusercontent.com/dunwu/images/master/cs/java/javalib/jms/jms-publishSubscribe.gif\" alt=\"img\"/\u003e\u003c/p\u003e\n\u003ch4 id=\"ConnectionFactory\"\u003e\u003ca href=\"#ConnectionFactory\" class=\"headerlink\" title=\"ConnectionFactory\"\u003e\u003c/a\u003eConnectionFactory\u003c/h4\u003e\u003cp\u003e创建 \u003ccode\u003eConnection\u003c/code\u003e 对象的工厂，针对两种不同的 jms 消息模型，分别有 \u003ccode\u003eQueueConnectionFactory\u003c/code\u003e 和\u003ccode\u003eTopicConnectionFactory\u003c/code\u003e 两种。可以通过 JNDI 来查找 \u003ccode\u003eConnectionFactory\u003c/code\u003e 对象。\u003c/p\u003e\n\u003ch4 id=\"Connection\"\u003e\u003ca href=\"#Connection\" class=\"headerlink\" title=\"Connection\"\u003e\u003c/a\u003eConnection\u003c/h4\u003e\u003cp\u003e\u003ccode\u003eConnection\u003c/code\u003e 表示在客户端和 JMS 系统之间建立的链接（对 TCP/IP socket 的包装）。\u003ccode\u003eConnection\u003c/code\u003e 可以产生一个或多个\u003ccode\u003eSession\u003c/code\u003e。跟 \u003ccode\u003eConnectionFactory\u003c/code\u003e 一样，\u003ccode\u003eConnection\u003c/code\u003e 也有两种类型：\u003ccode\u003eQueueConnection\u003c/code\u003e 和 \u003ccode\u003eTopicConnection\u003c/code\u003e。\u003c/p\u003e\n\u003ch4 id=\"Destination\"\u003e\u003ca href=\"#Destination\" class=\"headerlink\" title=\"Destination\"\u003e\u003c/a\u003eDestination\u003c/h4\u003e\u003cp\u003e\u003ccode\u003eDestination\u003c/code\u003e 是一个包装了消息目标标识符的被管对象。消息目标是指消息发布和接收的地点，或者是队列 \u003ccode\u003eQueue\u003c/code\u003e ，或者是主题 \u003ccode\u003eTopic\u003c/code\u003e 。JMS 管理员创建这些对象，然后用户通过 JNDI 发现它们。和连接工厂一样，管理员可以创建两种类型的目标，点对点模型的 \u003ccode\u003eQueue\u003c/code\u003e，以及发布者/订阅者模型的 \u003ccode\u003eTopic\u003c/code\u003e。\u003c/p\u003e\n\u003ch4 id=\"Session\"\u003e\u003ca href=\"#Session\" class=\"headerlink\" title=\"Session\"\u003e\u003c/a\u003eSession\u003c/h4\u003e\u003cp\u003e\u003ccode\u003eSession\u003c/code\u003e 表示一个单线程的上下文，用于发送和接收消息。由于会话是单线程的，所以消息是连续的，就是说消息是按照发送的顺序一个一个接收的。会话的好处是它支持事务。如果用户选择了事务支持，会话上下文将保存一组消息，直到事务被提交才发送这些消息。在提交事务之前，用户可以使用回滚操作取消这些消息。一个会话允许用户创建消息，生产者来发送消息，消费者来接收消息。同样，\u003ccode\u003eSession\u003c/code\u003e 也分 \u003ccode\u003eQueueSession\u003c/code\u003e 和 \u003ccode\u003eTopicSession\u003c/code\u003e。\u003c/p\u003e\n\u003ch4 id=\"MessageConsumer\"\u003e\u003ca href=\"#MessageConsumer\" class=\"headerlink\" title=\"MessageConsumer\"\u003e\u003c/a\u003eMessageConsumer\u003c/h4\u003e\u003cp\u003e\u003ccode\u003eMessageConsumer\u003c/code\u003e 由 \u003ccode\u003eSession\u003c/code\u003e 创建，并用于将消息发送到 \u003ccode\u003eDestination\u003c/code\u003e。消费者可以同步地（阻塞模式），或（非阻塞）接收 \u003ccode\u003eQueue\u003c/code\u003e 和 \u003ccode\u003eTopic\u003c/code\u003e 类型的消息。同样，消息生产者分两种类型：\u003ccode\u003eQueueSender\u003c/code\u003e 和\u003ccode\u003eTopicPublisher\u003c/code\u003e。\u003c/p\u003e\n\u003ch4 id=\"MessageProducer\"\u003e\u003ca href=\"#MessageProducer\" class=\"headerlink\" title=\"MessageProducer\"\u003e\u003c/a\u003eMessageProducer\u003c/h4\u003e\u003cp\u003e\u003ccode\u003eMessageProducer\u003c/code\u003e 由 \u003ccode\u003eSession\u003c/code\u003e 创建，用于接收被发送到 \u003ccode\u003eDestination\u003c/code\u003e 的消息。\u003ccode\u003eMessageProducer\u003c/code\u003e 有两种类型：\u003ccode\u003eQueueReceiver\u003c/code\u003e 和 \u003ccode\u003eTopicSubscriber\u003c/code\u003e。可分别通过 \u003ccode\u003esession\u003c/code\u003e 的 \u003ccode\u003ecreateReceiver(Queue)\u003c/code\u003e 或 \u003ccode\u003ecreateSubscriber(Topic)\u003c/code\u003e 来创建。当然，也可以 \u003ccode\u003esession\u003c/code\u003e 的 \u003ccode\u003ecreatDurableSubscriber\u003c/code\u003e 方法来创建持久化的订阅者。\u003c/p\u003e\n\u003ch4 id=\"Message\"\u003e\u003ca href=\"#Message\" class=\"headerlink\" title=\"Message\"\u003e\u003c/a\u003eMessage\u003c/h4\u003e\u003cp\u003e是在消费者和生产者之间传送的对象，也就是说从一个应用程序传送到另一个应用程序。一个消息有三个主要部分：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e消息头（必须）：包含用于识别和为消息寻找路由的操作设置。\u003c/li\u003e\n\u003cli\u003e一组消息属性（可选）：包含额外的属性，支持其他提供者和用户的兼容。可以创建定制的字段和过滤器（消息选择器）。\u003c/li\u003e\n\u003cli\u003e一个消息体（可选）：允许用户创建五种类型的消息（文本消息，映射消息，字节消息，流消息和对象消息）。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e消息接口非常灵活，并提供了许多方式来定制消息的内容。\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eCommon\u003c/th\u003e\n\u003cth\u003ePoint-to-Point\u003c/th\u003e\n\u003cth\u003ePublish-Subscribe\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\u003ctr\u003e\n\u003ctd\u003eConnectionFactory\u003c/td\u003e\n\u003ctd\u003eQueueConnectionFactory\u003c/td\u003e\n\u003ctd\u003eTopicConnectionFactory\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eConnection\u003c/td\u003e\n\u003ctd\u003eQueueConnection\u003c/td\u003e\n\u003ctd\u003eTopicConnection\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eDestination\u003c/td\u003e\n\u003ctd\u003eQueue\u003c/td\u003e\n\u003ctd\u003eTopic\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eSession\u003c/td\u003e\n\u003ctd\u003eQueueSession\u003c/td\u003e\n\u003ctd\u003eTopicSession\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eMessageProducer\u003c/td\u003e\n\u003ctd\u003eQueueSender\u003c/td\u003e\n\u003ctd\u003eTopicPublisher\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eMessageSender\u003c/td\u003e\n\u003ctd\u003eQueueReceiver, QueueBrowser\u003c/td\u003e\n\u003ctd\u003eTopicSubscriber\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\u003c/table\u003e\n\u003ch2 id=\"安装\"\u003e\u003ca href=\"#安装\" class=\"headerlink\" title=\"安装\"\u003e\u003c/a\u003e安装\u003c/h2\u003e\u003cp\u003e\u003cstrong\u003e安装条件\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eJDK1.7 及以上版本\u003c/p\u003e\n\u003cp\u003e本地配置了 \u003cstrong\u003eJAVA_HOME\u003c/strong\u003e 环境变量。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e下载\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e支持 Windows/Unix/Linux/Cygwin\u003c/p\u003e\n\u003cp\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"http://activemq.apache.org/download.html\"\u003eActiveMQ 官方下载地址\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWindows 下运行\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e（1）解压压缩包到本地；\u003c/p\u003e\n\u003cp\u003e（2）打开控制台，进入安装目录的 \u003ccode\u003ebin\u003c/code\u003e 目录下；\u003c/p\u003e\n\u003cfigure class=\"highlight apache\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"attribute\"\u003ecd\u003c/span\u003e\u003cspan class=\"meta\"\u003e [activemq_install_dir]\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e（3）执行 \u003ccode\u003eactivemq start\u003c/code\u003e 来启动 ActiveMQ\u003c/p\u003e\n\u003cfigure class=\"highlight crmsh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003ebin\\activemq \u003cspan class=\"literal\"\u003estart\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e\u003cstrong\u003e测试安装是否成功\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e（1）ActiveMQ 默认监听端口为 61616\u003c/p\u003e\n\u003cfigure class=\"highlight routeros\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003enetstat -an|\u003cspan class=\"built_in\"\u003efind\u003c/span\u003e “61616”\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e（2）访问 \u003ca target=\"_blank\" rel=\"noopener\" href=\"http://127.0.0.1:8161/admin/\"\u003ehttp://127.0.0.1:8161/admin/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e（3）输入用户名、密码\u003c/p\u003e\n\u003cfigure class=\"highlight pgsql\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003eLogin\u003c/span\u003e: \u003cspan class=\"keyword\"\u003eadmin\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003ePasswort: \u003cspan class=\"keyword\"\u003eadmin\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e（4）点击导航栏的 Queues 菜单\u003c/p\u003e\n\u003cp\u003e（5）添加一个队列（queue）\u003c/p\u003e\n\u003ch2 id=\"项目中的应用\"\u003e\u003ca href=\"#项目中的应用\" class=\"headerlink\" title=\"项目中的应用\"\u003e\u003c/a\u003e项目中的应用\u003c/h2\u003e\u003cp\u003e\u003cstrong\u003e引入依赖\u003c/strong\u003e\u003c/p\u003e\n\u003cfigure class=\"highlight xml\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"tag\"\u003e\u0026lt;\u003cspan class=\"name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"tag\"\u003e\u0026lt;\u003cspan class=\"name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003eorg.apache.activemq\u003cspan class=\"tag\"\u003e\u0026lt;/\u003cspan class=\"name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"tag\"\u003e\u0026lt;\u003cspan class=\"name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003eactivemq-all\u003cspan class=\"tag\"\u003e\u0026lt;/\u003cspan class=\"name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"tag\"\u003e\u0026lt;\u003cspan class=\"name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e5.14.1\u003cspan class=\"tag\"\u003e\u0026lt;/\u003cspan class=\"name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"tag\"\u003e\u0026lt;/\u003cspan class=\"name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e\u003cstrong\u003eSender.java\u003c/strong\u003e\u003c/p\u003e\n\u003cfigure class=\"highlight java\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e26\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e27\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e28\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e29\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e30\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e31\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e32\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e33\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e34\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e35\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e36\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e37\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e38\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e39\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e40\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e41\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e42\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e43\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e44\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e45\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e46\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e47\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e48\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e49\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e50\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e51\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e52\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e53\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e54\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e55\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e56\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e57\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e58\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e59\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"title class_\"\u003eSender\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003eprivate\u003c/span\u003e \u003cspan class=\"keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"keyword\"\u003efinal\u003c/span\u003e \u003cspan class=\"type\"\u003eint\u003c/span\u003e \u003cspan class=\"variable\"\u003eSEND_NUMBER\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e \u003cspan class=\"number\"\u003e4\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003emain\u003c/span\u003e\u003cspan class=\"params\"\u003e(String[] args)\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// ConnectionFactory ：连接工厂，JMS 用它创建连接\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        ConnectionFactory connectionFactory;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// Connection ：JMS 客户端到JMS Provider 的连接\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"type\"\u003eConnection\u003c/span\u003e \u003cspan class=\"variable\"\u003econnection\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e \u003cspan class=\"literal\"\u003enull\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// Session： 一个发送或接收消息的线程\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        Session session;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// Destination ：消息的目的地;消息发送给谁.\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        Destination destination;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// MessageProducer：消息发送者\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        MessageProducer producer;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// TextMessage message;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// 构造ConnectionFactory实例对象，此处采用ActiveMq的实现jar\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        connectionFactory = \u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eActiveMQConnectionFactory\u003c/span\u003e(\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                ActiveMQConnection.DEFAULT_USER,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                ActiveMQConnection.DEFAULT_PASSWORD,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                \u003cspan class=\"string\"\u003e\u0026#34;tcp://localhost:61616\u0026#34;\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003etry\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"comment\"\u003e// 构造从工厂得到连接对象\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            connection = connectionFactory.createConnection();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"comment\"\u003e// 启动\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            connection.start();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"comment\"\u003e// 获取操作连接\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            session = connection.createSession(Boolean.TRUE,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                    Session.AUTO_ACKNOWLEDGE);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"comment\"\u003e// 获取session注意参数值xingbo.xu-queue是一个服务器的queue，须在在ActiveMq的console配置\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            destination = session.createQueue(\u003cspan class=\"string\"\u003e\u0026#34;FirstQueue\u0026#34;\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"comment\"\u003e// 得到消息生成者【发送者】\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            producer = session.createProducer(destination);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"comment\"\u003e// 设置不持久化，此处学习，实际根据项目决定\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            producer.setDeliveryMode(DeliveryMode.NON_PERSISTENT);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"comment\"\u003e// 构造消息，此处写死，项目就是参数，或者方法获取\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            sendMessage(session, producer);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            session.commit();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        } \u003cspan class=\"keyword\"\u003ecatch\u003c/span\u003e (Exception e) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            e.printStackTrace();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        } \u003cspan class=\"keyword\"\u003efinally\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"keyword\"\u003etry\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                \u003cspan class=\"keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"literal\"\u003enull\u003c/span\u003e != connection)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                    connection.close();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            } \u003cspan class=\"keyword\"\u003ecatch\u003c/span\u003e (Throwable ignore) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003esendMessage\u003c/span\u003e\u003cspan class=\"params\"\u003e(Session session, MessageProducer producer)\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"keyword\"\u003ethrows\u003c/span\u003e Exception {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e (\u003cspan class=\"type\"\u003eint\u003c/span\u003e \u003cspan class=\"variable\"\u003ei\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e \u003cspan class=\"number\"\u003e1\u003c/span\u003e; i \u0026lt;= SEND_NUMBER; i++) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"type\"\u003eTextMessage\u003c/span\u003e \u003cspan class=\"variable\"\u003emessage\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e session\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                    .createTextMessage(\u003cspan class=\"string\"\u003e\u0026#34;ActiveMq 发送的消息\u0026#34;\u003c/span\u003e + i);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"comment\"\u003e// 发送消息到目的地方\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            System.out.println(\u003cspan class=\"string\"\u003e\u0026#34;发送消息：\u0026#34;\u003c/span\u003e + \u003cspan class=\"string\"\u003e\u0026#34;ActiveMq 发送的消息\u0026#34;\u003c/span\u003e + i);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            producer.send(message);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e\u003cstrong\u003eReceiver.java\u003c/strong\u003e\u003c/p\u003e\n\u003cfigure class=\"highlight java\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e26\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e27\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e28\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e29\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e30\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e31\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e32\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e33\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e34\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e35\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e36\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e37\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e38\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e39\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e40\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e41\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e42\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e43\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e44\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e45\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e46\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e47\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"title class_\"\u003eReceiver\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003epublic\u003c/span\u003e \u003cspan class=\"keyword\"\u003estatic\u003c/span\u003e \u003cspan class=\"keyword\"\u003evoid\u003c/span\u003e \u003cspan class=\"title function_\"\u003emain\u003c/span\u003e\u003cspan class=\"params\"\u003e(String[] args)\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// ConnectionFactory ：连接工厂，JMS 用它创建连接\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        ConnectionFactory connectionFactory;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// Connection ：JMS 客户端到JMS Provider 的连接\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"type\"\u003eConnection\u003c/span\u003e \u003cspan class=\"variable\"\u003econnection\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e \u003cspan class=\"literal\"\u003enull\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// Session： 一个发送或接收消息的线程\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        Session session;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// Destination ：消息的目的地;消息发送给谁.\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        Destination destination;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"comment\"\u003e// 消费者，消息接收者\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        MessageConsumer consumer;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        connectionFactory = \u003cspan class=\"keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"title class_\"\u003eActiveMQConnectionFactory\u003c/span\u003e(\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                ActiveMQConnection.DEFAULT_USER,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                ActiveMQConnection.DEFAULT_PASSWORD,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                \u003cspan class=\"string\"\u003e\u0026#34;tcp://localhost:61616\u0026#34;\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003etry\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"comment\"\u003e// 构造从工厂得到连接对象\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            connection = connectionFactory.createConnection();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"comment\"\u003e// 启动\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            connection.start();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"comment\"\u003e// 获取操作连接\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            session = connection.createSession(Boolean.FALSE,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                    Session.AUTO_ACKNOWLEDGE);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"comment\"\u003e// 获取session注意参数值xingbo.xu-queue是一个服务器的queue，须在在ActiveMq的console配置\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            destination = session.createQueue(\u003cspan class=\"string\"\u003e\u0026#34;FirstQueue\u0026#34;\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            consumer = session.createConsumer(destination);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"keyword\"\u003ewhile\u003c/span\u003e (\u003cspan class=\"literal\"\u003etrue\u003c/span\u003e) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                \u003cspan class=\"comment\"\u003e//设置接收者接收消息的时间，为了便于测试，这里谁定为100s\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                \u003cspan class=\"type\"\u003eTextMessage\u003c/span\u003e \u003cspan class=\"variable\"\u003emessage\u003c/span\u003e \u003cspan class=\"operator\"\u003e=\u003c/span\u003e (TextMessage) consumer.receive(\u003cspan class=\"number\"\u003e100000\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                \u003cspan class=\"keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"literal\"\u003enull\u003c/span\u003e != message) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                    System.out.println(\u003cspan class=\"string\"\u003e\u0026#34;收到消息\u0026#34;\u003c/span\u003e + message.getText());\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                } \u003cspan class=\"keyword\"\u003eelse\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                    \u003cspan class=\"keyword\"\u003ebreak\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        } \u003cspan class=\"keyword\"\u003ecatch\u003c/span\u003e (Exception e) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            e.printStackTrace();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        } \u003cspan class=\"keyword\"\u003efinally\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"keyword\"\u003etry\u003c/span\u003e {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                \u003cspan class=\"keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"literal\"\u003enull\u003c/span\u003e != connection)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                    connection.close();\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            } \u003cspan class=\"keyword\"\u003ecatch\u003c/span\u003e (Throwable ignore) {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e\u003cstrong\u003e运行\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e先运行 Receiver.java 进行消息监听，再运行 Send.java 发送消息。\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e输出\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eSend 的输出内容\u003c/p\u003e\n\u003cfigure class=\"highlight\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e发送消息：Activemq 发送消息0\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e发送消息：Activemq 发送消息1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e发送消息：Activemq 发送消息2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e发送消息：Activemq 发送消息3\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003eReceiver 的输出内容\u003c/p\u003e\n\u003cfigure class=\"highlight\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e收到消息ActiveMQ 发送消息0\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e收到消息ActiveMQ 发送消息1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e收到消息ActiveMQ 发送消息2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e收到消息ActiveMQ 发送消息3\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch2 id=\"资源\"\u003e\u003ca href=\"#资源\" class=\"headerlink\" title=\"资源\"\u003e\u003c/a\u003e资源\u003c/h2\u003e\u003cul\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"http://activemq.apache.org/\"\u003eActiveMQ 官网\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://docs.oracle.com/cd/E19575-01/819-3669/6n5sg7cgq/index.html\"\u003eoracle 官方的 jms 介绍\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n    \u003c/div\u003e",
  "Date": "2022-02-17T14:34:30Z",
  "Author": "钝悟 ◾ Dunwu"
}