{
  "Source": "dunwu",
  "Title": "iptables",
  "Link": "https://dunwu.github.io/blog/pages/eb9176/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\u003ch1 id=\"Iptables-应用\"\u003e\u003ca href=\"#Iptables-应用\" class=\"headerlink\" title=\"Iptables 应用\"\u003e\u003c/a\u003eIptables 应用\u003c/h1\u003e\u003cblockquote\u003e\n\u003cp\u003e\u003cem\u003eiptables\u003c/em\u003e 是一个配置 Linux 内核 \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://wiki.archlinux.org/index.php/Firewall\"\u003e防火墙\u003c/a\u003e 的命令行工具，是 \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://en.wikipedia.org/wiki/Netfilter\"\u003enetfilter\u003c/a\u003e 项目的一部分。 可以直接配置，也可以通过许多前端和图形界面配置。\u003c/p\u003e\n\u003cp\u003eiptables 也经常代指该内核级防火墙。iptables 用于 \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://en.wikipedia.org/wiki/Ipv4\"\u003eipv4\u003c/a\u003e，\u003cem\u003eip6tables\u003c/em\u003e 用于 \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://en.wikipedia.org/wiki/Ipv6\"\u003eipv6\u003c/a\u003e。\u003c/p\u003e\n\u003cp\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://wiki.archlinux.org/index.php/Nftables\"\u003enftables\u003c/a\u003e 已经包含在 \u003ca target=\"_blank\" rel=\"noopener\" href=\"http://www.phoronix.com/scan.php?page=news_item\u0026amp;px=MTQ5MDU\"\u003eLinux kernel 3.13\u003c/a\u003e 中，以后会取代 iptables 成为主要的 Linux 防火墙工具。\u003c/p\u003e\n\u003cp\u003e环境：CentOS7\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2 id=\"简介\"\u003e\u003ca href=\"#简介\" class=\"headerlink\" title=\"简介\"\u003e\u003c/a\u003e简介\u003c/h2\u003e\u003cp\u003e\u003cstrong\u003eiptables 可以检测、修改、转发、重定向和丢弃 IPv4 数据包\u003c/strong\u003e。\u003c/p\u003e\n\u003cp\u003e过滤 IPv4 数据包的代码已经内置于内核中，并且按照不同的目的被组织成 \u003cstrong\u003e表\u003c/strong\u003e 的集合。\u003cstrong\u003e表\u003c/strong\u003e 由一组预先定义的 \u003cstrong\u003e链\u003c/strong\u003e 组成，\u003cstrong\u003e链\u003c/strong\u003e包含遍历顺序规则。每一条规则包含一个谓词的潜在匹配和相应的动作（称为 \u003cstrong\u003e目标\u003c/strong\u003e），如果谓词为真，该动作会被执行。也就是说条件匹配。\u003c/p\u003e\n\u003ch2 id=\"安装-iptables\"\u003e\u003ca href=\"#安装-iptables\" class=\"headerlink\" title=\"安装 iptables\"\u003e\u003c/a\u003e安装 iptables\u003c/h2\u003e\u003cp\u003e（1）禁用 firewalld\u003c/p\u003e\n\u003cp\u003eCentOS 7 上默认安装了 firewalld 作为防火墙，使用 iptables 建议关闭并禁用 firewalld。\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003esystemctl stop firewalld\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esystemctl \u003cspan class=\"built_in\"\u003edisable\u003c/span\u003e firewalld\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e（2）安装 iptables\u003c/p\u003e\n\u003cfigure class=\"highlight cmake\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eyum \u003cspan class=\"keyword\"\u003einstall\u003c/span\u003e -y iptables-services\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e（3）服务管理\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e查看服务状态：\u003ccode\u003esystemctl status iptables\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e启用服务：\u003ccode\u003esystemctl enable iptables\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e禁用服务：\u003ccode\u003esystemctl disable iptables\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e启动服务：\u003ccode\u003esystemctl start iptables\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e重启服务：\u003ccode\u003esystemctl restart iptables\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e关闭服务: \u003ccode\u003esystemctl stop iptables\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"命令\"\u003e\u003ca href=\"#命令\" class=\"headerlink\" title=\"命令\"\u003e\u003c/a\u003e命令\u003c/h2\u003e\u003cp\u003e基本语法：\u003c/p\u003e\n\u003cfigure class=\"highlight stylus\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"function\"\u003e\u003cspan class=\"title\"\u003eiptables\u003c/span\u003e\u003cspan class=\"params\"\u003e(选项)\u003c/span\u003e\u003cspan class=\"params\"\u003e(参数)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e基本选项说明：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e参数\u003c/th\u003e\n\u003cth\u003e作用\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\u003ctr\u003e\n\u003ctd\u003e-P\u003c/td\u003e\n\u003ctd\u003e设置默认策略:iptables -P INPUT (DROP\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-F\u003c/td\u003e\n\u003ctd\u003e清空规则链\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-L\u003c/td\u003e\n\u003ctd\u003e查看规则链\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-A\u003c/td\u003e\n\u003ctd\u003e在规则链的末尾加入新规则\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-I\u003c/td\u003e\n\u003ctd\u003enum 在规则链的头部加入新规则\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-D\u003c/td\u003e\n\u003ctd\u003enum 删除某一条规则\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-s\u003c/td\u003e\n\u003ctd\u003e匹配来源地址 IP/MASK，加叹号”!”表示除这个 IP 外。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-d\u003c/td\u003e\n\u003ctd\u003e匹配目标地址\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-i\u003c/td\u003e\n\u003ctd\u003e网卡名称 匹配从这块网卡流入的数据\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-o\u003c/td\u003e\n\u003ctd\u003e网卡名称 匹配从这块网卡流出的数据\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e-p\u003c/td\u003e\n\u003ctd\u003e匹配协议,如 tcp,udp,icmp\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e–dport num\u003c/td\u003e\n\u003ctd\u003e匹配目标端口号\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e–sport num\u003c/td\u003e\n\u003ctd\u003e匹配来源端口号\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\u003c/table\u003e\n\u003cp\u003e顺序：\u003c/p\u003e\n\u003cfigure class=\"highlight css\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eiptables -t 表名 \u0026lt;-\u003cspan class=\"selector-tag\"\u003eA\u003c/span\u003e/\u003cspan class=\"selector-tag\"\u003eI\u003c/span\u003e/D/R\u0026gt; 规则链名 \u003cspan class=\"selector-attr\"\u003e[规则号]\u003c/span\u003e \u0026lt;-\u003cspan class=\"selector-tag\"\u003ei\u003c/span\u003e/o 网卡名\u0026gt; -\u003cspan class=\"selector-tag\"\u003ep\u003c/span\u003e 协议名 \u0026lt;-s 源IP/源子网\u0026gt; \u003cspan class=\"attr\"\u003e--sport\u003c/span\u003e 源端口 \u0026lt;-d 目标IP/目标子网\u0026gt; \u003cspan class=\"attr\"\u003e--dport\u003c/span\u003e 目标端口 -j 动作\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch2 id=\"iptables-示例\"\u003e\u003ca href=\"#iptables-示例\" class=\"headerlink\" title=\"iptables 示例\"\u003e\u003c/a\u003eiptables 示例\u003c/h2\u003e\u003ch3 id=\"清空当前的所有规则和计数\"\u003e\u003ca href=\"#清空当前的所有规则和计数\" class=\"headerlink\" title=\"清空当前的所有规则和计数\"\u003e\u003c/a\u003e清空当前的所有规则和计数\u003c/h3\u003e\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eiptables -F  # 清空所有的防火墙规则\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -X  # 删除用户自定义的空链\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -Z  # 清空计数\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"配置允许-ssh-端口连接\"\u003e\u003ca href=\"#配置允许-ssh-端口连接\" class=\"headerlink\" title=\"配置允许 ssh 端口连接\"\u003e\u003c/a\u003e配置允许 ssh 端口连接\u003c/h3\u003e\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eiptables -A INPUT -s 192.168.1.0/24 -p tcp --dport 22 -j ACCEPT\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta prompt_\"\u003e# \u003c/span\u003e\u003cspan class=\"language-bash\"\u003e22为你的ssh端口， -s 192.168.1.0/24表示允许这个网段的机器来连接，其它网段的ip地址是登陆不了你的机器的。 -j ACCEPT表示接受这样的请求\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"允许本地回环地址可以正常使用\"\u003e\u003ca href=\"#允许本地回环地址可以正常使用\" class=\"headerlink\" title=\"允许本地回环地址可以正常使用\"\u003e\u003c/a\u003e允许本地回环地址可以正常使用\u003c/h3\u003e\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eiptables -A INPUT -i lo -j ACCEPT\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta prompt_\"\u003e#\u003c/span\u003e\u003cspan class=\"language-bash\"\u003e本地圆环地址就是那个127.0.0.1，是本机上使用的,它进与出都设置为允许\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -A OUTPUT -o lo -j ACCEPT\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"设置默认的规则\"\u003e\u003ca href=\"#设置默认的规则\" class=\"headerlink\" title=\"设置默认的规则\"\u003e\u003c/a\u003e设置默认的规则\u003c/h3\u003e\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eiptables -P INPUT DROP # 配置默认的不让进\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -P FORWARD DROP # 默认的不允许转发\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -P OUTPUT ACCEPT # 默认的可以出去\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"配置白名单\"\u003e\u003ca href=\"#配置白名单\" class=\"headerlink\" title=\"配置白名单\"\u003e\u003c/a\u003e配置白名单\u003c/h3\u003e\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eiptables -A INPUT -p all -s 192.168.1.0/24 -j ACCEPT  # 允许机房内网机器可以访问\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -A INPUT -p all -s 192.168.140.0/24 -j ACCEPT  # 允许机房内网机器可以访问\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -A INPUT -p tcp -s 183.121.3.7 --dport 3380 -j ACCEPT # 允许183.121.3.7访问本机的3380端口\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"开启相应的服务端口\"\u003e\u003ca href=\"#开启相应的服务端口\" class=\"headerlink\" title=\"开启相应的服务端口\"\u003e\u003c/a\u003e开启相应的服务端口\u003c/h3\u003e\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eiptables -A INPUT -p tcp --dport 80 -j ACCEPT # 开启80端口，因为web对外都是这个端口\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -A INPUT -p icmp --icmp-type 8 -j ACCEPT # 允许被ping\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT # 已经建立的连接得让它进来\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"保存规则到配置文件中\"\u003e\u003ca href=\"#保存规则到配置文件中\" class=\"headerlink\" title=\"保存规则到配置文件中\"\u003e\u003c/a\u003e保存规则到配置文件中\u003c/h3\u003e\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003ecp /etc/sysconfig/iptables /etc/sysconfig/iptables.bak # 任何改动之前先备份，请保持这一优秀的习惯\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables-save \u0026gt; /etc/sysconfig/iptables\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003ecat /etc/sysconfig/iptables\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"列出已设置的规则\"\u003e\u003ca href=\"#列出已设置的规则\" class=\"headerlink\" title=\"列出已设置的规则\"\u003e\u003c/a\u003e列出已设置的规则\u003c/h3\u003e\u003cblockquote\u003e\n\u003cp\u003eiptables -L [-t 表名][链名]\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cul\u003e\n\u003cli\u003e四个表名 \u003ccode\u003eraw\u003c/code\u003e，\u003ccode\u003enat\u003c/code\u003e，\u003ccode\u003efilter\u003c/code\u003e，\u003ccode\u003emangle\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e五个规则链名 \u003ccode\u003eINPUT\u003c/code\u003e、\u003ccode\u003eOUTPUT\u003c/code\u003e、\u003ccode\u003eFORWARD\u003c/code\u003e、\u003ccode\u003ePREROUTING\u003c/code\u003e、\u003ccode\u003ePOSTROUTING\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003efilter 表包含\u003ccode\u003eINPUT\u003c/code\u003e、\u003ccode\u003eOUTPUT\u003c/code\u003e、\u003ccode\u003eFORWARD\u003c/code\u003e三个规则链\u003c/li\u003e\n\u003c/ul\u003e\n\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eiptables -L -t nat                  # 列出 nat 上面的所有规则\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta prompt_\"\u003e# \u003c/span\u003e\u003cspan class=\"language-bash\"\u003e           ^ -t 参数指定，必须是 raw， nat，filter，mangle 中的一个\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -L -t nat  --line-numbers  # 规则带编号\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -L INPUT\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -L -nv  # 查看，这个列表看起来更详细\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"清除已有规则\"\u003e\u003ca href=\"#清除已有规则\" class=\"headerlink\" title=\"清除已有规则\"\u003e\u003c/a\u003e清除已有规则\u003c/h3\u003e\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eiptables -F INPUT  # 清空指定链 INPUT 上面的所有规则\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -X INPUT  # 删除指定的链，这个链必须没有被其它任何规则引用，而且这条上必须没有任何规则。\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                   # 如果没有指定链名，则会删除该表中所有非内置的链。\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -Z INPUT  # 把指定链，或者表中的所有链上的所有计数器清零。\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"删除已添加的规则\"\u003e\u003ca href=\"#删除已添加的规则\" class=\"headerlink\" title=\"删除已添加的规则\"\u003e\u003c/a\u003e删除已添加的规则\u003c/h3\u003e\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta prompt_\"\u003e# \u003c/span\u003e\u003cspan class=\"language-bash\"\u003e添加一条规则\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -A INPUT -s 192.168.1.5 -j DROP\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e将所有 iptables 以序号标记显示，执行：\u003c/p\u003e\n\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eiptables -L -n --line-numbers\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e比如要删除 INPUT 里序号为 8 的规则，执行：\u003c/p\u003e\n\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eiptables -D INPUT 8\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"开放指定的端口\"\u003e\u003ca href=\"#开放指定的端口\" class=\"headerlink\" title=\"开放指定的端口\"\u003e\u003c/a\u003e开放指定的端口\u003c/h3\u003e\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eiptables -A INPUT -s 127.0.0.1 -d 127.0.0.1 -j ACCEPT               #允许本地回环接口(即运行本机访问本机)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT    #允许已建立的或相关连的通行\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -A OUTPUT -j ACCEPT         #允许所有本机向外的访问\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -A INPUT -p tcp --dport 22 -j ACCEPT    #允许访问22端口\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -A INPUT -p tcp --dport 80 -j ACCEPT    #允许访问80端口\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -A INPUT -p tcp --dport 21 -j ACCEPT    #允许ftp服务的21端口\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -A INPUT -p tcp --dport 20 -j ACCEPT    #允许FTP服务的20端口\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -A INPUT -j reject       #禁止其他未允许的规则访问\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -A FORWARD -j REJECT     #禁止其他未允许的规则访问\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"屏蔽-IP\"\u003e\u003ca href=\"#屏蔽-IP\" class=\"headerlink\" title=\"屏蔽 IP\"\u003e\u003c/a\u003e屏蔽 IP\u003c/h3\u003e\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eiptables -A INPUT -p tcp -m tcp -s 192.168.0.8 -j DROP  # 屏蔽恶意主机（比如，192.168.0.8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -I INPUT -s 123.45.6.7 -j DROP       #屏蔽单个IP的命令\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -I INPUT -s 123.0.0.0/8 -j DROP      #封整个段即从123.0.0.1到123.255.255.254的命令\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -I INPUT -s 124.45.0.0/16 -j DROP    #封IP段即从123.45.0.1到123.45.255.254的命令\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -I INPUT -s 123.45.6.0/24 -j DROP    #封IP段即从123.45.6.1到123.45.6.254的命令是\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"指定数据包出去的网络接口\"\u003e\u003ca href=\"#指定数据包出去的网络接口\" class=\"headerlink\" title=\"指定数据包出去的网络接口\"\u003e\u003c/a\u003e指定数据包出去的网络接口\u003c/h3\u003e\u003cp\u003e只对 OUTPUT，FORWARD，POSTROUTING 三个链起作用。\u003c/p\u003e\n\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eiptables -A FORWARD -o eth0\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"查看已添加的规则\"\u003e\u003ca href=\"#查看已添加的规则\" class=\"headerlink\" title=\"查看已添加的规则\"\u003e\u003c/a\u003e查看已添加的规则\u003c/h3\u003e\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eiptables -L -n -v\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eChain INPUT (policy DROP 48106 packets, 2690K bytes)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e pkts bytes target     prot opt in     out     source               destination\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e 5075  589K ACCEPT     all  --  lo     *       0.0.0.0/0            0.0.0.0/0\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e 191K   90M ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0           tcp dpt:22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e1499K  133M ACCEPT     tcp  --  *      *       0.0.0.0/0            0.0.0.0/0           tcp dpt:80\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4364K 6351M ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0           state RELATED,ESTABLISHED\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e 6256  327K ACCEPT     icmp --  *      *       0.0.0.0/0            0.0.0.0/0\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eChain FORWARD (policy ACCEPT 0 packets, 0 bytes)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e pkts bytes target     prot opt in     out     source               destination\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eChain OUTPUT (policy ACCEPT 3382K packets, 1819M bytes)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e pkts bytes target     prot opt in     out     source               destination\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e 5075  589K ACCEPT     all  --  *      lo      0.0.0.0/0            0.0.0.0/0\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"启动网络转发规则\"\u003e\u003ca href=\"#启动网络转发规则\" class=\"headerlink\" title=\"启动网络转发规则\"\u003e\u003c/a\u003e启动网络转发规则\u003c/h3\u003e\u003cp\u003e公网\u003ccode\u003e210.14.67.7\u003c/code\u003e让内网\u003ccode\u003e192.168.188.0/24\u003c/code\u003e上网\u003c/p\u003e\n\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eiptables -t nat -A POSTROUTING -s 192.168.188.0/24 -j SNAT --to-source 210.14.67.127\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"端口映射\"\u003e\u003ca href=\"#端口映射\" class=\"headerlink\" title=\"端口映射\"\u003e\u003c/a\u003e端口映射\u003c/h3\u003e\u003cp\u003e本机的 2222 端口映射到内网 虚拟机的 22 端口\u003c/p\u003e\n\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eiptables -t nat -A PREROUTING -d 210.14.67.127 -p tcp --dport 2222  -j DNAT --to-dest 192.168.188.115:22\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"字符串匹配\"\u003e\u003ca href=\"#字符串匹配\" class=\"headerlink\" title=\"字符串匹配\"\u003e\u003c/a\u003e字符串匹配\u003c/h3\u003e\u003cp\u003e比如，我们要过滤所有 TCP 连接中的字符串\u003ccode\u003etest\u003c/code\u003e，一旦出现它我们就终止这个连接，我们可以这么做：\u003c/p\u003e\n\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eiptables -A INPUT -p tcp -m string --algo kmp --string \u0026#34;test\u0026#34; -j REJECT --reject-with tcp-reset\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiptables -L\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta prompt_\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta prompt_\"\u003e# \u003c/span\u003e\u003cspan class=\"language-bash\"\u003eChain INPUT (policy ACCEPT)\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta prompt_\"\u003e# \u003c/span\u003e\u003cspan class=\"language-bash\"\u003etarget     prot opt \u003cspan class=\"built_in\"\u003esource\u003c/span\u003e               destination\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta prompt_\"\u003e# \u003c/span\u003e\u003cspan class=\"language-bash\"\u003eREJECT     tcp  --  anywhere             anywhere            STRING match \u003cspan class=\"string\"\u003e\u0026#34;test\u0026#34;\u003c/span\u003e ALGO name kmp TO 65535 reject-with tcp-reset\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta prompt_\"\u003e#\u003c/span\u003e\u003cspan class=\"language-bash\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-bash\"\u003e\u003cspan class=\"comment\"\u003e# Chain FORWARD (policy ACCEPT)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta prompt_\"\u003e# \u003c/span\u003e\u003cspan class=\"language-bash\"\u003etarget     prot opt \u003cspan class=\"built_in\"\u003esource\u003c/span\u003e               destination\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta prompt_\"\u003e#\u003c/span\u003e\u003cspan class=\"language-bash\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-bash\"\u003e\u003cspan class=\"comment\"\u003e# Chain OUTPUT (policy ACCEPT)\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta prompt_\"\u003e# \u003c/span\u003e\u003cspan class=\"language-bash\"\u003etarget     prot opt \u003cspan class=\"built_in\"\u003esource\u003c/span\u003e               destination\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"阻止-Windows-蠕虫的攻击\"\u003e\u003ca href=\"#阻止-Windows-蠕虫的攻击\" class=\"headerlink\" title=\"阻止 Windows 蠕虫的攻击\"\u003e\u003c/a\u003e阻止 Windows 蠕虫的攻击\u003c/h3\u003e\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eiptables -I INPUT -j DROP -p tcp -s 0.0.0.0/0 -m string --algo kmp --string \u0026#34;cmd.exe\u0026#34;\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"防止-SYN-洪水攻击\"\u003e\u003ca href=\"#防止-SYN-洪水攻击\" class=\"headerlink\" title=\"防止 SYN 洪水攻击\"\u003e\u003c/a\u003e防止 SYN 洪水攻击\u003c/h3\u003e\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eiptables -A INPUT -p tcp --syn -m limit --limit 5/second -j ACCEPT\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch2 id=\"参考资料\"\u003e\u003ca href=\"#参考资料\" class=\"headerlink\" title=\"参考资料\"\u003e\u003c/a\u003e参考资料\u003c/h2\u003e\u003cul\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://wiki.archlinux.org/index.php/iptables_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)\"\u003ehttps://wiki.archlinux.org/index.php/iptables_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://wangchujiang.com/linux-command/c/iptables.html\"\u003ehttps://wangchujiang.com/linux-command/c/iptables.html\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n    \u003c/div\u003e",
  "Date": "2019-11-25T09:25:00Z",
  "Author": "钝悟 ◾ Dunwu"
}