{
  "Source": "izsk.me",
  "Title": "highcharts中的svg在服务器端自动转化成图片",
  "Link": "https://izsk.me/2017/09/17/highcharts%E4%B8%AD%E7%9A%84svg%E5%9C%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%87%AA%E5%8A%A8%E8%BD%AC%E5%8C%96%E6%88%90%E5%9B%BE%E7%89%87/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\n\n      \n      \n\n      \n        \u003cp\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://highcharts.com/\"\u003eHighcharts\u003c/a\u003e 是一个用纯JavaScript编写的一个图表库， 能够很简单便捷的在web网站或是web应用程序添加有交互性的图表，并且免费提供给个人学习、个人网站和非商业用途使用。HighCharts支持的图表类型有曲线图、区域图、柱状图、饼状图、散状点图和综合图表等各种图形,效果非常美观,被广泛的应用于图表生成,类似图表库还有百度的Echart等.\u003c/p\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\n\u003ch3 id=\"highcharts\"\u003e\u003ca href=\"#highcharts\" class=\"headerlink\" title=\"highcharts\"\u003e\u003c/a\u003e\u003cstrong\u003ehighcharts\u003c/strong\u003e\u003c/h3\u003e\u003cp\u003e在html上生成highcharts图表是很容易的,\u003cstrong\u003e我们只需要根据需求选择图形,然后定义样式,最后把数据塞进highcharts的series中即可渲染\u003c/strong\u003e,而且highcharts还提供了页面(客户端)导出功能,可以很方便的导出为jpg、png、pdf、svg等格式,但是如何在服务器端(这里使用flask)自动生成图形然后保存为图片呢?\u003c/p\u003e\n\u003cp\u003e其实,我们在网面上看到的highcharts图形,其实不是一张图片,而是svg格式,具体的名词解释请自行搜索,说白了就是一种xml语言,格式如下:\u003c/p\u003e\n\u003cfigure class=\"highlight html\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"tag\"\u003e\u0026lt;\u003cspan class=\"name\"\u003esvg\u003c/span\u003e \u003cspan class=\"attr\"\u003exmlns:xlink\u003c/span\u003e=\u003cspan class=\"string\"\u003e\u0026#34;http://www.w3.org/1999/xlink\u0026#34;\u003c/span\u003e \u003cspan class=\"attr\"\u003eversion\u003c/span\u003e=\u003cspan class=\"string\"\u003e\u0026#34;1.1\u0026#34;\u003c/span\u003e \u003cspan class=\"attr\"\u003eclass\u003c/span\u003e=\u003cspan class=\"string\"\u003e\u0026#34;highcharts-root\u0026#34;\u003c/span\u003e \u003cspan class=\"attr\"\u003e...\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"tag\"\u003e\u0026lt;/\u003cspan class=\"name\"\u003esvg\u003c/span\u003e\u0026gt;\u003c/span\u003e \u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e那么自动生成并保存为图片思路就很清晰了:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003col\u003e\n\u003cli\u003e获取数据填充模板html\u003c/li\u003e\n\u003cli\u003e从模板html中获取所有svg标签,使用Highcharts自带function-getSVG()\u003c/li\u003e\n\u003cli\u003e使用cairosvg将svg转换成png或者使用phantomjs\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e第1点渲染模板html没有什么好说的,无非就是按照需求组织数据的问题,我们直接从第2点开始\u003c/p\u003e\n\u003ch3 id=\"getSVG\"\u003e\u003ca href=\"#getSVG\" class=\"headerlink\" title=\"getSVG()\"\u003e\u003c/a\u003e\u003cstrong\u003egetSVG()\u003c/strong\u003e\u003c/h3\u003e\u003cp\u003e主要思路为\u003cstrong\u003e一个按钮点击后通过getSVG获取所有图表的svg信息,再使用Highcharts.post构造post表单传入后端\u003c/strong\u003e,当然这里也可以使用request库的xpath获取svg元素,Highcharts既然的现成的办法所以就直接用了,这里有个需要注意的地方就是如果想要保留图表原本的长宽的话,在chart.getSVG()时像下面代码所示那样使用长宽,不然得到的svg的长宽会变成默认值\u003c/p\u003e\n\u003cp\u003e模板html中getSVG()代码如下:\u003c/p\u003e\n\u003cfigure class=\"highlight html\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e26\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e27\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e28\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e29\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e30\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e31\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e32\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e33\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e34\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e35\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"tag\"\u003e\u0026lt;\u003cspan class=\"name\"\u003escript\u003c/span\u003e \u003cspan class=\"attr\"\u003etype\u003c/span\u003e=\u003cspan class=\"string\"\u003e\u0026#34;text/javascript\u0026#34;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"language-javascript\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e\u003cspan class=\"title class_\"\u003eHighcharts\u003c/span\u003e.\u003cspan class=\"property\"\u003egetSVG\u003c/span\u003e = \u003cspan class=\"keyword\"\u003efunction\u003c/span\u003e (\u003cspan class=\"params\"\u003echarts\u003c/span\u003e) {\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e    \u003cspan class=\"keyword\"\u003evar\u003c/span\u003e svgArr = [];\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e    \u003cspan class=\"title class_\"\u003eHighcharts\u003c/span\u003e.\u003cspan class=\"title function_\"\u003eeach\u003c/span\u003e(charts, \u003cspan class=\"keyword\"\u003efunction\u003c/span\u003e (\u003cspan class=\"params\"\u003echart\u003c/span\u003e) {\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e    \t  \u003cspan class=\"comment\"\u003e//需要指定长宽,要不然导出svg时会长宽会变成默认值\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e        \u003cspan class=\"keyword\"\u003evar\u003c/span\u003e svg = chart.\u003cspan class=\"title function_\"\u003egetSVG\u003c/span\u003e({\u003cspan class=\"attr\"\u003echart\u003c/span\u003e:{\u003cspan class=\"attr\"\u003ewidth\u003c/span\u003e:chart.\u003cspan class=\"property\"\u003echartWidth\u003c/span\u003e,\u003cspan class=\"attr\"\u003eheight\u003c/span\u003e:chart.\u003cspan class=\"property\"\u003echartHeight\u003c/span\u003e}});\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e        svgArr.\u003cspan class=\"title function_\"\u003epush\u003c/span\u003e(svg);\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e    });\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e    \u003cspan class=\"keyword\"\u003ereturn\u003c/span\u003e svgArr;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e};\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e\u003c/span\u003e\u003cspan class=\"tag\"\u003e\u0026lt;/\u003cspan class=\"name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"tag\"\u003e\u0026lt;\u003cspan class=\"name\"\u003escript\u003c/span\u003e \u003cspan class=\"attr\"\u003etype\u003c/span\u003e=\u003cspan class=\"string\"\u003e\u0026#34;text/javascript\u0026#34;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"language-javascript\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e\u003cspan class=\"title class_\"\u003eHighcharts\u003c/span\u003e.\u003cspan class=\"property\"\u003eexportCharts\u003c/span\u003e = \u003cspan class=\"keyword\"\u003efunction\u003c/span\u003e (\u003cspan class=\"params\"\u003echarts, options\u003c/span\u003e) {\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e    \u003cspan class=\"comment\"\u003e// Merge the options\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e    options = \u003cspan class=\"title class_\"\u003eHighcharts\u003c/span\u003e.\u003cspan class=\"title function_\"\u003emerge\u003c/span\u003e(\u003cspan class=\"title class_\"\u003eHighcharts\u003c/span\u003e.\u003cspan class=\"title function_\"\u003egetOptions\u003c/span\u003e().\u003cspan class=\"property\"\u003eexporting\u003c/span\u003e, options);\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e    \u003cspan class=\"comment\"\u003e// Post to export server\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e    \u003cspan class=\"title class_\"\u003eHighcharts\u003c/span\u003e.\u003cspan class=\"title function_\"\u003epost\u003c/span\u003e(options.\u003cspan class=\"property\"\u003eurl\u003c/span\u003e, {\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e        \u003cspan class=\"comment\"\u003e//filename: options.filename || \u0026#39;chart\u0026#39;,\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e        \u003cspan class=\"attr\"\u003etype\u003c/span\u003e: options.\u003cspan class=\"property\"\u003etype\u003c/span\u003e,\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e        \u003cspan class=\"comment\"\u003e//width: options.width,\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e        \u003cspan class=\"attr\"\u003esvg\u003c/span\u003e: \u003cspan class=\"title class_\"\u003eHighcharts\u003c/span\u003e.\u003cspan class=\"title function_\"\u003egetSVG\u003c/span\u003e(charts),\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e        \u003cspan class=\"attr\"\u003e_search\u003c/span\u003e: \u003cspan class=\"variable language_\"\u003ewindow\u003c/span\u003e.\u003cspan class=\"property\"\u003elocation\u003c/span\u003e.\u003cspan class=\"property\"\u003esearch\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e    });\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e};\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e\u003c/span\u003e\u003cspan class=\"tag\"\u003e\u0026lt;/\u003cspan class=\"name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"tag\"\u003e\u0026lt;\u003cspan class=\"name\"\u003escript\u003c/span\u003e \u003cspan class=\"attr\"\u003etype\u003c/span\u003e=\u003cspan class=\"string\"\u003e\u0026#34;text/javascript\u0026#34;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"language-javascript\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e$(\u003cspan class=\"string\"\u003e\u0026#39;#exportPDF\u0026#39;\u003c/span\u003e).\u003cspan class=\"title function_\"\u003eclick\u003c/span\u003e(\u003cspan class=\"keyword\"\u003efunction\u003c/span\u003e (\u003cspan class=\"params\"\u003e\u003c/span\u003e){\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e     \u003cspan class=\"title class_\"\u003eHighcharts\u003c/span\u003e.\u003cspan class=\"title function_\"\u003eexportCharts\u003c/span\u003e([chart1,chart2],\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e     {\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e        \u003cspan class=\"attr\"\u003etype\u003c/span\u003e: \u003cspan class=\"string\"\u003e\u0026#39;image/png\u0026#39;\u003c/span\u003e,\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e        \u003cspan class=\"comment\"\u003e//width: \u0026#39;600\u0026#39;,\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e        \u003cspan class=\"attr\"\u003eurl\u003c/span\u003e: \u003cspan class=\"string\"\u003e\u0026#39;/pdfdownload/\u0026#39;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e    });\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e});\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"language-javascript\"\u003e\u003c/span\u003e\u003cspan class=\"tag\"\u003e\u0026lt;/\u003cspan class=\"name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e这样post到后端之后再request.form.to_dict()得到所有参数即可拿到svg信息,当然这里得到的是所有图表的svg串,需要进行分割处理,这里以‘,\u0026lt;svg’为分割符,然后使用开源库**\u003ca target=\"_blank\" rel=\"noopener\" href=\"http://cairosvg.org/documentation/\"\u003ecairosvg\u003c/a\u003e**中的svg2png将svg转换成png图片.\u003c/p\u003e\n\u003cfigure class=\"highlight python\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"title function_\"\u003ecairosvg2png\u003c/span\u003e(\u003cspan class=\"params\"\u003esvg,chartlst\u003c/span\u003e):\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    field_svg = re.split(\u003cspan class=\"string\"\u003er\u0026#34;,\u0026lt;svg \u0026#34;\u003c/span\u003e,svg)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e#第一个svg是完整的\u0026lt;svg\u0026gt;\u0026lt;/svg\u0026gt;,从第二个开始就需要在开头补\u0026lt;svg ,\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    svg2png(bytestring=field_svg[\u003cspan class=\"number\"\u003e0\u003c/span\u003e], write_to=\u003cspan class=\"string\"\u003e\u0026#34;.\\\\static\\\\img\\\\pdf\\\\\u0026#34;\u003c/span\u003e + chartlst[\u003cspan class=\"number\"\u003e0\u003c/span\u003e] + \u003cspan class=\"string\"\u003e\u0026#34;.png\u0026#34;\u003c/span\u003e)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e x \u003cspan class=\"keyword\"\u003ein\u003c/span\u003e \u003cspan class=\"built_in\"\u003erange\u003c/span\u003e(\u003cspan class=\"built_in\"\u003elen\u003c/span\u003e(field_svg)-\u003cspan class=\"number\"\u003e1\u003c/span\u003e):\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        svg2png(bytestring=\u003cspan class=\"string\"\u003e\u0026#34;\u0026lt;svg \u0026#34;\u003c/span\u003e + field_svg[x+\u003cspan class=\"number\"\u003e1\u003c/span\u003e], write_to=\u003cspan class=\"string\"\u003e\u0026#34;.\\\\static\\\\img\\\\pdf\\\\\u0026#34;\u003c/span\u003e + chartlst[x+\u003cspan class=\"number\"\u003e1\u003c/span\u003e] + \u003cspan class=\"string\"\u003e\u0026#34;.png\u0026#34;\u003c/span\u003e)  \u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"phantomjs\"\u003e\u003ca href=\"#phantomjs\" class=\"headerlink\" title=\"phantomjs\"\u003e\u003c/a\u003e\u003cstrong\u003ephantomjs\u003c/strong\u003e\u003c/h3\u003e\u003cp\u003e除了上面的方法外,还可以使用phantomjs来自动在服务器端把svg转换成png/jpeg/pdf,这也是highcharts推荐的方式,phantomjs是一个很强大的基于WebKit的服务器端JavaScript API,也是开源库,使用场景也非常广泛.特别在自动化测试及爬虫方面,有兴趣的可以\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/ariya/phantomjs\"\u003e看这里\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e而且phantomjs支持以服务的方式一直运行,只需要把信息传递到它指定的端口即可,非常方便,这次是因为不能安装在服务器上,所以没有采纳,这里使用子进程运行phantomjs.exe,直接使用时需用-resources指定js文件:\u003c/p\u003e\n\u003cfigure class=\"highlight python\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"title function_\"\u003eexportForm\u003c/span\u003e():\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    command = \u003cspan class=\"string\"\u003e\u0026#34;phantomjs.exe highcharts-convert.js -infile test.json -outfile chart2.png -scale 2.5 width=1000 -constr Chart -resources highcharts.js,jquery.js\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    child = subprocess.Popen(command,shell=\u003cspan class=\"literal\"\u003eTrue\u003c/span\u003e)\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"参考文章\"\u003e\u003ca href=\"#参考文章\" class=\"headerlink\" title=\"参考文章:\"\u003e\u003c/a\u003e\u003cstrong\u003e参考文章:\u003c/strong\u003e\u003c/h3\u003e\u003cblockquote\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/ariya/phantomjs\"\u003ephantomjs\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"http://cairosvg.org/documentation/\"\u003ecairosvg\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"转载请注明原作者-周淑科-https-izsk-me\"\u003e\u003ca href=\"#转载请注明原作者-周淑科-https-izsk-me\" class=\"headerlink\" title=\"转载请注明原作者: 周淑科(https://izsk.me)\"\u003e\u003c/a\u003e\u003cstrong\u003e转载请注明原作者: 周淑科(\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://izsk.me/\"\u003ehttps://izsk.me\u003c/a\u003e)\u003c/strong\u003e\u003c/h3\u003e\u003chr/\u003e\n\n      \n    \u003c/div\u003e",
  "Date": "2017-09-17T17:30:53+08:00",
  "Author": "Z.S.K."
}