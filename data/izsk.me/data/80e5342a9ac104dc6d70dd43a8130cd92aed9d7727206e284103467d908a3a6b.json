{
  "Source": "izsk.me",
  "Title": "Kubernetes学习(k8s的资源模板生成工具-boilr)",
  "Link": "https://izsk.me/2020/12/26/Kubernetes-Resource-Templates-Boilr/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\n\n      \n      \n\n      \n        \u003cp\u003e相信在使用k8s的过程中，对于各种资源的操作一定是最多的，社区包括kubernetes本身出了多种模板生成工具，比如helm, kustomize这两种是最常用的，本人也一直在用，但有的场景依然会觉得这两个工具相对较重，helm使用的是gotemplate，而kustomize则又依赖于kubectl，两者都有一定的学习成本且没有交互能力，最近在做的一个小需求是: 如何快速地让开发同学以最简单的方式根据提供的模板生成部署文件，github上发现了个\u003ccode\u003eboilr\u003c/code\u003e的工具，虽然工具老了点，但是足够地小，功能足够简单，重要的是有交互功能，比较贴合需求\u003c/p\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\n\u003cp\u003eboilr已经很久很久没更新了，很功能上看，boilr也引用了仓库的概念，本人相信boilr的作者是想把这个工具做的很NB\u003c/p\u003e\n\u003cp\u003e当然,从Readme看，也非常简洁，用法也相对简单\u003c/p\u003e\n\u003ch3 id=\"安装\"\u003e\u003ca href=\"#安装\" class=\"headerlink\" title=\"安装\"\u003e\u003c/a\u003e安装\u003c/h3\u003e\u003cp\u003e根据readme直接下载二进制文件即可使用\u003c/p\u003e\n\u003ch3 id=\"使用\"\u003e\u003ca href=\"#使用\" class=\"headerlink\" title=\"使用\"\u003e\u003c/a\u003e使用\u003c/h3\u003e\u003cp\u003e几乎所有的模板系统的生成思路都一样的，\u003cstrong\u003e根据给定的k-v去替换相应的占位符\u003c/strong\u003e，boilr也不例外\u003c/p\u003e\n\u003cp\u003e在使用前，先下载个模板文件，这里就使用官方的例子:\u003c/p\u003e\n\u003cp\u003e使用之前需要先初始化boilr的相关目录, 默认情况下，会生成/root/.config/boilr/templates目录，这个可以从源代码看到(configuration.go)[\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/zhoushuke/boilr/blob/master/pkg/boilr/configuration.go]\"\u003ehttps://github.com/zhoushuke/boilr/blob/master/pkg/boilr/configuration.go]\u003c/a\u003e\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eboilr init .\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e然后就可以下载模板目录了\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eboilr template download littlemanco/boilr-k8sservice k8sservice\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e注意: 因为boilr很久都没有维护了，在download时可能会遇到\u003ccode\u003epkt-line 3: invalid capabilities\u003c/code\u003e,这是由于boilr代码里使用的\u003ccode\u003ego-git\u003c/code\u003e相对于现在来说，版本太旧了，所以可以直接通过git clone 把模板下下来，是一样的效果\u003c/p\u003e\n\u003cp\u003e通过git clone下载下来后需要把\u003ccode\u003eboilr-k8sservice\u003c/code\u003e放到\u003ccode\u003e/root/.config/boilr/templates\u003c/code\u003e目录下\u003c/p\u003e\n\u003cp\u003e这里最主要的是有个\u003ccode\u003eproject.json\u003c/code\u003e文件\u003c/p\u003e\n\u003cfigure class=\"highlight json\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"punctuation\"\u003e{\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"attr\"\u003e\u0026#34;Namespace\u0026#34;\u003c/span\u003e\u003cspan class=\"punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;product\u0026#34;\u003c/span\u003e\u003cspan class=\"punctuation\"\u003e,\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"attr\"\u003e\u0026#34;Service\u0026#34;\u003c/span\u003e\u003cspan class=\"punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;product\u0026#34;\u003c/span\u003e\u003cspan class=\"punctuation\"\u003e,\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"attr\"\u003e\u0026#34;Application\u0026#34;\u003c/span\u003e\u003cspan class=\"punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;nginx\u0026#34;\u003c/span\u003e\u003cspan class=\"punctuation\"\u003e,\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"attr\"\u003e\u0026#34;Role\u0026#34;\u003c/span\u003e\u003cspan class=\"punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;webserver\u0026#34;\u003c/span\u003e\u003cspan class=\"punctuation\"\u003e,\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"attr\"\u003e\u0026#34;ApplicationPortProtocol\u0026#34;\u003c/span\u003e\u003cspan class=\"punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"punctuation\"\u003e[\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"string\"\u003e\u0026#34;TCP\u0026#34;\u003c/span\u003e\u003cspan class=\"punctuation\"\u003e,\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"string\"\u003e\u0026#34;UDP\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"punctuation\"\u003e,\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"attr\"\u003e\u0026#34;ApplicationPortName\u0026#34;\u003c/span\u003e\u003cspan class=\"punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;http\u0026#34;\u003c/span\u003e\u003cspan class=\"punctuation\"\u003e,\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"attr\"\u003e\u0026#34;ApplicationPort\u0026#34;\u003c/span\u003e\u003cspan class=\"punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"number\"\u003e80\u003c/span\u003e\u003cspan class=\"punctuation\"\u003e,\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"attr\"\u003e\u0026#34;Type\u0026#34;\u003c/span\u003e\u003cspan class=\"punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"punctuation\"\u003e[\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"string\"\u003e\u0026#34;ClusterIP\u0026#34;\u003c/span\u003e\u003cspan class=\"punctuation\"\u003e,\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"string\"\u003e\u0026#34;NodePort\u0026#34;\u003c/span\u003e\u003cspan class=\"punctuation\"\u003e,\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"string\"\u003e\u0026#34;LoadBalancer\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"punctuation\"\u003e,\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"attr\"\u003e\u0026#34;UsePrometheus\u0026#34;\u003c/span\u003e\u003cspan class=\"punctuation\"\u003e:\u003c/span\u003e \u003cspan class=\"punctuation\"\u003e[\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"string\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e\u003cspan class=\"punctuation\"\u003e,\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"string\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"punctuation\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e通过解析这个文件里的字段进行模板文件的替换，文件中的value都是默认值，如果是列表的话，在交互时可提供选择,还是很方便的\u003c/p\u003e\n\u003cp\u003e使用以下命令指定使用该模板\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eboilr template use k8sservice /tmp/deploy\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e后面的\u003ccode\u003e/tmp/deploy\u003c/code\u003e是最终生成的模板文件保存的目录，我这里修改了点东西\u003c/p\u003e\n\u003cp\u003e详细的交互输出如下:\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e以下是详细输出内容:\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e​```bash\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e[?] Please choose a value \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;module_name\u0026#34;\u003c/span\u003e [default: \u003cspan class=\"string\"\u003e\u0026#34;test-frontend\u0026#34;\u003c/span\u003e]: product\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e[?] Please choose a value \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;config_name\u0026#34;\u003c/span\u003e [default: \u003cspan class=\"string\"\u003e\u0026#34;config.yml\u0026#34;\u003c/span\u003e]: \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e[✔] Created deploy/base/configmap.yml.j2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e[?] Please choose a value \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;registry_host\u0026#34;\u003c/span\u003e [default: \u003cspan class=\"string\"\u003e\u0026#34;{{registry_host}}\u0026#34;\u003c/span\u003e]: \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e[?] Please choose a value \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;registry_project\u0026#34;\u003c/span\u003e [default: \u003cspan class=\"string\"\u003e\u0026#34;{{registry_project}}\u0026#34;\u003c/span\u003e]: \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e[?] Please choose a value \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;registry_image\u0026#34;\u003c/span\u003e [default: \u003cspan class=\"string\"\u003e\u0026#34;{{registry_image}}\u0026#34;\u003c/span\u003e]: \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e[?] Please choose a value \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;registry_tag\u0026#34;\u003c/span\u003e [default: \u003cspan class=\"string\"\u003e\u0026#34;{{registry_tag}}\u0026#34;\u003c/span\u003e]: \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e[?] Please choose a value \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;port_number\u0026#34;\u003c/span\u003e [default: 8080]: \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e[?] Please choose a value \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;config_path\u0026#34;\u003c/span\u003e [default: \u003cspan class=\"string\"\u003e\u0026#34;/app/services\u0026#34;\u003c/span\u003e]: \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e[✔] Created deploy/base/deployment.yml.j2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e[?] Please choose an option \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;port_name\u0026#34;\u003c/span\u003e \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    1 - \u003cspan class=\"string\"\u003e\u0026#34;http\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    2 - \u003cspan class=\"string\"\u003e\u0026#34;grpc\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    Choose from 1..2 [default: 1]: \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e[?] Please choose a value \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;port_protocol\u0026#34;\u003c/span\u003e [default: \u003cspan class=\"string\"\u003e\u0026#34;TCP\u0026#34;\u003c/span\u003e]: \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e[?] Please choose a value \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;service_type\u0026#34;\u003c/span\u003e [default: \u003cspan class=\"string\"\u003e\u0026#34;ClusterIP\u0026#34;\u003c/span\u003e]: \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e[✔] Created deploy/base/service.yml.j2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e[?] Please choose a value \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;namespace_name\u0026#34;\u003c/span\u003e [default: \u003cspan class=\"string\"\u003e\u0026#34;prod\u0026#34;\u003c/span\u003e]: \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e[✔] Created deploy/vars/main.yml\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e[✔] Successfully executed the project template sensespring \u003cspan class=\"keyword\"\u003ein\u003c/span\u003e /tmp/xpath\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\n\n\u003ch3 id=\"dockerfile\"\u003e\u003ca href=\"#dockerfile\" class=\"headerlink\" title=\"dockerfile\"\u003e\u003c/a\u003edockerfile\u003c/h3\u003e\u003cp\u003e通过上面的使用，为了减少对环境的依赖，可以将模板文件打包到镜像中，这样开发同学就可以直接使用镜像进行生成，还是很方便的\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eFROM alpine:latest\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eRUN apk add --no-cache tzdata bash ca-certificates\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eADD boilr /usr/local/bin/boilr\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eRUN \u003cspan class=\"built_in\"\u003emkdir\u003c/span\u003e -p /root/.config/boilr \u0026amp;\u0026amp; \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"built_in\"\u003echmod\u003c/span\u003e +x /usr/local/bin/boilr\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eADD templates /root/.config/boilr/templates\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eWORKDIR /tmp\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eENTRYPOINT [ \u003cspan class=\"string\"\u003e\u0026#34;boilr\u0026#34;\u003c/span\u003e, \u003cspan class=\"string\"\u003e\u0026#34;template\u0026#34;\u003c/span\u003e, \u003cspan class=\"string\"\u003e\u0026#34;use\u0026#34;\u003c/span\u003e, \u003cspan class=\"string\"\u003e\u0026#34;your-template\u0026#34;\u003c/span\u003e, \u003cspan class=\"string\"\u003e\u0026#34;/tmp/xpath\u0026#34;\u003c/span\u003e ]\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# docker build\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e#   docker build --no-cache -t xgenerator:v0.1 .\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# docker run\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e#   docker run -it -v /tmp/xpath:/tmp/xpath --rm 1f6d7ed63c0a\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e通过这种方式，如果模板后续有变动，也可以通过调整镜像的方式推送到开发同学手中，很容易维护，在CI/CD中又打通了一环\u003c/p\u003e\n\u003ch3 id=\"源码分析\"\u003e\u003ca href=\"#源码分析\" class=\"headerlink\" title=\"源码分析\"\u003e\u003c/a\u003e源码分析\u003c/h3\u003e\u003cp\u003eboilr的源码还是非常清楚的，可能是因为逻辑相对比较简单，本人不是专业开发，理解起来也不是很难.\u003c/p\u003e\n\u003ch3 id=\"参考文章\"\u003e\u003ca href=\"#参考文章\" class=\"headerlink\" title=\"参考文章:\"\u003e\u003c/a\u003e\u003cstrong\u003e参考文章:\u003c/strong\u003e\u003c/h3\u003e\u003cblockquote\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/tmrts/boilr\"\u003ehttps://github.com/tmrts/boilr\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/littlemanco/boilr-k8sdeployment/blob/master/README.rst\"\u003ehttps://github.com/littlemanco/boilr-k8sdeployment/blob/master/README.rst\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/littlemanco/boilr-k8sservice/blob/master/README.rst\"\u003ehttps://github.com/littlemanco/boilr-k8sservice/blob/master/README.rst\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"转载请注明原作者-周淑科-https-izsk-me\"\u003e\u003ca href=\"#转载请注明原作者-周淑科-https-izsk-me\" class=\"headerlink\" title=\"转载请注明原作者: 周淑科(https://izsk.me)\"\u003e\u003c/a\u003e\u003cstrong\u003e转载请注明原作者: 周淑科(\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://izsk.me/\"\u003ehttps://izsk.me\u003c/a\u003e)\u003c/strong\u003e\u003c/h3\u003e\n      \n    \u003c/div\u003e",
  "Date": "2020-12-26T22:50:53+08:00",
  "Author": "Z.S.K."
}