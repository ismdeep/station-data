{
  "Source": "liam.page",
  "Title": "使 LaTeX 文稿中的 URL 正确换行",
  "Link": "https://liam.page/2017/05/17/help-the-url-command-from-hyperref-to-break-at-line-wrapping-point/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\n\n      \n        \u003cp\u003e大部分稍有经验的 LaTeX 用户，都知道使用 \u003ccode\u003e\\url\u003c/code\u003e 命令在 LaTeX 文稿中插入 URL。更资深一些的用户，会使用 \u003ccode\u003ehyperref\u003c/code\u003e 宏包，而不是过时的 \u003ccode\u003eurl\u003c/code\u003e 宏包来处理。\u003c/p\u003e\n\u003cp\u003e然而，不论是否资深，大多数用户应该都有遇到过 LaTeX 无法正确对 URL 进行折行的问题。此篇介绍一下如何处理。\u003c/p\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\n\u003cp\u003eTeX 对于断行和分页，是有专门的算法处理的。通常而言，如果一个单词（一整个 \u003ccode\u003e\\url\u003c/code\u003e 可以看做是一个单词），TeX 不知道从何处进行分词，那么 TeX 就不会在这个单词上断行。对于很长的单词，比如一个 \u003ccode\u003e\\url\u003c/code\u003e，如果 TeX 不能在此处断行，而它又处于某一行的末尾，就很容易出现 overful box。\u003c/p\u003e\n\u003cp\u003e因此，本质上，这个问题需要让 \u003ccode\u003e\\url\u003c/code\u003e 命令，知道我们允许在何处断行。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ehyperref\u003c/code\u003e 宏包提供了两个宏，\u003ccode\u003e\\UrlBreaks\u003c/code\u003e 以及 \u003ccode\u003e\\UrlBigBreaks\u003c/code\u003e，用于告知 TeX，用户允许在何处截断 URL 以便换行。二者有一些细微的差别，但此处按下不表——大多数读者只需要使用 \u003ccode\u003e\\UrlBreaks\u003c/code\u003e 即可。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\documentclass\u003c/span\u003e{article}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\usepackage\u003c/span\u003e{hyperref}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\makeatletter\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\def\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\UrlAlphabet\u003c/span\u003e{\u003cspan class=\"comment\"\u003e%\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e      \u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\a\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\b\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\c\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\d\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\e\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\f\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\g\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\h\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\i\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\j\u003c/span\u003e\u003cspan class=\"comment\"\u003e%\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e      \u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\k\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\l\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\m\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\n\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\o\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\p\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\q\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\r\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\s\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\t\u003c/span\u003e\u003cspan class=\"comment\"\u003e%\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e      \u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\u\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\v\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\w\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\x\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\y\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\z\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\A\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\B\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\C\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\D\u003c/span\u003e\u003cspan class=\"comment\"\u003e%\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e      \u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\E\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\F\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\G\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\H\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\I\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\J\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\K\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\L\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\M\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\N\u003c/span\u003e\u003cspan class=\"comment\"\u003e%\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e      \u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\O\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\P\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\Q\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\R\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\S\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\T\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\U\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\V\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\W\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\X\u003c/span\u003e\u003cspan class=\"comment\"\u003e%\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e      \u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\Y\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\Z\u003c/span\u003e}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\def\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\UrlDigits\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\1\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\2\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\3\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\4\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\5\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\6\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\7\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\8\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\9\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\do\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\0\u003c/span\u003e}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\g@addto@macro\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\UrlBreaks\u003c/span\u003e}{\u003cspan class=\"keyword\"\u003e\\UrlOrds\u003c/span\u003e}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\g@addto@macro\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\UrlBreaks\u003c/span\u003e}{\u003cspan class=\"keyword\"\u003e\\UrlAlphabet\u003c/span\u003e}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\g@addto@macro\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\UrlBreaks\u003c/span\u003e}{\u003cspan class=\"keyword\"\u003e\\UrlDigits\u003c/span\u003e}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\makeatother\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\begin\u003c/span\u003e{document}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\url\u003c/span\u003e{\u003cspan class=\"link\"\u003ehttp://foo.bar.com/documentclassarticleusepackagehyperrefbegindocumenturlenddocument\u003c/span\u003e}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\end\u003c/span\u003e{document}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e在这里，\u003ccode\u003e\\UrlOrds\u003c/code\u003e 里记录了一些特殊符号（例如 \u003ccode\u003e-\u003c/code\u003e 和 \u003ccode\u003e_\u003c/code\u003e），而 \u003ccode\u003e\\UrlAlphabet\u003c/code\u003e 记录了 26 个英文字母的大小写，\u003ccode\u003e\\UrlDigits\u003c/code\u003e 则记录了 10 个阿拉伯数字。\u003c/p\u003e\n\u003cp\u003e而后，我们使用 LaTeX 内核提供的 \u003ccode\u003e\\g@addto@marco\u003c/code\u003e，依次将上述三个宏的内容，续接在 \u003ccode\u003e\\UrlBreaks\u003c/code\u003e 之后。这就是说，我们允许在上述所有字符处断行。\u003c/p\u003e\n\u003cp\u003e如此，编译出的结果也是符合预期的。\u003c/p\u003e\n\u003cp\u003e\u003cimg data-src=\"/uploads/images/LaTeX/url-linebreak.png\" alt=\"能够正确换行的 URL 示例\"/\u003e\u003c/p\u003e\n\n    \u003c/div\u003e",
  "Date": "2017-05-17T05:58:36Z",
  "Author": "Liam Huang"
}