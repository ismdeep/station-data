{
  "Source": "liam.page",
  "Title": "解决钉钉（DingTalk）在 macOS 上的权限问题",
  "Link": "https://liam.page/2020/06/29/Issues-of-Dingtalk-on-macOS/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\n\n      \n        \u003cp\u003e最近，因为各种原因，我先后两次需要给\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://anyi.im/\"\u003e悠悠\u003c/a\u003e在 macOS 上安装钉钉。但是，两次安装钉钉，悠悠都反映通过钉钉和别人语音、视频会议的时候，别人看不见她、听不见她、无法共享屏幕等问题。\u003c/p\u003e\n\u003cp\u003e归根究底，这都是钉钉在 macOS 上权限控制的问题。\u003c/p\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\n\u003ch2 id=\"权限管理在哪里\"\u003e\u003ca href=\"#权限管理在哪里\" class=\"headerlink\" title=\"权限管理在哪里\"\u003e\u003c/a\u003e权限管理在哪里\u003c/h2\u003e\u003cp\u003eGUI 下，macOS 的权限控制位于：\u003ccode\u003e系统偏好设置\u003c/code\u003e -\u0026gt; \u003ccode\u003e安全性与隐私\u003c/code\u003e -\u0026gt; \u003ccode\u003e隐私\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e\u003cimg data-src=\"/uploads/images/computer-skills/macOS-Privacy.jpg\"/\u003e\u003c/p\u003e\n\u003cp\u003e在隐私标签页中，我们可以看到有若干项涉及到隐私的权限控制。比如有\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e定位服务\u003c/li\u003e\n\u003cli\u003e通讯录\u003c/li\u003e\n\u003cli\u003e日历\u003c/li\u003e\n\u003cli\u003e提醒事项\u003c/li\u003e\n\u003cli\u003e照片\u003c/li\u003e\n\u003cli\u003e摄像头\u003c/li\u003e\n\u003cli\u003e麦克风\u003c/li\u003e\n\u003cli\u003e辅助功能\u003c/li\u003e\n\u003cli\u003e磁盘完全访问权限\u003c/li\u003e\n\u003cli\u003e屏幕录制\u003c/li\u003e\n\u003cli\u003e……\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"钉钉都要什么权限\"\u003e\u003ca href=\"#钉钉都要什么权限\" class=\"headerlink\" title=\"钉钉都要什么权限\"\u003e\u003c/a\u003e钉钉都要什么权限\u003c/h2\u003e\u003cp\u003e钉钉在语音会议时，会申请麦克风权限；在视频会议时，还会额外申请摄像头权限；在共享屏幕时，还会额外申请屏幕录制权限。\u003c/p\u003e\n\u003cp\u003e理论上，只要在安全性与隐私里的隐私标签页的相应项目中，勾上钉钉，它就能够正常工作。但因为某些不明的原因（——我猜这个锅得由钉钉的开发与测试来背），你可能会遇到：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e勾上了，但仍然某项功能仍然无法正常工作；\u003c/li\u003e\n\u003cli\u003e没勾上，但是相应项目中也没有钉钉这个候选项，所以想勾也勾不上。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"重置相应权限\"\u003e\u003ca href=\"#重置相应权限\" class=\"headerlink\" title=\"重置相应权限\"\u003e\u003c/a\u003e重置相应权限\u003c/h2\u003e\u003cp\u003emacOS 提供了 \u003ccode\u003etccutil\u003c/code\u003e 这个命令行程序来重置隐私设置。为此，你需要首先退出钉钉，并将其更新到官网的最新版本；而后打开终端（Terminal），然后键入命令：\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003esudo tccutil reset Microphone\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esudo tccutil reset Camera\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esudo tccutil reset ScreenCapture\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e这里，\u003ccode\u003esudo\u003c/code\u003e 是为了获取系统最高权限——\u003ccode\u003eroot\u003c/code\u003e 用户权限。这是因为，隐私设置的数据库，默认不允许普通用户访问。这里我们通过 \u003ccode\u003etccutil reset\u003c/code\u003e 依次重置了麦克风、摄像头、屏幕录制的隐私设置。\u003c/p\u003e\n\u003cp\u003e此时，再打开钉钉，发起视频会议，钉钉就会弹窗申请麦克风和摄像头的权限。你只需要在弹出的对话框中点击「好」，就能自动赋予钉钉相应权限。\u003c/p\u003e\n\u003cp\u003e共享桌面所需的屏幕录制权限则有些复杂。当你在视频会议状态，选择共享桌面时，钉钉确实会发起权限申请。但你不能直接点击「好」，而需要打开系统偏好设置，进入安全性与隐私的隐私标签页，找到屏幕录制，再给钉钉打上勾。但不幸的是，就算你这样操作，钉钉仍然没有该项权限。\u003c/p\u003e\n\u003cp\u003e实验后，我发现正确的做法：不是通过视频会议的共享桌面功能触发权限申请，而是通过另一个同样需要该项权限的功能——截图——来触发权限申请。你只需要找到任意联系人，进入对话状态后，点击小剪刀进行截图，然后再赋予权限，即可正常激活钉钉的屏幕录制权限。\u003c/p\u003e\n\u003cp\u003e做完这些之后，你只需要重启钉钉，就应该能正常使用语音、视频会议，并且能够正常地在会议中共享桌面了。\u003c/p\u003e\n\u003ch2 id=\"万一操作失误了怎么办\"\u003e\u003ca href=\"#万一操作失误了怎么办\" class=\"headerlink\" title=\"万一操作失误了怎么办\"\u003e\u003c/a\u003e万一操作失误了怎么办\u003c/h2\u003e\u003cp\u003e请继续在终端当中执行下列命令，然后重新赋予权限：\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003esudo tccutil reset Microphone\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esudo tccutil reset Camera\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esudo tccutil reset ScreenCapture\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n    \u003c/div\u003e",
  "Date": "2020-06-29T10:19:55Z",
  "Author": "Liam Huang"
}