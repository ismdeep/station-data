{
  "Source": "liam.page",
  "Title": "LaTeX 中的浮动体：基础篇",
  "Link": "https://liam.page/2017/03/11/floats-in-LaTeX-basic/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\n\n      \n        \u003cp\u003e此篇介绍一下 LaTeX 中的浮动体基本概念，以及最常见的几个问题。\u003c/p\u003e\n\u003ch2 id=\"浮动体是什么\"\u003e\u003ca href=\"#浮动体是什么\" class=\"headerlink\" title=\"浮动体是什么\"\u003e\u003c/a\u003e浮动体是什么\u003c/h2\u003e\u003cp\u003e在实际撰写文稿的过程中，我们可能会碰到一些占据篇幅较大，但同时又不方便分页的内容。（比如图片和表格，通常属于这样的类型）此时，我们通常会希望将它们\u003cstrong\u003e放在别的地方\u003c/strong\u003e，避免页面空间不够而强行置入这些内容导致 overfull vbox 或者大片的空白。此外，因为被放在别的地方，所以，我们通常需要对这些内容做一个\u003cstrong\u003e简单的描述\u003c/strong\u003e，确保读者在看到这些大块的内容时，不至于无从下手去理解。同时，因为此类内容被放在别的地方，所以在文中引述它们时，我们无法用「下图」、「上表」之类的相对位置来引述他们。于是，我们需要对它们进行编号，方便在文中引用。\u003c/p\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\n\u003cp\u003e注意到，使用浮动体的根本目的是\u003cstrong\u003e避免不合理的分页或者大块的空白\u003c/strong\u003e，为此，我们需要\u003cstrong\u003e将大块的内容移至别的地方\u003c/strong\u003e。与之相辅相成的是浮动体的一些特性：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e是一个容器，包含某些不可分页的大块内容；\u003c/li\u003e\n\u003cli\u003e有一个简短的描述，比如图题或者表题；\u003c/li\u003e\n\u003cli\u003e有一个编号，用于引述。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e在 LaTeX 中，默认有 \u003ccode\u003efigure\u003c/code\u003e 和 \u003ccode\u003etable\u003c/code\u003e 两种浮动体。（当然，你还可以自定义其他类型的浮动体）在这些环境中，可以用 \u003ccode\u003e\\caption{}\u003c/code\u003e 命令生成上述简短的描述。至于编号，也是用 \u003ccode\u003e\\caption{}\u003c/code\u003e 生成的。这类编号遵循了 TeX 对于编号处理的传统：它们会自动编号，不需要用户操心具体的编号数值。\u003c/p\u003e\n\u003cp\u003e至于「别的地方」是哪里，LaTeX 为浮动体启用了所谓「位置描述符」的标记。基本来说，包含以下几种\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eh\u003c/code\u003e - 表示 here。此类浮动体称为文中的浮动体（in-text floats）。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003et\u003c/code\u003e - 表示 top。此类浮动体会尝试放在一页的顶部。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eb\u003c/code\u003e - 表示 bottom。此类浮动体会尝试放在一页的底部。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ep\u003c/code\u003e - 表示 float page，浮动页。此类浮动体会尝试单独成页。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eLaTeX 会将浮动体与文本流分离，而后按照位置描述符，根据相应的算法插入 LaTeX 认为合适的位置。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003cfigcaption\u003e\u003cspan\u003e一个简单的实例\u003c/span\u003e\u003c/figcaption\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\documentclass\u003c/span\u003e{article}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\begin\u003c/span\u003e{document}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eFigure \u003cspan class=\"keyword\"\u003e\\ref\u003c/span\u003e{fig:dummy} is a dummy figure to show the use of basic floats in \u003cspan class=\"keyword\"\u003e\\LaTeX\u003c/span\u003e{}.\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\begin\u003c/span\u003e{figure}[htb]\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\rule\u003c/span\u003e{4cm}{3cm} \u003cspan class=\"comment\"\u003e% a black box, treat it as a dummy figure\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\caption\u003c/span\u003e{Dummy figure}\u003cspan class=\"keyword\"\u003e\\label\u003c/span\u003e{fig:dummy}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\end\u003c/span\u003e{figure}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\end\u003c/span\u003e{document}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch2 id=\"限制浮动效果\"\u003e\u003ca href=\"#限制浮动效果\" class=\"headerlink\" title=\"限制浮动效果\"\u003e\u003c/a\u003e限制浮动效果\u003c/h2\u003e\u003cp\u003e有些强（chu）迫（nv）症（zuo）宝宝希望保留浮动体的标题以及编号的功能，但是希望浮动体「乖乖待在插入的位置」。\u003c/p\u003e\n\u003cp\u003e对于这些小朋友，老夫必须说：「这是病，得治」。\u003c/p\u003e\n\u003cp\u003e说它是「病」，是因为浮动效果本身是好的；相反，禁止浮动效果，可能导致页面出现大片的空白。另一方面，这些小朋友希望浮动体待在原地，很可能是习惯了「下图」、「上表」这样的引述方式；而没有使用科技论文标准的「图 1」、「表 2」的引述方式。\u003c/p\u003e\n\u003cp\u003e因此，老夫墙裂建议各位小朋友，不要管它，随它浮动去吧。\u003c/p\u003e\n\u003cp\u003e当然，在一些极端的情况，也会出现 LaTeX 无法很好地处理浮动体放置位置的情况。这时候需要我们做一些辅助工作，帮助和限制 LaTeX 的浮动算法。\u003c/p\u003e\n\u003cp\u003e如果希望避免浮动体跨过 \u003ccode\u003e\\section\u003c/code\u003e 等章节标题，可以使用 \u003ccode\u003eplaceins\u003c/code\u003e 宏包。它能在章节标题前，强制输出上一章节中尚未输出的浮动体。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\usepackage\u003c/span\u003e[section]{placeins}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e如果希望彻底禁止某个浮动体的浮动效果，可以使用 \u003ccode\u003efloat\u003c/code\u003e 宏包提供的 \u003ccode\u003eH\u003c/code\u003e 位置选项。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\usepackage\u003c/span\u003e{float}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e% ...\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\begin\u003c/span\u003e{figure}[H]\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e% ...\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\begin\u003c/span\u003e{table}[H]\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e% ...\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch2 id=\"浮动体过多报错\"\u003e\u003ca href=\"#浮动体过多报错\" class=\"headerlink\" title=\"浮动体过多报错\"\u003e\u003c/a\u003e浮动体过多报错\u003c/h2\u003e\u003cp\u003eLaTeX 是有\u003cdel\u003e底线的\u003c/del\u003e上限的。LaTeX 会把所有尚未确定位置的浮动体，放入 \u003ccode\u003e\\@freelist\u003c/code\u003e 中暂存。而 \u003ccode\u003e\\@freelist\u003c/code\u003e 默认情况下，最多能处理 18 个浮动体。因此，在某些极端情况下，如果 LaTeX 暂时无法处理的浮动体数目超过 18 个时，就会报错。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e! LaTeX Error: Too many unprocessed floats.\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e此时有两种解决问题的思路：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e强制输出所有尚未确定位置的浮动体，清空 \u003ccode\u003e\\@freelist\u003c/code\u003e；\u003c/li\u003e\n\u003cli\u003e增强 LaTeX 的处理能力。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e对于第一种思路，我们可以用 \u003ccode\u003e\\clearpage\u003c/code\u003e，或者 \u003ccode\u003eplaceins\u003c/code\u003e 宏包提供的 \u003ccode\u003e\\FloatBarrier\u003c/code\u003e 命令。两个命令都会输出所有尚未输出的浮动体。不同的是，\u003ccode\u003e\\clearpage\u003c/code\u003e 会做一些额外的工作，比如另起一页，继续排版。个人建议使用 \u003ccode\u003e\\FloatBarrier\u003c/code\u003e 命令，遵循「一个命令只做好一件事」的原则。\u003c/p\u003e\n\u003cp\u003e如果使用了 \u003ccode\u003e\\FloatBarrier\u003c/code\u003e 命令，还是经常会报错提示未处理的浮动体过多，那么就要考虑第二种思路了。对于第二种思路，我们可以使用 \u003ccode\u003emorefloats\u003c/code\u003e 宏包。\u003ccode\u003e\\usepackage[morefloats = 18]{morefloats}\u003c/code\u003e，来增加 18 个槽位，以便能够向 \u003ccode\u003e\\@freelist\u003c/code\u003e 放入更多的浮动体。\u003c/p\u003e\n\u003cp\u003e在 2015 年，\u003ca target=\"_blank\" rel=\"noopener\" href=\"http://tex.stackexchange.com/users/1090/david-carlisle\"\u003eDavid Carlisle\u003c/a\u003e 在\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://www.latex-project.org/news/latex2e-news/ltnews22.pdf\"\u003e新版的 LaTeX2e (2015)\u003c/a\u003e 中实现了 \u003ccode\u003e\\extrafloats\u003c/code\u003e 命令，可以方便地新增更多的槽位。具体用法只需在导言区执行该命令即可：\u003ccode\u003e\\extrafloats{500}\u003c/code\u003e。\u003c/p\u003e\n\u003ch2 id=\"浮动体上下的垂直距离\"\u003e\u003ca href=\"#浮动体上下的垂直距离\" class=\"headerlink\" title=\"浮动体上下的垂直距离\"\u003e\u003c/a\u003e浮动体上下的垂直距离\u003c/h2\u003e\u003cp\u003e最近总有人不爽 LaTeX 浮动体与周围文本的默认间距。LaTeX 浮动体相关的定义都可以在 \u003ccode\u003esource2e\u003c/code\u003e 当中找到，这里罗列重要的间距如下。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e\\floatsep\u003c/code\u003e - 相邻两个浮动体之间的垂直距离。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\textfloatsep\u003c/code\u003e - 页面中最后一个 \u003ccode\u003et\u003c/code\u003e 模式的浮动体与文本的间距；页面中第一个 \u003ccode\u003eb\u003c/code\u003e 模式的浮动体与文本的间距。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\intextsep\u003c/code\u003e - 页面中共 \u003ccode\u003eh\u003c/code\u003e 模式的浮动体上下与文本的间距。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e因此，你可以通过 \u003ccode\u003e\\setlength\u003c/code\u003e 命令修改上述三个垂直距离，以便调整浮动体与前后文本的距离了。\u003c/p\u003e\n\n    \u003c/div\u003e",
  "Date": "2017-03-11T07:34:10Z",
  "Author": "Liam Huang"
}