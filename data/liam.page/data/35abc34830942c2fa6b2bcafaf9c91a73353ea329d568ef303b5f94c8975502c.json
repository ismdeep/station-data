{
  "Source": "liam.page",
  "Title": "在 TeX Live 测试期间跨版本更新宏包",
  "Link": "https://liam.page/2015/06/02/fake-tlpretest-to-update-packages/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\n\n      \n        \u003cp\u003eTeX Live 是由国际 TeX 用户组（TUG）维护的 TeX 发行版，一般被认为是 TeX 发行版的「正统」，具有稳定、更新快、维护足的特点。\u003c/p\u003e\n\u003cp\u003e不过，使用 TeX Live 也有麻烦的地方——TeX Live 每年都更新，而更新版本之后旧版本就无法再从 CTAN 上自动更新宏包。这样一来，TeX Live 用户就不得不每年都重新安装一次，相当麻烦。而且，在新版测试期间更新的宏包，旧版本的用户就无法通过 \u003ccode\u003etlmgr\u003c/code\u003e 来更新了。对于中国的用户而言，TeX Live 2014 向 TeX Live 2015 的过渡期尤为难熬，因为 \u003ca href=\"/2015/05/16/ctex-20-released/\"\u003eCTeX 宏集的新版本\u003c/a\u003e 发布了。\u003c/p\u003e\n\u003cp\u003e这篇文章中，我将介绍如何在旧版本的 TeX Live 中跨版本更新宏包。\u003c/p\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\n\u003ch2 id=\"原理\"\u003e\u003ca href=\"#原理\" class=\"headerlink\" title=\"原理\"\u003e\u003c/a\u003e原理\u003c/h2\u003e\u003cp\u003e虽然听上去麻烦，但实际上还是还是很简单的。\u003c/p\u003e\n\u003cp\u003e默认情况下，TeX Live 通过新建一个以年份数字为名的目录来区分当前的 TeX Live 版本。比如，对于安装了 TeX Live 2014 的用户，会有这样的目录结构：\u003c/p\u003e\n\u003cfigure class=\"highlight plaintext\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e- texlive\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e|- 2014\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e|- texmf-local\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e按照 TUG 的意图，如果用户在此基础上安装 TeX Live 2015，那么目录结构会变成：\u003c/p\u003e\n\u003cfigure class=\"highlight plaintext\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e- texlive\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e|- 2014\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e|- 2015\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e|- texmf-local\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cblockquote\u003e\n\u003cp\u003e这样做的好处是，用户可以自由地在不同版本之间切换，同时多个版本共用一个 \u003ccode\u003etexmf-local\u003c/code\u003e 目录（用户配置目录）。只是，对于大多数人的大多数情况来说，这是没有必要的。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e因此，为了将 TeX Live 2014 伪装成正在参与测试的 TeX Live 2015，我们首先要将目录名字修改成 \u003ccode\u003e2015\u003c/code\u003e。修改过目录之后，我们还需要正确处理 TeX 系统的二进制文件和系统 \u003ccode\u003ePATH\u003c/code\u003e 变量。在这之后，我们只需要将 \u003ccode\u003etlmgr\u003c/code\u003e 的远程仓库设置为 \u003ccode\u003etlpretest\u003c/code\u003e 仓库就好了。\u003c/p\u003e\n\u003ch2 id=\"实际操作看看\"\u003e\u003ca href=\"#实际操作看看\" class=\"headerlink\" title=\"实际操作看看\"\u003e\u003c/a\u003e实际操作看看\u003c/h2\u003e\u003cp\u003e这里我们以 TeX Live 2014 升级到 TeX Live 2015 pretest 为例，未来版本的升级步骤与此类似。\u003c/p\u003e\n\u003cp\u003e对于 MacTeX 2014 用户，可以在终端下进行如此操作：\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003ecd\u003c/span\u003e /usr/local/texlive/\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esudo \u003cspan class=\"built_in\"\u003emv\u003c/span\u003e ./2014 ./2015\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003ecd\u003c/span\u003e ./2015/bin/x86_64-darwin\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esudo ./tlmgr option sys_bin /usr/texbin/\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esudo ./tlmgr path add\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esudo tlmgr option repository http://ctan.ijs.si/mirror/tlpretest/\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esudo tlmgr update --self --all\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e在这里：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e将工作目录切换到 \u003ccode\u003etexlive\u003c/code\u003e 目录\u003c/li\u003e\n\u003cli\u003e修改年份目录的名字，从 \u003ccode\u003e2014\u003c/code\u003e 修改为 \u003ccode\u003e2015\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e由于修改目录名字破坏了 TeX 系统的二进制文件和系统 \u003ccode\u003ePATH\u003c/code\u003e 之间的关联，在进行下一步操作之后，我们需要切换到二进制文件目录\u003c/li\u003e\n\u003cli\u003e运行当前目录下的 \u003ccode\u003etlmgr\u003c/code\u003e 工具，配置系统二进制文件的目录为 \u003ccode\u003e/usr/texbin/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e同样是运行当前目录下的 \u003ccode\u003etlmgr\u003c/code\u003e 工具，将 TeX 系统的二进制文件和系统 \u003ccode\u003ePATH\u003c/code\u003e 重新关联起来\u003c/li\u003e\n\u003cli\u003e将 \u003ccode\u003etlmgr\u003c/code\u003e 的远程仓库设置为 \u003ccode\u003etlpretest\u003c/code\u003e 仓库，因为已经配置好上述关联，所以不需要用 \u003ccode\u003e./\u003c/code\u003e 来指明当前目录\u003c/li\u003e\n\u003cli\u003e使用 \u003ccode\u003etlmgr\u003c/code\u003e 更新宏包和其他相关组件\u003c/li\u003e\n\u003c/ol\u003e\n\u003cblockquote\u003e\n\u003cp\u003e2020-03-29 更新：\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e你可能无需执行上述 4) 和 5) 两步，转而使用 \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://mirrors.tuna.tsinghua.edu.cn/tlpretest/update-tlmgr-latest.sh\"\u003e\u003ccode\u003eupdate-tlmgr-latest.sh\u003c/code\u003e 的 \u003ccode\u003etlpretest\u003c/code\u003e 版本\u003c/a\u003e。\u003c/li\u003e\n\u003cli\u003e清华大学 TUNA 镜像现已支持 \u003ccode\u003etlpretest\u003c/code\u003e，因此无需再使用国外的源：\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://mirrors.tuna.tsinghua.edu.cn/tlpretest/\"\u003ehttps://mirrors.tuna.tsinghua.edu.cn/tlpretest/\u003c/a\u003e。\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eLinux 系统的操作和 Mac OS X 下的操作基本相同，不再赘述。\u003c/p\u003e\n\u003cp\u003eWindows 用户的操作基本可以在图形界面下操作：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e首先进入 TeX Live 的安装目录\u003c/li\u003e\n\u003cli\u003e然后修改文件夹的名字\u003c/li\u003e\n\u003cli\u003e在系统设置中，修改 \u003ccode\u003ePATH\u003c/code\u003e 变量的值\u003c/li\u003e\n\u003cli\u003e然后打开命令提示符窗口（cmd）\u003c/li\u003e\n\u003cli\u003e执行命令 \u003ccode\u003etlmgr option repository http://ctan.ijs.si/mirror/tlpretest/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e执行命令 \u003ccode\u003etlmgr update --self --all\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n    \u003c/div\u003e",
  "Date": "2015-06-02T03:36:32Z",
  "Author": "Liam Huang"
}