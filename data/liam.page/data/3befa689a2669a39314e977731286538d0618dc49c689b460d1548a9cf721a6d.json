{
  "Source": "liam.page",
  "Title": "在 Windows 中抹除磁盘上所有已删除文件的痕迹",
  "Link": "https://liam.page/2019/09/16/safe-clean-all-data-on-disks-in-Windows/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\n\n      \n        \u003cp\u003e我们知道，在电脑上删除文件时，并不会真的删除数据，而仅仅是在文件系统中将相应文件的索引删除。哪怕是格式化，在「快速格式化」的情况下，也不会删除磁盘上的数据。这种删除/格式化的操作，有歹心的人是有可能恢复数据的。\u003c/p\u003e\n\u003cp\u003e因此，在某些情况下——例如归还借用的电脑时——我们会希望能够真正地「粉碎」文件，避免被人恢复敏感数据。\u003c/p\u003e\n\u003cp\u003e市面上有不少「粉碎文件」的工具。但：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e为了信息安全这件事情，专门安装第三方工具，这件事情本身就很吊诡；\u003c/li\u003e\n\u003cli\u003e如果要粉碎大量文件，同时保证全盘没有遗漏，这些第三方工具往往不可靠。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e这篇介绍用 Windows 自带的工具解决这个问题。\u003c/p\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\n\u003ch2 id=\"CIPHER\"\u003e\u003ca href=\"#CIPHER\" class=\"headerlink\" title=\"CIPHER\"\u003e\u003c/a\u003e\u003ccode\u003eCIPHER\u003c/code\u003e\u003c/h2\u003e\u003cp\u003eWindows 自带有名为 \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/cipher\"\u003e\u003ccode\u003eCIPHER\u003c/code\u003e\u003c/a\u003e 的工具。这个工具本身是用来在 NTFS 格式的磁盘上加密磁盘或磁盘上的文件的。不过，我们这里要用到它的 \u003ccode\u003e/w\u003c/code\u003e 参数。以下是这个参数的作用：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eRemoves data from available unused disk space on the entire volume. If you use the /w parameter, all other parameters are ignored. The directory specified can be located anywhere in a local volume. If it is a mount point or points to a directory in another volume, the data on that volume is removed.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e翻译：\u003ccode\u003ecipher /w:\u0026lt;directory\u0026gt;\u003c/code\u003e 移除卷上所有未使用的空间并忽略所有其他参数。这里，\u003ccode\u003e\u0026lt;directory\u0026gt;\u003c/code\u003e 可以是卷上的任意目录。如果该目录是其他卷的挂载点，则 \u003ccode\u003ecipher\u003c/code\u003e 将会移除被挂载的卷上的数据。\u003c/p\u003e\n\u003cp\u003e这个介绍有一点没介绍明白：具体怎样移除卷上的所有空间呢？作为一个用于加密的工具，「移除」的方法当然是很安全的啦。实际上，\u003ccode\u003ecipher /w:\u0026lt;directory\u0026gt;\u003c/code\u003e 会在磁盘上所有可用空间上，先全部写入 \u003ccode\u003e0x00\u003c/code\u003e，再全部写入 \u003ccode\u003e0xFF\u003c/code\u003e，再全部写入随机值。如此一来，磁盘上空闲空间里的内容，就变得难以恢复了。\u003c/p\u003e\n\u003ch2 id=\"批处理\"\u003e\u003ca href=\"#批处理\" class=\"headerlink\" title=\"批处理\"\u003e\u003c/a\u003e批处理\u003c/h2\u003e\u003cp\u003e今天写了一个 Windows 批处理脚本，利用 \u003ccode\u003ecipher /w\u003c/code\u003e 在所有磁盘的空闲空间上抹除数据。\u003c/p\u003e\n\u003cfigure class=\"highlight plaintext\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e@echo off\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003efor %%i in (A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z) do (\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  if exist %%i:\\ (\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    echo \u0026#34;will start to cipher %%i\u0026#34;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    cipher /w:%%i:\\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  )\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e)\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e在桌面上新建一个文本文件 \u003ccode\u003ecipher_disks.txt\u003c/code\u003e，将这些内容粘贴上去，而后修改后缀名为 \u003ccode\u003e.bat\u003c/code\u003e，即改名为 \u003ccode\u003ecipher_disks.bat\u003c/code\u003e。如此一来，只需双击该批处理脚本，即可抹除所有磁盘上的空闲空间中的数据了。\u003c/p\u003e\n\u003cp\u003e于是，在归还电脑时，只需先将个人数据/敏感文件全部删除，然后执行该批处理脚本即可。\u003c/p\u003e\n\n    \u003c/div\u003e",
  "Date": "2019-09-16T09:59:24Z",
  "Author": "Liam Huang"
}