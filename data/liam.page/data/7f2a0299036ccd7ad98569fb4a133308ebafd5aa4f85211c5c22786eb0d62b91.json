{
  "Source": "liam.page",
  "Title": "编写 iOS 越狱插件：从 NIC 中创建项目",
  "Link": "https://liam.page/2023/01/20/Build-an-iOS-Jailbreak-Tweak-init-project-from-NIC/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\n\n      \n        \u003cp\u003e安装好 Theos 之后，我们便可以开始编写插件了。第一步，我们可以利用 Theos 提供的 New Instance Creator（NIC）来创建一个项目模板。这样一来，很多基本信息的文件，我们就不用手工编辑了。\u003c/p\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\n\u003ch2 id=\"执行-NIC\"\u003e\u003ca href=\"#执行-NIC\" class=\"headerlink\" title=\"执行 NIC\"\u003e\u003c/a\u003e执行 NIC\u003c/h2\u003e\u003cp\u003e在安装好 Theos 的基础上，可以执行下列命令启动 NIC 程序。\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"variable\"\u003e$THEOS\u003c/span\u003e/bin/nic.pl\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e之后，NIC 会在终端上打印出一个列表，询问你想要创建何种类型的项目。\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e$ \u003cspan class=\"variable\"\u003e$THEOS\u003c/span\u003e/bin/nic.pl\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eNIC 2.0 - New Instance Creator\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e------------------------------\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  [1.] iphone/activator_event\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  [2.] iphone/activator_listener\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  [3.] iphone/application\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  [4.] iphone/application_swift\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  [5.] iphone/control_center_module-11up\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  [6.] iphone/cydget\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  [7.] iphone/flipswitch_switch\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  [8.] iphone/framework\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  [9.] iphone/library\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  [10.] iphone/notification_center_widget\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  [11.] iphone/notification_center_widget-7up\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  [12.] iphone/preference_bundle\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  [13.] iphone/preference_bundle_swift\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  [14.] iphone/theme\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  [15.] iphone/tool\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  [16.] iphone/tool_swift\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  [17.] iphone/tweak\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  [18.] iphone/tweak_with_simple_preferences\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  [19.] iphone/xpc_service\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  [20.] iphone/xpc_service_modern\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eChoose a Template (required):\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e我们主要关注的是其中的 \u003ccode\u003eiphone/tweak\u003c/code\u003e 和 \u003ccode\u003eiphone/tweak_with_simple_preferences\u003c/code\u003e。后者会构造一个 \u003ccode\u003ePreferences.plist\u003c/code\u003e 文件，以便我们能在 iOS 的系统设置中配置该插件的行为。\u003c/p\u003e\n\u003cp\u003e这里我们选择 18。接下来，NIC 会交互式地要求我们键入一些插件的信息。\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eChoose a Template (required): 18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eProject Name (required): PhantomSteps\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003ePackage Name [com.yourcompany.phantomsteps]: page.liam.phantom_steps\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eAuthor/Maintainer Name [Liam Huang]:\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e[iphone/tweak_with_simple_preferences] MobileSubstrate Bundle filter [com.apple.springboard]: com.apple.Health\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e[iphone/tweak_with_simple_preferences] List of applications to terminate upon installation (space-separated, \u003cspan class=\"string\"\u003e\u0026#39;-\u0026#39;\u003c/span\u003e \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e none) [SpringBoard]: com.apple.Health\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eInstantiating iphone/tweak_with_simple_preferences \u003cspan class=\"keyword\"\u003ein\u003c/span\u003e phantomsteps/...\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eDone.\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e这里，我们给项目起名为 \u003ccode\u003ePhantomSteps\u003c/code\u003e，其包名称为 \u003ccode\u003epage.liam.phantom_steps\u003c/code\u003e。你可以按需修改。MobileSubstrate Bundle filter 这一项是说，你可能影响的 App 的名字。List of applications to terminate upon installation 这一项则是说，在安装你的插件时，需要杀死的程序的名字。\u003c/p\u003e\n\u003ch2 id=\"目录结构\"\u003e\u003ca href=\"#目录结构\" class=\"headerlink\" title=\"目录结构\"\u003e\u003c/a\u003e目录结构\u003c/h2\u003e\u003cp\u003e创建成功后，目录结构应该类似\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e$ tree .\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e.\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e├── Makefile\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e├── PhantomSteps.plist\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e├── Tweak.x\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e├── control\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e└── layout\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    └── Library\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        └── PreferenceLoader\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            └── Preferences\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                └── PhantomSteps\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                    └── Preferences.plist\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5 directories, 5 files\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e这里\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ePhantomSteps.plist\u003c/code\u003e 记录了需要杀死的包的名称。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003econtrol\u003c/code\u003e 包含了先前在 NIC 交互式环境中填写的信息。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eMakefile\u003c/code\u003e 是对应 GNU make 的文件。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eTweak.x\u003c/code\u003e 是插件自身的代码。Theos 会从模板中创建一个带有各种注释的文件供参考。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cblockquote\u003e\n\u003cp\u003e通过 NIC 模板创建的项目可见：\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/Liam0205/PhantomSteps/tree/c48a76ae16ea761b24bfa94524331a1b7523d0b0\"\u003eGitHub\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\n    \u003c/div\u003e",
  "Date": "2023-01-19T16:21:45Z",
  "Author": "Liam Huang"
}