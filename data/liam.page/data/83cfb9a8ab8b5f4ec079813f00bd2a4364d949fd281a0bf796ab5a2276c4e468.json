{
  "Source": "liam.page",
  "Title": "在 iOS 14.5.1/unc0ver 8.0.2 上解决电池用量信息无法载入的问题",
  "Link": "https://liam.page/2023/02/12/fix-battery-usage-graph-on-iOS-14-5-1-unc0ver-8-0-2/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\n\n      \n        \u003cp\u003e手头的 iOS 14.5.1 自使用 unc0ver 8.0.2 越狱起就一直困扰于无法正确载入电池用量信息。今日终于无法忍受这一问题，遂解决它。\u003c/p\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\n\n\u003ch2 id=\"原因\"\u003e\u003ca href=\"#原因\" class=\"headerlink\" title=\"原因\"\u003e\u003c/a\u003e原因\u003c/h2\u003e\u003cp\u003e经过一番检索，在 \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/SongXiaoXi\"\u003e@SongXiaoXi\u003c/a\u003e 的\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/LinusHenze/Fugu14/pull/242#issue-1242075829\"\u003e这篇帖子\u003c/a\u003e中找到了问题的原因。具体来说，Fugu14 在越狱过程中，将用户名 \u003ccode\u003e_analyticsd\u003c/code\u003e 改为了 \u003ccode\u003e_nanalyticsd\u003c/code\u003e，但其 ID 和 \u003ccode\u003e$HOME\u003c/code\u003e 则保持不变。但随后其他的某个守护进程将 \u003ccode\u003e/private/var/db/analyticsd\u003c/code\u003e 及其子目录的所有者改为了 \u003ccode\u003e_analyticsd\u003c/code\u003e（ID 变更为 \u003ccode\u003e264\u003c/code\u003e）。这造成 \u003ccode\u003e_analyticsd.back\u003c/code\u003e 以 \u003ccode\u003e263\u003c/code\u003e 启动时无法读取 \u003ccode\u003e/private/var/db/analyticsd\u003c/code\u003e 下的数据库信息，导致电池用量信息无法渲染。\u003c/p\u003e\n\u003ch2 id=\"解决\"\u003e\u003ca href=\"#解决\" class=\"headerlink\" title=\"解决\"\u003e\u003c/a\u003e解决\u003c/h2\u003e\u003cp\u003e解决起来也很简单。我写了一个插件来完成所有需要的工作。你需要添加以下两个源，然后搜索安装 \u003ccode\u003eFixBetteryUsageFugu14\u003c/code\u003e：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ehttps://liam.page/apt/\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ehttps://liam.page/apt-beta/\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e插件会在每次 SpringBoard 启动时执行一些 Shell 命令。\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e你也可以手工执行这些命令观察其效果。但请确认你知道每一步在做什么之后再操作。\u003c/p\u003e\n\u003cp\u003e首先，你需要在 Cydia/Zebra 等包管理器中安装 \u003ccode\u003efile-cmds\u003c/code\u003e 这一软件包。它提供了 \u003ccode\u003echflags\u003c/code\u003e 命令。（或者，对于高级用户，也可以考虑安装 \u003ca target=\"_blank\" rel=\"noopener\" href=\"http://newosxbook.com/tools/iOSBinaries.html\"\u003e\u003ccode\u003ebinpack64\u003c/code\u003e\u003c/a\u003e）。\u003c/p\u003e\n\u003cp\u003e而后，你需要在 iOS 命令行（或者 SSH 过去）中执行下列命令。\u003c/p\u003e\n\u003cfigure class=\"highlight bash\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta\"\u003e#!/usr/bin/env bash\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003ecd\u003c/span\u003e /var/mobile/Containers/Data/Fugu14Untether/Library/Caches/com.apple.dyld/\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003els\u003c/span\u003e -l\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esudo chflags -v noschg,nouchg *.closure\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esudo \u003cspan class=\"built_in\"\u003echown\u003c/span\u003e 263:263 *.closure\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esudo chflags -v schg,uchg *.closure\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003els\u003c/span\u003e -l\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003ecd\u003c/span\u003e /var/mobile/Containers/Data/Fugu14Untether\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003els\u003c/span\u003e -l\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esudo \u003cspan class=\"built_in\"\u003echown\u003c/span\u003e -h 263:263 /var/mobile/Containers/Data/Fugu14Untether/Library \u003cspan class=\"comment\"\u003e# 只修改 Library 这一 symlink 的所有者\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003els\u003c/span\u003e -l\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003ecd\u003c/span\u003e /var/db\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003els\u003c/span\u003e -l\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esudo \u003cspan class=\"built_in\"\u003echown\u003c/span\u003e -R 263:263 /var/db/analyticsd/\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003els\u003c/span\u003e -l\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esudo launchctl stop com.apple.analyticsd\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003esleep\u003c/span\u003e 3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esudo launchctl start com.apple.analyticsd\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003c/blockquote\u003e\n\n    \u003c/div\u003e",
  "Date": "2023-02-12T11:01:30Z",
  "Author": "Liam Huang"
}