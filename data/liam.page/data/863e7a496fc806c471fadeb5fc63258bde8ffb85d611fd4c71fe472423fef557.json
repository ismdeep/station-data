{
  "Source": "liam.page",
  "Title": "谈谈拉格朗日乘数法",
  "Link": "https://liam.page/2018/10/12/Lagrange-Multiplier-Method/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\n\n      \n        \u003cp\u003e拉格朗日乘数法是约瑟夫·拉格朗日（Joseph-Louis Lagrange）提出的关于多元函数在有若干等式约束条件情况下求解最优化问题的解法。由于它在最大熵模型中有应用，所以在谈最大熵模型之前，首先要讲讲拉格朗日乘数法。\u003c/p\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\n\u003ch2 id=\"最简情形下的拉格朗日乘数法\"\u003e\u003ca href=\"#最简情形下的拉格朗日乘数法\" class=\"headerlink\" title=\"最简情形下的拉格朗日乘数法\"\u003e\u003c/a\u003e最简情形下的拉格朗日乘数法\u003c/h2\u003e\u003ch3 id=\"描述\"\u003e\u003ca href=\"#描述\" class=\"headerlink\" title=\"描述\"\u003e\u003c/a\u003e描述\u003c/h3\u003e\u003cp\u003e现在假设说有自变量 $x$ 和 $y$，以及关于它们的二元函数 $f(x, y)$，另有关于它们的等式约束条件 $g(x, y) = c$。现在的问题是，求解函数 $f$ 在约束条件 $g = c$ 下的最大值或最小值。显然，这是一个最优化问题，可简记为（以求最大值为例）\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e$$ \\begin{aligned} \u0026amp;{}\\max f(x, y), \\\\ \u0026amp;{}\\text{s.t. } g(x, y) = c. \\end{aligned} $$\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e拉格朗日乘数法是说，上述问题可转化为求解拉格朗日函数在无约束条件下的极值求解问题，\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e$$ \\mathcal{L}(x, y, \\lambda) \\overset{\\text{def}}{=}f(x, y) + \\lambda\\cdot g(x, y). $$\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e亦即求解拉格朗日函数驻点的问题\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e$$ \\begin{cases} \\frac{\\partial \\mathcal{L}}{\\partial x} = 0, \\\\ \\frac{\\partial \\mathcal{L}}{\\partial y} = 0, \\\\ \\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = 0. \\end{cases} $$\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e这是关于 $x$, $y$ 和 $\\lambda$ 的方程组，而它的解可能不止一个。拉格朗日乘数法说明，原优化问题的解必然处于该方程组的解集之中，只需对比解集中的点 $(x, y)$ 在原函数 $f(x, y)$ 中的值，即可得到原函数在等式约束条件下的最值。\u003c/p\u003e\n\u003ch3 id=\"证明\"\u003e\u003ca href=\"#证明\" class=\"headerlink\" title=\"证明\"\u003e\u003c/a\u003e证明\u003c/h3\u003e\u003cp\u003e拉格朗日乘数法的证明不难，简单（并不完全严格但足以说明问题）证明如下：\u003c/p\u003e\n\u003cp\u003e设二元函数 $f(x, y)$ 在点 \u003ccode\u003e$(x_0, y_0)$\u003c/code\u003e 处有极值 $\\kappa$，并且在点 \u003ccode\u003e$(x_0, y_0)$\u003c/code\u003e 的领域内连续，则在点 \u003ccode\u003e$(x_0, y_0)$\u003c/code\u003e 处有\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e$$f(x_0, y_0) = \\kappa.$$\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e另有一作为等式约束条件的常值函数 $g(x, y) = c$。显然，两个函数在点 \u003ccode\u003e$(x_0, y_0)$\u003c/code\u003e 处的全微分有\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e$$ \\begin{aligned} \\mathrm{d}f =\u0026amp;{} \\frac{\\partial f}{\\partial x}\\mathrm{d}x + \\frac{\\partial f}{\\partial y}\\mathrm{d}y = 0, \\\\ \\mathrm{d}g =\u0026amp;{} \\frac{\\partial g}{\\partial x}\\mathrm{d}x + \\frac{\\partial g}{\\partial y}\\mathrm{d}y = 0. \\end{aligned} $$\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e考虑微分 $\\mathrm{d} x$ 和 $\\mathrm{d}y$ 是任意的无穷小量，故两个方程关于两个微分的系数应当成比例。这就是说\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e\\begin{equation} \\begin{cases} \\frac{\\partial f}{\\partial x} - \\lambda\\cdot\\frac{\\partial g}{\\partial x} = 0, \\\\ \\frac{\\partial f}{\\partial y} - \\lambda\\cdot\\frac{\\partial g}{\\partial y} = 0. \\end{cases}\\tag{*}\\label{star} \\end{equation}\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e二式相加并积分即得拉格朗日函数\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e$$ \\mathcal{L}(x, y, \\lambda) \\overset{\\text{def}}{=}f(x, y) + \\lambda\\cdot g(x, y). $$\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e这也就是说，原优化问题的解必然是拉格朗日函数的一个极值。\u003c/p\u003e\n\u003ch3 id=\"物理意义\"\u003e\u003ca href=\"#物理意义\" class=\"headerlink\" title=\"物理意义\"\u003e\u003c/a\u003e物理意义\u003c/h3\u003e\u003cp\u003e考虑函数 $f(x, y) = d$ 的图像。由于只有一个自由度，所以它是一条曲线。特别地，对于序列 \u003ccode\u003e$\\bigl\\{d_1, d_2, \\ldots\\bigr\\}$\u003c/code\u003e 来说，\u003ccode\u003e$f(x, y) = d_k$\u003c/code\u003e 形成了一系列的曲线。若将 \u003ccode\u003e$d_k$\u003c/code\u003e 理解为高度，则这一系列的曲线即是函数 $f(x, y)$ 的等高线组。同样，对于约束 $g(x, y) = c$ 来说它也是一条曲线，我们称之为约束曲线。\u003c/p\u003e\n\u003cp\u003e据此，可绘图如下（摘自\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://en.wikipedia.org/wiki/Lagrange_multiplier\"\u003e英文 Wikipedia\u003c/a\u003e）\u003c/p\u003e\n\u003cp\u003e\u003cimg data-src=\"/uploads/images/mathematics/lagrange_multiplier_method.jpg\"/\u003e\u003c/p\u003e\n\u003cp\u003e现在我们需要思考的是，等高线组和约束曲线满足什么条件时，我们可以说函数 $f$ 在条件 $g = c$ 的约束下取得极值。不难理解，等高线组中的一条等高线与约束曲线相切时，函数 $f$ 可能取得极值。反过来想想就很容易理解了，假设不相切时（即相交时）取得极值，例如说在图中 $f(x, y) = d_2$ 时取得极值。如此，从交点开始沿着约束曲线的两个方向滑动，都还能继续与其它等高线相交，这与 $f(x, y)$ 取得极值矛盾。因此 $f(x, y)$ 在约束下取得极值时，函数曲线必然与约束曲线相切。\u003c/p\u003e\n\u003cp\u003e函数曲线相切，意味着两个函数的法线在切点重合，也就是两个函数的法向量相差一个系数 $\\lambda$，这也就是说两个函数在切点的梯度向量相差一个系数 $\\lambda$，即 \u003ccode\u003e$\\Bigl(\\frac{\\partial f}{\\partial x}, \\frac{\\partial f}{\\partial y}\\Bigr) = \\lambda\\Bigl(\\frac{\\partial g}{\\partial x}, \\frac{\\partial g}{\\partial y}\\Bigr)$\u003c/code\u003e。这恰好是上述证明过程中的 (\\ref{star})-式的向量表示。\u003c/p\u003e\n\u003cp\u003e因此我们说，拉格朗日乘数法有很直观的物理意义。\u003c/p\u003e\n\u003ch2 id=\"推广到一般情形下的拉格朗日乘数法\"\u003e\u003ca href=\"#推广到一般情形下的拉格朗日乘数法\" class=\"headerlink\" title=\"推广到一般情形下的拉格朗日乘数法\"\u003e\u003c/a\u003e推广到一般情形下的拉格朗日乘数法\u003c/h2\u003e\u003cp\u003e现在假设说有自变量向量 \u003ccode\u003e$x_1$\u003c/code\u003e, \u003ccode\u003e$x_2$\u003c/code\u003e, ..., \u003ccode\u003e$x_n$\u003c/code\u003e，以及关于它们的 $n$ 元函数 \u003ccode\u003e$f(x_1, x_2, \\ldots, x_n)$\u003c/code\u003e，另有关于它们的一组等式约束条件 \u003ccode\u003e$\\bigl\\{g_j(x_1, x_2, \\ldots, x_n) = c_j\\bigr\\}_K$\u003c/code\u003e。现在的问题是，求解函数 $f$ 在约束条件组 \u003ccode\u003e$\\bigl\\{g_j = c_j\\bigr\\}_K$\u003c/code\u003e 下的最大值或最小值。它可以转化为求解拉格朗日函数在无约束条件下的极值求解问题，\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e$$ \\mathcal{L}(x_1, x_2, \\ldots, x_n, \\lambda_1, \\lambda_2, \\ldots, \\lambda_K) \\overset{\\text{def}}{=} f(x_1, x_2, \\ldots, x_n) + \\sum_{j = 1}^{K}\\lambda_jg_j(x_1, x_2, \\ldots, x_n). $$\u003c/code\u003e\u003c/p\u003e\n\n    \u003c/div\u003e",
  "Date": "2018-10-12T02:03:20Z",
  "Author": "Liam Huang"
}