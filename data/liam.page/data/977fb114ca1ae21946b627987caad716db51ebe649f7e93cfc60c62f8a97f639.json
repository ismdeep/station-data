{
  "Source": "liam.page",
  "Title": "CTeX 2.4.14：macOS 字体配置升级",
  "Link": "https://liam.page/2018/05/03/ctex-2-4-14-update-for-the-fontset-for-macOS/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\n\n      \n        \u003cp\u003e近日，CTeX 宏集已更新到 2.4.14 版本，本次更新主要是 macOS 字体配置的升级。在此为本次更新做一个注解。\u003c/p\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\n\u003ch2 id=\"起因\"\u003e\u003ca href=\"#起因\" class=\"headerlink\" title=\"起因\"\u003e\u003c/a\u003e起因\u003c/h2\u003e\u003cp\u003e近来陆续有用户提出 CTeX 宏集在 macOS 上罗马字族的加粗会变为黑体（见\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/CTeX-org/ctex-kit/issues/335\"\u003e这里\u003c/a\u003e和\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/CTeX-org/ctex-kit/issues/351\"\u003e这里\u003c/a\u003e），但在较新版的 macOS 中，宋体、黑体、楷书已有多个字重的字体配置，因此 macOS 上，CTeX 宏集的字体配置无需像 Windows 上那样以黑体作为粗宋体的妥协。\u003c/p\u003e\n\u003cp\u003e此即本次更新的起因。\u003c/p\u003e\n\u003ch2 id=\"经过\"\u003e\u003ca href=\"#经过\" class=\"headerlink\" title=\"经过\"\u003e\u003c/a\u003e经过\u003c/h2\u003e\u003cp\u003e参考知乎\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://www.zhihu.com/people/ShikiSuen/activities\"\u003e孫志貴\u003c/a\u003e的建议，结合\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/leo-liu\"\u003e刘海洋\u003c/a\u003e指出无衬线字体在 \u003ccode\u003ebeamer\u003c/code\u003e 内的实际使用情况，我们认为：对于默认的无衬线字体，应当更多地照顾屏显效果，而非是打印效果。因此，我们决定将默认的无衬线字体配置为 \u003ccode\u003ePingFang SC\u003c/code\u003e，并提供新的字体选择命令 \u003ccode\u003e\\pingfang\u003c/code\u003e；而对于过去的华文黑体，则在字体选择命令 \u003ccode\u003e\\heiti\u003c/code\u003e 中予以保留。此外，考虑到与 Windows 上字体命令的兼容性，我们还决定：在引入苹方黑体后，将字体选择命令 \u003ccode\u003e\\yahei\u003c/code\u003e 作为 macOS 平台上苹方黑体的别名。\u003c/p\u003e\n\u003cp\u003e考虑到苹方黑体在 El Capitan 才被引入系统，在 Yosemite 及之前的系统中则默认没有该字体，同时考虑到过去旧文档的兼容性，我们决定：对于 macOS/OS X，将字体配置区分为 \u003ccode\u003emacold\u003c/code\u003e 及 \u003ccode\u003emacnew\u003c/code\u003e。如此，一方面 CTeX 宏集可以根据苹方黑体是否存在于系统内自动在新旧两个版本的字体配置中选择，另一方面用户可自行指定 \u003ccode\u003emacold\u003c/code\u003e 字库，以保留和旧文档的兼容性。\u003c/p\u003e\n\u003cp\u003e据此，对于 \u003ccode\u003emacnew\u003c/code\u003e 有如下字体配置。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e26\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e27\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e28\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e29\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e30\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e%\u0026lt;*macnew\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\sys_if_engine_pdftex:TF\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  { \u003cspan class=\"keyword\"\u003e\\ctex_fontset_error:n\u003c/span\u003e { mac } }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003e\\sys_if_engine_uptex:TF\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e      { \u003cspan class=\"keyword\"\u003e\\ctex_fontset_error:n\u003c/span\u003e { mac } }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e      {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003e\\setCJKmainfont\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e          [\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e               UprightFont = *~Light,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                  BoldFont = *~Bold\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                ItalicFont = Kaiti~SC,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            BoldItalicFont = Kaiti~SC~Bold\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e          ] { Songti~SC }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003e\\setCJKsansfont\u003c/span\u003e { PingFang~SC }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003e\\setCJKmonofont\u003c/span\u003e { STFangsong }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003e\\setCJKfamilyfont\u003c/span\u003e { zhsong }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e          [\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e               UprightFont = *~Light,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                  BoldFont = *~Bold,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e          ] { Songti~SC }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003e\\setCJKfamilyfont\u003c/span\u003e { zhhei }  { Heiti~SC }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003e\\setCJKfamilyfont\u003c/span\u003e { zhpf }   { PingFang~SC }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003e\\setCJKfamilyfont\u003c/span\u003e { zhfs }   { STFangsong }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003e\\setCJKfamilyfont\u003c/span\u003e { zhkai }  { Kaiti~SC }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e      }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e%\u0026lt;/macnew\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e%\u0026lt;macnew\u0026gt;\\NewDocumentCommand \\yahei    { } { \\CJKfamily { zhpf } }\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e%\u0026lt;macnew\u0026gt;\\NewDocumentCommand \\pingfang { } { \\CJKfamily { zhpf } }\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch2 id=\"结果\"\u003e\u003ca href=\"#结果\" class=\"headerlink\" title=\"结果\"\u003e\u003c/a\u003e结果\u003c/h2\u003e\u003cp\u003e经过编码后，CTeX 宏集升级到 2.4.14 (2018/05/01) 版本，新增功能如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e将 macOS/OS X 上的字库配置区分 \u003ccode\u003emacold\u003c/code\u003e 及 \u003ccode\u003emacnew\u003c/code\u003e；\u003c/li\u003e\n\u003cli\u003e默认情况下若检测到操作系统为 macOS/OS X，或经用户设置 \u003ccode\u003efontset = mac\u003c/code\u003e，则 CTeX 宏集将根据 \u003ccode\u003e/System/Library/Fonts/PingFang.ttc\u003c/code\u003e 的存在性载入 \u003ccode\u003emacold\u003c/code\u003e 或 \u003ccode\u003emacnew\u003c/code\u003e 的字库配置；\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emacold\u003c/code\u003e 的字库配置和旧版本中 \u003ccode\u003emac\u003c/code\u003e 的字库配置完全相同；\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emacnew\u003c/code\u003e 的字库配置中\u003cul\u003e\n\u003cli\u003e默认罗马字族（\u003ccode\u003e\\rmfamily\u003c/code\u003e）\u003cul\u003e\n\u003cli\u003e以 \u003ccode\u003eSongti~SC~Light\u003c/code\u003e 为 \u003ccode\u003e\\mdseries\u003c/code\u003e 字重；\u003c/li\u003e\n\u003cli\u003e以 \u003ccode\u003eSongti~SC~Bold\u003c/code\u003e 为 \u003ccode\u003e\\bfseries\u003c/code\u003e 字重；\u003c/li\u003e\n\u003cli\u003e以 \u003ccode\u003eKaiti~SC\u003c/code\u003e 为 \u003ccode\u003e\\itshape\u003c/code\u003e 字形；\u003c/li\u003e\n\u003cli\u003e以 \u003ccode\u003eKaiti~SC~Bold\u003c/code\u003e 为 \u003ccode\u003e\\itshape\\bfseries\u003c/code\u003e 字形字重之组合。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e默认无衬线字族（\u003ccode\u003e\\sffamily\u003c/code\u003e）以 \u003ccode\u003ePingFang~SC\u003c/code\u003e 取代过去的 \u003ccode\u003eSTXihei\u003c/code\u003e/\u003ccode\u003eSTHeiti\u003c/code\u003e 组合\u003c/li\u003e\n\u003cli\u003eCJK 字族 \u003ccode\u003ezhsong\u003c/code\u003e 以 \u003ccode\u003eSongti~SC\u003c/code\u003e 取代过去的 \u003ccode\u003eSTSong\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eCJK 字族 \u003ccode\u003ezhhei\u003c/code\u003e 以 \u003ccode\u003eHeiti~SC\u003c/code\u003e 取代过去的 \u003ccode\u003eSTHeiti\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eCJK 字族 \u003ccode\u003ezhkai\u003c/code\u003e 以 \u003ccode\u003eKaiti~SC\u003c/code\u003e 取代过去的 \u003ccode\u003eSTKaiti\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e新增 CJK 字族 \u003ccode\u003ezhpf\u003c/code\u003e，作为字体命令 \u003ccode\u003e\\yahei\u003c/code\u003e 和 \u003ccode\u003e\\pingfang\u003c/code\u003e 选择的字族\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e新版本的 CTeX 宏集\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://www.ctan.org/pkg/ctex\"\u003e已发布到 CTAN\u003c/a\u003e，预计将于 2018/05/04 前后可经由 \u003ccode\u003etlmgr\u003c/code\u003e/\u003ccode\u003empm\u003c/code\u003e 更新。\u003c/p\u003e\n\n    \u003c/div\u003e",
  "Date": "2018-05-03T02:48:37Z",
  "Author": "Liam Huang"
}