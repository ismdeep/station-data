{
  "Source": "liam.page",
  "Title": "TeX 主题选讲：盒子",
  "Link": "https://liam.page/2018/05/21/TeX-by-Topic-boxes/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\n\n      \n        \u003cblockquote\u003e\n\u003cp\u003e此篇基本上是译文，原文是 Victor Eijkhout 所著的《TeX by Topic》的第五章。译文项目参见：\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/CTeX-org/tex-by-topic-cn/releases/latest\"\u003eCTeX-org/tex-by-topic-cn\u003c/a\u003e。\u003cbr/\u003e转载请保留本段文字，尊重原作者和译者版权。\u003cbr/\u003e由于原著使用 GFDL，故而本文也被传染地同样使用 GFDL 许可，而不是本站默认的 BY-NC-SA 4.0 许可。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eTeX 中的水平与竖直盒子分别是水平与竖直列表内容的容器。盒子可保存在盒子寄存器当中。本章讨论盒子寄存器，以及关于盒子尺寸、盒子内容相互位置的问题。\u003c/p\u003e\n\u003cp\u003e所涉命令编目：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e\\hbox\u003c/code\u003e： 构造一个水平盒子。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\vbox\u003c/code\u003e： 构造一个竖直盒子，其参考点（reference point）是最后一个元素。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\vtop\u003c/code\u003e： 构造一个竖直盒子，其参考点是第一个元素。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\vcenter\u003c/code\u003e： 构造一个在竖直方向于数学轴（math axis）居中的竖直盒子；该命令仅在数学模式下使用。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\vsplit\u003c/code\u003e： 将竖直盒子顶部部分分离。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\box\u003c/code\u003e： 使用盒子寄存器，而后清空它。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\setbox\u003c/code\u003e： 将盒子赋值给一个盒子寄存器。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\copy\u003c/code\u003e： 使用盒子寄存器，但保留其中内容而不清空。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\ifhbox\u003c/code\u003e \u003ccode\u003e\\ifvbox\u003c/code\u003e： 判断盒子寄存器中保存的是水平盒子还是竖直盒子。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\ifvoid\u003c/code\u003e： 判断盒子寄存器是否为空。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\newbox\u003c/code\u003e： 分配新的盒子寄存器。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\unhbox\u003c/code\u003e \u003ccode\u003e\\unvbox\u003c/code\u003e： 将保存有水平盒子或竖直盒子的寄存器解包，并将其中内容追加到当前的水平列表或竖直列表中，而后清空寄存器。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\unhcopy\u003c/code\u003e \u003ccode\u003e\\unvcopy\u003c/code\u003e： 与 \u003ccode\u003e\\unhbox\u003c/code\u003e、\u003ccode\u003e\\unvbox\u003c/code\u003e 的行为相同，但不清空寄存器。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\ht\u003c/code\u003e \u003ccode\u003e\\dp\u003c/code\u003e \u003ccode\u003e\\wd\u003c/code\u003e： 返回及设置盒子寄存器中盒子的高度、深度、宽度。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\boxmaxdepth\u003c/code\u003e： 该命令表示 TeX 所允许的盒子的最大深度。在 plain TeX 中，它的默认值是 \u003ccode\u003e\\maxdimen\u003c/code\u003e。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\splitmaxdepth\u003c/code\u003e： 该命令表示 TeX 所允许的由 \u003ccode\u003e\\vsplit\u003c/code\u003e 生成盒子的最大深度。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\badness\u003c/code\u003e： 刚刚构造的盒子的劣度。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\hfuzz\u003c/code\u003e \u003ccode\u003e\\vfuzz\u003c/code\u003e： 该命令表示水平或竖直盒子的尺寸超出指定尺寸的阈值；当超过该阈值时，TeX 会考虑将其认定为溢出的（overfull）盒子。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\hbadness\u003c/code\u003e \u003ccode\u003e\\vbadness\u003c/code\u003e： 该命令表示一个阈值；当盒子的劣度超过该阈值时，TeX 会将相应盒子认定为欠满的（underfull）或者溢出的。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\overfullrule\u003c/code\u003e： 当水平盒子溢出时，TeX 会打印一条标尺，以表明有溢出的水平盒子；该命令表示上述标尺的宽度。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\hsize\u003c/code\u003e： 该命令表示在水平盒子内文本排版可用的行宽。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\vsize\u003c/code\u003e： 该命令表示页盒子（page box）的高度。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\lastbox\u003c/code\u003e： 若最后追加进当前列表的内容是一个盒子，则该寄存器会保存上述盒子。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\raise\u003c/code\u003e \u003ccode\u003e\\lower\u003c/code\u003e： 这两个命令用于在水平模式中调整盒子的垂直位置。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\moveleft\u003c/code\u003e \u003ccode\u003e\\moveright\u003c/code\u003e： 这两个命令用于在竖直模式中调整盒子的水平位置。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\everyhbox\u003c/code\u003e \u003ccode\u003e\\everyvbox\u003c/code\u003e： 这两个命令分别用于在每个水平盒子或竖直盒子开头处插入的记号列表。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\n\u003ch2 id=\"盒子\"\u003e\u003ca href=\"#盒子\" class=\"headerlink\" title=\"盒子\"\u003e\u003c/a\u003e盒子\u003c/h2\u003e\u003cp\u003e本章我们讨论盒子。TeX 中的水平盒子与竖直盒子分别是盒子是水平与竖直列表内容的容器。需要多次使用的盒子可以保存在盒子寄存器当中。\u003c/p\u003e\n\u003cp\u003e当 TeX 需要接受一个盒子（\u003ccode\u003e\u0026lt;box\u0026gt;\u003c/code\u003e）时，TeX 可接受以下形式：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e\\hbox \u0026lt;box specification\u0026gt; {\u0026lt;horizontal material\u0026gt;}\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\vbox \u0026lt;box specification\u0026gt; {\u0026lt;vertical material\u0026gt;}\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\vtop \u0026lt;box specification\u0026gt; {\u0026lt;vertical material\u0026gt;}\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\box \u0026lt;8-bit number\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\copy \u0026lt;8-bit number\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\vsplit \u0026lt;8-bit number\u0026gt; to \u0026lt;dimen\u0026gt;\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\lastbox\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e其中 \u003ccode\u003e\u0026lt;box specification\u0026gt;\u003c/code\u003e 的定义如下\u003c/p\u003e\n\u003cp\u003e\u003cimg data-src=\"/uploads/images/LaTeX/box_specification.png\"/\u003e\u003c/p\u003e\n\u003cp\u003e而 \u003ccode\u003e\u0026lt;8-bit number\u0026gt;\u003c/code\u003e 则是 0--255 范围内的数字。\u003c/p\u003e\n\u003cp\u003e包围盒子内容的花括号定义了一个分组；它们可以是分类码为 1 和 2 的显式字符，也可以是通过 \u003ccode\u003e\\let\u003c/code\u003e 定义的控制序列（隐式字符）；见下文。\u003c/p\u003e\n\u003cp\u003e除下文提到的 \u003ccode\u003e\\lastbox\u003c/code\u003e 之外，盒子通常可以用在水平、竖直和数学模式。盒子与模式之间的关系将在后续章节中讨论。\u003c/p\u003e\n\u003cp\u003e由 \u003ccode\u003e\\vcenter\u003c/code\u003e 命令（仅可在数学模式下使用）产生的盒子不是通常意义的盒子（\u003ccode\u003e\u0026lt;box\u0026gt;\u003c/code\u003e）。特别地，它不能赋值给 \u003ccode\u003e\\setbox\u003c/code\u003e；详见后续章节。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e\\vsplit\u003c/code\u003e 命令将在后续章节详细讨论。\u003c/p\u003e\n\u003ch2 id=\"盒子寄存器\"\u003e\u003ca href=\"#盒子寄存器\" class=\"headerlink\" title=\"盒子寄存器\"\u003e\u003c/a\u003e盒子寄存器\u003c/h2\u003e\u003cp\u003e共有 256 个盒子寄存器，它们从 0 开始编号至 255。盒子寄存器要不然是空的（void），要不然包含了一个水平盒子或一个竖直盒子。本节只讨论盒子\u003cstrong\u003e寄存器\u003c/strong\u003e；盒子的尺寸、内部内容的排列方式则在后续小节中讨论。\u003c/p\u003e\n\u003ch3 id=\"使用-newbox-分配盒子寄存器\"\u003e\u003ca href=\"#使用-newbox-分配盒子寄存器\" class=\"headerlink\" title=\"使用 \\newbox 分配盒子寄存器\"\u003e\u003c/a\u003e使用 \u003ccode\u003e\\newbox\u003c/code\u003e 分配盒子寄存器\u003c/h3\u003e\u003cp\u003eplain TeX 中的 \u003ccode\u003e\\newbox\u003c/code\u003e 宏可用于分配一个未被使用的盒子寄存器：\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\newbox\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\MyBox\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e此后，我们可以这样给盒子寄存器赋值：\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\MyBox\u003c/span\u003e=...\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e或者这样使用盒子寄存器里的内容：\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\box\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\MyBox\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e连续调用该命令会生成的盒子寄存器的编号也是连续的；这样，宏集合（macro collections）可以各自分配盒子寄存器，而无需担心与其它宏中分配的寄存器冲突。\u003c/p\u003e\n\u003cp\u003e盒子寄存器的编号是通过 \u003ccode\u003e\\chardef\u003c/code\u003e 赋值的（见后续章节）。这说明，\u003ccode\u003e\\MyBox\u003c/code\u003e 等价于一个数字（\u003ccode\u003e\u0026lt;number\u0026gt;\u003c/code\u003e），并且能被当做是数字使用。控制序列 \u003ccode\u003e\\newbox\u003c/code\u003e 是一个外部（\u003ccode\u003e\\outer\u003c/code\u003e）宏。新分配的盒子寄存器初始时是空的。\u003c/p\u003e\n\u003ch3 id=\"setbox、-box-和-copy-的用法\"\u003e\u003ca href=\"#setbox、-box-和-copy-的用法\" class=\"headerlink\" title=\"\\setbox、\\box 和 \\copy 的用法\"\u003e\u003c/a\u003e\u003ccode\u003e\\setbox\u003c/code\u003e、\u003ccode\u003e\\box\u003c/code\u003e 和 \u003ccode\u003e\\copy\u003c/code\u003e 的用法\u003c/h3\u003e\u003cp\u003e我们可以将一个盒子（\u003ccode\u003e\u0026lt;box\u0026gt;\u003c/code\u003e）赋值给盒子寄存器 ：\u003c/p\u003e\n\u003cp\u003e\u003cimg data-src=\"/uploads/images/LaTeX/setbox.png\"/\u003e\u003c/p\u003e\n\u003cp\u003e此处的 \u003ccode\u003e\u0026lt;box\u0026gt;\u003c/code\u003e 可以是显式的盒子，比如\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e37=\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{...} 以及 \u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e37=\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e{...}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e也可以是另一个盒子寄存器:\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e37=\u003cspan class=\"keyword\"\u003e\\box\u003c/span\u003e38\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e一般来说，盒子寄存器的编号由 \u003ccode\u003e\\newbox\u003c/code\u003e 命令分配。\u003c/p\u003e\n\u003cp\u003e通过 \u003ccode\u003e\\box\u003c/code\u003e 和 \u003ccode\u003e\\copy\u003c/code\u003e，我们可以将盒子寄存器中保存的盒子追加在 TeX 正在构建的列表当中。例如，下列命令会将编号为 38 的盒子追加到当前列表中：\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\box\u003c/span\u003e38\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e为节省内存，盒子寄存器在使用后会被清空：TeX 假设当你使用 \u003ccode\u003e\\box\u003c/code\u003e$nn$ 之后，你就不会再需要其中的内容了，于是便会清空它。如果你\u003cstrong\u003e确实\u003c/strong\u003e需要重复使用盒子寄存器的内容，你可以用 \u003ccode\u003e\\copy\u003c/code\u003e$nn$ 命令。它与 \u003ccode\u003e\\box\u003c/code\u003e$nn$ 的效果相同，但不会清空盒子寄存器中的内容。\u003c/p\u003e\n\u003cp\u003e通过 \u003ccode\u003e\\unhbox\u003c/code\u003e 和 \u003ccode\u003e\\unvbox\u003c/code\u003e 及其拷贝版本 \u003ccode\u003e\\unhcopy\u003c/code\u003e 和 \u003ccode\u003e\\unvcopy\u003c/code\u003e 解包盒子寄存器中的内容是可行的。不同于 \u003ccode\u003e\\box\u003c/code\u003e 可以在任何模式下使用，解包盒子的操作只能用在恰当的模式下——因为解包盒子会形成一个部分的水平列表或竖直列表（参见后续章节）。后文有关于解包盒子寄存器的更多信息。\u003c/p\u003e\n\u003ch3 id=\"关于盒子的条件判断：-ifvoid、-ifhbox-及-ifvbox\"\u003e\u003ca href=\"#关于盒子的条件判断：-ifvoid、-ifhbox-及-ifvbox\" class=\"headerlink\" title=\"关于盒子的条件判断：\\ifvoid、\\ifhbox 及 \\ifvbox\"\u003e\u003c/a\u003e关于盒子的条件判断：\u003ccode\u003e\\ifvoid\u003c/code\u003e、\u003ccode\u003e\\ifhbox\u003c/code\u003e 及 \u003ccode\u003e\\ifvbox\u003c/code\u003e\u003c/h3\u003e\u003cp\u003e通过 \u003ccode\u003e\\ifvoid\u003c/code\u003e 可以判断盒子寄存器是否为空。当 \u003ccode\u003e\\box\u0026lt;number\u0026gt;\u003c/code\u003e 为空时，下式返回真：\u003c/p\u003e\n\u003cp\u003e\u003cimg data-src=\"/uploads/images/LaTeX/ifvoid.png\"/\u003e\u003c/p\u003e\n\u003cp\u003e注意，盒子寄存器为空与盒子寄存器保存了空盒子是两码事。空盒子要么是水平盒子要么是竖直盒子；空的盒子寄存器既可以作为水平盒子使用，也可以作为竖直盒子使用。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e\\ifhbox\u003c/code\u003e 和 \u003ccode\u003e\\ifvbox\u003c/code\u003e 则分别用于判断一个盒子寄存器中的盒子是否为水平盒子或竖直盒子：\u003c/p\u003e\n\u003cp\u003e\u003cimg data-src=\"/uploads/images/LaTeX/ifhvbox.png\"/\u003e\u003c/p\u003e\n\u003cp\u003e注意，若寄存器为空，则两个判断都为假。\u003c/p\u003e\n\u003ch3 id=\"lastbox\"\u003e\u003ca href=\"#lastbox\" class=\"headerlink\" title=\"\\lastbox\"\u003e\u003c/a\u003e\u003ccode\u003e\\lastbox\u003c/code\u003e\u003c/h3\u003e\u003cp\u003e当 TeX 构建完成一个部分列表（partial list）后，此列表中的最后一个盒子可通过 \u003ccode\u003e\\lastbox\u003c/code\u003e 来访问。该命令的行为与盒子寄存器相似；因此，你可以将 \u003ccode\u003e\\lastbox\u003c/code\u003e 赋值给其他盒子寄存器，以将其从列表中删除。如果列表中最后一个元素不是盒子，则 \u003ccode\u003e\\lastbox\u003c/code\u003e 的行为与空寄存器相似。你无法通过 \u003ccode\u003e\\lastbox\u003c/code\u003e 访问主竖直列表中的最后一个元素；在这种情况下，\u003ccode\u003e\\lastbox\u003c/code\u003e 总是空寄存器。\u003c/p\u003e\n\u003cp\u003e举例来说，下面的语句将当前列表中的最后一个盒子赋值给编号为 0 的盒子寄存器，并将其从当前列表中删除：\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e{\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e0=\u003cspan class=\"keyword\"\u003e\\lastbox\u003c/span\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e由于赋值过程位于分组之内，在分组结束后，寄存器会被清空。因此，在一个自然段开始之时使用这一语句，可以删除缩进盒子（见后续章节）。后文也有关于 \u003ccode\u003e\\lastbox\u003c/code\u003e 的例子。\u003c/p\u003e\n\u003cp\u003e由于 \u003ccode\u003e\\lastbox\u003c/code\u003e 在外部竖直模式中总是为空，它不能访问追加到输出页上的盒子。但当页面保存在 \u003ccode\u003e\\box255\u003c/code\u003e 中时，我们可以在输出阶段解包这个盒子，而后取得 \u003ccode\u003e\\lastbox\u003c/code\u003e：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e译注：关于这一技巧，这里有一个完整的示例：\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://gist.github.com/91fd658069b0d3dfb7dbd2cba69b856a\"\u003ehttps://gist.github.com/91fd658069b0d3dfb7dbd2cba69b856a\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\unvbox\u003c/span\u003e255{\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e0=\u003cspan class=\"keyword\"\u003e\\lastbox\u003c/span\u003e}}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e值得一提的是，如果竖直模式中的盒子被 \u003ccode\u003e\\moveright\u003c/code\u003e 或 \u003ccode\u003e\\moveleft\u003c/code\u003e 调整过位置，或是水平模式中的盒子被 \u003ccode\u003e\\raise\u003c/code\u003e 或 \u003ccode\u003e\\lower\u003c/code\u003e 调整过位置，则使用 \u003ccode\u003e\\lastbox\u003c/code\u003e 访问列表中最后一个元素时，这些位置调整信息都会丢失。\u003c/p\u003e\n\u003ch2 id=\"盒子天然的尺寸\"\u003e\u003ca href=\"#盒子天然的尺寸\" class=\"headerlink\" title=\"盒子天然的尺寸\"\u003e\u003c/a\u003e盒子天然的尺寸\u003c/h2\u003e\u003cblockquote\u003e\n\u003cp\u003e译注：这里指的是没有其他拉伸、收缩的影响下，盒子自身的尺寸。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"已创建的水平盒子的尺寸\"\u003e\u003ca href=\"#已创建的水平盒子的尺寸\" class=\"headerlink\" title=\"已创建的水平盒子的尺寸\"\u003e\u003c/a\u003e已创建的水平盒子的尺寸\u003c/h3\u003e\u003cp\u003e\u003ccode\u003e\\hbox\u003c/code\u003e 内所有的元素都依次排在一行，并且它们的参考点会在齐盒子的基线（baseline）上对齐，除非显式使用 \u003ccode\u003e\\raise\u003c/code\u003e 或者 \u003ccode\u003e\\lower\u003c/code\u003e 调整它们竖直方向上的位置。\u003c/p\u003e\n\u003cp\u003e盒子的宽度是盒子内所有元素宽度之和。因此下面盒子的宽度为正\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\hskip\u003c/span\u003e1cm}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e而下面盒子的宽度为负\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\hskip\u003c/span\u003e-1cm}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e具体举例来说：\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003ea\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\kern\u003c/span\u003e-1em b}--\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e的输出是\u003c/p\u003e\n\u003cp\u003e\u003cimg data-src=\"/uploads/images/LaTeX/hbox_kern.png\"/\u003e\u003c/p\u003e\n\u003cp\u003e这表明，水平盒子可以有负的宽度。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e\\hbox\u003c/code\u003e 的高度和深度是盒子内所有元素在盒子基线上方和下方的最大值。水平盒子的高度和深度都是非负的。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e\\raise\u003c/code\u003e 和 \u003ccode\u003e\\lower\u003c/code\u003e 命令是在 \u003ccode\u003e\\hbox\u003c/code\u003e 内调整元素竖直位置的唯一方法（当然，除了在 \u003ccode\u003e\\hbox\u003c/code\u003e 中嵌套一个新的 \u003ccode\u003e\\vbox\u003c/code\u003e）；TeX 不允许在水平盒子中使用竖直命令（\u003ccode\u003e\u0026lt;vertical command\u0026gt;\u003c/code\u003e，例如 \u003ccode\u003e\\vskip\u003c/code\u003e）；此外，虽然我们可以在水平盒子中使用 \u003ccode\u003e\\par\u003c/code\u003e，但它却不会有任何作用。\u003c/p\u003e\n\u003ch3 id=\"已创建的竖直盒子的尺寸\"\u003e\u003ca href=\"#已创建的竖直盒子的尺寸\" class=\"headerlink\" title=\"已创建的竖直盒子的尺寸\"\u003e\u003c/a\u003e已创建的竖直盒子的尺寸\u003c/h3\u003e\u003cp\u003e在 \u003ccode\u003e\\vbox\u003c/code\u003e 内，竖直元素的参考点与盒子的参考点在竖直方向上对齐，除非显式使用 \u003ccode\u003e\\moveright\u003c/code\u003e 或者 \u003ccode\u003e\\moveleft\u003c/code\u003e 调整它们水平方向上的位置。\u003c/p\u003e\n\u003cp\u003e竖直盒子的参考点总是在盒子的左边界上。竖直盒子的宽度是盒子内所有元素的右边界相对参考点向右超出距离的最大值。盒子内元素相对参考点向左超出的距离则不被计算在盒子的宽度之中。因此，与前例相对应，下列代码的结果\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003ea\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\kern\u003c/span\u003e-1em b}}--\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e是\u003c/p\u003e\n\u003cp\u003e\u003cimg data-src=\"/uploads/images/LaTeX/vbox_kern.png\"/\u003e\u003c/p\u003e\n\u003cp\u003e由 \u003ccode\u003e\\vbox\u003c/code\u003e 和 \u003ccode\u003e\\vtop\u003c/code\u003e 生成的竖直盒子在计算高度和深度时会有所不同。基本原则是，\u003ccode\u003e\\vbox\u003c/code\u003e 的参考点位于最后一个元素的基线之上，而 \u003ccode\u003e\\vtop\u003c/code\u003e 的参考点位于第一个元素的基线之上。一般来说，只要最后一个（第一个）元素是盒子或者标尺（rule），则 \u003ccode\u003e\\vbox\u003c/code\u003e（\u003ccode\u003e\\vtop\u003c/code\u003e）的深度（高度）非零。\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e\\vbox\u003c/code\u003e 的高度是除最后一个元素之外所有元素高度与深度之和，再加上最后一个元素的高度；\u003ccode\u003e\\vbox\u003c/code\u003e 的深度则是最后一个元素的深度。\u003ccode\u003e\\vtop\u003c/code\u003e 的高度是第一个元素的高度；\u003ccode\u003e\\vtop\u003c/code\u003e 的深度则是除第一个元素之外所有元素高度与深度之和，再加上第一个元素的深度。也就是说，对于 \u003ccode\u003e\\vtop\u003c/code\u003e 来说，其深度是所包含所有元素的高度与深度之和，再减去第一个元素的高度。\u003c/p\u003e\n\u003cp\u003e如果 \u003ccode\u003e\\vtop\u003c/code\u003e（\u003ccode\u003e\\vbox\u003c/code\u003e）的第一个元素（最后一个元素）不是盒子或标尺，那么实际规则还要更复杂一点。如果 \u003ccode\u003e\\vbox\u003c/code\u003e 的最后一个元素是铅空（kern）或伸缩胶（glue），则盒子的深度为零；而若 \u003ccode\u003e\\vtop\u003c/code\u003e 的第一个元素是铅空或伸缩胶，则盒子的高度为零。（注意这些定义中的不对称性；可参考后续示例）\u003c/p\u003e\n\u003cp\u003e关于竖直盒子，还有一个限制：如果 \u003ccode\u003e\\vbox\u003c/code\u003e 或者 \u003ccode\u003e\\vtop\u003c/code\u003e 的深度超出 \u003ccode\u003e\\boxmaxdepth\u003c/code\u003e，则盒子的参考点会下移这一超出的数值。具体来说，超出限制的那一部分深度，会被加在盒子自身的高度之上。如果盒子有 \u003ccode\u003eto\u003c/code\u003e 或者 \u003ccode\u003espread\u003c/code\u003e 声明符，则相关的伸缩胶都会被重新设置，以将追加的高度考虑在内。\u003c/p\u003e\n\u003cp\u003e通常，\u003ccode\u003e\\boxmaxdepth\u003c/code\u003e 的值是 TeX 能表示的最大尺寸。但在一些情况下，例如，在 plain TeX 的输出阶段的一些计算中，它的值会被修改得小很多。详见后续章节。\u003c/p\u003e\n\u003ch3 id=\"例子\"\u003e\u003ca href=\"#例子\" class=\"headerlink\" title=\"例子\"\u003e\u003c/a\u003e例子\u003c/h3\u003e\u003cp\u003e水平盒子相较而言简单直接一些。水平盒子的宽度是盒子两条竖直边界之间的距离：从开始到结束，因此，水平盒子的宽度不一定是正数。例如在下例中，\u003ccode\u003e\\box1\u003c/code\u003e 的宽度为零。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e0=\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{aa} \u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e1=\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\copy\u003c/span\u003e0 \u003cspan class=\"keyword\"\u003e\\hskip\u003c/span\u003e-\u003cspan class=\"keyword\"\u003e\\wd\u003c/span\u003e0}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e具体来说 \u003ccode\u003e/\\box1/\u003c/code\u003e 的结果是（打了引号）\u003c/p\u003e\n\u003cp\u003e\u003cimg data-src=\"/uploads/images/LaTeX/box1.png\"/\u003e\u003c/p\u003e\n\u003cp\u003e水平盒子的高度和深度则不能为负。例如在下例中，\u003ccode\u003e\\box1\u003c/code\u003e 的深度是 \u003ccode\u003e0pt\u003c/code\u003e 而高度是 \u003ccode\u003e15pt\u003c/code\u003e。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e0=\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\vrule\u003c/span\u003e height 5pt depth 5pt}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e1=\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\raise\u003c/span\u003e 10pt \u003cspan class=\"keyword\"\u003e\\box\u003c/span\u003e0}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e竖直盒子相较而言就要麻烦不少。我们首先来讨论其宽度。首先，如下定义的水平盒子的宽度是 \u003ccode\u003e10pt\u003c/code\u003e。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e0=\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\hskip\u003c/span\u003e 10pt}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e则如下定义的竖直盒子宽度是 \u003ccode\u003e5pt\u003c/code\u003e。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e1=\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\moveleft\u003c/span\u003e 5pt \u003cspan class=\"keyword\"\u003e\\copy\u003c/span\u003e0}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e这是因为，在竖直盒子中，位于参考点左边的内容不计入其宽度。同样的，如下定义的竖直盒子宽度是 \u003ccode\u003e15pt\u003c/code\u003e。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e2=\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\moveright\u003c/span\u003e 5pt \u003cspan class=\"keyword\"\u003e\\copy\u003c/span\u003e0}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e如果 \u003ccode\u003e\\vbox\u003c/code\u003e 的最后一个元素是盒子，则其深度是最后一个元素的深度。因此，如下定义的 \u003ccode\u003e\\vbox\u003c/code\u003e 高度为 \u003ccode\u003e10pt\u003c/code\u003e 深度为 \u003ccode\u003e5pt\u003c/code\u003e。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\vskip\u003c/span\u003e 5pt \u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\vrule\u003c/span\u003e height 5pt depth 5pt}}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e如下定义的 \u003ccode\u003e\\vbox\u003c/code\u003e 的高度则是 \u003ccode\u003e0pt\u003c/code\u003e 而深度为 \u003ccode\u003e5pt\u003c/code\u003e。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\vskip\u003c/span\u003e -5pt \u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\vrule\u003c/span\u003e height 5pt depth 5pt}}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e如果最后一个元素是铅空或伸缩胶，则竖直盒子的深度为零。因此，如下定义的 \u003ccode\u003e\\vbox\u003c/code\u003e 高度为 \u003ccode\u003e15pt\u003c/code\u003e 深度为 \u003ccode\u003e0pt\u003c/code\u003e。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\vrule\u003c/span\u003e height 5pt depth 5pt}\u003cspan class=\"keyword\"\u003e\\vskip\u003c/span\u003e 5pt}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e下列 \u003ccode\u003e\\vbox\u003c/code\u003e 的高度为 \u003ccode\u003e5pt\u003c/code\u003e 深度则是 \u003ccode\u003e0pt\u003c/code\u003e。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\vrule\u003c/span\u003e height 5pt depth 5pt}\u003cspan class=\"keyword\"\u003e\\vskip\u003c/span\u003e -5pt}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e与 \u003ccode\u003e\\vbox\u003c/code\u003e 的深度对应，\u003ccode\u003e\\vtop\u003c/code\u003e 的高度基本上就是其第一个元素的高度。重复之前的例子，则如下定义的 \u003ccode\u003e\\vtop\u003c/code\u003e 高度为 \u003ccode\u003e0pt\u003c/code\u003e 深度为 \u003ccode\u003e15pt\u003c/code\u003e。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\vtop\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\vskip\u003c/span\u003e 5pt \u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\vrule\u003c/span\u003e height 5pt depth 5pt}}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e如下定义的 \u003ccode\u003e\\vtop\u003c/code\u003e 高度为 \u003ccode\u003e0pt\u003c/code\u003e 深度为 \u003ccode\u003e5pt\u003c/code\u003e。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\vtop\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\vskip\u003c/span\u003e -5pt \u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\vrule\u003c/span\u003e height 5pt depth 5pt}}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e如下定义的 \u003ccode\u003e\\vtop\u003c/code\u003e 高度为 \u003ccode\u003e5pt\u003c/code\u003e 深度为 \u003ccode\u003e10pt\u003c/code\u003e。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\vtop\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\vrule\u003c/span\u003e height 5pt depth 5pt} \u003cspan class=\"keyword\"\u003e\\vskip\u003c/span\u003e 5pt}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e如下定义的 \u003ccode\u003e\\vtop\u003c/code\u003e 高度为 \u003ccode\u003e5pt\u003c/code\u003e 深度为 \u003ccode\u003e0pt\u003c/code\u003e。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\vtop\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\vrule\u003c/span\u003e height 5pt depth 5pt} \u003cspan class=\"keyword\"\u003e\\vskip\u003c/span\u003e -5pt}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch2 id=\"继续讨论盒子的尺寸\"\u003e\u003ca href=\"#继续讨论盒子的尺寸\" class=\"headerlink\" title=\"继续讨论盒子的尺寸\"\u003e\u003c/a\u003e继续讨论盒子的尺寸\u003c/h2\u003e\u003ch3 id=\"预先指定尺寸\"\u003e\u003ca href=\"#预先指定尺寸\" class=\"headerlink\" title=\"预先指定尺寸\"\u003e\u003c/a\u003e预先指定尺寸\u003c/h3\u003e\u003cp\u003e盒子的尺寸可以通过尺寸说明符（\u003ccode\u003e\u0026lt;box specification\u0026gt;\u003c/code\u003e）来指定；具体语法可见上文。盒子中的伸缩胶会依需求缩放，使得盒子的尺寸达到上述设定值。预先指定盒子的尺寸的方法是：\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e to \u0026lt;dimen\u0026gt; \u003cspan class=\"keyword\"\u003e\\lb\u003c/span\u003e...\u003cspan class=\"keyword\"\u003e\\rb\u003c/span\u003e,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e to \u0026lt;dimen\u0026gt; \u003cspan class=\"keyword\"\u003e\\lb\u003c/span\u003e...\u003cspan class=\"keyword\"\u003e\\rb\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e如果盒子中有可以拉伸或收缩的伸缩胶，则这些伸缩胶会被拉伸或收缩，以将盒子的尺寸调整至指定的大小。与伸缩胶伸缩相关的是所谓的劣度值（见后续章节）。如果伸缩胶能够提供的拉伸或收缩值不足所需，则得到的盒子会欠满或溢出。后文有关于欠满和溢出的报错的相关讨论。\u003c/p\u003e\n\u003cp\u003e还有一个命令可使盒子实际的尺寸异于其天然尺寸。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e spread \u0026lt;dimen\u0026gt; \u003cspan class=\"keyword\"\u003e\\lb\u003c/span\u003e...\u003cspan class=\"keyword\"\u003e\\rb\u003c/span\u003e,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e spread \u0026lt;dimen\u0026gt; \u003cspan class=\"keyword\"\u003e\\lb\u003c/span\u003e...\u003cspan class=\"keyword\"\u003e\\rb\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e这种情况下，TeX 会使盒子内的伸缩胶拉伸或收缩，以在盒子天然尺寸的基础上缩放 \u003ccode\u003e\u0026lt;dimen\u0026gt;\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e与 \u003ccode\u003e\\vtop\u003c/code\u003e 配合使用尺寸说明符相对来说比较复杂。TeX 构造 \u003ccode\u003e\\vtop\u003c/code\u003e 时会先构造一个 \u003ccode\u003e\\vbox\u003c/code\u003e，同时会将尺寸说明符传递给该 \u003ccode\u003e\\vbox\u003c/code\u003e；而后再根据上述规则计算盒子的高度和深度。\u003c/p\u003e\n\u003cp\u003e伸缩胶相关设置将在后续章节中讨论。\u003c/p\u003e\n\u003ch3 id=\"改变盒子的尺寸\"\u003e\u003ca href=\"#改变盒子的尺寸\" class=\"headerlink\" title=\"改变盒子的尺寸\"\u003e\u003c/a\u003e改变盒子的尺寸\u003c/h3\u003e\u003cp\u003e我们可以用 \u003ccode\u003e\\ht\u003c/code\u003e、\u003ccode\u003e\\dp\u003c/code\u003e 和 \u003ccode\u003e\\wd\u003c/code\u003e 来分别获得盒子寄存器的高度、深度和宽度。举例来说，\u003ccode\u003e\\dp18\u003c/code\u003e 会给出 18 号盒子的深度。盒子的尺寸不光可读，还可写。通过给盒子的尺寸赋值，我们可以在某种意义上愚弄 TeX，使得在 TeX 看来某个盒子的尺寸不同于其真实值。不过，修改盒子尺寸并不会修改其中的内容；特别地，不会修改伸缩胶设置的方式。\u003c/p\u003e\n\u003cp\u003e不少格式（format）都定义了 \u003ccode\u003e\\smash\u003c/code\u003e 宏：\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\def\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\smash\u003c/span\u003e\u003cspan class=\"params\"\u003e#1\u003c/span\u003e{{\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e0=\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{\u003cspan class=\"params\"\u003e#1\u003c/span\u003e}\u003cspan class=\"keyword\"\u003e\\dp\u003c/span\u003e0=0pt \u003cspan class=\"keyword\"\u003e\\ht\u003c/span\u003e0=0pt \u003cspan class=\"keyword\"\u003e\\box\u003c/span\u003e0\u003cspan class=\"keyword\"\u003e\\relax\u003c/span\u003e}}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e在宏定义中，\u003ccode\u003e\\smash\u003c/code\u003e 命令将内容保存在盒子中，但是将盒子的高度和深度都值为零；这也就是说，最终盒子会被输出，但是后续有关盒子尺寸的计算中，TeX 都会将高度和深度认作是零。\u003c/p\u003e\n\u003cp\u003e改变盒子尺寸只能通过为其赋值来实现：这些盒子尺寸（\u003ccode\u003e\u0026lt;box dimen\u0026gt;\u003c/code\u003es）能且只能通过盒子尺寸赋值语句（\u003ccode\u003e\u0026lt;box size assignment\u0026gt;\u003c/code\u003e）来设置，而不能用诸如 \u003ccode\u003e\\advance\u003c/code\u003e 的命令来修改。\u003c/p\u003e\n\u003cp\u003e注意，\u003cstrong\u003e盒子尺寸赋值\u003c/strong\u003e总是\u003cstrong\u003e全局赋值\u003c/strong\u003e。赋值的效果会超出任意限定它的分组（参见后续章节）。因此下列代码\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e0=\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{---} {\u003cspan class=\"keyword\"\u003e\\wd\u003c/span\u003e0=0pt} a\u003cspan class=\"keyword\"\u003e\\box\u003c/span\u003e0b\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e有输出：\u003c/p\u003e\n\u003cp\u003e\u003cimg data-src=\"/uploads/images/LaTeX/abemdash.png\"/\u003e\u003c/p\u003e\n\u003cp\u003e上述有关被创建的盒子的尺寸限制并不适用于显式修改盒子尺寸的情况。例如，对水平盒子设置 \u003ccode\u003e\\dp0=-2pt\u003c/code\u003e 是合法的。\u003c/p\u003e\n\u003ch3 id=\"移动盒子\"\u003e\u003ca href=\"#移动盒子\" class=\"headerlink\" title=\"移动盒子\"\u003e\u003c/a\u003e移动盒子\u003c/h3\u003e\u003cp\u003e在水平盒子中，所有元素的参考点与盒子自身的参考点都位于同一条水平线上。水平盒子中的盒子可用 \u003ccode\u003e\\raise\u003c/code\u003e 或 \u003ccode\u003e\\lower\u003c/code\u003e 来上移或下移。\u003c/p\u003e\n\u003cp\u003e相似地，在竖直盒子中，所有元素的参考点与盒子自身的参考点都位于同一条竖直线上，且各个元素从上到下依次排列。竖直盒子中的盒子可用 \u003ccode\u003e\\moveleft\u003c/code\u003e 或 \u003ccode\u003e\\moveright\u003c/code\u003e 来左移或右移。\u003c/p\u003e\n\u003cp\u003e注意，上述命令只能用来移动盒子，特别地，这些命令不能用于字符或标尺。\u003c/p\u003e\n\u003ch3 id=\"盒子的尺寸与盒子的摆放\"\u003e\u003ca href=\"#盒子的尺寸与盒子的摆放\" class=\"headerlink\" title=\"盒子的尺寸与盒子的摆放\"\u003e\u003c/a\u003e盒子的尺寸与盒子的摆放\u003c/h3\u003e\u003cp\u003e在确定水平列表和竖直列表中元素的摆放位置时，TeX 需要维护两个变量：当前参考线以及在参考线上的当前位置。对于水平列表来说，参考线是包围当前内容的 \u003ccode\u003e\\hbox\u003c/code\u003e 的基线；对于竖直列表来说，参考线是穿过包围当前内容的 \u003ccode\u003e\\vbox\u003c/code\u003e 的参考点的竖线。\u003c/p\u003e\n\u003cp\u003e在水平模式中，TeX 放置元素的逻辑如下。初始时，参考线上的当前位置即是包围当前内容的从水平盒子的参考点。此后，TeX 会依如下步骤操作。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e如果元素被 \u003ccode\u003e\\raise\u003c/code\u003e 或 \u003ccode\u003e\\lower\u003c/code\u003e 上下移动了位置，则相应地调整元素的位置。\u003c/li\u003e\n\u003cli\u003e如果元素是水平盒子，则对其内容递归地调用该算法；如果元素是竖直盒子，按盒子的高度向上移动当前位置，而后按照后文所述的有关竖直盒子的算法放置盒子内竖直列表中的元素。\u003c/li\u003e\n\u003cli\u003e按当前元素的宽度，沿着参考线向右移动当前位置。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e对于竖直盒子中的竖直列表，TeX 的会将当前位置初始设置在盒子的左上角，参考线则是穿过该点的竖线——这条竖线同样也会穿过盒子的参考点。竖直盒子中的元素依照如下逻辑摆放。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e如果元素被 \u003ccode\u003e\\moveleft\u003c/code\u003e 或 \u003ccode\u003e\\moveright\u003c/code\u003e 上下移动了位置，则相应地调整元素的位置。\u003c/li\u003e\n\u003cli\u003e将元素的左上角与当前位置对齐。\u003c/li\u003e\n\u003cli\u003e如果元素是竖直盒子，则对其内容递归地调用该算法；如果元素是水平盒子，按盒子的高度向下移动当前位置，而后按照前文所述的有关竖直盒子的算法放置盒子内水平列表中的元素。\u003c/li\u003e\n\u003cli\u003e按当前元素的高度与深度之和，沿着参考线向下移动当前位置。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e注意，上文中没有描述 TeX 是如何构建盒子的。对于竖直盒子，构建盒子的过程还要包括插入行间距伸缩胶（行间胶，baselineskip glue）的过程。上文介绍的过程描述的是 TeX 会如何输出一个已经构建完成的盒子中的内容。\u003c/p\u003e\n\u003ch3 id=\"盒子与反向伸缩胶\"\u003e\u003ca href=\"#盒子与反向伸缩胶\" class=\"headerlink\" title=\"盒子与反向伸缩胶\"\u003e\u003c/a\u003e盒子与反向伸缩胶\u003c/h3\u003e\u003cp\u003e默认情况下，盒子在一条参考线上依次摆放。但有时，让盒子互相重叠也是很有用的。让盒子互相重叠，最简单的办法是使用反向行间胶。在水平模式中，下列代码会摆放编号为 8 的盒子，但不会移动当前位置。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e{\u003cspan class=\"keyword\"\u003e\\dimen\u003c/span\u003e0=\u003cspan class=\"keyword\"\u003e\\wd\u003c/span\u003e8 \u003cspan class=\"keyword\"\u003e\\box\u003c/span\u003e8 \u003cspan class=\"keyword\"\u003e\\kern\u003c/span\u003e-\u003cspan class=\"keyword\"\u003e\\dimen\u003c/span\u003e0}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e更实用的是使用 \u003ccode\u003e\\llap\u003c/code\u003e 和 \u003ccode\u003e\\rlap\u003c/code\u003e 命令。它们的定义如下：\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\def\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\llap\u003c/span\u003e\u003cspan class=\"params\"\u003e#1\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e to 0pt{\u003cspan class=\"keyword\"\u003e\\hss\u003c/span\u003e \u003cspan class=\"params\"\u003e#1\u003c/span\u003e}}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\def\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\rlap\u003c/span\u003e\u003cspan class=\"params\"\u003e#1\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e to 0pt{\u003cspan class=\"params\"\u003e#1\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\hss\u003c/span\u003e}}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e这两个命令允许其中的内容基于当前位置向左或向右突出。这里，\u003ccode\u003e\\hss\u003c/code\u003e 伸缩胶等价于 \u003ccode\u003e\\hskip 0pt plus 1fil minus 1fil\u003c/code\u003e，它能吸收 \u003ccode\u003e\\llap\u003c/code\u003e 或 \u003ccode\u003e\\rlap\u003c/code\u003e 的参数中的任意正负宽度。\u003c/p\u003e\n\u003cp\u003e举例来说，下列代码\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\llap\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e to 10pt{a\u003cspan class=\"keyword\"\u003e\\hfil\u003c/span\u003e}}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e等价于\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\hskip\u003c/span\u003e-10pt \u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e to 10pt{a\u003cspan class=\"keyword\"\u003e\\hfil\u003c/span\u003e}}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e它们的宽度都是 \u003ccode\u003e0pt\u003c/code\u003e。\u003c/p\u003e\n\u003ch2 id=\"盒子的欠满与溢出\"\u003e\u003ca href=\"#盒子的欠满与溢出\" class=\"headerlink\" title=\"盒子的欠满与溢出\"\u003e\u003c/a\u003e盒子的欠满与溢出\u003c/h2\u003e\u003cp\u003e如果盒子有尺寸说明符则 TeX 会拉伸或收缩其中的伸缩胶。对于仅有有限伸缩能力的伸缩胶，TeX 会计算其伸缩过程中的\u003cstrong\u003e劣度\u003c/strong\u003e（见后续章节）。在 TeX3 中，用户可通过 \u003ccode\u003e\\badness\u003c/code\u003e 宏来检查刚刚构建的盒子的劣度。劣度的取值范围是 $0$--$10,000$；而如果盒子溢出了，则其劣度为~$1,000,000$。\u003c/p\u003e\n\u003cp\u003e如果 TeX 认为劣度过大，则会给出一条诊断信息。我们首先考虑对水平盒子的报错。\u003c/p\u003e\n\u003cp\u003e若 \u003ccode\u003e\\hbadness\u003c/code\u003e${}\\geqslant10,000$，则 TeX 不会对需要拉伸其中伸缩胶的水平盒子报错；否则，当水平盒子中的伸缩胶拉伸的劣度超过 \u003ccode\u003e\\hbadness\u003c/code\u003e 时，TeX 会提示盒子欠满（underfull）。\u003c/p\u003e\n\u003cp\u003e伸缩胶的收缩可能引发盒子溢出的报错：如果盒子内伸缩胶最大的收缩量不足以使盒子的宽度满足指定的宽度，则 TeX 认为该盒子溢出了。当且仅当收缩量不足的量大于 \u003ccode\u003e\\hfuzz\u003c/code\u003e 或者 \u003ccode\u003e\\hbadness\u003c/code\u003e${}\u0026lt;100$ 时（这会使得所有可用的收缩的劣度为 $100$），TeX 才会报告盒子溢出的问题。\u003c/p\u003e\n\u003cp\u003e举例来说，如果盒子内伸缩胶的最大收缩量不足以使盒子的宽度减小到指定的尺寸，则若设置 **\u003ccode\u003e\\hfuzz=1pt\u003c/code\u003e**，TeX 会忽略上述不足的部分小于 \u003ccode\u003e1pt\u003c/code\u003e 的盒子而不报错。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e to 1pt{\u003cspan class=\"keyword\"\u003e\\hskip\u003c/span\u003e3pt minus .5pt}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e to 1pt{\u003cspan class=\"keyword\"\u003e\\hskip\u003c/span\u003e3pt minus 1.5pt}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e这里只有第一个盒子会报错：它比目标尺寸大了 \u003ccode\u003e1.5pt\u003c/code\u003e；但是第二个盒子不会报错，因为它只比目标尺寸大了 \u003ccode\u003e0.5pt\u003c/code\u003e，小于 **\u003ccode\u003e\\hfuzz\u003c/code\u003e**。\u003c/p\u003e\n\u003cp\u003e如果一个盒子虽不至变成溢出盒子但也被收缩了，也有可能被 TeX 报告问题：如果一个盒子比较紧凑，也就是说，如果这个盒子使用了至少一半的收缩能力，则在劣度（介于 13 到 100 之间）超过 \u003ccode\u003e\\hbadness\u003c/code\u003e 时，TeX 会报告这个问题。\u003c/p\u003e\n\u003cp\u003e对水平盒子与竖直盒子来说，相关警告的逻辑几乎完全相同。对于竖直盒子来说，有 \u003ccode\u003e\\vbadness\u003c/code\u003e 以及 \u003ccode\u003e\\vfuzz\u003c/code\u003e 来控制相关报错。区别之处在于，如果一个水平盒子溢出了，则 TeX 会在盒子右侧绘制一个高度与盒子相同宽度为 \u003ccode\u003e\\overfullrule\u003c/code\u003e 的溢出标尺。此处有一个例外，在 \u003ccode\u003e\\halign\u003c/code\u003e 中，如果 \u003ccode\u003e\\tabskip\u003c/code\u003e 伸缩胶无法提供足够的收缩量时，TeX 不会绘制溢出标尺。\u003c/p\u003e\n\u003ch2 id=\"盒子的开始与结束\"\u003e\u003ca href=\"#盒子的开始与结束\" class=\"headerlink\" title=\"盒子的开始与结束\"\u003e\u003c/a\u003e盒子的开始与结束\u003c/h2\u003e\u003cp\u003e盒子的内容以花括号定界。其中，左右花括号既可以是显式字符（分类码为 1 和 2 的字符），也可以是使用命令 \u003ccode\u003e\\let\u003c/code\u003e 定义的隐式字符。TeX 会将记号 \u003ccode\u003e\\everyhbox\u003c/code\u003e 或者 \u003ccode\u003e\\everyvbox\u003c/code\u003e 插入在左花括号之后。如果盒子位于 \u003ccode\u003e\\setbox\u003c/code\u003e 赋值语句中，则记号 \u003ccode\u003e\\afterassignment\u003c/code\u003e 会在「everybox」记号之前插入在左花括号之后。\u003c/p\u003e\n\u003cp\u003e举例来说，\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\everyhbox\u003c/span\u003e{b}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\afterassignment\u003c/span\u003e a\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e0=\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{c}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\showbox\u003c/span\u003e0\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e的结果是：\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u0026gt; \u003cspan class=\"keyword\"\u003e\\box\u003c/span\u003e0=\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e(6.94444+0.0)x15.27782\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e.\u003cspan class=\"keyword\"\u003e\\tenrm\u003c/span\u003e a\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e.\u003cspan class=\"keyword\"\u003e\\tenrm\u003c/span\u003e b\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e.\u003cspan class=\"keyword\"\u003e\\kern\u003c/span\u003e0.27779\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e.\u003cspan class=\"keyword\"\u003e\\tenrm\u003c/span\u003e c\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e借助隐式花括号，我们可以通过宏来开始和结束盒子。比如下面的代码就用到了这一特性：\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\def\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\openbox\u003c/span\u003e\u003cspan class=\"params\"\u003e#1\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e\u003cspan class=\"params\"\u003e#1\u003c/span\u003e=\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\bgroup\u003c/span\u003e}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\def\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\closebox\u003c/span\u003e\u003cspan class=\"params\"\u003e#1\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\egroup\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\DoSomethingWithBox\u003c/span\u003e\u003cspan class=\"params\"\u003e#1\u003c/span\u003e}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\openbox\u003c/span\u003e0 ... \u003cspan class=\"keyword\"\u003e\\closebox\u003c/span\u003e0\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e利用这一机制，我们可以提取整个自然段的内容：\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e译注：这是一个在 plain TeX 下的示例，而非是 LaTeX 下的。因此，这里的 \u003ccode\u003e\\parbox\u003c/code\u003e 不是 LaTeX 里的段落盒子。关于这一技巧，此处有一完整示例：\\url{\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://gist.github.com/1d8b9bd2f401eb0ea970a47693723ab1\"\u003ehttps://gist.github.com/1d8b9bd2f401eb0ea970a47693723ab1\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\everypar\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\parbox\u003c/span\u003e=\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e   \u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\bgroup\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003e\\everypar\u003c/span\u003e{}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        \u003cspan class=\"keyword\"\u003e\\def\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\par\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\egroup\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\UseBox\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\parbox\u003c/span\u003e}}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e此处，\u003ccode\u003e\\everypar\u003c/code\u003e 命令\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e译注：\u003ccode\u003e\\everypar\u003c/code\u003e 命令的参数，会被插入在每个开启自然段的水平列表的头部，位于缩进盒子之后。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e开始了一个盒子，并且将自然段的文本内容保存在盒子中。假设段落的开头是：\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eBegin a text ...\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e这就等价于\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e译注：注意这里忽略了盒子开头位置的 \u003ccode\u003e\\everypar\u003c/code\u003e 以及对 \u003ccode\u003e\\par\u003c/code\u003e 的重定义。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\parbox\u003c/span\u003e=\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e{Begin a text ...\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e由于在盒子中，\u003ccode\u003e\\par\u003c/code\u003e 被重定义了，所以，假设段落的结尾是\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e译注：注意这里的 \u003ccode\u003e\\par\u003c/code\u003e 可以是手工插入的，也可以是输入处理器在\\cstate{S\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e 遇见行尾符自动插入的。}：\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e... a text ends.\u003cspan class=\"keyword\"\u003e\\par\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e等价于\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e... a text ends.}\u003cspan class=\"keyword\"\u003e\\Usebox\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\parbox\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e在这个例子中，\u003ccode\u003e\\UseBox\u003c/code\u003e 命令只能将盒子作为一个整体对待；如果想要分别处理盒子中的元素，则需要使用新的技巧。在下列代码中，\u003ccode\u003e\\HandleLines\u003c/code\u003e 可以访问自然段竖直列表中连续的元素：\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\everypar\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\parbox\u003c/span\u003e=\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e \u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\bgroup\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\everypar\u003c/span\u003e{}\u003cspan class=\"comment\"\u003e%\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e      \u003cspan class=\"keyword\"\u003e\\def\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\par\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\endgraf\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\HandleLines\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e               \u003cspan class=\"keyword\"\u003e\\egroup\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\box\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\parbox\u003c/span\u003e}}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\def\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\HandleLines\u003c/span\u003e{ ... \u003cspan class=\"keyword\"\u003e\\lastbox\u003c/span\u003e ... }\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e后文还有一个相关例子。\u003c/p\u003e\n\u003ch2 id=\"将盒子解包\"\u003e\u003ca href=\"#将盒子解包\" class=\"headerlink\" title=\"将盒子解包\"\u003e\u003c/a\u003e将盒子解包\u003c/h2\u003e\u003cp\u003e使用 \u003ccode\u003e\\unhbox\u003c/code\u003e 和 \u003ccode\u003e\\unvbox\u003c/code\u003e 可将盒子解包；\u003ccode\u003e\\unhcopy\u003c/code\u003e 和 \u003ccode\u003e\\unvcopy\u003c/code\u003e 是对应的拷贝版本。由于它们会构建部分的水平列表和竖直列表，它们分别是水平命令和竖直命令（见后续章节）。注意，不能用 \u003ccode\u003e\\unhbox\u003c/code\u003e 去解包一个寄存了 \u003ccode\u003e\\vbox\u003c/code\u003e 的盒子寄存器；反过来也一样不行。不过，空寄存器可以用 \u003ccode\u003e\\unhbox\u003c/code\u003e 也可以用 \u003ccode\u003e\\unvbox\u003c/code\u003e 解包。\u003c/p\u003e\n\u003cp\u003e解包操作会将盒子寄存器中盒子的内容取出，而后追加在盒子所处的列表中；所有的伸缩胶会被重新设置。因此下列代码\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e0=\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e to 1cm{\u003cspan class=\"keyword\"\u003e\\hfil\u003c/span\u003e} \u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e to 2cm{\u003cspan class=\"keyword\"\u003e\\unhbox\u003c/span\u003e0}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e与下列代码完全相同\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e to 2cm{\u003cspan class=\"keyword\"\u003e\\hfil\u003c/span\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e且与下列代码不同\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e to 2cm{\u003cspan class=\"keyword\"\u003e\\kern\u003c/span\u003e1cm}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e\u003ccode\u003e\\unhbox\u003c/code\u003e 的这一本质特性被用来定义 \u003ccode\u003e\\leavevmode\u003c/code\u003e：\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\def\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\leavevmode\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\unhbox\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\voidb@x\u003c/span\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e该命令会使 TeX 从竖直模式切换到水平模式，而不向水平列表中添加任何额外的东西。当然，由模式切换出发的 \u003ccode\u003e\\indent\u003c/code\u003e 会在水平列表中添加一个缩进盒子。在水平模式中，\u003ccode\u003e\\leavevmode\u003c/code\u003e 没有任何作用。注意，此处没必要使用 \u003ccode\u003e\\unhcopy\u003c/code\u003e，因为寄存器本身就是空的。\u003c/p\u003e\n\u003cp\u003e还有一个细节需要注意：在竖直模式中解包竖直盒子的操作不会在前序内容与盒子内容之间添加任何行间伸缩胶。此外，\u003ccode\u003e\\prevdepth\u003c/code\u003e 的值也不会发生改变，因此，盒子内容之间的伸缩胶以及盒子内容与后续内容之间的伸缩胶仅在盒子前面有东西存在的时候才会生效；并且，行间伸缩胶的只取决于之前内容的深度。相似地，在水平模式中解包水平盒子的操作不会改变 \u003ccode\u003e\\spacefactor\u003c/code\u003e。\u003c/p\u003e\n\u003ch2 id=\"盒子中的文本\"\u003e\u003ca href=\"#盒子中的文本\" class=\"headerlink\" title=\"盒子中的文本\"\u003e\u003c/a\u003e盒子中的文本\u003c/h2\u003e\u003cp\u003e水平盒子与竖直盒子里都能装文本，但它们处理文本的方式有所区别。在水平盒子中，文本被摆放在一条直线上，并且盒子的宽度在原则上是文本（及盒子内其它元素）的自然宽度。水平盒子中不允许有竖直命令（\u003ccode\u003e\u0026lt;vertical command\u0026gt;\u003c/code\u003e），此外 \u003ccode\u003e\\par\u003c/code\u003e 在水平盒子里没有任何作用。\u003c/p\u003e\n\u003cp\u003e竖直盒子相对来说就要复杂得多了。在竖直盒子中，一旦遇到字符或其他任何水平命令（\u003ccode\u003e\u0026lt;horizontal command\u0026gt;\u003c/code\u003e），TeX 就会开始在非受限水平模式构建段落；也就是说，仿佛这一段落是直属于页面的一部分。而当遇到竖直命令（\u003ccode\u003e\u0026lt;vertical command\u0026gt;\u003c/code\u003e）或盒子结束时，TeX 会使用当前的参数值（例如 \u003ccode\u003e\\hsize\u003c/code\u003e）将该段落分段成行。\u003c/p\u003e\n\u003cp\u003e因此，下列代码的\u003cstrong\u003e不会\u003c/strong\u003e输出宽度为 3 厘米的段落（如果 \u003ccode\u003e\\hsize\u003c/code\u003e${} \u0026gt; {}$\u003ccode\u003e3cm\u003c/code\u003e，则水平盒子会溢出）：\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e to 3cm{\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e{some reasonably long text}}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e下列代码才会输出宽度为 3 厘米的段落：\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\hsize\u003c/span\u003e=3cm some reasonably long text}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e竖直盒子中的成段文本会被分段成行，而后每行都会被打包进一个水平盒子中。这些水平盒子会堆叠在内部竖直模式当中，盒子之间有 \u003ccode\u003e\\baselineskip\u003c/code\u003e 和 \u003ccode\u003e\\lineskip\u003c/code\u003e 分割（见后续章节）。这也是页面当中文本内容摆放的过程；只不过水平盒子是在外部竖直模式当中堆叠起来的。\u003c/p\u003e\n\u003cp\u003e如果内部竖直列表是空的，则 TeX 不会在段落开始处插入 \u003ccode\u003e\\parskip\u003c/code\u003e 伸缩胶。\u003c/p\u003e\n\u003cp\u003e由于水平盒子中的文本不会被分段成行，受限和非受限水平模式还有这样一个区别：在受限水平模式中，TeX 不会插入 discretionary nodes 和会改变当前语言值的无名项目（whatsit items）。如果文本随后被解包形成段落的一部分，则这可能引发一些问题。\u003c/p\u003e\n\u003cp\u003e后续章节有关于这些内容的解释。\u003c/p\u003e\n\u003ch2 id=\"杂记\"\u003e\u003ca href=\"#杂记\" class=\"headerlink\" title=\"杂记\"\u003e\u003c/a\u003e杂记\u003c/h2\u003e\u003ch3 id=\"忘掉-box\"\u003e\u003ca href=\"#忘掉-box\" class=\"headerlink\" title=\"忘掉 \\box\"\u003e\u003c/a\u003e忘掉 \u003ccode\u003e\\box\u003c/code\u003e\u003c/h3\u003e\u003cp\u003e在 \u003ccode\u003e\\newcount\\foo\u003c/code\u003e 之后，我们就可以单独用 \u003ccode\u003e\\foo\u003c/code\u003e 来访问这个计数器了。但是，对于盒子来说则必须使用 \u003ccode\u003e\\box\\foo\u003c/code\u003e 来访问相应的盒子。其原因在于，TeX 中不存在单独的 \u003ccode\u003e\\boxdef\u003c/code\u003e 命令，而是用 \u003ccode\u003e\\chardef\u003c/code\u003e 命令来代替（详见后续章节）。\u003c/p\u003e\n\u003cp\u003e举例来说，假设 \u003ccode\u003e\\newbox\\foo\u003c/code\u003e 命令分配了编号为 25 的寄存器，则 \\textup{\u003ccode\u003e\\foo\u003c/code\u003e} 与 \u003ccode\u003e\\char25\u003c/code\u003e 等价。\u003c/p\u003e\n\u003ch3 id=\"特殊用途的盒子\"\u003e\u003ca href=\"#特殊用途的盒子\" class=\"headerlink\" title=\"特殊用途的盒子\"\u003e\u003c/a\u003e特殊用途的盒子\u003c/h3\u003e\u003cp\u003e有些盒子寄存器有特殊用途。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e编号为 255 的盒子 \u003ccode\u003e\\box255\u003c/code\u003e 在 TeX 内部参与页面输出的例程。\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\\voidb@x\u003c/code\u003e 是一个数字，对应的盒子寄存器在 \u003ccode\u003eplain.tex\u003c/code\u003e 中分配；我们可以总是假设它是一个空寄存器。它被用于定义诸如 \u003ccode\u003e\\leavevmode\u003c/code\u003e 等宏。\u003c/li\u003e\n\u003cli\u003e使用 plain TeX 宏 \u003ccode\u003e\\newinsert\u003c/code\u003e 创建新的 \u003ccode\u003e\\insert\u003c/code\u003e 之后，TeX 会预留编号相同的若干寄存器，且编号从 254 开始向前倒数。这些寄存器是：\u003ccode\u003e\\count\u003c/code\u003e、\u003ccode\u003e\\dimen\u003c/code\u003e、\u003ccode\u003e\\skip\u003c/code\u003e 以及 \u003ccode\u003e\\box\u003c/code\u003e。\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"水平模式中竖直盒子的高度\"\u003e\u003ca href=\"#水平模式中竖直盒子的高度\" class=\"headerlink\" title=\"水平模式中竖直盒子的高度\"\u003e\u003c/a\u003e水平模式中竖直盒子的高度\u003c/h3\u003e\u003cp\u003e在水平模式中，竖直盒子的参考点与包围它的水平盒子的参考点在竖直方向上对齐。TeX 会从竖直盒子的左上角，即竖直盒子参考点上方与参考点距离等于竖直盒子高度的点，开始遍历竖直盒子中的内容。改变盒子的高度会改变盒子中内容摆放的高度。\u003c/p\u003e\n\u003cp\u003e考虑以下代码\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{a\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e0=\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{b}}\u003cspan class=\"keyword\"\u003e\\box\u003c/span\u003e0 c}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e其效果是\u003c/p\u003e\n\u003cp\u003e\u003cimg data-src=\"/uploads/images/LaTeX/abc.png\"/\u003e\u003c/p\u003e\n\u003cp\u003e再考虑以下代码\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{a\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e0=\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{b}}\u003cspan class=\"keyword\"\u003e\\ht\u003c/span\u003e0=0cm \u003cspan class=\"keyword\"\u003e\\box\u003c/span\u003e0 c}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e其效果是\u003c/p\u003e\n\u003cp\u003e\u003cimg data-src=\"/uploads/images/LaTeX/alowbc.png\"/\u003e\u003c/p\u003e\n\u003cp\u003e相对的，在竖直模式中改变水平盒子的宽度不会影响水平盒子摆放的位置。\u003c/p\u003e\n\u003ch3 id=\"竖直盒子的更多细节\"\u003e\u003ca href=\"#竖直盒子的更多细节\" class=\"headerlink\" title=\"竖直盒子的更多细节\"\u003e\u003c/a\u003e竖直盒子的更多细节\u003c/h3\u003e\u003cp\u003e有两种竖直盒子：\u003ccode\u003e\\vbox\u003c/code\u003e 和 \u003ccode\u003e\\vtop\u003c/code\u003e。嵌套使用两种盒子的结果可能会令人困惑。例如\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\vtop\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e{...}}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e完全等价于\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e{...}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e如前所述，若 \u003ccode\u003e\\vbox\u003c/code\u003e 的最后一个元素是铅空或伸缩胶，则其深度为零；若 \u003ccode\u003e\\vtop\u003c/code\u003e 的第一个元素是铅空或伸缩胶，则其高度为零。前面的几个例子已经通过用铅空作为第一个元素或者最后一个元素演示了这一点，但是，如果 \u003ccode\u003e\\vtop\u003c/code\u003e 的第一个元素不是铅空或伸缩胶，人们有可能忽视其对 \u003ccode\u003e\\vtop\u003c/code\u003e 的影响。举例来说，尽管下列代码中，第一个元素不是铅空或伸缩胶，但其高度为零。这是因为在 \u003ccode\u003e\\write\u003c/code\u003e 指令中包含了一个无名项目，它会被放在竖直列表当中。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\vtop\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\write\u003c/span\u003e16{...}...}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e修正的办法是通过 \u003ccode\u003e\\leavevmode\u003c/code\u003e 离开竖直模式，切换到水平模式并开启新的自然段，而后将无名项目放在自然段的起始处，而非是自然段的上方。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\vtop\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\leavevmode\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\write\u003c/span\u003e16{...}...}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e摆放数值列表中的元素有时会比较棘手。例如，竖直列表中的水平盒子与竖直盒子的处理方式是不一样的。考虑以下例子，在 \u003ccode\u003e\\offinterlineskip\u003c/code\u003e 之后\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e译注：\u003ccode\u003e\\offinterlineskip\u003c/code\u003e 会禁止 TeX 在行与行之间自动地插入行间伸缩胶；因此，在 \u003ccode\u003e\\offinterlineskip\u003c/code\u003e 之后，每行的 \u003ccode\u003e\\hbox\u003c/code\u003e 会没有缝隙地堆叠在一起。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e第一个例子\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{a}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e     \u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e0=\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{(}}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e     \u003cspan class=\"keyword\"\u003e\\ht\u003c/span\u003e0=0pt \u003cspan class=\"keyword\"\u003e\\dp\u003c/span\u003e0=0pt \u003cspan class=\"keyword\"\u003e\\box\u003c/span\u003e0\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e     \u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{ b}}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e结果是\u003c/p\u003e\n\u003cp\u003e\u003cimg data-src=\"/uploads/images/LaTeX/ab.png\"/\u003e\u003c/p\u003e\n\u003cp\u003e稍稍修改之后\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{a}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e     \u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e0=\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{(}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e     \u003cspan class=\"keyword\"\u003e\\ht\u003c/span\u003e0=0pt \u003cspan class=\"keyword\"\u003e\\dp\u003c/span\u003e0=0pt \u003cspan class=\"keyword\"\u003e\\box\u003c/span\u003e0\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e     \u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{ b}}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e结果变成了\u003c/p\u003e\n\u003cp\u003e\u003cimg data-src=\"/uploads/images/LaTeX/abprime.png\"/\u003e\u003c/p\u003e\n\u003cp\u003e造成这一区别的原因在于，水平盒子的摆放位置由其参考点确定，而竖直盒子的摆放位置由其左上角确定。\u003c/p\u003e\n\u003ch3 id=\"将-lastbox-还回列表\"\u003e\u003ca href=\"#将-lastbox-还回列表\" class=\"headerlink\" title=\"将 \\lastbox 还回列表\"\u003e\u003c/a\u003e将 \u003ccode\u003e\\lastbox\u003c/code\u003e 还回列表\u003c/h3\u003e\u003cp\u003e通过 \u003ccode\u003e\\lastbox\u003c/code\u003e 你可以将（内部）竖直列表中最后一个盒子取出。但是，如果你想把取出的盒子换回去，则竖直间距可能会出问题。比如说，如果你这样将它换回去，则行间伸缩胶会有两份。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\tmpbox\u003c/span\u003e=\u003cspan class=\"keyword\"\u003e\\lastbox\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\usethetmpbox\u003c/span\u003e \u003cspan class=\"keyword\"\u003e\\box\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\tmpbox\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e而如果你在换回去之前使用 \u003ccode\u003e\\unskip\u003c/code\u003e 命令，看上去解决了问题，但实际上错得更加微妙：\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\tmpbox\u003c/span\u003e=\u003cspan class=\"keyword\"\u003e\\lastbox\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\unskip\u003c/span\u003e \u003cspan class=\"keyword\"\u003e\\usethetmpbox\u003c/span\u003e \u003cspan class=\"keyword\"\u003e\\box\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\tmpbox\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e此时，内部距离（\u003ccode\u003e\u0026lt;internal dimen\u0026gt;\u003c/code\u003e）\u003ccode\u003e\\prevdepth\u003c/code\u003e（控制行间伸缩胶；见后续章节）的值会因最后一个盒子而改变，但正确的行间伸缩胶应该由上一个盒子来决定。正确的方法不是使用 \u003ccode\u003e\\unskip\u003c/code\u003e，而是使用 \u003ccode\u003e\\nointerlineskip\u003c/code\u003e：\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\tmpbox\u003c/span\u003e=\u003cspan class=\"keyword\"\u003e\\lastbox\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\usethetmpbox\u003c/span\u003e \u003cspan class=\"keyword\"\u003e\\nointerlineskip\u003c/span\u003e \u003cspan class=\"keyword\"\u003e\\box\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\tmpbox\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003ch3 id=\"使用-lastbox-切分自然段\"\u003e\u003ca href=\"#使用-lastbox-切分自然段\" class=\"headerlink\" title=\"使用 \\lastbox 切分自然段\"\u003e\u003c/a\u003e使用 \u003ccode\u003e\\lastbox 切分自然段\u003c/code\u003e\u003c/h3\u003e\u003cp\u003e反复调用 \u003ccode\u003e\\last...\u003c/code\u003e 和 \u003ccode\u003e\\un...\u003c/code\u003e 可以将自然段切分开。这里给出一个例子。\u003c/p\u003e\n\u003cp\u003e\u003cimg data-src=\"/uploads/images/LaTeX/eatlines.png\"/\u003e\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\newbox\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\linebox\u003c/span\u003e \u003cspan class=\"keyword\"\u003e\\newbox\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\snapbox\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\def\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\eatlines\u003c/span\u003e{\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e   \u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\linebox\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\lastbox\u003c/span\u003e    \u003cspan class=\"comment\"\u003e% check the last line\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e   \u003cspan class=\"keyword\"\u003e\\ifvoid\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\linebox\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e   \u003cspan class=\"keyword\"\u003e\\else\u003c/span\u003e                      \u003cspan class=\"comment\"\u003e% if it\u0026#39;s not empty\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e   \u003cspan class=\"keyword\"\u003e\\unskip\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\unpenalty\u003c/span\u003e          \u003cspan class=\"comment\"\u003e% take whatever is\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e   {\u003cspan class=\"keyword\"\u003e\\eatlines\u003c/span\u003e}                \u003cspan class=\"comment\"\u003e% above it;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                              \u003cspan class=\"comment\"\u003e% collapse the line\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e   \u003cspan class=\"keyword\"\u003e\\setbox\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\snapbox\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\hbox\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\unhcopy\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\linebox\u003c/span\u003e}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                      \u003cspan class=\"comment\"\u003e% depending on the difference\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e   \u003cspan class=\"keyword\"\u003e\\ifdim\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\wd\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\snapbox\u003c/span\u003e\u0026lt;.98\u003cspan class=\"keyword\"\u003e\\wd\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\linebox\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e         \u003cspan class=\"keyword\"\u003e\\box\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\snapbox\u003c/span\u003e \u003cspan class=\"comment\"\u003e% take the one or the other,\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e   \u003cspan class=\"keyword\"\u003e\\else\u003c/span\u003e \u003cspan class=\"keyword\"\u003e\\box\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\linebox\u003c/span\u003e \u003cspan class=\"keyword\"\u003e\\fi\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e   \u003cspan class=\"keyword\"\u003e\\fi\u003c/span\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e它的使用方式是\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\vbox\u003c/span\u003e{ ... some text ... \u003cspan class=\"keyword\"\u003e\\par\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\eatlines\u003c/span\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e或者也可以用 \u003ccode\u003e\\everypar\u003c/code\u003e 自动插入。\u003c/p\u003e\n\u003cp\u003e宏 \u003ccode\u003e\\eatlines\u003c/code\u003e 会从竖直列表取得 \u003ccode\u003e\\lastbox\u003c/code\u003e。如果列表为空，则 \u003ccode\u003e\\ifvoid\u003c/code\u003e 将返回真。这些盒子都是水平盒子，每个盒子包含了段落中的一行：如果使用 \u003ccode\u003e\\ifhbox\u003c/code\u003e 来判断盒子分类的话，将返回真。\u003c/p\u003e\n\n    \u003c/div\u003e",
  "Date": "2018-05-21T09:11:35Z",
  "Author": "Liam Huang"
}