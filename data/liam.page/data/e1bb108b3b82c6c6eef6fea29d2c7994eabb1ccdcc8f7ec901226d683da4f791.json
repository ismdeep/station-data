{
  "Source": "liam.page",
  "Title": "踩坑：value to great for base",
  "Link": "https://liam.page/2019/11/11/value-too-great-for-base-in-shell/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\n\n      \n        \u003cp\u003e前几天启动的定时任务，有几个实例挂掉了。报错提示：\u003c/p\u003e\n\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003evalue too great for base (error token is \u0026#34;08\u0026#34;)\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\n\u003cp\u003e出错的相关代码如下：\u003c/p\u003e\n\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eif [ $((${hour_s} + ${hour_diff})) -gt 23 ]; then\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta prompt_\"\u003e  # \u003c/span\u003e\u003cspan class=\"language-bash\"\u003efoo bar\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003efi\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e这里 \u003ccode\u003e${hour_s}\u003c/code\u003e 是当前标定时间的小时数。形如 \u003ccode\u003e00\u003c/code\u003e, \u003ccode\u003e01\u003c/code\u003e, \u003ccode\u003e02\u003c/code\u003e, ..., \u003ccode\u003e08\u003c/code\u003e, \u003ccode\u003e09\u003c/code\u003e, ..., \u003ccode\u003e23\u003c/code\u003e。\u003ccode\u003e${hour_diff}\u003c/code\u003e 是需要向后处理的小时数。这段代码的意图，是判断二者相加是否大于 \u003ccode\u003e23\u003c/code\u003e。若大于 \u003ccode\u003e23\u003c/code\u003e，则需要在日期上 \u003ccode\u003e+1\u003c/code\u003e，否则只需要操作小时即可限定数据范围。\u003c/p\u003e\n\u003cp\u003e关键就在于 \u003ccode\u003e08\u003c/code\u003e 和 \u003ccode\u003e09\u003c/code\u003e 的意思。这里 \u003ccode\u003e08\u003c/code\u003e 是上午八点的意思，为了保持格式一致，在 \u003ccode\u003e8\u003c/code\u003e 的前面填充了 \u003ccode\u003e0\u003c/code\u003e。但 Shell 把它当成是八进制（base is 8）。这样一来，怪不得 Shell 认为 \u003ccode\u003e08\u003c/code\u003e 是不合法的八进制数。为解决这个问题，我们需要告知 Shell 这是个前面填充了 0 的十进制数。于是我们需要改成这样：\u003c/p\u003e\n\u003cfigure class=\"highlight shell\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eif [ $((10#${hour_s} + ${hour_diff})) -gt 23 ]; then\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta prompt_\"\u003e  # \u003c/span\u003e\u003cspan class=\"language-bash\"\u003efoo bar\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003efi\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n    \u003c/div\u003e",
  "Date": "2019-11-11T01:57:34Z",
  "Author": "Liam Huang"
}