{
  "Source": "liam.page",
  "Title": "嘿嘿嘿使 TeX 爆炸",
  "Link": "https://liam.page/2020/04/28/hhh-explodes-TeX/",
  "Content": "\u003cdiv class=\"post-body\" itemprop=\"articleBody\"\u003e\n\n      \n        \u003cp\u003eTeX 里有 \u003ccode\u003e\\leavevmode\u003c/code\u003e 用来从竖直模式中切出去，那么有没有 \u003ccode\u003e\\leavehmode\u003c/code\u003e 呢？一定会有好奇宝宝好奇这个奇怪的问题的。\u003c/p\u003e\n\u003cp\u003e答案是：\u003cdel\u003e嘿嘿嘿使 TeX 爆炸\u003c/del\u003e不存在。\u003c/p\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\n\u003cp\u003eTeX 总是从竖直模式开始，然后一旦遇到水平命令时，就会离开竖直模式，然后开始构建段落。除非结束这个段落，TeX 是不会离开水平模式的。\u003c/p\u003e\n\u003cp\u003e怎么结束这个段落？当然是你熟知的 \u003ccode\u003e\\par\u003c/code\u003e 命令。实际上，任何会导致 TeX 离开水平模式的命令，都会调用 \u003ccode\u003e\\par\u003c/code\u003e 这个命令——这里的 \u003ccode\u003e\\par\u003c/code\u003e 是最原始到那个 \u003ccode\u003e\\par\u003c/code\u003e 原语。如果你把 \u003ccode\u003e\\par\u003c/code\u003e 定义成了一个不包含原语版的 \u003ccode\u003e\\par\u003c/code\u003e 的时候，所有导致 TeX 离开水平模式的命令都会导致死循环。比如下面代码：\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\def\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\par\u003c/span\u003e{}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003ex\u003cspan class=\"keyword\"\u003e\\vskip\u003c/span\u003e 1pt\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e（你看，让 TeX 死循环就这么简单）\u003c/p\u003e\n\u003cp\u003e所以，不存在 \u003ccode\u003e\\leavehmode\u003c/code\u003e 这种东西。能让 TeX 离开水平模式的只有 \u003ccode\u003e\\par\u003c/code\u003e。\u003c/p\u003e\n\u003cp\u003e不过，存在一种情况下，TeX 可以部分地离开模式——\u003ccode\u003e\\vadjust\u003c/code\u003e 命令。在水平模式中遇到 \u003ccode\u003e\\vadjust\u003c/code\u003e 时，TeX 会把它的参数中的所有竖直元素打包在一起暂存，然后等到断行成段之后，TeX 再把 \u003ccode\u003e\\vadjust\u003c/code\u003e 里的内容插入到 \u003ccode\u003e\\vadjust\u003c/code\u003e 存在的那一行之后。比如：\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\documentclass\u003c/span\u003e{ctexart}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\usepackage\u003c/span\u003e{zhlipsum}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\begin\u003c/span\u003e{document}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e嘿嘿嘿\u003cspan class=\"keyword\"\u003e\\vadjust\u003c/span\u003e{\u003cspan class=\"keyword\"\u003e\\vskip\u003c/span\u003e 3ex}\u003cspan class=\"keyword\"\u003e\\zhlipsum\u003c/span\u003e[3]\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\end\u003c/span\u003e{document}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e\u003cimg data-src=\"/uploads/images/LaTeX/vadjust.jpg\"/\u003e\u003c/p\u003e\n\u003chr/\u003e\n\u003cp\u003e那么为什么「嘿嘿嘿使 TeX 爆炸」呢？因为当你把 \u003ccode\u003e\\par\u003c/code\u003e 定义成「嘿嘿嘿」的时候，TeX 就会因为陷入死循环而不断地把「嘿嘿嘿」塞入内存，然后就炸掉了。\u003c/p\u003e\n\u003cfigure class=\"highlight tex\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\documentclass\u003c/span\u003e{ctexart}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\begin\u003c/span\u003e{document}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\def\u003c/span\u003e\u003cspan class=\"keyword\"\u003e\\par\u003c/span\u003e{嘿嘿嘿}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003ex\u003cspan class=\"keyword\"\u003e\\vskip\u003c/span\u003e 1pt\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003e\\end\u003c/span\u003e{document}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n\u003cp\u003e日志如下：\u003c/p\u003e\n\u003cfigure class=\"highlight text\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e(./ltxtest.aux) ABD: EverySelectfont initializing macros\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e! TeX capacity exceeded, sorry [main memory size=5000000].\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u0026lt;to be read again\u0026gt;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e                   \\vskip\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003el.4 x\\vskip\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            1pt\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eNo pages of output.\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eTranscript written on ltxtest.log.\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\n    \u003c/div\u003e",
  "Date": "2020-04-28T11:48:31Z",
  "Author": "Liam Huang"
}