{
  "Source": "morningspace",
  "Title": "OpenShift v3的填坑之旅",
  "Link": "https://morningspace.github.io/tech/openshift-v3-trap-and-pitfalls/",
  "Content": "\u003cdiv class=\"page__inner-wrap\"\u003e\n      \n\n      \u003csection class=\"page__content e-content\" itemprop=\"text\"\u003e\n        \n          \u003caside class=\"sidebar__right sticky\"\u003e\n            \u003cnav class=\"toc\"\u003e\n              \u003cheader\u003e\u003ch4 class=\"nav__title\"\u003e\u003ci class=\"fas fa-file-alt\"\u003e\u003c/i\u003e 在本页上\u003c/h4\u003e\u003c/header\u003e\n              \u003cul class=\"toc__menu\"\u003e\u003cli\u003e\u003ca href=\"#openshift\"\u003eOpenShift\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"#坑1web-console登录总是重定向到127001\"\u003e坑#1：Web Console登录总是重定向到127.0.0.1\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"#坑2admission-webhook默认没有开启\"\u003e坑#2：Admission Webhook默认没有开启\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"#坑3api服务重启后不能立刻对外提供服务\"\u003e坑#3：API服务重启后不能立刻对外提供服务\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"#坑4hostpath-pv报permission-denied\"\u003e坑#4：HostPath PV报Permission denied\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"#坑5openshift的dns服务问题\"\u003e坑#5：OpenShift的DNS服务问题\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"#坑6openshiftlocalvolumes目录删除失败\"\u003e坑#6：openshift.local.volumes目录删除失败\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"#坑7docker-desktop在mac上的代理问题\"\u003e坑#7：Docker Desktop在Mac上的代理问题\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"#坑8varlibkubeletdevice-plugins问题\"\u003e坑#8：/var/lib/kubelet/device-plugins问题\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"#坑9openshift集群在mac上重启失败\"\u003e坑#9：OpenShift集群在Mac上重启失败\u003c/a\u003e\u003c/li\u003e\u003cli\u003e\u003ca href=\"#更多参考资料\"\u003e更多参考资料\u003c/a\u003e\u003c/li\u003e\u003c/ul\u003e\n\n            \u003c/nav\u003e\n          \u003c/aside\u003e\n        \n        \u003c!-- Place this tag in your head or just before your close body tag. --\u003e\n\u003cscript async=\"\" defer=\"\" src=\"https://buttons.github.io/buttons.js\"\u003e\u003c/script\u003e\n\n\u003cblockquote\u003e\n  \u003cp\u003e伴随着开源项目\u003ca href=\"https://github.com/morningspace/lab-k8s-playground\"\u003elab-k8s-playground\u003c/a\u003e v1.2的发布，All-in-One K8S Playground现在可以同时支持标准Kubernetes和OpenShift啦！本文总结了在支持OpenShift v3.11过程中遇到的一系列问题。如果您喜欢这个项目，欢迎点击下面的按钮，关注，加星，以及贡献代码^_^\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e\u003ca class=\"github-button\" href=\"https://github.com/morningspace/lab-k8s-playground/subscription\" data-icon=\"octicon-eye\" data-size=\"large\" aria-label=\"Watch morningspace/lab-k8s-playground on GitHub\"\u003eWatch\u003c/a\u003e \u003ca class=\"github-button\" href=\"https://github.com/morningspace/lab-k8s-playground\" data-icon=\"octicon-star\" data-size=\"large\" aria-label=\"Star morningspace/lab-k8s-playground on GitHub\"\u003eStar\u003c/a\u003e \u003ca class=\"github-button\" href=\"https://github.com/morningspace/lab-k8s-playground/fork\" data-icon=\"octicon-repo-forked\" data-size=\"large\" aria-label=\"Fork morningspace/lab-k8s-playground on GitHub\"\u003eFork\u003c/a\u003e\u003c/p\u003e\n\n\u003ch2 id=\"openshift\"\u003eOpenShift\u003c/h2\u003e\n\n\u003cp\u003e\u003cimg src=\"/assets/images/lab/k8s/openshift.png\" alt=\"\" class=\"align-center\"/\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://www.openshift.com/\"\u003eOpenShift\u003c/a\u003e是Red Hat开发的构筑于Kubernetes之上的企业级容器应用平台，为企业应用与服务的开发，管理，以及部署提供了全面的支持，是当前炙手可热的一款Kubernetes发行版本。其社区版称为\u003ca href=\"https://www.okd.io/\"\u003eOKD\u003c/a\u003e（OpenShift Kubernetes Distribution的缩写，原名Origin）。\u003c/p\u003e\n\n\u003cp\u003e在\u003ca href=\"/tech/all-in-one-openshift-playground/\"\u003eAll-in-One K8S Playground新增OpenShift支持\u003c/a\u003e一文中，我们已经了解了，如何利用\u003ca href=\"https://github.com/morningspace/lab-k8s-playground/\"\u003eAll-in-One Kubernetes Playground\u003c/a\u003e在单机环境下部署一个支持OKD v3.11版本的单节点集群，以及如何在上面部署\u003ca href=\"https://istio.io\"\u003eIstio\u003c/a\u003e和\u003ca href=\"https://developer.ibm.com/apiconnect\"\u003eAPI Connect\u003c/a\u003e。\u003c/p\u003e\n\n\u003cp\u003e本文将告诉你，All-in-One K8S Playground在支持OpenShift v3.11过程中遇到的一些问题，以及相应的解决办法。这其中，大部分问题的解决办法都已经通过脚本的形式固化在了All-in-One K8S Playground里，这也是该Playground的价值所在！\u003c/p\u003e\n\n\u003ch2 id=\"坑1web-console登录总是重定向到127001\"\u003e坑#1：Web Console登录总是重定向到127.0.0.1\u003c/h2\u003e\n\n\u003cp\u003e在本机启动OpenShift集群时，服务器的访问地址基本都是\u003ccode class=\"language-plaintext highlighter-rouge\"\u003e127.0.0.1\u003c/code\u003e。但有时候，我们也会在远程机器上部署OpenShift集群，这个时候的服务器访问地址通常就是某个具体的IP地址或者hostname了。\u003c/p\u003e\n\n\u003cp\u003e在利用\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eoc cluster up\u003c/code\u003e命令启动OpenShift的时候，OpenShift为我们提供了一个参数\u003ccode class=\"language-plaintext highlighter-rouge\"\u003e--public-hostname\u003c/code\u003e，用来指定集群启动起来以后服务器的访问地址。比如：\u003c/p\u003e\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003eoc cluster up \u003cspan class=\"nt\"\u003e--public-hostname\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"nv\"\u003e$HOST_IP\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e但即便如此，我们也经常会遇到OpenShift在登录Web Console时自动重定向到\u003ccode class=\"language-plaintext highlighter-rouge\"\u003e127.0.0.1\u003c/code\u003e这样的情况。这往往是由于，我们在上一次启动OpenShift时使用了\u003ccode class=\"language-plaintext highlighter-rouge\"\u003e127.0.0.1\u003c/code\u003e，而在本次启动OpenShift时又没有清除之前启动时留在本地的配置文件目录。这个时候，可以先清除本地OpenShift的配置文件目录，然后再启动OpenShift。\u003c/p\u003e\n\n\u003cblockquote\u003e\n  \u003cp\u003e在Playground里，配置文件目录在\u003ccode class=\"language-plaintext highlighter-rouge\"\u003e~/openshift.local.clusterup\u003c/code\u003e下，执行\u003ccode class=\"language-plaintext highlighter-rouge\"\u003elaunch kubernetes::clean\u003c/code\u003e时会为我们清除掉这个目录。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e有关这一问题的详细讨论，参见：\u003c/p\u003e\n\n\u003ctable\u003e\n  \u003cthead\u003e\n    \u003ctr\u003e\n      \u003cth\u003e网络资源\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ca href=\"https://github.com/openshift/origin/issues/20726\"\u003eAccess fail with ‘oc cluster up –public-hostname=public ip’ and redirect to 127.0.0.1\u003c/a\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch2 id=\"坑2admission-webhook默认没有开启\"\u003e坑#2：Admission Webhook默认没有开启\u003c/h2\u003e\n\n\u003cp\u003e在部署类似Istio这样的应用时，需要我们的Kubernetes集群开启\u003ca href=\"https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/\"\u003eAdmission Webhook\u003c/a\u003e。Kubernetes从v1.11开始默认就开启了这项功能。但是，OpenShift直到v3.11为止，默认都还没有开启它。\u003c/p\u003e\n\n\u003cp\u003e事实上，OpenShift的\u003ca href=\"https://github.com/openshift/origin\"\u003eGitHub库\u003c/a\u003e里是有专门的\u003ca href=\"https://github.com/openshift/origin/pull/20953\"\u003ePR\u003c/a\u003e用来解决这一问题的。但是由于种种原因，最后并没有进入v3.11。\u003c/p\u003e\n\n\u003cp\u003e在v3.11上解决这一问题的方法，可以参考\u003ca href=\"https://github.com/minishift/minishift\"\u003eMinishift\u003c/a\u003e的这个\u003ca href=\"https://github.com/minishift/minishift/pull/3044\"\u003ePR\u003c/a\u003e。\u003c/p\u003e\n\n\u003cblockquote\u003e\n  \u003cp\u003e在Playground里，执行\u003ccode class=\"language-plaintext highlighter-rouge\"\u003elaunch istio\u003c/code\u003e时，会自动完成对OpenShift配置的修改以开启Admission Webhook，并自动重启OpenShift的API服务，以使配置修改生效。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e有关这一问题的详细讨论，参见：\u003c/p\u003e\n\n\u003ctable\u003e\n  \u003cthead\u003e\n    \u003ctr\u003e\n      \u003cth\u003e网络资源\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ca href=\"https://github.com/openshift/origin/issues/20530\"\u003eConsider enabling admission webhooks by default with oc cluster up\u003c/a\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ca href=\"https://github.com/minishift/minishift/issues/2676\"\u003eEnable mutating and validating webhooks\u003c/a\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch2 id=\"坑3api服务重启后不能立刻对外提供服务\"\u003e坑#3：API服务重启后不能立刻对外提供服务\u003c/h2\u003e\n\n\u003cp\u003e为了启动Admission Webhook，我们需要对OpenShift的配置进行修改，并重启它的API服务。关于重启API服务的方法，可以参考\u003ca href=\"https://github.com/minishift/minishift\"\u003eMinishift\u003c/a\u003e的这个\u003ca href=\"https://github.com/minishift/minishift/pull/3044\"\u003ePR\u003c/a\u003e。\u003c/p\u003e\n\n\u003cp\u003e做为自动化脚本的一部分，我们需要在检测到API服务成功重启以后，继续后面的部署工作。为此，参照Minishift的做法，我们可以通过访问\u003ccode class=\"language-plaintext highlighter-rouge\"\u003e/healthz\u003c/code\u003e来判断OpenShift的API服务是否已经成功启动：\u003c/p\u003e\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003ecurl \u003cspan class=\"nt\"\u003e-k\u003c/span\u003e https://\u003cspan class=\"nv\"\u003e$HOST_IP\u003c/span\u003e:8443/healthz\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e通常，当\u003ccode class=\"language-plaintext highlighter-rouge\"\u003e/healthz\u003c/code\u003e返回\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eok\u003c/code\u003e的时候，就表示API服务可以对外提供服务了。但是，在实际测试的过程中发现，即使\u003ccode class=\"language-plaintext highlighter-rouge\"\u003e/healthz\u003c/code\u003e返回\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eok\u003c/code\u003e，某些OpenShift的操作仍然会失败。比如：\u003c/p\u003e\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003eoc login \u003cspan class=\"nt\"\u003e-u\u003c/span\u003e system:admin\nError from server \u003cspan class=\"o\"\u003e(\u003c/span\u003eInternalError\u003cspan class=\"o\"\u003e)\u003c/span\u003e: Internal error occurred: unexpected response: 400\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cblockquote\u003e\n  \u003cp\u003e在Playground里，当重启API服务时，除了检测\u003ccode class=\"language-plaintext highlighter-rouge\"\u003e/healthz\u003c/code\u003e，还增加了额外的检测机制，以保证重启后的API服务能够真正对外提供服务。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e有关这一问题的详细讨论，参见：\u003c/p\u003e\n\n\u003ctable\u003e\n  \u003cthead\u003e\n    \u003ctr\u003e\n      \u003cth\u003e网络资源\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ca href=\"https://github.com/openshift/origin/issues/23864\"\u003eHow to detect if apiserver is fully restarted and ready for use\u003c/a\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch2 id=\"坑4hostpath-pv报permission-denied\"\u003e坑#4：HostPath PV报Permission denied\u003c/h2\u003e\n\n\u003cp\u003e部署API Connect时，我们使用了HostPath类型的Persistent Volume。但很多Pod在启动过程中都会遇到创建目录或文件失败的情况，从而导致Pod启动失败。比如：\u003c/p\u003e\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003eklo r31f4a26f5e-apiconnect-cc-0 \u003cspan class=\"nt\"\u003e-n\u003c/span\u003e apiconnect\n\u003cspan class=\"nb\"\u003emkdir\u003c/span\u003e: cannot create directory \u003cspan class=\"s1\"\u003e\u0026#39;/var/db/data\u0026#39;\u003c/span\u003e: Permission denied\n\u003cspan class=\"nb\"\u003emkdir\u003c/span\u003e: cannot create directory \u003cspan class=\"s1\"\u003e\u0026#39;/var/db/logs\u0026#39;\u003c/span\u003e: Permission denied\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e这是因为大多数API Connect的Pod都以非root用户运行，而在宿主机上创建的Persistent Volume目录，默认权限都是\u003ccode class=\"language-plaintext highlighter-rouge\"\u003edrwxr-xr-x\u003c/code\u003e，即：\u003ccode class=\"language-plaintext highlighter-rouge\"\u003egroup\u003c/code\u003e和\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eother\u003c/code\u003e对目录都没有写的权限，导致Pod在这些目录下无法创建子目录或文件。\u003c/p\u003e\n\n\u003cp\u003e根据实际测试，除了按照API Connect的文档，把\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eanyuid\u003c/code\u003e这个Security Context Constraint赋给\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eapiconnect\u003c/code\u003e名字空间下的所有service account之外：\u003c/p\u003e\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003eoc adm policy add-scc-to-group anyuid system:serviceaccounts:apiconnect\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e我们还需要为Persistent Volume目录及其子目录和文件赋予更大的权限：\u003c/p\u003e\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003e\u003cspan class=\"nb\"\u003echmod \u003c/span\u003eugo+rwx \u003cspan class=\"nt\"\u003e-R\u003c/span\u003e /path/to/apic/pv\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cblockquote\u003e\n  \u003cp\u003e在Playground里，\u003ccode class=\"language-plaintext highlighter-rouge\"\u003elaunch apic\u003c/code\u003e会帮我们自动创建API Connect运行所需的Persistent Volume目录及其子目录，并为它们赋予足够的权限。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e有关这一问题的详细讨论，参见：\u003c/p\u003e\n\n\u003ctable\u003e\n  \u003cthead\u003e\n    \u003ctr\u003e\n      \u003cth\u003e网络资源\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ca href=\"https://github.com/kubernetes/minikube/issues/1990\"\u003eDirectories provisioned by hostPath provisioner are only writeable by root\u003c/a\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ca href=\"https://github.com/openshift/origin/issues/9131\"\u003ePermission denied in pod\u003c/a\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ca href=\"https://github.com/rook/rook/issues/1314\"\u003eOpenShift: insufficient permission inside the containers\u003c/a\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch2 id=\"坑5openshift的dns服务问题\"\u003e坑#5：OpenShift的DNS服务问题\u003c/h2\u003e\n\n\u003cp\u003eAPI Connect在运行期间需要通过指定的域名来访问它所提供的服务，这就要用到DNS服务了。标准的Kubernetes从v1.13开始就默认使用\u003ca href=\"https://coredns.io/\"\u003eCoreDNS\u003c/a\u003e来替代原来的Kube-DNS实现了。基于CoreDNS，我们可以利用它的\u003ca href=\"https://coredns.io/plugins/hosts/\"\u003ehosts\u003c/a\u003e插件为API Connect指定静态DNS规则，就像在\u003ccode class=\"language-plaintext highlighter-rouge\"\u003e/etc/hosts\u003c/code\u003e里配置\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eIP-Host\u003c/code\u003e映射一样。\u003c/p\u003e\n\n\u003cp\u003e而OpenShift的DNS服务，到v3.11为止，一直都是基于一个叫做\u003ca href=\"https://github.com/skynetservices/skydns\"\u003eSkyDNS\u003c/a\u003e的项目实现的。通过尝试发现，它并没有提供类似CoreDNS的hosts插件那样的方法对DNS进行定制。因此，我们需要为OpenShift配置额外的DNS服务器，甚至可能要搭建自己的DNS服务器。对于只是配置静态DNS规则这样的简单需求而言，这个方案就有点过于复杂了。\u003c/p\u003e\n\n\u003cblockquote\u003e\n  \u003cp\u003e目前，Playground采用的解决办法是基于\u003ca href=\"https://nip.io/\"\u003enip.io\u003c/a\u003e的公共DNS服务，实现域名到IP的自动转换。事实上，OpenShift通过route定义暴露集群服务默认也是用的nip.io。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e根据OpenShift 4.1的\u003ca href=\"https://docs.openshift.com/container-platform/4.1/release_notes/ocp-4-1-release-notes.html\"\u003eRelease Notes\u003c/a\u003e，似乎从v4.x开始，OpenShift用CoreDNS取代了原来的SkyDNS。从相应的\u003ca href=\"https://github.com/openshift/origin/pull/22270\"\u003ePR\u003c/a\u003e里可以看到，所有和SkyDNS相关的逻辑也都被清除掉了。\u003c/p\u003e\n\n\u003cp\u003e有关这一问题的详细讨论，参见：\u003c/p\u003e\n\n\u003ctable\u003e\n  \u003cthead\u003e\n    \u003ctr\u003e\n      \u003cth\u003e网络资源\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ca href=\"https://github.com/openshift/origin/issues/23769\"\u003eWhat’s the simplest way to setup IP host mappings for OpenShift … cluster?\u003c/a\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ca href=\"https://github.com/openshift/origin/issues/21422\"\u003eWhy OKD 3.11 with Kubernetes 1.11,but not use CoreDNS?\u003c/a\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch2 id=\"坑6openshiftlocalvolumes目录删除失败\"\u003e坑#6：openshift.local.volumes目录删除失败\u003c/h2\u003e\n\n\u003cp\u003e当我们用\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eoc cluster down\u003c/code\u003e把OpenShift集群停掉时，有时也希望把OpenShift留在本地的配置文件目录一并删除掉。但在CentOS和RHEL上，删除这个目录时会报错：\u003c/p\u003e\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003e\u003cspan class=\"nb\"\u003erm\u003c/span\u003e \u003cspan class=\"nt\"\u003e-rf\u003c/span\u003e ~/openshift.local.clusterup\n\u003cspan class=\"nb\"\u003erm\u003c/span\u003e: cannot remove ‘openshift.local.clusterup/openshift.local.volumes/pods/916be4fd-e32f-11e9-b688-005056bcdc55/volumes/kubernetes.io~secret/serving-cert’: Device or resource busy\n...\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e这是由于OpenShift集群在运行期间会为Pod在宿主机上设置mount点，而停掉集群的时候，这些mount点由于某些原因，并没有被正确地unmount。解决这一问题的方法是手工对它们进行unmount，具体做法可以参考这个\u003ca href=\"https://github.com/openshift/origin/pull/4982\"\u003ePR\u003c/a\u003e。\u003c/p\u003e\n\n\u003cblockquote\u003e\n  \u003cp\u003e在Playground里，执行\u003ccode class=\"language-plaintext highlighter-rouge\"\u003elaunch kubernetes::clean\u003c/code\u003e时会自动帮我们寻找当前还没有被unmount的与OpenShift有关的目录，并逐一执行unmount。\u003c/p\u003e\n\u003c/blockquote\u003e\n\n\u003cp\u003e有关这一问题的详细讨论，参见：\u003c/p\u003e\n\n\u003ctable\u003e\n  \u003cthead\u003e\n    \u003ctr\u003e\n      \u003cth\u003e网络资源\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ca href=\"https://github.com/openshift/origin/pull/2629\"\u003eUmount secret volumes before trying to remove\u003c/a\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch2 id=\"坑7docker-desktop在mac上的代理问题\"\u003e坑#7：Docker Desktop在Mac上的代理问题\u003c/h2\u003e\n\n\u003cp\u003e在Mac上启动Openshift时，会在集群启动结束时见到下面的警告信息：\u003c/p\u003e\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003eWARNING: An HTTP proxy \u003cspan class=\"o\"\u003e(\u003c/span\u003egateway.docker.internal:3128\u003cspan class=\"o\"\u003e)\u003c/span\u003e is configured \u003cspan class=\"k\"\u003efor \u003c/span\u003ethe Docker daemon, but you did not specify one \u003cspan class=\"k\"\u003efor \u003c/span\u003ecluster up\nWARNING: An HTTPS proxy \u003cspan class=\"o\"\u003e(\u003c/span\u003egateway.docker.internal:3129\u003cspan class=\"o\"\u003e)\u003c/span\u003e is configured \u003cspan class=\"k\"\u003efor \u003c/span\u003ethe Docker daemon, but you did not specify one \u003cspan class=\"k\"\u003efor \u003c/span\u003ecluster up\nWARNING: A proxy is configured \u003cspan class=\"k\"\u003efor \u003c/span\u003eDocker, however 172.30.1.1 is not included \u003cspan class=\"k\"\u003ein \u003c/span\u003eits NO_PROXY list.\n   172.30.1.1 needs to be included \u003cspan class=\"k\"\u003ein \u003c/span\u003ethe Docker daemon\u003cspan class=\"s1\"\u003e\u0026#39;s NO_PROXY environment variable so pushes to the local OpenShift registry can succeed.\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e这是由于Docker Desktop for Mac从某个版本开始引入了一种内部代理机制，叫做“transparent proxy”。如果执行\u003ccode class=\"language-plaintext highlighter-rouge\"\u003edocker info\u003c/code\u003e命令，我们可以看到，\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eHTTP Proxy\u003c/code\u003e和\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eHTTPS Proxy\u003c/code\u003e这两项被设置成了相应的值：\u003c/p\u003e\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003edocker info|grep \u003cspan class=\"nt\"\u003e-i\u003c/span\u003e proxy\n HTTP Proxy: gateway.docker.internal:3128\n HTTPS Proxy: gateway.docker.internal:3129\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e即便运行Docker时不需要代理，这两个值也是始终存在的。OpenShift在启动时提供了相应的命令行参数：\u003ccode class=\"language-plaintext highlighter-rouge\"\u003e--http-proxy\u003c/code\u003e，\u003ccode class=\"language-plaintext highlighter-rouge\"\u003e--https-proxy\u003c/code\u003e，可以帮我们把这两个值传给OpenShift。\u003c/p\u003e\n\n\u003cp\u003e另一方面，做为OpenShift的内部Docker Registry，IP地址为\u003ccode class=\"language-plaintext highlighter-rouge\"\u003e172.30.1.11\u003c/code\u003e，是不需要经过代理的，因此它应该出现在\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eNO_PROXY\u003c/code\u003e环境变量里。\u003c/p\u003e\n\n\u003cp\u003e但问题是，我们通过Docker Desktop提供的界面对\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eNO_PROXY\u003c/code\u003e的设置并不起作用（Preferences… \u0026gt; Proxies \u0026gt; Manual proxy configuration \u0026gt; Bypass proxy settings for these hosts \u0026amp; domains）。\u003c/p\u003e\n\n\u003cp\u003e目前为止，Docker Desktop的最新版本还没有修复这个问题。不过，据称它的17.09.1-ce-mac42版本是可以工作的。因此，现在解决这一问题的唯一方法是安装低版本的Docker Desktop。\u003c/p\u003e\n\n\u003cp\u003e有关这一问题的详细讨论，参见：\u003c/p\u003e\n\n\u003ctable\u003e\n  \u003cthead\u003e\n    \u003ctr\u003e\n      \u003cth\u003e网络资源\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ca href=\"https://github.com/docker/for-mac/issues/2732\"\u003eDocker for Mac \u003ccode class=\"language-plaintext highlighter-rouge\"\u003eno_proxy\u003c/code\u003e not honored\u003c/a\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ca href=\"https://github.com/docker/for-mac/issues/2467\"\u003eUnwanted Proxy\u003c/a\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ca href=\"https://github.com/openshift/origin/issues/19528\"\u003eApplication deployment failing when cluster setup using oc cluster up on Mac\u003c/a\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ca href=\"https://github.com/openshift/origin/issues/18596\"\u003ecluster up fails to push to the registry on Docker for Mac CE 17.12.0 and newer\u003c/a\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ca href=\"https://github.com/openshift/origin/issues/11323\"\u003eoc cluster up does not work in a proxied environment\u003c/a\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ca href=\"https://lists.openshift.redhat.com/openshift-archives/users/2018-February/msg00017.html\"\u003eNo persistent volumes available in OpenShift Origin 3.7.1\u003c/a\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch2 id=\"坑8varlibkubeletdevice-plugins问题\"\u003e坑#8：/var/lib/kubelet/device-plugins问题\u003c/h2\u003e\n\n\u003cp\u003e在Mac上启动OpenShift还会遇到下面的错误，导致集群启动失败：\u003c/p\u003e\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003eMounts denied: The path /var/lib/kubelet/device-plugins is not shared from OS X and is not known to Docker. You can configure shared paths from Docker -\u0026gt; Preferences... -\u0026gt; File Sharing. See https://docs.docker.com/docker-for-mac/osxfs/#namespaces \u003cspan class=\"k\"\u003efor \u003c/span\u003emore info.\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e一种解决办法，是通过Docker Desktop for Mac的Preferences界面，先把Kubernetes开启，然后再把它关闭：Preferences… \u0026gt; Kubernetes \u0026gt; Enable Kubernetes。\u003c/p\u003e\n\n\u003cp\u003e有关这一问题的详细讨论，参见：\u003c/p\u003e\n\n\u003ctable\u003e\n  \u003cthead\u003e\n    \u003ctr\u003e\n      \u003cth\u003e网络资源\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ca href=\"https://github.com/openshift/origin/issues/21230\"\u003eopenshift v3.11 does not start on Mac OS X\u003c/a\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch2 id=\"坑9openshift集群在mac上重启失败\"\u003e坑#9：OpenShift集群在Mac上重启失败\u003c/h2\u003e\n\n\u003cp\u003e这个问题同样是和Mac相关的，当我们在先前已经成功启动过OpenShift集群的Mac机器上再次启动OpenShift时，会遇到因为端口被占用的错误而导致重启失败：\u003c/p\u003e\n\u003cdiv class=\"language-plaintext highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003eGetting a Docker client ...\nChecking if image openshift/origin-control-plane:v3.11 is available ...\nChecking type of volume mount ...\nDetermining server IP ...\nChecking if OpenShift is already running ...\nChecking for supported Docker version (=\u0026gt;1.22) ...\nChecking if insecured registry is configured properly in Docker ...\nChecking if required ports are available ...\nerror: a port needed by OpenShift is not available\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e这是由于，Docker Desktop默认会把Kubernetes相关的系统级Docker容器隐藏起来，包括：那些\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ek8s_POD_\u003c/code\u003e打头的容器，以及\u003ccode class=\"language-plaintext highlighter-rouge\"\u003ekube_system\u003c/code\u003e名字空间下的容器，它们用\u003ccode class=\"language-plaintext highlighter-rouge\"\u003edocker ps\u003c/code\u003e是查不到的。\u003c/p\u003e\n\n\u003cp\u003e另一方面，\u003ccode class=\"language-plaintext highlighter-rouge\"\u003eoc cluster down\u003c/code\u003e在执行时由于获取不到这些系统级容器，所以也就无法停掉它们。OpenShift集群运行所需要的端口，就是被这些容器占用的。利用\u003ccode class=\"language-plaintext highlighter-rouge\"\u003elsof\u003c/code\u003e命令可以看到，具体的端口包括\u003ccode class=\"language-plaintext highlighter-rouge\"\u003e1936\u003c/code\u003e，\u003ccode class=\"language-plaintext highlighter-rouge\"\u003e443\u003c/code\u003e，\u003ccode class=\"language-plaintext highlighter-rouge\"\u003e80\u003c/code\u003e：\u003c/p\u003e\n\u003cdiv class=\"language-shell highlighter-rouge\"\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre class=\"highlight\"\u003e\u003ccode\u003e\u003cspan class=\"nv\"\u003e$ \u003c/span\u003elsof \u003cspan class=\"nt\"\u003e-Pni\u003c/span\u003e|grep com.docke.\u003cspan class=\"k\"\u003e*\u003c/span\u003eTCP.\u003cspan class=\"k\"\u003e*\u003c/span\u003eLISTEN\ncom.docke 45430 moyingbj    7u  IPv4 0x6dcd0b5b57f496b1      0t0  TCP 127.0.0.1:56861 \u003cspan class=\"o\"\u003e(\u003c/span\u003eLISTEN\u003cspan class=\"o\"\u003e)\u003c/span\u003e\ncom.docke 45434 moyingbj   15u  IPv6 0x6dcd0b5b2df9e889      0t0  TCP \u003cspan class=\"k\"\u003e*\u003c/span\u003e:1936 \u003cspan class=\"o\"\u003e(\u003c/span\u003eLISTEN\u003cspan class=\"o\"\u003e)\u003c/span\u003e\ncom.docke 45434 moyingbj   17u  IPv6 0x6dcd0b5b3066f2c9      0t0  TCP \u003cspan class=\"k\"\u003e*\u003c/span\u003e:443 \u003cspan class=\"o\"\u003e(\u003c/span\u003eLISTEN\u003cspan class=\"o\"\u003e)\u003c/span\u003e\ncom.docke 45434 moyingbj   20u  IPv6 0x6dcd0b5b3066ed09      0t0  TCP \u003cspan class=\"k\"\u003e*\u003c/span\u003e:80 \u003cspan class=\"o\"\u003e(\u003c/span\u003eLISTEN\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/div\u003e\n\n\u003cp\u003e解决的办法同样是通过Docker Desktop for Mac的Preferences界面，首先开启Kubernetes，然后确保勾选了“Show system containers (advanced)”，最后再关闭Kubernetes。\u003c/p\u003e\n\n\u003cp\u003e\u003cimg src=\"/assets/images/lab/k8s/docker-mac-k8s-settings.png\" alt=\"\" class=\"align-center\"/\u003e\u003c/p\u003e\n\n\u003cp\u003e有关这一问题的详细讨论，参见：\u003c/p\u003e\n\n\u003ctable\u003e\n  \u003cthead\u003e\n    \u003ctr\u003e\n      \u003cth\u003e网络资源\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ca href=\"https://github.com/openshift/origin/issues/22381\"\u003eerror: a port needed by OpenShift is not available\u003c/a\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003ctd\u003e\u003ca href=\"https://github.com/openshift/origin/issues/19486\"\u003eoc cluster down leave hypershift process running when using docker for mac\u003c/a\u003e\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\n\u003ch2 id=\"更多参考资料\"\u003e更多参考资料\u003c/h2\u003e\n\n\u003cp\u003e读到这里，相信你对开源项目\u003ca href=\"https://github.com/morningspace/lab-k8s-playground\"\u003elab-k8s-playground\u003c/a\u003e及其All-in-One Playground的应用应该有了更全面的了解了。那么，还有哪些参考资料你可以访问呢？那就请快速读一下下面这段Shell脚本编写的“代码”吧😊 相信一定难不倒你！\u003c/p\u003e\n\n\u003cp\u003e选择你感兴趣的分支，点击相应分支下列出的文档资源。最后，如果您喜欢这个项目，欢迎点击本文开头处（或下列代码注释里）的按钮，关注，加星，以及贡献代码^_^\u003c/p\u003e\n\n\u003cp style=\"background-color: #111; padding: 1em; text-align: left; font-size: 20px\"\u003e\n\u003ccode style=\"outline: none; box-sizing: border-box; font-family: Monaco, Consolas, \u0026#34;Lucida Console\u0026#34;, monospace; background-color: #111\"\u003e\n\u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(173, 0, 161);\"\u003efunction\u003cspan\u003e \u003c/span\u003e\u003c/span\u003ewhere_to_start\u003cspan\u003e \u003c/span\u003e\u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(31, 170, 170);\"\u003e{\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n  \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(173, 0, 161);\"\u003ecase\u003c/span\u003e \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(255, 0, 134);\"\u003e$I_want\u003c/span\u003e \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(173, 0, 161);\"\u003ein\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n  \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(0, 201, 24);\"\u003e\u0026#34;to learn what it provides in general\u0026#34;\u003c/span\u003e\u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003e)\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n    \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003ecat\u003c/span\u003e \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(55, 119, 230);\"\u003e\u0026#34;\u003ca href=\"https://morningspace.github.io/lab-k8s-playground/docs/All-in-One-Playground-Overview.html\" rel=\"noopener\" target=\"_blank\"\u003eAll-in-One K8S Playground Overview\u003c/a\u003e\u0026#34;\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n    \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003e;;\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n  \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(0, 201, 24);\"\u003e\u0026#34;to get started quickly\u0026#34;\u003c/span\u003e\u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003e)\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n    \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003ecat\u003c/span\u003e \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(55, 119, 230);\"\u003e\u0026#34;\u003ca href=\"https://morningspace.github.io/lab-k8s-playground/docs/All-in-One-Playground-Usage-Guide.html\" rel=\"noopener\" target=\"_blank\"\u003eAll-in-One K8S Playground Usage Guide\u003c/a\u003e\u0026#34;\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n    \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003ecat\u003c/span\u003e \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(55, 119, 230);\"\u003e\u0026#34;\u003ca href=\"http://localhost:4000/tech/all-in-one-k8s-playground\" rel=\"noopener\" target=\"_blank\"\u003eAll-in-One K8S Playground 中文使用指南\u003c/a\u003e\u0026#34;\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n    \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003e;;\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n  \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(0, 201, 24);\"\u003e\u0026#34;to understand what\u0026#39;s behind\u0026#34;\u003c/span\u003e\u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003e)\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n    \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003ecat\u003c/span\u003e \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(55, 119, 230);\"\u003e\u0026#34;\u003ca href=\"https://morningspace.github.io/tech/k8s-run\" rel=\"noopener\" target=\"_blank\"\u003eLaunch multi-node k8s cluster locally in one min...\u003c/a\u003e\u0026#34;\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n    \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003ecat\u003c/span\u003e \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(55, 119, 230);\"\u003e\u0026#34;\u003ca href=\"https://v.youku.com/v_show/id_XNDI2Mzk1NDcyMA==.html?f=52221532\" rel=\"noopener\" target=\"_blank\"\u003eKubernetes实战视频: 如何1分钟内在本地启动一个多节点集群\u003c/a\u003e\u0026#34;\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n    \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003ecat\u003c/span\u003e \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(55, 119, 230);\"\u003e\u0026#34;\u003ca href=\"https://morningspace.github.io/tech/openshift-v3-trap-and-pitfalls\" rel=\"noopener\" target=\"_blank\"\u003eOpenShift v3的填坑之旅\u003c/a\u003e\u0026#34;\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n    \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003ecat\u003c/span\u003e \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(55, 119, 230);\"\u003e\u0026#34;\u003ca href=\"https://morningspace.github.io/tech/openshift-v4-trap-and-pitfalls\" rel=\"noopener\" target=\"_blank\"\u003eOpenShift v4的填坑之旅\u003c/a\u003e\u0026#34;\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n    \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003e;;\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n  \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(0, 201, 24);\"\u003e\u0026#34;to extend it by myself\u0026#34;\u003c/span\u003e\u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003e)\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n    \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003ecat\u003c/span\u003e \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(55, 119, 230);\"\u003e\u0026#34;\u003ca href=\"https://morningspace.github.io/lab-k8s-playground/docs/Launch-Utility-Usage-Guide.html\" rel=\"noopener\" target=\"_blank\"\u003eLaunch Utility Usage Guide\u003c/a\u003e\u0026#34;\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n    \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003ecat\u003c/span\u003e \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(55, 119, 230);\"\u003e\u0026#34;\u003ca href=\"https://github.com/morningspace/lab-k8s-playground/blob/master/install/targets/sample.sh\" rel=\"noopener\" target=\"_blank\"\u003eA Sample Target for Demo Purpose\u003c/a\u003e\u0026#34;\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n    \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003e;;\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n  \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(0, 201, 24);\"\u003e\u0026#34;to learn more cool features\u0026#34;\u003c/span\u003e\u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003e)\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n    \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003ecat\u003c/span\u003e \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(55, 119, 230);\"\u003e\u0026#34;\u003ca href=\"https://morningspace.github.io/lab-k8s-playground/docs/APIC-Quick-Guide.html\" rel=\"noopener\" target=\"_blank\"\u003eQuick Guide to Launch APIC Playground\u003c/a\u003e\u0026#34;\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n    \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003ecat\u003c/span\u003e \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(55, 119, 230);\"\u003e\u0026#34;\u003ca href=\"https://morningspace.github.io/tech/all-in-one-apic-playground/\" rel=\"noopener\" target=\"_blank\"\u003e把API Connect关进All-in-One K8S Playground里\u003c/a\u003e\u0026#34;\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n    \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003ecat\u003c/span\u003e \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(55, 119, 230);\"\u003e\u0026#34;\u003ca href=\"https://morningspace.github.io/tech/all-in-one-openshift-playground/\" rel=\"noopener\" target=\"_blank\"\u003eAll-in-One K8S Playground新增OpenShift支持\u003c/a\u003e\u0026#34;\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n    \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003ecat\u003c/span\u003e \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(55, 119, 230);\"\u003e\u0026#34;\u003ca href=\"https://morningspace.github.io/tech/all-in-one-openshift-v4-playground/\" rel=\"noopener\" target=\"_blank\"\u003eAll-in-One K8S Playground支持OpenShift v4\u003c/a\u003e\u0026#34;\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n    \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003e;;\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n  \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(0, 201, 24);\"\u003e\u0026#34;to contribute back\u0026#34;\u003c/span\u003e\u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003e)\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n    \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(119, 119, 119);\"\u003e# Feel free to click these buttons: \u003ca class=\"github-button\" href=\"https://github.com/morningspace/lab-k8s-playground/subscription\" data-icon=\"octicon-eye\" aria-label=\"Watch morningspace/lab-k8s-playground on GitHub\"\u003eWatch\u003c/a\u003e \u003ca class=\"github-button\" href=\"https://github.com/morningspace/lab-k8s-playground\" data-icon=\"octicon-star\" aria-label=\"Star morningspace/lab-k8s-playground on GitHub\"\u003eStar\u003c/a\u003e \u003ca class=\"github-button\" href=\"https://github.com/morningspace/lab-k8s-playground/fork\" data-icon=\"octicon-repo-forked\" aria-label=\"Fork morningspace/lab-k8s-playground on GitHub\"\u003eFork\u003c/a\u003e\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n    git clone\u003cspan\u003e \u003c/span\u003e\u003ca href=\"https://github.com/morningspace/lab-k8s-playground.git\" rel=\"noopener\" target=\"_blank\"\u003ehttps://github.com/morningspace/lab-k8s-playground.git\u003c/a\u003e\u003cbr style=\"outline: none;\"/\u003e\n    \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s;\"\u003e;;\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n  \u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(173, 0, 161);\"\u003eesac\u003c/span\u003e\u003cbr style=\"outline: none;\"/\u003e\n\u003cspan style=\"outline: none; box-sizing: border-box; transition: all 0.2s ease-in-out 0s; color: rgb(31, 170, 170);\"\u003e}\u003c/span\u003e\u003c/code\u003e\n\u003c/p\u003e\n\n        \n      \u003c/section\u003e\n\n      \u003cfooter class=\"page__meta\"\u003e\n        \n        \n  \n\n\n  \n\n  \u003cp class=\"page__taxonomy\"\u003e\n    \u003cstrong\u003e\u003ci class=\"fas fa-fw fa-tags\" aria-hidden=\"true\"\u003e\u003c/i\u003e 标签: \u003c/strong\u003e\n    \u003cspan itemprop=\"keywords\"\u003e\n    \n      \u003ca href=\"/tags/#dummies\" class=\"page__taxonomy-item p-category\" rel=\"tag\"\u003edummies\u003c/a\u003e\u003cspan class=\"sep\"\u003e, \u003c/span\u003e\n    \n      \u003ca href=\"/tags/#dummies-kubernetes\" class=\"page__taxonomy-item p-category\" rel=\"tag\"\u003edummies_kubernetes\u003c/a\u003e\u003cspan class=\"sep\"\u003e, \u003c/span\u003e\n    \n      \u003ca href=\"/tags/#kubernetes\" class=\"page__taxonomy-item p-category\" rel=\"tag\"\u003ekubernetes\u003c/a\u003e\u003cspan class=\"sep\"\u003e, \u003c/span\u003e\n    \n      \u003ca href=\"/tags/#lab\" class=\"page__taxonomy-item p-category\" rel=\"tag\"\u003elab\u003c/a\u003e\u003cspan class=\"sep\"\u003e, \u003c/span\u003e\n    \n      \u003ca href=\"/tags/#openshift\" class=\"page__taxonomy-item p-category\" rel=\"tag\"\u003eopenshift\u003c/a\u003e\n    \n    \u003c/span\u003e\n  \u003c/p\u003e\n\n\n\n\n  \n\n\n  \n\n  \u003cp class=\"page__taxonomy\"\u003e\n    \u003cstrong\u003e\u003ci class=\"fas fa-fw fa-folder-open\" aria-hidden=\"true\"\u003e\u003c/i\u003e 分类: \u003c/strong\u003e\n    \u003cspan itemprop=\"keywords\"\u003e\n    \n      \u003ca href=\"/categories/#tech\" class=\"page__taxonomy-item p-category\" rel=\"tag\"\u003etech\u003c/a\u003e\n    \n    \u003c/span\u003e\n  \u003c/p\u003e\n\n\n        \n\n  \u003cp class=\"page__date\"\u003e\u003cstrong\u003e\u003ci class=\"fas fa-fw fa-calendar-alt\" aria-hidden=\"true\"\u003e\u003c/i\u003e 更新时间:\u003c/strong\u003e \u003ctime class=\"dt-published\" datetime=\"2019-10-26T00:00:00+08:00\"\u003eOctober 26, 2019\u003c/time\u003e\u003c/p\u003e\n\n      \u003c/footer\u003e\n\n      \u003csection class=\"page__share\"\u003e\n  \n    \u003ch4 class=\"page__share-title\"\u003e分享\u003c/h4\u003e\n  \n\n  \u003ca href=\"https://twitter.com/intent/tweet?text=OpenShift+v3%E7%9A%84%E5%A1%AB%E5%9D%91%E4%B9%8B%E6%97%85%20https%3A%2F%2Fmorningspace.github.io%2Ftech%2Fopenshift-v3-trap-and-pitfalls%2F\" class=\"btn btn--twitter\" onclick=\"window.open(this.href, \u0026#39;window\u0026#39;, \u0026#39;left=20,top=20,width=500,height=500,toolbar=1,resizable=0\u0026#39;); return false;\" title=\"分享 Twitter\"\u003e\u003ci class=\"fab fa-fw fa-twitter\" aria-hidden=\"true\"\u003e\u003c/i\u003e\u003cspan\u003e Twitter\u003c/span\u003e\u003c/a\u003e\n\n  \u003ca href=\"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fmorningspace.github.io%2Ftech%2Fopenshift-v3-trap-and-pitfalls%2F\" class=\"btn btn--facebook\" onclick=\"window.open(this.href, \u0026#39;window\u0026#39;, \u0026#39;left=20,top=20,width=500,height=500,toolbar=1,resizable=0\u0026#39;); return false;\" title=\"分享 Facebook\"\u003e\u003ci class=\"fab fa-fw fa-facebook\" aria-hidden=\"true\"\u003e\u003c/i\u003e\u003cspan\u003e Facebook\u003c/span\u003e\u003c/a\u003e\n\n  \u003ca href=\"https://www.linkedin.com/shareArticle?mini=true\u0026amp;url=https%3A%2F%2Fmorningspace.github.io%2Ftech%2Fopenshift-v3-trap-and-pitfalls%2F\" class=\"btn btn--linkedin\" onclick=\"window.open(this.href, \u0026#39;window\u0026#39;, \u0026#39;left=20,top=20,width=500,height=500,toolbar=1,resizable=0\u0026#39;); return false;\" title=\"分享 LinkedIn\"\u003e\u003ci class=\"fab fa-fw fa-linkedin\" aria-hidden=\"true\"\u003e\u003c/i\u003e\u003cspan\u003e LinkedIn\u003c/span\u003e\u003c/a\u003e\n\u003c/section\u003e\n\n\n      \n  \u003cnav class=\"pagination\"\u003e\n    \n      \u003ca href=\"/tech/all-in-one-openshift-playground/\" class=\"pagination--pager\" title=\"All-in-One K8S Playground新增OpenShift支持\n\"\u003e向前\u003c/a\u003e\n    \n    \n      \u003ca href=\"/tech/git-merge-stories-6/\" class=\"pagination--pager\" title=\"Git合并那些事——神奇的Rebase\n\"\u003e向后\u003c/a\u003e\n    \n  \u003c/nav\u003e\n\n    \u003c/div\u003e",
  "Date": "2019-10-26T00:00:00+08:00",
  "Author": "MornigSpace"
}