{
  "Source": "shellhacks",
  "Title": "MikroTik: Firewall – Default Config \u0026 Basics For Dummies",
  "Link": "https://www.shellhacks.com/mikrotik-firewall-default-config-basics-for-dummies/",
  "Content": "\u003cdiv class=\"entry-content\"\u003e\n\u003cdiv class=\"aa-c0262a59e306efb642d372782ec3f87d aa-before-content\" id=\"aa-c0262a59e306efb642d372782ec3f87d\"\u003e\u003c/div\u003e\u003cp\u003eMikroTik RouterOS has a very powerful firewall implementation and for ones who are not very familiar with networking it may be complex to figure out how to configure it properly.\u003c/p\u003e\n\u003cp\u003eIn this note you will find a basic information that can help you to understand better how MikroTik firewall works.\u003c/p\u003e\n\u003cp\u003eAlso, on the example of the default MikroTik firewall config, I will explain each of the rules.\u003cspan id=\"more-5070\"\u003e\u003c/span\u003e\u003c/p\u003e\n\u003cp class=\"note-lnk\"\u003e\u003cstrong\u003eCool Tip:\u003c/strong\u003e List MikroTik RouterOS firewall rules! \u003ca href=\"/mikrotik-list-firewall-rules/\"\u003eRead more →\u003c/a\u003e\u003c/p\u003e\n\u003ch2\u003eMikroTik Firewall\u003c/h2\u003e\n\u003cp\u003eTo show the current MikroTik firewall filter rules, execute:\u003c/p\u003e\n\u003cpre\u003e[\u003cspan style=\"color:blue;\"\u003eadmin\u003c/span\u003e@\u003cspan style=\"color:green;\"\u003eMikroTik\u003c/span\u003e] \u0026gt; /ip firewall filter print\n[\u003cspan style=\"color:blue;\"\u003eadmin\u003c/span\u003e@\u003cspan style=\"color:green;\"\u003eMikroTik\u003c/span\u003e] \u0026gt; /ipv6 firewall filter print\n\u003c/pre\u003e\n\u003cp\u003eTo list the commands that have been used to configure that rules, execute:\u003c/p\u003e\n\u003cpre\u003e[\u003cspan style=\"color:blue;\"\u003eadmin\u003c/span\u003e@\u003cspan style=\"color:green;\"\u003eMikroTik\u003c/span\u003e] \u0026gt; /ip firewall filter export\n[\u003cspan style=\"color:blue;\"\u003eadmin\u003c/span\u003e@\u003cspan style=\"color:green;\"\u003eMikroTik\u003c/span\u003e] \u0026gt; /ipv6 firewall filter export\n\u003c/pre\u003e\n\u003cp\u003eTo show all the MikroTik firewall settings, execute:\u003c/p\u003e\n\u003cpre\u003e[\u003cspan style=\"color:blue;\"\u003eadmin\u003c/span\u003e@\u003cspan style=\"color:green;\"\u003eMikroTik\u003c/span\u003e] \u0026gt; /ip firewall export verbose\n[\u003cspan style=\"color:blue;\"\u003eadmin\u003c/span\u003e@\u003cspan style=\"color:green;\"\u003eMikroTik\u003c/span\u003e] \u0026gt; /ipv6 firewall export verbose\n\u003c/pre\u003e\n\u003ch3\u003eBasics\u003c/h3\u003e\n\u003cp\u003eThe MikroTik firewall operates by means of \u003ca href=\"https://wiki.mikrotik.com/wiki/Manual:IP/Firewall/Filter#Properties\" rel=\"noopener\" target=\"_blank\"\u003efirewall rules\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eEach rule consists of two parts:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eThe \u003cstrong\u003ematcher\u003c/strong\u003e, which matches traffic flow against given conditions, e.g. \u003ccode\u003eCONNECTION-STATE\u003c/code\u003e, \u003ccode\u003eSRC-ADDRESS\u003c/code\u003e, \u003ccode\u003eDST-ADDRESS\u003c/code\u003e, \u003ccode\u003ePROTOCOL\u003c/code\u003e, etc.\u003c/li\u003e\n\u003cli\u003eThe \u003cstrong\u003eaction\u003c/strong\u003e which defines what to do with the matched packet.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch4\u003eConnection States\u003c/h4\u003e\n\u003cp\u003eIn each MikroTik firewall, there are 5 connection states which can be applied to a particular network packet:\u003c/p\u003e\n\u003ctable class=\"ptable\"\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003cth\u003eConnection State\u003c/th\u003e\n\u003cth\u003eDescription\u003c/th\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eNEW\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eA packet requesting a new connection, such as a \u003ccode\u003eSYN\u003c/code\u003e packet in \u003ccode\u003eTCP\u003c/code\u003e.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eESTABLISHED\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eA packet that is a part of an existing connection. The \u003ccode\u003eNEW\u003c/code\u003e connection gets into the \u003ccode\u003eESTABLISHED\u003c/code\u003e state upon receiving the reply packet to or through the firewall.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eRELATED\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eA packet that is requesting a new connection while being a part of another \u003ccode\u003eESTABLISHED\u003c/code\u003e connection. For example, \u003ccode\u003eFTP\u003c/code\u003e establishes connection on port 21, but to transfer data it spawns a new connection (typically on port 20) that will be considered as \u003ccode\u003eRELATED\u003c/code\u003e.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eINVALID\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eA packet that is not part of any connections. It is suggested to \u003ccode\u003eDROP\u003c/code\u003e everything in this state.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eUNTRACKED\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eA packet that has been marked not to be tracked in a firewall RAW table. The RAW table allows to exempt certain packets from connection tracking, that significantly reduces load on CPU and is very useful for DOS attack mitigation.\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch4\u003eChains\u003c/h4\u003e\n\u003cp\u003eMikroTik firewall filtering rules are grouped together in chains.\u003c/p\u003e\n\u003cp\u003eIt allows a packet to be matched against one common criteria in one chain and then pass over for processing against some other common criteria to another chain (using \u003ccode\u003eJUMP\u003c/code\u003e action).\u003c/p\u003e\n\u003cp\u003eThere are 3 predefined chains:\u003c/p\u003e\n\u003ctable class=\"ptable\"\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003cth\u003eFirewall Chain\u003c/th\u003e\n\u003cth\u003eDescription\u003c/th\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eINPUT\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eUsed to process packets entering the router (\u003ccode\u003eDST\u003c/code\u003e address – one of the router’s addresses).\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eFORWARD\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eUsed to process packets passing through the router. (\u003ccode\u003eSRC\u003c/code\u003e and \u003ccode\u003eDST\u003c/code\u003e addresses are not on the router.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eOUTPUT\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eUsed to process packets originated from the router (\u003ccode\u003eSRC\u003c/code\u003e address – one of the router’s addresses).\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp class=\"note-blue\"\u003eℹ️ Packets passing through the router (\u003ccode\u003eFORWARD\u003c/code\u003e chain) are not processed against the rules of the \u003ccode\u003eINPUT\u003c/code\u003e and \u003ccode\u003eOUTPUT\u003c/code\u003e chains.\u003c/p\u003e\n\u003cp\u003eWhen processing a chain, rules are taken from the chain in the order they are listed there from top to bottom.\u003c/p\u003e\n\u003ch4\u003eActions\u003c/h4\u003e\n\u003cp\u003eIf a packet matches the criteria of the rule, then the specified action is performed on it and no more rules are processed in that chain (the exception is the \u003ccode\u003ePASSTHROUGH\u003c/code\u003e action).\u003c/p\u003e\n\u003cp\u003eIf the packet is matched by the rule, one of the following actions can be taken:\u003c/p\u003e\n\u003ctable class=\"ptable\"\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003cth\u003eAction\u003c/th\u003e\n\u003cth\u003eDescription\u003c/th\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eACCEPT\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eAccept the packet. \u003cu\u003eAccepted packet won’t be passed to the next firewall rule\u003c/u\u003e.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eADD-DST-TO-ADDRESS-LIST\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eAdd a \u003ccode\u003eDST\u003c/code\u003e address to an address list specified by the \u003ccode\u003eaddress-list\u003c/code\u003e parameter.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eADD-SRC-TO-ADDRESS-LIST\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eAdd a \u003ccode\u003eSRC\u003c/code\u003e address to an address list specified by the \u003ccode\u003eaddress-list\u003c/code\u003e parameter.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eDROP\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eSilently drop the packet.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eFASTTRACK-CONNECTION\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eProcess packets from a connection using FastPath by enabling \u003ca href=\"https://wiki.mikrotik.com/wiki/Manual:IP/Fasttrack\" rel=\"noopener\" target=\"_blank\"\u003eFastTrack\u003c/a\u003e for the connection.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eJUMP\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eJump to the user defined chain specified by the value of the \u003ccode\u003ejump-target\u003c/code\u003e parameter.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eLOG\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eAdd a message to the system log containing the following data: \u003ccode\u003eIN-INTERFACE\u003c/code\u003e, \u003ccode\u003eOUT-INTERFACE\u003c/code\u003e, \u003ccode\u003eSRC-MAC\u003c/code\u003e, \u003ccode\u003ePROTOCOL\u003c/code\u003e, \u003ccode\u003eSRC-IP:PORT\u003c/code\u003e \u0026amp;RARR; \u003ccode\u003eDST-IP:PORT\u003c/code\u003e and a length of the packet. After the packet is matched it will be passed to the next rule in the list (similar to \u003ccode\u003ePASSTHROUGH\u003c/code\u003e).\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003ePASSTHROUGH\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eIf the packet is matched by the rule, increase a counter and go to the next rule (useful for statistics).\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eREJECT\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eDrop the packet and send an \u003ccode\u003eICMP\u003c/code\u003e reject message.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eRETURN\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003ePasses control back to the chain from where the \u003ccode\u003eJUMP\u003c/code\u003e took place.\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eTARPIT\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eCaptures and holds \u003ccode\u003eTCP\u003c/code\u003e connections (replies with \u003ccode\u003eSYN/ACK\u003c/code\u003e to the inbound \u003ccode\u003eTCP SYN\u003c/code\u003e packet).\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp class=\"note-red\"\u003e⚠️ \u003cstrong\u003eWarning\u003c/strong\u003e: If a packet hasn’t matched any of the rules within the built-in chains, then it will be \u003ccode\u003e\u003cstrong\u003eACCEPTED\u003c/strong\u003e\u003c/code\u003e!\u003c/p\u003e\n\u003ch3\u003eDefault MikroTik Firewall Rules\u003c/h3\u003e\n\u003cp class=\"note-lnk\"\u003e\u003cstrong\u003eCool Tip:\u003c/strong\u003e Factory reset of a MikroTik router! \u003ca href=\"/reset-mikrotik-router/\"\u003eRead more →\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eTo show the default MikroTik firewall rules, execute:\u003c/p\u003e\n\u003cpre\u003e[\u003cspan style=\"color:blue;\"\u003eadmin\u003c/span\u003e@\u003cspan style=\"color:green;\"\u003eMikroTik\u003c/span\u003e] \u0026gt; /system default-configuration print\u003c/pre\u003e\n\u003cp\u003eThe command above returns the default MikroTik configuration, that includes the default MikroTik firewall rules.\u003c/p\u003e\n\u003cp\u003eIf you want to export it, you can do it using the following command:\u003c/p\u003e\n\u003cpre\u003e[\u003cspan style=\"color:blue;\"\u003eadmin\u003c/span\u003e@\u003cspan style=\"color:green;\"\u003eMikroTik\u003c/span\u003e] \u0026gt; /system default-configuration print file=defConf.txt\u003c/pre\u003e\n\u003cp\u003eThen you can copy the exported file from the MikroTik router to your computer:\u003c/p\u003e\n\u003cpre\u003eC:\\\u0026gt; sftp admin@192.168.88.1:defConf.txt\n\u003c/pre\u003e\n\u003cp\u003eAlternatively, you can download it from a “Files” menu through a WinBox/WebFig interface.\u003c/p\u003e\n\u003ch4\u003eExample\u003c/h4\u003e\n\u003cp\u003eHere are the default IPv4 firewall rules on my MikroTik hAP AX³:\u003c/p\u003e\n\u003cp\u003e\u003cscript data-pagespeed-no-defer=\"\"\u003e(function(){for(var g=\"function\"==typeof Object.defineProperties?Object.defineProperty:function(b,c,a){if(a.get||a.set)throw new TypeError(\"ES3 does not support getters and setters.\");b!=Array.prototype\u0026\u0026b!=Object.prototype\u0026\u0026(b[c]=a.value)},h=\"undefined\"!=typeof window\u0026\u0026window===this?this:\"undefined\"!=typeof global\u0026\u0026null!=global?global:this,k=[\"String\",\"prototype\",\"repeat\"],l=0;l\u003ck.length-1;l++){var m=k[l];m in h||(h[m]={});h=h[m]}var n=k[k.length-1],p=h[n],q=p?p:function(b){var c;if(null==this)throw new TypeError(\"The 'this' value for String.prototype.repeat must not be null or undefined\");c=this+\"\";if(0\u003eb||1342177279\u003cb)throw new RangeError(\"Invalid count value\");b|=0;for(var a=\"\";b;)if(b\u00261\u0026\u0026(a+=c),b\u003e\u003e\u003e=1)c+=c;return a};q!=p\u0026\u0026null!=q\u0026\u0026g(h,n,{configurable:!0,writable:!0,value:q});var t=this;function u(b,c){var a=b.split(\".\"),d=t;a[0]in d||!d.execScript||d.execScript(\"var \"+a[0]);for(var e;a.length\u0026\u0026(e=a.shift());)a.length||void 0===c?d[e]?d=d[e]:d=d[e]={}:d[e]=c};function v(b){var c=b.length;if(0\u003cc){for(var a=Array(c),d=0;d\u003cc;d++)a[d]=b[d];return a}return[]};function w(b){var c=window;if(c.addEventListener)c.addEventListener(\"load\",b,!1);else if(c.attachEvent)c.attachEvent(\"onload\",b);else{var a=c.onload;c.onload=function(){b.call(this);a\u0026\u0026a.call(this)}}};var x;function y(b,c,a,d,e){this.h=b;this.j=c;this.l=a;this.f=e;this.g={height:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,width:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth};this.i=d;this.b={};this.a=[];this.c={}}function z(b,c){var a,d,e=c.getAttribute(\"data-pagespeed-url-hash\");if(a=e\u0026\u0026!(e in b.c))if(0\u003e=c.offsetWidth\u0026\u00260\u003e=c.offsetHeight)a=!1;else{d=c.getBoundingClientRect();var f=document.body;a=d.top+(\"pageYOffset\"in window?window.pageYOffset:(document.documentElement||f.parentNode||f).scrollTop);d=d.left+(\"pageXOffset\"in window?window.pageXOffset:(document.documentElement||f.parentNode||f).scrollLeft);f=a.toString()+\",\"+d;b.b.hasOwnProperty(f)?a=!1:(b.b[f]=!0,a=a\u003c=b.g.height\u0026\u0026d\u003c=b.g.width)}a\u0026\u0026(b.a.push(e),b.c[e]=!0)}y.prototype.checkImageForCriticality=function(b){b.getBoundingClientRect\u0026\u0026z(this,b)};u(\"pagespeed.CriticalImages.checkImageForCriticality\",function(b){x.checkImageForCriticality(b)});u(\"pagespeed.CriticalImages.checkCriticalImages\",function(){A(x)});function A(b){b.b={};for(var c=[\"IMG\",\"INPUT\"],a=[],d=0;d\u003cc.length;++d)a=a.concat(v(document.getElementsByTagName(c[d])));if(a.length\u0026\u0026a[0].getBoundingClientRect){for(d=0;c=a[d];++d)z(b,c);a=\"oh=\"+b.l;b.f\u0026\u0026(a+=\"\u0026n=\"+b.f);if(c=!!b.a.length)for(a+=\"\u0026ci=\"+encodeURIComponent(b.a[0]),d=1;d\u003cb.a.length;++d){var e=\",\"+encodeURIComponent(b.a[d]);131072\u003e=a.length+e.length\u0026\u0026(a+=e)}b.i\u0026\u0026(e=\"\u0026rd=\"+encodeURIComponent(JSON.stringify(B())),131072\u003e=a.length+e.length\u0026\u0026(a+=e),c=!0);C=a;if(c){d=b.h;b=b.j;var f;if(window.XMLHttpRequest)f=new XMLHttpRequest;else if(window.ActiveXObject)try{f=new ActiveXObject(\"Msxml2.XMLHTTP\")}catch(r){try{f=new ActiveXObject(\"Microsoft.XMLHTTP\")}catch(D){}}f\u0026\u0026(f.open(\"POST\",d+(-1==d.indexOf(\"?\")?\"?\":\"\u0026\")+\"url=\"+encodeURIComponent(b)),f.setRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded\"),f.send(a))}}}function B(){var b={},c;c=document.getElementsByTagName(\"IMG\");if(!c.length)return{};var a=c[0];if(!(\"naturalWidth\"in a\u0026\u0026\"naturalHeight\"in a))return{};for(var d=0;a=c[d];++d){var e=a.getAttribute(\"data-pagespeed-url-hash\");e\u0026\u0026(!(e in b)\u0026\u00260\u003ca.width\u0026\u00260\u003ca.height\u0026\u00260\u003ca.naturalWidth\u0026\u00260\u003ca.naturalHeight||e in b\u0026\u0026a.width\u003e=b[e].o\u0026\u0026a.height\u003e=b[e].m)\u0026\u0026(b[e]={rw:a.width,rh:a.height,ow:a.naturalWidth,oh:a.naturalHeight})}return b}var C=\"\";u(\"pagespeed.CriticalImages.getBeaconData\",function(){return C});u(\"pagespeed.CriticalImages.Run\",function(b,c,a,d,e,f){var r=new y(b,c,a,e,f);x=r;d\u0026\u0026w(function(){window.setTimeout(function(){A(r)},0)})});})();pagespeed.CriticalImages.Run('/ngx_pagespeed_beacon','https://www.shellhacks.com/mikrotik-firewall-default-config-basics-for-dummies/','Xs549MdaXt',true,false,'z2uyGiOjWXA');\u003c/script\u003e\u003cimg fetchpriority=\"high\" decoding=\"async\" src=\"/wp-content/uploads/mikrotik-default-ipv4-firewall-rules.png\" alt=\"\" width=\"752\" height=\"573\" class=\"aligncenter size-full wp-image-5082\" srcset=\"https://www.shellhacks.com/wp-content/uploads/mikrotik-default-ipv4-firewall-rules.png 752w, https://www.shellhacks.com/wp-content/uploads/mikrotik-default-ipv4-firewall-rules-700x533.png 700w\" sizes=\"(max-width: 752px) 100vw, 752px\" data-pagespeed-url-hash=\"1574298045\" onload=\"pagespeed.CriticalImages.checkImageForCriticality(this);\"/\u003e\u003c/p\u003e\n\u003cp\u003eLet’s see what each of these default rules is doing 🤔.\u003c/p\u003e\n\u003cp\u003e🔄 A dummy rule that simply counts packets passing through the router:\u003c/p\u003e\n\u003cpre\u003e 0  D ;;; special dummy rule to show fasttrack counters\n      chain=forward action=passthrough\n\u003c/pre\u003e\n\u003cp\u003eThis rule serves for passing the matching packets to the \u003ccode\u003eFORWARD\u003c/code\u003e chain (\u003cem\u003eand bypassing the other chains to speedup the processing\u003c/em\u003e) where they might be marked as \u003ca href=\"https://wiki.mikrotik.com/wiki/Manual:IP/Fasttrack\" rel=\"noopener\" target=\"_blank\"\u003eFastTracked\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eTo display the counters, execute:\u003c/p\u003e\n\u003cpre\u003e[\u003cspan style=\"color:blue;\"\u003eadmin\u003c/span\u003e@\u003cspan style=\"color:green;\"\u003eMikroTik\u003c/span\u003e] \u0026gt; /ip firewall filter print stats\n\u003cspan style=\"color:grey;\"\u003e\u003cem\u003e- or -\u003c/em\u003e\u003c/span\u003e\n[\u003cspan style=\"color:blue;\"\u003eadmin\u003c/span\u003e@\u003cspan style=\"color:green;\"\u003eMikroTik\u003c/span\u003e] \u0026gt; /ip firewall filter print follow stats\n\u003cspan style=\"color:grey;\"\u003e\u003cem\u003e- sample output -\u003c/em\u003e\u003c/span\u003e\nFlags: D - DYNAMIC\nColumns: CHAIN, ACTION, BYTES, PACKETS\n #   CHAIN    ACTION                         BYTES     PACKETS\n;;; special dummy rule to show fasttrack counters\n 0 D forward  passthrough           \u003cstrong\u003e29 320 602 344\u003c/strong\u003e  \u003cstrong\u003e22 976 648\u003c/strong\u003e\n...\n\u003c/pre\u003e\n\u003cp\u003e✔️ Allow packets entering the router, that are a part of the already \u003ccode\u003eESTABLISHED\u003c/code\u003e or \u003ccode\u003eRELATED\u003c/code\u003e connections, as well as allow packets that have been marked as \u003ccode\u003eUNTRACKED\u003c/code\u003e:\u003c/p\u003e\n\u003cpre\u003e 1    ;;; defconf: accept established,related,untracked\n      chain=input action=accept connection-state=established,related,untracked\n\u003c/pre\u003e\n\u003cp\u003e❌ Drop \u003ccode\u003eINVALID\u003c/code\u003e packets entering the router:\u003c/p\u003e\n\u003cpre\u003e 2    ;;; defconf: drop invalid\n      chain=input action=drop connection-state=invalid\n\u003c/pre\u003e\n\u003cp\u003e✔️ Allow \u003ccode\u003eICMP\u003c/code\u003e packets (incl. \u003ccode\u003eping\u003c/code\u003e) entering the router:\u003c/p\u003e\n\u003cpre\u003e 3    ;;; defconf: accept ICMP\n      chain=input action=accept protocol=icmp\n\u003c/pre\u003e\n\u003cp\u003e✔️ The next firewall rule is required for \u003ca href=\"https://wiki.mikrotik.com/wiki/Manual:CAPsMAN\" rel=\"noopener\" target=\"_blank\"\u003eCAPsMAN\u003c/a\u003e (Controlled Access Point system Manager) feature, that allows a MikrRotik router to manage multiple wireless access points:\u003c/p\u003e\n\u003cpre\u003e 4    ;;; defconf: accept to local loopback (for CAPsMAN)\n      chain=input action=accept dst-address=127.0.0.1\n\u003c/pre\u003e\n\u003cp\u003e❌ Drop all packet entering the router, that are not coming from a \u003ccode\u003eLAN\u003c/code\u003e interface list:\u003c/p\u003e\n\u003cpre\u003e 5    ;;; defconf: drop all not coming from LAN\n      chain=input action=drop in-interface-list=!LAN\n\u003c/pre\u003e\n\u003cp\u003eTo display interface members in each interface list, execute:\u003c/p\u003e\n\u003cpre\u003e[\u003cspan style=\"color:blue;\"\u003eadmin\u003c/span\u003e@\u003cspan style=\"color:green;\"\u003eMikroTik\u003c/span\u003e] \u0026gt; /interface list member print\n\u003cspan style=\"color:grey;\"\u003e\u003cem\u003e- sample output -\u003c/em\u003e\u003c/span\u003e\nColumns: LIST, INTERFACE\n# LIST  INTERFACE\n;;; defconf\n0 LAN   bridge\n;;; defconf\n1 WAN   ether1\n\u003c/pre\u003e\n\u003cp\u003eTo list the interface that are the members of the bridge, execute:\u003c/p\u003e\n\u003cpre\u003e[\u003cspan style=\"color:blue;\"\u003eadmin\u003c/span\u003e@\u003cspan style=\"color:green;\"\u003eMikroTik\u003c/span\u003e] \u0026gt; /interface bridge port print value-list\n\u003cspan style=\"color:grey;\"\u003e\u003cem\u003e- sample output -\u003c/em\u003e\u003c/span\u003e\ninterface: ether2   ether3   ether4   ether5  wifi1   wifi2\n...\n\u003c/pre\u003e\n\u003cp\u003e✔️ Check all packets passing through the router if they match \u003ca href=\"https://wiki.mikrotik.com/wiki/Manual:IP/IPsec\" rel=\"noopener\" target=\"_blank\"\u003eIPsec\u003c/a\u003e (Internet Protocol Security) policies, that decide which traffic should go to what peer and how it should be encrypted:\u003c/p\u003e\n\u003cpre\u003e 6    ;;; defconf: accept in ipsec policy\n      chain=forward action=accept ipsec-policy=in,ipsec\n\n 7    ;;; defconf: accept out ipsec policy\n      chain=forward action=accept ipsec-policy=out,ipsec\n\u003c/pre\u003e\n\u003cp\u003e⏩ Mark packets passing through the router as \u003ca href=\"https://wiki.mikrotik.com/wiki/Manual:IP/Fasttrack\" rel=\"noopener\" target=\"_blank\"\u003eFastTracked\u003c/a\u003e if they are a part of the already \u003ccode\u003eESTABLISHED\u003c/code\u003e or \u003ccode\u003eRELATED\u003c/code\u003e connections:\u003c/p\u003e\n\u003cpre\u003e 8    ;;; defconf: fasttrack\n      chain=forward action=fasttrack-connection hw-offload=yes connection-state=established,related\n\u003c/pre\u003e\n\u003cp\u003eWhen the first packet matches \u003ccode\u003eaction=fasttrack-connection\u003c/code\u003e, all subsequent packets will just fly through, bypassing firewall, connection tracking, simple queues, etc., that can significantly improves the performance.\u003c/p\u003e\n\u003cp class=\"note-blue\"\u003eℹ️ Note that not all packets in a connection can be FastTracked, so it is likely to see some packets going through a slow path even though connection is marked for FastTrack. This is the reason why \u003ccode\u003efasttrack-connection\u003c/code\u003e is followed by the identical \u003ccode\u003eaction=accept\u003c/code\u003e rule (see below).\u003c/p\u003e\n\u003cp\u003e✔️ Allow packets passing through the router, if they are a part of the already \u003ccode\u003eESTABLISHED\u003c/code\u003e or \u003ccode\u003eRELATED\u003c/code\u003e connections, as well as allow the \u003ccode\u003eUNTRACKED\u003c/code\u003e packets:\u003c/p\u003e\n\u003cpre\u003e 9    ;;; defconf: accept established,related,untracked\n      chain=forward action=accept connection-state=established,related,untracked\n\u003c/pre\u003e\n\u003cp\u003e❌ Drop \u003ccode\u003eINVALID\u003c/code\u003e packets passing through the router:\u003c/p\u003e\n\u003cpre\u003e10    ;;; defconf: drop invalid\n      chain=forward action=drop connection-state=invalid\n\u003c/pre\u003e\n\u003cp\u003e❌ \u003ccode\u003eDROP\u003c/code\u003e packets passing through the router and requesting a \u003ccode\u003eNEW\u003c/code\u003e connection, if they are coming from one of the \u003ccode\u003eWAN\u003c/code\u003e interfaces and they are not DSTNATed (Destination NATed):\u003c/p\u003e\n\u003cpre\u003e11    ;;; defconf: drop all from WAN not DSTNATed\n      chain=forward action=drop connection-state=new connection-nat-state=!dstnat in-interface-list=WAN\n\u003c/pre\u003e\n\u003cp class=\"note-blue\"\u003eℹ \u003ccode\u003eDSTNAT\u003c/code\u003e: Destination NAT changes the destination address in IP header of a packet. It may also change the destination port in the \u003ccode\u003eTCP\u003c/code\u003e/\u003ccode\u003eUDP\u003c/code\u003e headers. The typical usage of \u003ccode\u003eDSTNAT\u003c/code\u003e is to redirect incoming packets with a destination of a public \u003ccode\u003eIP-address:port\u003c/code\u003e to a private \u003ccode\u003eIP-address:port\u003c/code\u003e inside \u003ccode\u003eLAN\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"heateorSssClear\"\u003e\u003c/div\u003e\u003cdiv class=\"heateor_sss_sharing_container heateor_sss_horizontal_sharing\" data-heateor-sss-href=\"https://www.shellhacks.com/mikrotik-firewall-default-config-basics-for-dummies/\"\u003e\u003cdiv class=\"heateor_sss_sharing_title\" style=\"font-weight:bold\"\u003eWas it useful? Share this post with the world!\u003c/div\u003e\u003cdiv class=\"heateor_sss_sharing_ul\"\u003e\u003ca aria-label=\"Facebook\" class=\"heateor_sss_facebook\" href=\"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.shellhacks.com%2Fmikrotik-firewall-default-config-basics-for-dummies%2F\" title=\"Facebook\" rel=\"nofollow noopener\" target=\"_blank\" style=\"font-size:32px!important;box-shadow:none;display:inline-block;vertical-align:middle\"\u003e\u003cspan class=\"heateor_sss_svg\" style=\"background-color:#3c589a;width:87.5px;height:31.25px;display:inline-block;opacity:1;float:left;font-size:32px;box-shadow:none;display:inline-block;font-size:16px;padding:0 4px;vertical-align:middle;background-repeat:repeat;overflow:hidden;padding:0;cursor:pointer;box-sizing:content-box\"\u003e\u003csvg style=\"display:block;\" focusable=\"false\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" height=\"100%\" viewBox=\"-5 -5 42 42\"\u003e\u003cpath d=\"M17.78 27.5V17.008h3.522l.527-4.09h-4.05v-2.61c0-1.182.33-1.99 2.023-1.99h2.166V4.66c-.375-.05-1.66-.16-3.155-.16-3.123 0-5.26 1.905-5.26 5.405v3.016h-3.53v4.09h3.53V27.5h4.223z\" fill=\"#fff\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/a\u003e\u003ca aria-label=\"Twitter\" class=\"heateor_sss_button_twitter\" href=\"http://twitter.com/intent/tweet?via=ShellHacks\u0026amp;text=MikroTik%3A%20Firewall%20-%20Default%20Config%20%26%20Basics%20For%20Dummies\u0026amp;url=https%3A%2F%2Fwww.shellhacks.com%2Fmikrotik-firewall-default-config-basics-for-dummies%2F\" title=\"Twitter\" rel=\"nofollow noopener\" target=\"_blank\" style=\"font-size:32px!important;box-shadow:none;display:inline-block;vertical-align:middle\"\u003e\u003cspan class=\"heateor_sss_svg heateor_sss_s__default heateor_sss_s_twitter\" style=\"background-color:#55acee;width:87.5px;height:31.25px;display:inline-block;opacity:1;float:left;font-size:32px;box-shadow:none;display:inline-block;font-size:16px;padding:0 4px;vertical-align:middle;background-repeat:repeat;overflow:hidden;padding:0;cursor:pointer;box-sizing:content-box\"\u003e\u003csvg style=\"display:block;\" focusable=\"false\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" height=\"100%\" viewBox=\"-4 -4 39 39\"\u003e\u003cpath d=\"M28 8.557a9.913 9.913 0 0 1-2.828.775 4.93 4.93 0 0 0 2.166-2.725 9.738 9.738 0 0 1-3.13 1.194 4.92 4.92 0 0 0-3.593-1.55 4.924 4.924 0 0 0-4.794 6.049c-4.09-.21-7.72-2.17-10.15-5.15a4.942 4.942 0 0 0-.665 2.477c0 1.71.87 3.214 2.19 4.1a4.968 4.968 0 0 1-2.23-.616v.06c0 2.39 1.7 4.38 3.952 4.83-.414.115-.85.174-1.297.174-.318 0-.626-.03-.928-.086a4.935 4.935 0 0 0 4.6 3.42 9.893 9.893 0 0 1-6.114 2.107c-.398 0-.79-.023-1.175-.068a13.953 13.953 0 0 0 7.55 2.213c9.056 0 14.01-7.507 14.01-14.013 0-.213-.005-.426-.015-.637.96-.695 1.795-1.56 2.455-2.55z\" fill=\"#fff\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/a\u003e\u003ca aria-label=\"Linkedin\" class=\"heateor_sss_button_linkedin\" href=\"https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fwww.shellhacks.com%2Fmikrotik-firewall-default-config-basics-for-dummies%2F\" title=\"Linkedin\" rel=\"nofollow noopener\" target=\"_blank\" style=\"font-size:32px!important;box-shadow:none;display:inline-block;vertical-align:middle\"\u003e\u003cspan class=\"heateor_sss_svg heateor_sss_s__default heateor_sss_s_linkedin\" style=\"background-color:#0077b5;width:87.5px;height:31.25px;display:inline-block;opacity:1;float:left;font-size:32px;box-shadow:none;display:inline-block;font-size:16px;padding:0 4px;vertical-align:middle;background-repeat:repeat;overflow:hidden;padding:0;cursor:pointer;box-sizing:content-box\"\u003e\u003csvg style=\"display:block;\" focusable=\"false\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" height=\"100%\" viewBox=\"0 0 32 32\"\u003e\u003cpath d=\"M6.227 12.61h4.19v13.48h-4.19V12.61zm2.095-6.7a2.43 2.43 0 0 1 0 4.86c-1.344 0-2.428-1.09-2.428-2.43s1.084-2.43 2.428-2.43m4.72 6.7h4.02v1.84h.058c.56-1.058 1.927-2.176 3.965-2.176 4.238 0 5.02 2.792 5.02 6.42v7.395h-4.183v-6.56c0-1.564-.03-3.574-2.178-3.574-2.18 0-2.514 1.7-2.514 3.46v6.668h-4.187V12.61z\" fill=\"#fff\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/a\u003e\u003ca aria-label=\"Reddit\" class=\"heateor_sss_button_reddit\" href=\"http://reddit.com/submit?url=https%3A%2F%2Fwww.shellhacks.com%2Fmikrotik-firewall-default-config-basics-for-dummies%2F\u0026amp;title=MikroTik%3A%20Firewall%20-%20Default%20Config%20%26%20Basics%20For%20Dummies\" title=\"Reddit\" rel=\"nofollow noopener\" target=\"_blank\" style=\"font-size:32px!important;box-shadow:none;display:inline-block;vertical-align:middle\"\u003e\u003cspan class=\"heateor_sss_svg heateor_sss_s__default heateor_sss_s_reddit\" style=\"background-color:#ff5700;width:87.5px;height:31.25px;display:inline-block;opacity:1;float:left;font-size:32px;box-shadow:none;display:inline-block;font-size:16px;padding:0 4px;vertical-align:middle;background-repeat:repeat;overflow:hidden;padding:0;cursor:pointer;box-sizing:content-box\"\u003e\u003csvg style=\"display:block;\" focusable=\"false\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" height=\"100%\" viewBox=\"-3.5 -3.5 39 39\"\u003e\u003cpath d=\"M28.543 15.774a2.953 2.953 0 0 0-2.951-2.949 2.882 2.882 0 0 0-1.9.713 14.075 14.075 0 0 0-6.85-2.044l1.38-4.349 3.768.884a2.452 2.452 0 1 0 .24-1.176l-4.274-1a.6.6 0 0 0-.709.4l-1.659 5.224a14.314 14.314 0 0 0-7.316 2.029 2.908 2.908 0 0 0-1.872-.681 2.942 2.942 0 0 0-1.618 5.4 5.109 5.109 0 0 0-.062.765c0 4.158 5.037 7.541 11.229 7.541s11.22-3.383 11.22-7.541a5.2 5.2 0 0 0-.053-.706 2.963 2.963 0 0 0 1.427-2.51zm-18.008 1.88a1.753 1.753 0 0 1 1.73-1.74 1.73 1.73 0 0 1 1.709 1.74 1.709 1.709 0 0 1-1.709 1.711 1.733 1.733 0 0 1-1.73-1.711zm9.565 4.968a5.573 5.573 0 0 1-4.081 1.272h-.032a5.576 5.576 0 0 1-4.087-1.272.6.6 0 0 1 .844-.854 4.5 4.5 0 0 0 3.238.927h.032a4.5 4.5 0 0 0 3.237-.927.6.6 0 1 1 .844.854zm-.331-3.256a1.726 1.726 0 1 1 1.709-1.712 1.717 1.717 0 0 1-1.712 1.712z\" fill=\"#fff\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/a\u003e\u003ca aria-label=\"Whatsapp\" class=\"heateor_sss_whatsapp\" href=\"https://api.whatsapp.com/send?text=MikroTik%3A%20Firewall%20-%20Default%20Config%20%26%20Basics%20For%20Dummies https%3A%2F%2Fwww.shellhacks.com%2Fmikrotik-firewall-default-config-basics-for-dummies%2F\" title=\"Whatsapp\" rel=\"nofollow noopener\" target=\"_blank\" style=\"font-size:32px!important;box-shadow:none;display:inline-block;vertical-align:middle\"\u003e\u003cspan class=\"heateor_sss_svg\" style=\"background-color:#55eb4c;width:87.5px;height:31.25px;display:inline-block;opacity:1;float:left;font-size:32px;box-shadow:none;display:inline-block;font-size:16px;padding:0 4px;vertical-align:middle;background-repeat:repeat;overflow:hidden;padding:0;cursor:pointer;box-sizing:content-box\"\u003e\u003csvg style=\"display:block;\" focusable=\"false\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" height=\"100%\" viewBox=\"-6 -5 40 40\"\u003e\u003cpath class=\"heateor_sss_svg_stroke heateor_sss_no_fill\" stroke=\"#fff\" stroke-width=\"2\" fill=\"none\" d=\"M 11.579798566743314 24.396926207859085 A 10 10 0 1 0 6.808479557110079 20.73576436351046\"\u003e\u003c/path\u003e\u003cpath d=\"M 7 19 l -1 6 l 6 -1\" class=\"heateor_sss_no_fill heateor_sss_svg_stroke\" stroke=\"#fff\" stroke-width=\"2\" fill=\"none\"\u003e\u003c/path\u003e\u003cpath d=\"M 10 10 q -1 8 8 11 c 5 -1 0 -6 -1 -3 q -4 -3 -5 -5 c 4 -2 -1 -5 -1 -4\" fill=\"#fff\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/a\u003e\u003ca aria-label=\"Telegram\" class=\"heateor_sss_button_telegram\" href=\"https://telegram.me/share/url?url=https%3A%2F%2Fwww.shellhacks.com%2Fmikrotik-firewall-default-config-basics-for-dummies%2F\u0026amp;text=MikroTik%3A%20Firewall%20-%20Default%20Config%20%26%20Basics%20For%20Dummies\" title=\"Telegram\" rel=\"nofollow noopener\" target=\"_blank\" style=\"font-size:32px!important;box-shadow:none;display:inline-block;vertical-align:middle\"\u003e\u003cspan class=\"heateor_sss_svg heateor_sss_s__default heateor_sss_s_telegram\" style=\"background-color:#3da5f1;width:87.5px;height:31.25px;display:inline-block;opacity:1;float:left;font-size:32px;box-shadow:none;display:inline-block;font-size:16px;padding:0 4px;vertical-align:middle;background-repeat:repeat;overflow:hidden;padding:0;cursor:pointer;box-sizing:content-box\"\u003e\u003csvg style=\"display:block;\" focusable=\"false\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" height=\"100%\" viewBox=\"0 0 32 32\"\u003e\u003cpath fill=\"#fff\" d=\"M25.515 6.896L6.027 14.41c-1.33.534-1.322 1.276-.243 1.606l5 1.56 1.72 5.66c.226.625.115.873.77.873.506 0 .73-.235 1.012-.51l2.43-2.363 5.056 3.734c.93.514 1.602.25 1.834-.863l3.32-15.638c.338-1.363-.52-1.98-1.41-1.577z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/a\u003e\u003ca class=\"heateor_sss_more\" title=\"More\" rel=\"nofollow noopener\" style=\"font-size: 32px!important;border:0;box-shadow:none;display:inline-block!important;font-size:16px;padding:0 4px;vertical-align: middle;display:inline;\" href=\"/mikrotik-firewall-default-config-basics-for-dummies/\" onclick=\"event.preventDefault()\"\u003e\u003cspan class=\"heateor_sss_svg\" style=\"background-color:#ee8e2d;width:87.5px;height:31.25px;display:inline-block!important;opacity:1;float:left;font-size:32px!important;box-shadow:none;display:inline-block;font-size:16px;padding:0 4px;vertical-align:middle;display:inline;background-repeat:repeat;overflow:hidden;padding:0;cursor:pointer;box-sizing:content-box;\" onclick=\"heateorSssMoreSharingPopup(this, \u0026#39;https://www.shellhacks.com/mikrotik-firewall-default-config-basics-for-dummies/\u0026#39;, \u0026#39;MikroTik%3A%20Firewall%20-%20Default%20Config%20%26%20Basics%20For%20Dummies\u0026#39;, \u0026#39;\u0026#39; )\"\u003e\u003csvg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"-.3 0 32 32\" version=\"1.1\" width=\"100%\" height=\"100%\" style=\"display:block;\" xml:space=\"preserve\"\u003e\u003cg\u003e\u003cpath fill=\"#fff\" d=\"M18 14V8h-4v6H8v4h6v6h4v-6h6v-4h-6z\" fill-rule=\"evenodd\"\u003e\u003c/path\u003e\u003c/g\u003e\u003c/svg\u003e\u003c/span\u003e\u003c/a\u003e\u003c/div\u003e\u003cdiv class=\"heateorSssClear\"\u003e\u003c/div\u003e\u003c/div\u003e\u003cdiv class=\"heateorSssClear\"\u003e\u003c/div\u003e\u003cdiv class=\"aa-a4caa5dcd608d817c67f05a7e3a0ee6d aa-after-content\" id=\"aa-a4caa5dcd608d817c67f05a7e3a0ee6d\"\u003e\u003c/div\u003e\n\u003c/div\u003e",
  "Date": "2023-04-26T21:37:09Z",
  "Author": "ShellHacks"
}