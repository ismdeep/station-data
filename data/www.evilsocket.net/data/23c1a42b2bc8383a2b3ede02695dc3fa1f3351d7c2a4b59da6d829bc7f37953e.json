{
  "Source": "www.evilsocket.net",
  "Title": "Hacking a Herb Vaporizer to Set Its Temperature Limit From 190C to 6553.5C Remotely",
  "Link": "https://www.evilsocket.net/2017/08/25/Mini-Post-Hacking-a-Herb-Vaporizer-using-GNU-Linux-and-BLE-raw-commands/",
  "Content": "\u003cdiv class=\"content\" itemprop=\"articleBody\"\u003e\n\u003cp\u003eTonight my brain decided, instead of sleeping (why even bother trying, right?), to start a \u003ca href=\"/2015/01/29/nike-fuelband-se-ble-protocol-reversed/\"\u003enew\u003c/a\u003e short adventure in the \u003cstrong\u003eBluetooth Low Energy\u003c/strong\u003e world. I’m a happy \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://www.storz-bickel.com/eu/en/crafty.html\"\u003eCrafty\u003c/a\u003e vaporizer owner and as I discovered by chance, I can access it using my laptop.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2017/08/ble_1.png\" alt=\"ble_1\"/\u003e\u003c/p\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\u003cp\u003eBTLE is conceptually easy, you’ve got “descriptors”, each one with an unique identifier and each one is arbitrarily used by the vendor for configuration purposes, control of the device, etc by read or write operations. So, first thing first, let’s reverse \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://play.google.com/store/apps/details?id=com.storz_bickel.app.m_vap\"\u003etheir mobile application\u003c/a\u003e in order to identify interesting descriptors!\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2017/08/ble_2.png\" alt=\"ble_2\"/\u003e\u003c/p\u003e\n\u003cp\u003eHere it is, we can read and write stuff with \u003cstrong\u003eno authentication whatsoever\u003c/strong\u003e … so, let’s get evil, shall we? :) \u003c/p\u003e\n\u003cp\u003eHow about writing to:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003epublic static final UUID characteristicTargetTemperatureUUID = UUID.fromString(\u0026#34;00000021-4C45-4B43-4942-265A524F5453\u0026#34;);\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe target temperature ( 190 C in my case ) is multiplied by 10 (\u003cdel\u003edon’t ask\u003c/del\u003e as someone \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://www.reddit.com/r/netsec/comments/6vvroj/hacking_a_herb_vaporizer_to_set_its_temperature/dm4e4gj/\"\u003evigorously pointed out\u003c/a\u003e, that’s \u003cem\u003e“pretty common when you don’t have/want floating-point arithmetic, or you want to represent exact values for a certain precision”\u003c/em\u003e … it doesn’t really matter for the scope of this blog post, but now we’re all happy) and stored as two bytes, \u003cstrong\u003eso let’s try to overwrite it with the maximum!\u003c/strong\u003e \u003cem\u003e-put evil laugh here-\u003c/em\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2017/08/ble_temp.png\" alt=\"ble_temp\"/\u003e\u003c/p\u003e\n\u003cp\u003eWhich should be a limit of 6553.5 Celsius degrees.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2017/08/pew.jpg\" alt=\"pew pew\"/\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eBOOM BABY!!!\u003c/strong\u003e \u003cstrong\u003eI have no idea what happens if I turn it on now\u003c/strong\u003e … it’s the only Crafty I have, and it’s not cheap, I’m not going to try, but the options are:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eHopefully some firmware security measure blocks the device from melting.\u003c/li\u003e\n\u003cli\u003eDevice melts in your hands.\u003c/li\u003e\n\u003cli\u003eBattery just dies before it melts. \u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eHow likely is \u003cstrong\u003e1\u003c/strong\u003e given there’s no security at all at the BTLE layer? Maybe some hardware security device? If anyone has a spare Crafty to try, let me know …\u003c/p\u003e\n\u003ch3 id=\"Disclosure\"\u003e\u003ca href=\"#Disclosure\" class=\"headerlink\" title=\"Disclosure\"\u003e\u003c/a\u003eDisclosure\u003c/h3\u003e\u003cp\u003eI can hear people screaming \u003cstrong\u003eand what about responsible disclosure ?!\u003c/strong\u003e … I don’t know why people give responsible disclosure for granted to be honest … I do this stuff for fun, if I need to start searching for contacts and wait for replies it becomes a job and it’s not fun anymore … ¯\\_(ツ)_/¯\u003c/p\u003e\n\u003ch3 id=\"Bonus-Level\"\u003e\u003ca href=\"#Bonus-Level\" class=\"headerlink\" title=\"Bonus Level\"\u003e\u003c/a\u003eBonus Level\u003c/h3\u003e\u003cp\u003eOn the info screen of the app, if you tap 5 times on the serial number and put the correct password, it’ll unlock some nice diagnostic menu … this is \u003ccode\u003eSHA256(password)\u003c/code\u003e :)\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2017/08/ble_3.png\" alt=\"ble_3\"/\u003e\u003c/p\u003e\n\u003cp\u003eDiagnostic menu options (\u003cstrong\u003ealso controllable via BTLE\u003c/strong\u003e):\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2017/08/ble_diag.png\" alt=\"ble_3\"/\u003e\u003c/p\u003e\n\u003c/div\u003e",
  "Date": "2017-08-25T01:10:53Z",
  "Author": "Simone Margaritelli"
}