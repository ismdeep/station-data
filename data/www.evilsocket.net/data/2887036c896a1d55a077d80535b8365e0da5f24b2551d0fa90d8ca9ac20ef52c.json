{
  "Source": "www.evilsocket.net",
  "Title": "BetterCap and the First REAL DoubleDirect ICMP Redirect Attack",
  "Link": "https://www.evilsocket.net/2016/01/10/BetterCap-and-the-first-REAL-DoubleDirect-ICMP-Redirect-Attack/",
  "Content": "\u003cdiv class=\"content\" itemprop=\"articleBody\"\u003e\n\u003cp\u003eThe next release of \u003ca target=\"_blank\" rel=\"noopener\" href=\"http://www.bettercap.org/\"\u003ebettercap\u003c/a\u003e will include a \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/evilsocket/bettercap/blob/8d1467987935762a890871c7e792c32b7390df53/lib/bettercap/spoofers/icmp.rb\"\u003enew spoofer module\u003c/a\u003e as an alternative to the default ARP spoofer.\u003cbr/\u003eThe new module performs a \u003cstrong\u003efully automated\u003c/strong\u003e and full duplex \u003cstrong\u003eICMP Redirect\u003c/strong\u003e MITM attack, what my collegues at Zimperium discovered and \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://blog.zimperium.com/doubledirect-zimperium-discovers-full-duplex-icmp-redirect-attacks-in-the-wild/\"\u003ecalled a\u003c/a\u003e \u003cstrong\u003eDoubleDirect\u003c/strong\u003e attack.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eBetterCap will be the very first MITM framework to have this feature 100% working without any additional spoofers.\u003c/strong\u003e\u003c/p\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\u003cp\u003eIf you’re thinking about ettercap ICMP spoofer which was released (I think) years ago, let me remind you what its \u003ca target=\"_blank\" rel=\"noopener\" href=\"http://www.irongeek.com/i.php?page=backtrack-3-man/ettercap\"\u003edocumentation\u003c/a\u003e says about it:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eObviously you have to be able to sniff all the traffic. If you are on a switch you have\nto use a different mitm attack such as arp poisoning.\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eSo yeah, unless you’re \u003cstrong\u003ealready\u003c/strong\u003e able to sniff network traffic ( in which case, why would you even need to do a MITM attack?!?!?! ), \u003cstrong\u003eettercap’s ICMP module is completely useless\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2016/01/photo.jpg\" alt=\"lulz\"/\u003e\u003c/p\u003e\n\u003cp\u003eOn the other hand, \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/byt3bl33d3r/MITMf/\"\u003eMITMf\u003c/a\u003e is not that much better, if you look closely at \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/byt3bl33d3r/MITMf/blob/d0b4fd66fafe9b3197e66b71dcc24e5e64f10eb3/core/poisoners/ICMP.py\"\u003eits code\u003c/a\u003e, you will find that the ICMP spoofer only does this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003edef build_icmp(self):\n   pkt = IP(src=self.gateway, dst=self.target)/ICMP(type=5,code=1, gw=self.ip_address) /\\\n              IP(src=self.target, dst=self.gateway)/UDP()\n\n   return pkt\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWhich basically will only reroute traffic to the gateway.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2016/01/Meme-derp.jpg\" alt=\"derp\"/\u003e\u003c/p\u003e\n\u003cp\u003eIn order to have a \u003cstrong\u003ereal\u003c/strong\u003e and \u003cstrong\u003efull duplex\u003c/strong\u003e MITM using ICMP Redirect packets, you have to reroute the gateway and every other address that the target/victim is requesting, which is why I used\u003cbr/\u003ea \u003cstrong\u003eDNS\u003c/strong\u003e watcher thread just like described on Zimperium’s blog post.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2016/01/papel-de-parede-meme-freddie-mercury-136608662.jpg\" alt=\"imsexy\"/\u003e\u003c/p\u003e\n\u003cp\u003eSo stay tuned guys, the next release is close!\u003c/p\u003e\n\u003c/div\u003e",
  "Date": "2016-01-10T12:56:22Z",
  "Author": "Simone Margaritelli"
}