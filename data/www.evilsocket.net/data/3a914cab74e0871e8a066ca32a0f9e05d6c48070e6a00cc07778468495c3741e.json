{
  "Source": "www.evilsocket.net",
  "Title": "RuberTooth - a Complete Ruby Porting of the Ubertooth Libraries and Utilities.",
  "Link": "https://www.evilsocket.net/2015/02/12/RuberTooth-A-complete-Ruby-porting-of-the-ubertooth-libraries-and-utilities/",
  "Content": "\u003cdiv class=\"content\" itemprop=\"articleBody\"\u003e\n\u003cp\u003eToday, finally my \u003cstrong\u003eubertooth\u003c/strong\u003e arrived and I immediately started hacking with it.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2015/02/ubertooth.jpg\" alt=\"ubertooth\"/\u003e\u003c/p\u003e\n\u003cp\u003eI installed its libraries and tools both on OS X and on my Linux virtual machine, and after a while I noticed a few things:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe compilation process is not well documented for newer versions of OS X, thus manual code patching here and there is required.\u003c/li\u003e\n\u003cli\u003eSome of the tools are only available for GNU/Linux.\u003c/li\u003e\n\u003cli\u003eSome of the tools are unstable.\u003c/li\u003e\n\u003cli\u003eThere’s no way to create my own UberTooth scripts without using C.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eRegarding the last point, there is a Python porting which is incomplete, it lacks most of the features that the native libraries have, so ubertooth is definitely not a scriptable device … or maybe not :)\u003c/p\u003e\n\u003cp\u003eI studied the USB communication protocol implemented inside \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/greatscottgadgets/ubertooth/tree/master/host/libubertooth\"\u003elibubertooth\u003c/a\u003e and found out that is very easy and well implemented, so I started to write some Ruby code ( \u003cstrong\u003eI hate Python!\u003c/strong\u003e ) using the \u003cstrong\u003elibusb\u003c/strong\u003e gem and a new project was born :)\u003c/p\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\u003cp\u003e\u003cimg src=\"/images/2015/02/Schermata-2015-02-12-alle-20-25-17.png\" alt=\"rubertooth in action\"/\u003e\u003c/p\u003e\n\u003cp\u003eThis project, \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/evilsocket/rubertooth\"\u003eRuberTooth\u003c/a\u003e, aims to be a complete Ruby porting of the ubertooth libraries and utilities, made by hackers for hackers, so anyone will be able to easily create scripts for their ubertooth devices.\u003c/p\u003e\n\u003cp\u003eHere’s an example BLE packet sniffer ( which is the equivalent of the \u003cstrong\u003eubertooth-btle\u003c/strong\u003e native tool ).\u003c/p\u003e\n\u003cfigure class=\"highlight ruby\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e26\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e27\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e28\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e29\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e30\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e31\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e32\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e33\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e34\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e35\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e36\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e37\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e38\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e39\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e40\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e41\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"variable\"\u003e$LOAD_PATH\u003c/span\u003e.unshift File.expand_path(\u003cspan class=\"string\"\u003e\u0026#34;../../lib\u0026#34;\u003c/span\u003e, \u003cspan class=\"keyword\"\u003e__FILE__\u003c/span\u003e)\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003erequire\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#39;ubertooth\u0026#39;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003erequire\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#39;usbpktrx\u0026#39;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003erequire\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#39;lepacket\u0026#39;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eMODES = { \u003cspan class=\"symbol\"\u003e:follow\u003c/span\u003e =\u0026gt; \u003cspan class=\"number\"\u003e0\u003c/span\u003e, \u003cspan class=\"symbol\"\u003e:promisc\u003c/span\u003e =\u0026gt; \u003cspan class=\"number\"\u003e1\u003c/span\u003e }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003emode = MODES[\u003cspan class=\"symbol\"\u003e:follow\u003c/span\u003e]\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003euber = RUbertooth::Ubertooth.new\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eputs \u003cspan class=\"string\"\u003e\u0026#34;Found device: \u0026#39;\u003cspan class=\"subst\"\u003e#{uber.device.inspect}\u003c/span\u003e\u0026#39;\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003euber.set_modulation RUbertooth::Ubertooth::MODULATIONS[\u003cspan class=\"symbol\"\u003e:MOD_BT_LOW_ENERGY\u003c/span\u003e]\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003eif\u003c/span\u003e mode == MODES[\u003cspan class=\"symbol\"\u003e:follow\u003c/span\u003e]\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    uber.set_channel \u003cspan class=\"number\"\u003e2402\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    uber.btle_sniffing \u003cspan class=\"number\"\u003e2\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003eelse\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    uber.btle_promisc\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003eend\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eprev_ts = \u003cspan class=\"number\"\u003e0\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eputs \u003cspan class=\"string\"\u003e\u0026#34;Starting polling loop ...\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003euber.keep_polling \u003cspan class=\"number\"\u003e0.5\u003c/span\u003e \u003cspan class=\"keyword\"\u003edo\u003c/span\u003e \u003cspan class=\"params\"\u003e|pkt|\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    ts_diff = pkt.clk100ns - prev_ts\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    prev_ts = pkt.clk100ns\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    printf \u003cspan class=\"string\"\u003e\u0026#34;\\nfreq=%d addr=%08x delta_t=%.03f ms\\n\u0026#34;\u003c/span\u003e, pkt.frequency, pkt.access_address, ts_diff / \u003cspan class=\"number\"\u003e10000.0\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    (\u003cspan class=\"number\"\u003e4\u003c/span\u003e..pkt.data_length - \u003cspan class=\"number\"\u003e1\u003c/span\u003e).each \u003cspan class=\"keyword\"\u003edo\u003c/span\u003e \u003cspan class=\"params\"\u003e|i|\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        printf \u003cspan class=\"string\"\u003e\u0026#34; %02x\u0026#34;\u003c/span\u003e, pkt.data[i]\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003eend\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    puts\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    lepkt = RUbertooth::BlueTooth::LePacket.decode pkt.data, pkt.frequency, pkt.clk100ns\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    lepkt.dump\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003eend\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003c/div\u003e",
  "Date": "2015-02-12T19:29:13Z",
  "Author": "Simone Margaritelli"
}