{
  "Source": "www.evilsocket.net",
  "Title": "SuperFish AdWare Found Inside X-Notifier Browser Extension Code.",
  "Link": "https://www.evilsocket.net/2015/02/20/SuperFish-AdWare-found-inside-X-Notifier-browser-extension-code/",
  "Content": "\u003cdiv class=\"content\" itemprop=\"articleBody\"\u003e\n\u003cp\u003eYou probably already heard about \u003cstrong\u003eSuperFish\u003c/strong\u003e around the web, an adware that Lenovo pre-installed on its computers since mid-2014. The danger does not reside inside the adware itself, that basically just injects some advertisment inside user web searches, but in the fact that, in order to handle HTTPS search engines ( Google ), it installs a root CA on the computer and replaces every HTTPS certificate sent by the web server with this one, leaving the victim vulnerable to SLL man in the middle attacks.\u003c/p\u003e\n\u003cp\u003eAs soon as I heard the name “SuperFish”, it suddenly was somehow familiar to me … “Where the hell did I hear this name before?”\u003c/p\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\u003cp\u003eAnd there it goes, I have the \u003ca target=\"_blank\" rel=\"noopener\" href=\"http://xnotifier.tobwithu.com/\"\u003e\u003cstrong\u003eX-Notifier\u003c/strong\u003e\u003c/a\u003e browser extension installed on Google Chrome, wich is very useful to handle multiple gmail accounts at once without using a desktop email client, this is its options panel:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2015/02/Schermata-2015-02-20-alle-18-22-34.png\" alt=\"xnotifier options\"/\u003e\u003c/p\u003e\n\u003cp\u003eLook at the bottom left of the picture …. there you go, the extension offers an optional ( but turned on by default ) SuperFish injection :D\u003c/p\u003e\n\u003cp\u003eWhen enabled, you will find this request for each page you visit:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2015/02/Schermata-2015-02-20-alle-18-22-05.png\" alt=\"superfish request\"/\u003e\u003c/p\u003e\n\u003cp\u003eAnd here’s the code ( xnotifier/js/inject.js ):\u003c/p\u003e\n\u003cfigure class=\"highlight javascript\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003edocument\u003c/span\u003e.addEventListener(\u003cspan class=\"string\"\u003e\u0026#39;DOMContentLoaded\u0026#39;\u003c/span\u003e, \u003cspan class=\"function\"\u003e\u003cspan class=\"keyword\"\u003efunction\u003c/span\u003e (\u003cspan class=\"params\"\u003e\u003c/span\u003e) \u003c/span\u003e{\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  chrome.extension.sendMessage({\u003cspan class=\"attr\"\u003emsg\u003c/span\u003e:\u003cspan class=\"string\"\u003e\u0026#34;enabled\u0026#34;\u003c/span\u003e},\u003cspan class=\"function\"\u003e\u003cspan class=\"keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"params\"\u003eresponse\u003c/span\u003e)\u003c/span\u003e{\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"keyword\"\u003eif\u003c/span\u003e(response.enabled){\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e      \u003cspan class=\"keyword\"\u003evar\u003c/span\u003e script=\u003cspan class=\"built_in\"\u003edocument\u003c/span\u003e.createElement(\u003cspan class=\"string\"\u003e\u0026#39;script\u0026#39;\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e      script.type=\u003cspan class=\"string\"\u003e\u0026#39;text/javascript\u0026#39;\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e      script.src=\u003cspan class=\"built_in\"\u003edocument\u003c/span\u003e.location.protocol + \u003cspan class=\"string\"\u003e\u0026#34;//www.superfish.com/ws/sf_main.jsp?dlsource=xnotifier\u0026amp;userId=\u0026#34;\u003c/span\u003e+response.uid+\u003cspan class=\"string\"\u003e\u0026#34;\u0026amp;CTID=xn-cr\u0026#34;\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e      \u003cspan class=\"keyword\"\u003evar\u003c/span\u003e h=\u003cspan class=\"built_in\"\u003edocument\u003c/span\u003e.getElementsByTagName(\u003cspan class=\"string\"\u003e\u0026#34;head\u0026#34;\u003c/span\u003e)[\u003cspan class=\"number\"\u003e0\u003c/span\u003e];\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e      h.appendChild(script);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  });\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e});\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eFortunately the server seems to be down, but the domain itself is still active:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eRegistrant Org: Superfish Inc. is associated with ~1 other domains\n...\nDomain Name: SUPERFISH.COM\nRegistrar: GODADDY.COM, LLC\nSponsoring Registrar IANA ID: 146\n...\nUpdated Date: 21-sep-2014\nCreation Date: 16-oct-2005\nExpiration Date: 16-oct-2017\n...\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eSo, apparently, Lenovo is not the only to use SuperFish services, that btw is not only an adware, but a whole company selling ads.\u003c/p\u003e\n\u003c/div\u003e",
  "Date": "2015-02-20T17:39:05Z",
  "Author": "Simone Margaritelli"
}