{
  "Source": "www.evilsocket.net",
  "Title": "Process Introspection for Fun and Profit",
  "Link": "https://www.evilsocket.net/2014/02/02/Process-introspection-for-fun-and-profit/",
  "Content": "\u003cdiv class=\"content\" itemprop=\"articleBody\"\u003e\n\u003cp\u003eWhile studying Windows internals for my job, I had to deepen my knowledge of executable loading process, including their memory layout, address relocations and so on.\u003cbr/\u003eI came accross the \u003cstrong\u003ePEB\u003c/strong\u003e ( process environment block ), a data structure ( mostly undocumented ) that NT systems use internally to handle many aspects of a process, including a list of loaded libraries, environment variables, command line arguments, heap informations, TLS slots and so on.\u003cbr/\u003eThe interesting fact about the PEB is that can be inspected to obtain those informations without the use of any standard API, thus resulting in an interesting technique to detect bad written virtual machines, emulators and any sort of sandboxing that could be used by a malware analyst or an anti virus product.\u003cbr/\u003eMoreover you could check the PEB to detect if a DLL has been injected into your process to perform api hooking.\u003cbr/\u003eAPI hooking softwares usually hooks API such as \u003cstrong\u003eEnumProcessModules\u003c/strong\u003e and patch them to hide the presence of the injected module. Inspecting the PEB you will be able to perform the same task only analyzing your address space, thus avoiding API patching.\u003c/p\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\u003cp\u003eThe address of the structure in our process virtual memory can be obtained with the \u003cstrong\u003eNtQueryInformationProcess\u003c/strong\u003e API, once you have the address you can cast it to a pointer to the following type.\u003c/p\u003e\n\u003cfigure class=\"highlight c\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e26\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e27\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e28\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e29\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e30\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e31\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e32\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e33\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e34\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e35\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e36\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e37\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e38\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e39\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e40\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e41\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e42\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e43\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e44\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e45\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e46\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e47\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e48\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e49\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e50\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e51\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e52\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e53\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e54\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e55\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e56\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e57\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e58\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e59\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003etypedef\u003c/span\u003e \u003cspan class=\"class\"\u003e\u003cspan class=\"keyword\"\u003estruct\u003c/span\u003e _\u003cspan class=\"title\"\u003ePEB\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"class\"\u003e{\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  BYTE                    InheritedAddressSpace;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  BYTE                    ReadImageFileExecOptions;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  BYTE                    BeingDebugged;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  BYTE                    Spare;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwMutant;                              \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwImageBaseAddress;                                                      \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  PEB_LDR_DATA*           LoaderData;                                                                      \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwProcessParameters;                                                \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwSubSystemData;                     \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwProcessHeap;                       \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwFastPebLock;                       \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwFastPebLockRoutine;                \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwFastPebUnlockRoutine;              \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwEnvironmentUpdateCount;            \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwKernelCallbackTable;               \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwEventLogSection;                   \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwEventLog;                          \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwFreeList;                          \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwTlsExpansionCounter;               \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwTlsBitmap;                         \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwTlsBitmapBits[\u003cspan class=\"number\"\u003e0x2\u003c/span\u003e];\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwReadOnlySharedMemoryBase;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwReadOnlySharedMemoryHeap;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwReadOnlyStaticServerData;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwAnsiCodePageData;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwOemCodePageData;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwUnicodeCaseTableData;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwNumberOfProcessors;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwNtGlobalFlag;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwSpare2;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwCriticalSectionTimeout1;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwCriticalSectionTimeout2;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwHeapSegmentReserve;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwHeapSegmentCommit;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwHeapDeCommitTotalFreeThreshold;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwHeapDeCommitFreeBlockThreshold;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwNumberOfHeaps;                              \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwMaximumNumberOfHeaps;                        \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   *ProcessHeaps;                               \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwGdiSharedHandleTable;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwProcessStarterHelper;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwGdiDCAttributeList;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwLoaderLock;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwOSMajorVersion;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwOSMinorVersion;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwOSBuildNumber;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwOSPlatformId;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwImageSubSystem;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwImageSubSystemMajorVersion;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwImageSubSystemMinorVersion;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   GdiHandleBuffer[\u003cspan class=\"number\"\u003e0x22\u003c/span\u003e];\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwPostProcessInitRoutine;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwTlsExpansionBitmap;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  BYTE                    TlsExpansionBitmapBits[\u003cspan class=\"number\"\u003e0x80\u003c/span\u003e];\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwSessionId;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003ePEB;\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eAs you can see there’s a lot that can be tested to evade sandboxing software due to the fact that most of them won’t emulate a correct PEB, the following source code will demonstrate how to read it and print many informations about the process.\u003c/p\u003e\n\u003cfigure class=\"highlight c\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e26\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e27\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e28\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e29\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e30\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e31\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e32\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e33\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e34\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e35\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e36\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e37\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e38\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e39\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e40\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e41\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e42\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e43\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e44\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e45\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e46\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e47\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e48\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e49\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e50\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e51\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e52\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e53\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e54\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e55\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e56\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e57\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e58\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e59\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e60\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e61\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e62\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e63\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e64\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e65\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e66\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e67\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e68\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e69\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e70\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e71\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e72\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e73\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e74\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e75\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e76\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e77\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e78\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e79\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e80\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e81\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e82\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e83\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e84\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e85\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e86\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e87\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e88\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e89\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e90\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e91\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e92\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e93\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e94\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e95\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e96\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e97\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e98\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e99\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e100\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e101\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e102\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e103\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e104\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e105\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e106\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e107\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e108\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e109\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e110\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e111\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e112\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e113\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e114\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e115\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e116\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e117\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e118\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e119\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e120\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e121\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e122\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e123\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e124\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e125\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e126\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e127\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e128\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e129\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e130\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e131\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e132\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e133\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e134\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e135\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e136\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e137\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e138\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e139\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e140\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e141\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e142\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e143\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e144\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e145\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e146\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e147\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e148\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e149\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e150\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e151\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e152\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e153\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e154\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e155\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e156\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e157\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e158\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e159\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e160\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e161\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e162\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e163\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e164\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e165\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e166\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e167\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e168\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e169\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e170\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e171\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e172\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e173\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e174\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e175\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e176\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e177\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e178\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e179\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e180\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e181\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e182\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e183\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e184\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e185\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e186\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e187\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e188\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e189\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e190\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e191\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e192\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e193\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e194\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e195\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e196\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e197\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e198\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e199\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e200\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e201\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e202\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e203\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e204\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e205\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e206\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e207\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e208\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e209\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e210\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e211\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e212\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e213\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e214\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e215\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e216\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e217\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e218\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e219\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e220\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e221\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e222\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e223\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e224\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e225\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e226\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e227\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e228\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e229\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e230\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e231\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e232\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e233\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e234\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e235\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e236\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e237\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e238\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e239\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e240\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e241\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e242\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e243\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e244\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e245\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e246\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e247\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e248\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e249\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e250\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e251\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e252\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e253\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta\"\u003e#\u003cspan class=\"meta-keyword\"\u003einclude\u003c/span\u003e \u003cspan class=\"meta-string\"\u003e\u0026lt;Windows.h\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta\"\u003e#\u003cspan class=\"meta-keyword\"\u003einclude\u003c/span\u003e \u003cspan class=\"meta-string\"\u003e\u0026lt;stdio.h\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"meta\"\u003e#\u003cspan class=\"meta-keyword\"\u003einclude\u003c/span\u003e \u003cspan class=\"meta-string\"\u003e\u0026lt;assert.h\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"class\"\u003e\u003cspan class=\"keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"title\"\u003ePROCESS_BASIC_INFORMATION\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"class\"\u003e{\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  PVOID Reserved1;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  PVOID PebBaseAddress;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  PVOID Reserved2[\u003cspan class=\"number\"\u003e2\u003c/span\u003e];\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  ULONG_PTR UniqueProcessId;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  PVOID Reserved3;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e};\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003etypedef\u003c/span\u003e \u003cspan class=\"class\"\u003e\u003cspan class=\"keyword\"\u003estruct\u003c/span\u003e _\u003cspan class=\"title\"\u003ePEB_LDR_DATA\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"class\"\u003e{\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  BYTE       Reserved1[\u003cspan class=\"number\"\u003e8\u003c/span\u003e];\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  PVOID      Reserved2[\u003cspan class=\"number\"\u003e3\u003c/span\u003e];\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  LIST_ENTRY InMemoryOrderModuleList;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003ePEB_LDR_DATA ;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003etypedef\u003c/span\u003e \u003cspan class=\"class\"\u003e\u003cspan class=\"keyword\"\u003estruct\u003c/span\u003e _\u003cspan class=\"title\"\u003eTIB\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"class\"\u003e{\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  PEXCEPTION_REGISTRATION_RECORD* ExceptionList; \u003cspan class=\"comment\"\u003e// FS:0x00\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD dwStackBase;                             \u003cspan class=\"comment\"\u003e// FS:0x04\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD dwStackLimit;                            \u003cspan class=\"comment\"\u003e// FS:0x08\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD dwSubSystemTib;                          \u003cspan class=\"comment\"\u003e// FS:0x0C\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD dwFiberData;                             \u003cspan class=\"comment\"\u003e// FS:0x10\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD dwArbitraryUserPointer;                  \u003cspan class=\"comment\"\u003e// FS:0x14\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD dwTIBOffset;                             \u003cspan class=\"comment\"\u003e// FS:0x18\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eTIB;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"keyword\"\u003etypedef\u003c/span\u003e \u003cspan class=\"class\"\u003e\u003cspan class=\"keyword\"\u003estruct\u003c/span\u003e _\u003cspan class=\"title\"\u003ePEB\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"class\"\u003e{\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  BYTE                    InheritedAddressSpace;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  BYTE                    ReadImageFileExecOptions;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  BYTE                    BeingDebugged;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  BYTE                    Spare;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwMutant;                              \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwImageBaseAddress;                                                      \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  PEB_LDR_DATA*           LoaderData;                                                                      \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwProcessParameters;                                                \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwSubSystemData;                     \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwProcessHeap;                       \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwFastPebLock;                       \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwFastPebLockRoutine;                \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwFastPebUnlockRoutine;              \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwEnvironmentUpdateCount;            \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwKernelCallbackTable;               \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwEventLogSection;                   \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwEventLog;                          \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwFreeList;                          \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwTlsExpansionCounter;               \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwTlsBitmap;                         \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwTlsBitmapBits[\u003cspan class=\"number\"\u003e0x2\u003c/span\u003e];\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwReadOnlySharedMemoryBase;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwReadOnlySharedMemoryHeap;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwReadOnlyStaticServerData;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwAnsiCodePageData;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwOemCodePageData;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwUnicodeCaseTableData;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwNumberOfProcessors;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwNtGlobalFlag;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwSpare2;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwCriticalSectionTimeout1;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwCriticalSectionTimeout2;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwHeapSegmentReserve;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwHeapSegmentCommit;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwHeapDeCommitTotalFreeThreshold;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwHeapDeCommitFreeBlockThreshold;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwNumberOfHeaps;                              \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwMaximumNumberOfHeaps;                        \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   *ProcessHeaps;                               \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwGdiSharedHandleTable;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwProcessStarterHelper;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwGdiDCAttributeList;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwLoaderLock;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwOSMajorVersion;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwOSMinorVersion;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwOSBuildNumber;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwOSPlatformId;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwImageSubSystem;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwImageSubSystemMajorVersion;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwImageSubSystemMinorVersion;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   GdiHandleBuffer[\u003cspan class=\"number\"\u003e0x22\u003c/span\u003e];\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwPostProcessInitRoutine;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwTlsExpansionBitmap;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  BYTE                    TlsExpansionBitmapBits[\u003cspan class=\"number\"\u003e0x80\u003c/span\u003e];\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD                   dwSessionId;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003ePEB;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"class\"\u003e\u003cspan class=\"keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"title\"\u003eUNICODE_STRING\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"class\"\u003e{\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  USHORT Length;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  USHORT MaximumLength;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  PWSTR  Buffer;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e};\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"class\"\u003e\u003cspan class=\"keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"title\"\u003eLDR_MODULE\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"class\"\u003e{\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  LIST_ENTRY              InLoadOrderModuleList;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  LIST_ENTRY              InMemoryOrderModuleList;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  LIST_ENTRY              InInitializationOrderModuleList;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  PVOID                   BaseAddress;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  PVOID                   EntryPoint;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  ULONG                   SizeOfImage;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"class\"\u003e\u003cspan class=\"keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"title\"\u003eUNICODE_STRING\u003c/span\u003e  \u003cspan class=\"title\"\u003eFullDllName\u003c/span\u003e;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"class\"\u003e\u003cspan class=\"keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"title\"\u003eUNICODE_STRING\u003c/span\u003e  \u003cspan class=\"title\"\u003eBaseDllName\u003c/span\u003e;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  ULONG                   Flags;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  SHORT                   LoadCount;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  SHORT                   TlsIndex;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  LIST_ENTRY              HashTableEntry;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  ULONG                   TimeDateStamp;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e};\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"class\"\u003e\u003cspan class=\"keyword\"\u003eenum\u003c/span\u003e \u003cspan class=\"title\"\u003ePROCESSINFOCLASS\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"class\"\u003e{\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  ProcessBasicInformation = \u003cspan class=\"number\"\u003e0\u003c/span\u003e,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  ProcessDebugPort = \u003cspan class=\"number\"\u003e7\u003c/span\u003e,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  ProcessWow64Information = \u003cspan class=\"number\"\u003e26\u003c/span\u003e,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  ProcessImageFileName = \u003cspan class=\"number\"\u003e27\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e};\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"function\"\u003e\u003cspan class=\"keyword\"\u003etypedef\u003c/span\u003e \u003cspan class=\"title\"\u003eNTSTATUS\u003c/span\u003e \u003cspan class=\"params\"\u003e(*NtQueryInformationProcess_T)\u003c/span\u003e\u003cspan class=\"params\"\u003e( HANDLE, \u003cspan class=\"keyword\"\u003eenum\u003c/span\u003e PROCESSINFOCLASS, PVOID, ULONG, PULONG )\u003c/span\u003e\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"function\"\u003e\u003cspan class=\"keyword\"\u003eint\u003c/span\u003e \u003cspan class=\"title\"\u003emain\u003c/span\u003e\u003cspan class=\"params\"\u003e()\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"function\"\u003e\u003c/span\u003e{\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  HMODULE hNtdll;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  NTSTATUS status;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  ULONG bytesReturned;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  PLIST_ENTRY lEntry;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  NtQueryInformationProcess_T pfnNtQueryInformationProcess;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  DWORD dwTIB;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"class\"\u003e\u003cspan class=\"keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"title\"\u003ePROCESS_BASIC_INFORMATION\u003c/span\u003e \u003cspan class=\"title\"\u003ebasicInfo\u003c/span\u003e;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  PEB* peb;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  TIB *tib;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"class\"\u003e\u003cspan class=\"keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"title\"\u003eLDR_MODULE\u003c/span\u003e *\u003cspan class=\"title\"\u003epLdrModule\u003c/span\u003e;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  hNtdll = LoadLibrary(\u003cspan class=\"string\"\u003eL\u0026#34;ntdll.dll\u0026#34;\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  pfnNtQueryInformationProcess = (NtQueryInformationProcess_T)GetProcAddress(hNtdll, \u003cspan class=\"string\"\u003e\u0026#34;NtQueryInformationProcess\u0026#34;\u003c/span\u003e );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  assert(pfnNtQueryInformationProcess != \u003cspan class=\"literal\"\u003eNULL\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  status = pfnNtQueryInformationProcess( GetCurrentProcess(), ProcessBasicInformation, \u0026amp;basicInfo, \u003cspan class=\"keyword\"\u003esizeof\u003c/span\u003e(basicInfo), \u0026amp;bytesReturned );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  assert(status == \u003cspan class=\"number\"\u003e0\u003c/span\u003e \u0026amp;\u0026amp; bytesReturned == \u003cspan class=\"keyword\"\u003esizeof\u003c/span\u003e(basicInfo));\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"comment\"\u003e// get our TIB address ( same as mov eax, fs:0x18 )\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  dwTIB = __readfsdword(\u003cspan class=\"number\"\u003e0x18\u003c/span\u003e);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  tib = (TIB *)dwTIB;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"comment\"\u003e// get our PEB address\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  peb = (PEB *)basicInfo.PebBaseAddress;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;TIB.ExceptionList          : %08X\\n\u0026#34;\u003c/span\u003e, tib-\u0026gt;ExceptionList );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;TIB.dwStackBase            : %08X\\n\u0026#34;\u003c/span\u003e, tib-\u0026gt;dwStackBase );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;TIB.dwStackLimit           : %08X\\n\u0026#34;\u003c/span\u003e, tib-\u0026gt;dwStackLimit );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;TIB.dwSubSystemTib         : %08X\\n\u0026#34;\u003c/span\u003e, tib-\u0026gt;dwSubSystemTib );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;TIB.dwFiberData            : %08X\\n\u0026#34;\u003c/span\u003e, tib-\u0026gt;dwFiberData );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;TIB.dwArbitraryUserPointer : %08X\\n\u0026#34;\u003c/span\u003e, tib-\u0026gt;dwArbitraryUserPointer );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;TIB.dwTIBOffset            : %08X\\n\u0026#34;\u003c/span\u003e, tib-\u0026gt;dwTIBOffset );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;\\n\u0026#34;\u003c/span\u003e );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.InheritedAddressSpace : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;InheritedAddressSpace );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.ReadImageFileExecOptions : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;ReadImageFileExecOptions );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.BeingDebugged : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;BeingDebugged );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.Spare : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;Spare );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwMutant : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwMutant );                              \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwImageBaseAddress : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwImageBaseAddress );                                                      \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.LoaderData : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;LoaderData );                                                                      \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwProcessParameters : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwProcessParameters );                                                \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwSubSystemData : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwSubSystemData );                     \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwProcessHeap : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwProcessHeap );                       \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwFastPebLock : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwFastPebLock );                       \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwFastPebLockRoutine : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwFastPebLockRoutine );                \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwFastPebUnlockRoutine : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwFastPebUnlockRoutine );              \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwEnvironmentUpdateCount : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwEnvironmentUpdateCount );            \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwKernelCallbackTable : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwKernelCallbackTable );               \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwEventLogSection : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwEventLogSection );                   \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwEventLog : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwEventLog );                          \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwFreeList : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwFreeList );                          \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwTlsExpansionCounter : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwTlsExpansionCounter );               \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwTlsBitmap : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwTlsBitmap );                         \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwReadOnlySharedMemoryBase : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwReadOnlySharedMemoryBase );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwReadOnlySharedMemoryHeap : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwReadOnlySharedMemoryHeap );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwReadOnlyStaticServerData : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwReadOnlyStaticServerData );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwAnsiCodePageData : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwAnsiCodePageData );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwOemCodePageData : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwOemCodePageData );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwUnicodeCaseTableData : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwUnicodeCaseTableData );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwNumberOfProcessors : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwNumberOfProcessors );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwNtGlobalFlag : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwNtGlobalFlag );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwSpare2 : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwSpare2 );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwCriticalSectionTimeout1 : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwCriticalSectionTimeout1 );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwCriticalSectionTimeout2 : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwCriticalSectionTimeout2 );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwHeapSegmentReserve : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwHeapSegmentReserve );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwHeapSegmentCommit : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwHeapSegmentCommit );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwHeapDeCommitTotalFreeThreshold : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwHeapDeCommitTotalFreeThreshold );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwHeapDeCommitFreeBlockThreshold : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwHeapDeCommitFreeBlockThreshold );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwNumberOfHeaps : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwNumberOfHeaps );                              \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwMaximumNumberOfHeaps : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwMaximumNumberOfHeaps );                        \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.*ProcessHeaps : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;ProcessHeaps );                               \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwGdiSharedHandleTable : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwGdiSharedHandleTable );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwProcessStarterHelper : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwProcessStarterHelper );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwGdiDCAttributeList : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwGdiDCAttributeList );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwLoaderLock : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwLoaderLock );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwOSMajorVersion : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwOSMajorVersion );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwOSMinorVersion : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwOSMinorVersion );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwOSBuildNumber : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwOSBuildNumber );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwOSPlatformId : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwOSPlatformId );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwImageSubSystem : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwImageSubSystem );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwImageSubSystemMajorVersion : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwImageSubSystemMajorVersion );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwImageSubSystemMinorVersion : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwImageSubSystemMinorVersion );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwPostProcessInitRoutine : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwPostProcessInitRoutine );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwTlsExpansionBitmap : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwTlsExpansionBitmap );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;PEB.dwSessionId : %08X\\n\u0026#34;\u003c/span\u003e, peb-\u0026gt;dwSessionId );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e( \u003cspan class=\"string\"\u003e\u0026#34;\\n\u0026#34;\u003c/span\u003e );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"comment\"\u003e// get the main module\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  pLdrModule = (struct LDR_MODULE*)peb-\u0026gt;LoaderData-\u0026gt;InMemoryOrderModuleList.Flink;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  (\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"string\"\u003e\u0026#34;%-17S base@ %10p size: %10x flags: %12x\\n\u0026#34;\u003c/span\u003e,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    pLdrModule-\u0026gt;FullDllName.Buffer,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    pLdrModule-\u0026gt;BaseAddress,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    pLdrModule-\u0026gt;SizeOfImage,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    pLdrModule-\u0026gt;Flags\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"comment\"\u003e// loop each loaded module\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e( lEntry = peb-\u0026gt;LoaderData-\u0026gt;InMemoryOrderModuleList.Flink-\u0026gt;Flink; pLdrModule-\u0026gt;BaseAddress != \u003cspan class=\"number\"\u003e0\u003c/span\u003e; lEntry = lEntry-\u0026gt;Flink )\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  {\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    pLdrModule = (struct LDR_MODULE*)lEntry;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"built_in\"\u003eprintf\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    (\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e      \u003cspan class=\"string\"\u003e\u0026#34;%-17S base@ %10p size: %10x flags: %12x\\n\u0026#34;\u003c/span\u003e,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e      pLdrModule-\u0026gt;FullDllName.Buffer,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e      pLdrModule-\u0026gt;BaseAddress,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e      pLdrModule-\u0026gt;SizeOfImage,\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e      pLdrModule-\u0026gt;Flags\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  }\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  FreeLibrary( hNtdll );\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  \u003cspan class=\"keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"number\"\u003e0\u003c/span\u003e;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003c/div\u003e",
  "Date": "2014-02-02T02:17:24Z",
  "Author": "Simone Margaritelli"
}