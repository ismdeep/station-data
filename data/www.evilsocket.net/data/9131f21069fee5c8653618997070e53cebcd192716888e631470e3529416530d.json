{
  "Source": "www.evilsocket.net",
  "Title": "Enumerate/Bruteforce/Attack All the Things! Presenting Legba",
  "Link": "https://www.evilsocket.net/2023/11/02/Enumerate-Bruteforce-Attack-All-The-Things-Presenting-Legba/",
  "Content": "\u003cdiv class=\"content\" itemprop=\"articleBody\"\u003e\n\u003cp\u003eDuring the last few weeks Iâ€™ve been working on a new tool that started as a way for me to become more familiar with Rust and its \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://tokio.rs/\"\u003etokio asynchronous runtime\u003c/a\u003e and then quickly turned into quite a comprehensive and efficient replacement for similar tools (thc-hydra, medusa, patator, etc). In this blog post Iâ€™m going to briefly present \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/evilsocket/legba\"\u003eproject Legba\u003c/a\u003e, the reasons behind its implementation and a few of the many possible use cases.\u003c/p\u003e\n\u003ca href=\"https://en.wikipedia.org/wiki/Papa_Legba\" target=\"_blank\"\u003e\n\u003cimg width=\"350px\" src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/7/77/VeveLegba.svg/800px-VeveLegba.svg.png\"/\u003e\n\u003c/a\u003e\n\u003ch2 id=\"TL-DR\"\u003e\u003ca href=\"#TL-DR\" class=\"headerlink\" title=\"TL;DR\"\u003e\u003c/a\u003eTL;DR\u003c/h2\u003e\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003edocker run -it evilsocket/legba:latest -h \u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eDonâ€™t forget to \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/evilsocket/legba/wiki\"\u003eRTFM\u003c/a\u003e.\u003c/p\u003e\n\u003ch2 id=\"Rust-Async-FTW\"\u003e\u003ca href=\"#Rust-Async-FTW\" class=\"headerlink\" title=\"Rust + Async FTW\"\u003e\u003c/a\u003eRust + Async FTW\u003c/h2\u003e\u003cp\u003eWhen searching for authentication bruteforcing and wordlist attack tools, most of the times \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/vanhauser-thc/thc-hydra\"\u003eTHC Hydra\u003c/a\u003e is presented as the de facto standard, with some minor alternatives that are either 1-to-1 copies of it, much slower Python implementations, or protocol specific implementations.\u003c/p\u003e\n\u003cp\u003eWhile studying Hydra source code, three main factors caught my attention:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eItâ€™s using \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/vanhauser-thc/thc-hydra/blob/master/hydra-mod.c\"\u003eblocking sockets\u003c/a\u003e, meaning suboptimal scaling of I/O concurrent operations.\u003c/li\u003e\n\u003cli\u003eItâ€™s implemented in a non memory safe language.\u003c/li\u003e\n\u003cli\u003eIt does not support modern features such as CSRF token grabbing for HTTP requests, Kerberos Pre-Auth and more.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eFor these reasons (and because I was a bit bored after months of not coding anything) I decided to work on Legba, with the following objectives in mind:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eUse Rust which would not only make the tool blazing fast, but memory safe and efficient.\u003c/li\u003e\n\u003cli\u003eUse an asynchronous runtime in order to get the best possible performance.\u003c/li\u003e\n\u003cli\u003eImplement it as a generic framework that supports highly modular plugins in order to easily add new features without touching the core.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eAfter some hours of coding, refactoring and optimizing Iâ€™ve come up with something thatâ€™s (in my opinion) pretty great. With an average runtime memory usage of less than 15MB, Legba beats Hydra in terms of efficiency by several orders of magnitude. \u003c/p\u003e\n\u003cp\u003eHereâ€™s a benchmark of the two running some common plugins, both targeting the same test servers on localhost. The benchmark has been executed on a macOS laptop with an M1 Max CPU, using a wordlist of 1000 passwords with the correct one being on the last line. Legba was compiled in release mode, Hydra compiled and installed via \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://formulae.brew.sh/formula/hydra\"\u003ebrew formula\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eFar from being an exhaustive benchmark, this table still gives a clear idea of how using an asynchronous runtime can drastically improve performances.\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eTest Name\u003c/th\u003e\n\u003cth\u003eHydra Tasks\u003c/th\u003e\n\u003cth\u003eHydra Time\u003c/th\u003e\n\u003cth\u003eLegba Tasks\u003c/th\u003e\n\u003cth\u003eLegba Time\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\u003ctr\u003e\n\u003ctd\u003eHTTP basic auth\u003c/td\u003e\n\u003ctd\u003e16\u003c/td\u003e\n\u003ctd\u003e7.100s\u003c/td\u003e\n\u003ctd\u003e10\u003c/td\u003e\n\u003ctd\u003e1.560s \u003cstrong\u003e(ðŸš€ 4.5x faster)\u003c/strong\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eHTTP POST login (wordpress)\u003c/td\u003e\n\u003ctd\u003e16\u003c/td\u003e\n\u003ctd\u003e14.854s\u003c/td\u003e\n\u003ctd\u003e10\u003c/td\u003e\n\u003ctd\u003e5.045s \u003cstrong\u003e(ðŸš€ 2.9x faster)\u003c/strong\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eSSH\u003c/td\u003e\n\u003ctd\u003e16\u003c/td\u003e\n\u003ctd\u003e7m29.85s *\u003c/td\u003e\n\u003ctd\u003e10\u003c/td\u003e\n\u003ctd\u003e8.150s \u003cstrong\u003e(ðŸš€ 55.1x faster)\u003c/strong\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eMySQL\u003c/td\u003e\n\u003ctd\u003e4 **\u003c/td\u003e\n\u003ctd\u003e9.819s\u003c/td\u003e\n\u003ctd\u003e4 **\u003c/td\u003e\n\u003ctd\u003e2.542s \u003cstrong\u003e(ðŸš€ 3.8x faster)\u003c/strong\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eMicrosoft SQL\u003c/td\u003e\n\u003ctd\u003e16\u003c/td\u003e\n\u003ctd\u003e7.609s\u003c/td\u003e\n\u003ctd\u003e10\u003c/td\u003e\n\u003ctd\u003e4.789s \u003cstrong\u003e(ðŸš€ 1.5x faster)\u003c/strong\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\u003c/table\u003e\n\u003cp\u003e\u003csup\u003e* While this result would suggest a default delay between connection attempts used by Hydra. Iâ€™ve tried to study the source code to find such delay but to my knowledge thereâ€™s none. For some reason itâ€™s simply very slow.\u003c/sup\u003e\u003cbr/\u003e\u003csup\u003e** For MySQL hydra automatically reduces the amount of tasks to 4, therefore legbaâ€™s concurrency level has been adjusted to 4 as well.\u003c/sup\u003e\u003c/p\u003e\n\u003cp\u003eNote how, while using less concurrent tasks, Legba is faster and in most cases more memory efficient.\u003c/p\u003e\n\u003ch2 id=\"A-Framework-For-Everything\"\u003e\u003ca href=\"#A-Framework-For-Everything\" class=\"headerlink\" title=\"A Framework For Everything\"\u003e\u003c/a\u003eA Framework For Everything\u003c/h2\u003e\u003cp\u003eAfter implementing the core framework and the first protocol plugins, I realized that the tool functionalities went beyond just attacking authentication mechanisms via bruteforcing and wordlist attacks. Any type of enumeration task that requires an efficient parallelism and network I/O would be a good fit for it. This resulted in an extensive list of modules covering both authentication and enumeration of resources. Iâ€™ll add here just a few use cases, I highly recommend you guys to check \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/evilsocket/legba/wiki\"\u003ethe project wiki\u003c/a\u003e for the documentation and a full list of features.\u003c/p\u003e\n\u003ch3 id=\"All-the-HTTP-Things\"\u003e\u003ca href=\"#All-the-HTTP-Things\" class=\"headerlink\" title=\"All the HTTP Things\"\u003e\u003c/a\u003eAll the HTTP Things\u003c/h3\u003e\u003cp\u003eThe very first module I developed, of course, was the HTTP module, which quickly became a set of different submodules supporting all sorts of things, such as:\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eHTTP Basic Authentication\u003c/strong\u003e\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003elegba http.basic \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --username admin \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --password wordlists/passwords.txt \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --target http://localhost:8888/\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003e\u003cstrong\u003eHTTP Requests with NTLMv1 and NTLMv2 Authentication\u003c/strong\u003e\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003elegba http.ntlm2 \\ \u003cspan class=\"comment\"\u003e# use http.ntlm1 for v1.0\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --domain example.org \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --workstation client \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --username admin \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --password wordlists/passwords.txt \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --target https://localhost:8888/\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003e\u003cstrong\u003eHTTP Pages Enumeration\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eThis was implemented to replace \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/evilsocket/dirsearch\"\u003edirsearch\u003c/a\u003e.\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003elegba http.enum \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --payloads data/pages.txt \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --target http://localhost:8888/ \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --http-enum-ext php \\ \u003cspan class=\"comment\"\u003e# php is the default value for file extensions\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --http-success-codes 200 \u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eWordpress plugin discovery using interpolation syntax:\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003elegba http.enum \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --payloads data/wordpress-plugins.txt \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --target http://localhost:8888/wp-content/plugins/{PAYLOAD}/readme.txt \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --http-success-codes 200 \u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eLFI vulnerability fuzzing:\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003elegba http.enum \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --payloads data/lfi.txt \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --target http://localhost:8888/ \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --http-success-string \u003cspan class=\"string\"\u003e\u0026#34;root:\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eThe \u003ccode\u003edata/lfi.txt\u003c/code\u003e would be something like:\u003c/p\u003e\n\u003cfigure class=\"highlight plain\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e?page=..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003efile?filename=..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5cetc/passwd\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e...\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e... and so on ...\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e...\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eGoogle Suite / GMail valid accounts enumeration (this is a pretty neat trick that \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://twitter.com/evilsocket/status/1720063591007543775\"\u003eIâ€™ve recently found out about\u003c/a\u003e):\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003elegba http.enum \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --payloads data/employees-names.txt \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --http-success-string \u003cspan class=\"string\"\u003e\u0026#34;COMPASS\u0026#34;\u003c/span\u003e \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --http-success-codes 204 \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --quiet \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --target \u003cspan class=\"string\"\u003e\u0026#34;https://mail.google.com/mail/gxlu?email={PAYLOAD}@broadcom.com\u0026#34;\u003c/span\u003e \u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003e\u003cstrong\u003eVarious web login pages\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eHTTP Post Request (Wordpress wp-login.php page):\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003elegba http \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --username admin \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --password wordlists/passwords.txt \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --target http://localhost:8888/wp-login.php \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --http-method POST \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --http-success-codes 302 \\ \u003cspan class=\"comment\"\u003e# wordpress redirects on successful login\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --http-payload \u003cspan class=\"string\"\u003e\u0026#39;log={USERNAME}\u0026amp;pwd={PASSWORD}\u0026#39;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eHTTP Post Request (Wordpress xmlrpc.php)\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003elegba http \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --username admin \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --password wordlists/passwords.txt \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --target http://localhost:8888/xmlrpc.php \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --http-method POST \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --http-payload \u003cspan class=\"string\"\u003e\u0026#39;\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;iso-8859-1\u0026#34;?\u0026gt;\u0026lt;methodCall\u0026gt;\u0026lt;methodName\u0026gt;wp.getUsersBlogs\u0026lt;/methodName\u0026gt;\u0026lt;params\u0026gt;\u0026lt;param\u0026gt;\u0026lt;value\u0026gt;\u0026lt;string\u0026gt;{USERNAME}\u0026lt;/string\u0026gt;\u0026lt;/value\u0026gt;\u0026lt;/param\u0026gt;\u0026lt;param\u0026gt;\u0026lt;value\u0026gt;\u0026lt;string\u0026gt;{PASSWORD}\u0026lt;/string\u0026gt;\u0026lt;/value\u0026gt;\u0026lt;/param\u0026gt;\u0026lt;/params\u0026gt;\u0026lt;/methodCall\u0026gt;\u0026#39;\u003c/span\u003e \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --http-success-string \u003cspan class=\"string\"\u003e\u0026#39;isAdmin\u0026#39;\u003c/span\u003e \u003cspan class=\"comment\"\u003e# what string successful response will contain\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eOr using the @ syntax to load the payload from a file:\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003elegba http \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --username admin \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --password wordlists/passwords.txt \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --target http://localhost:8888/xmlrpc.php \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --http-method POST \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --http-payload @xmlrpc-payload.xml \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --http-success-string \u003cspan class=\"string\"\u003e\u0026#39;isAdmin\u0026#39;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eHTTP Post Request with CSRF Token grabbing:\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003elegba http \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --username admin \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --password wordlists/passwords.txt \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --target http://localhost:8888/ \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --http-csrf-page http://localhost:8888/ \\ \u003cspan class=\"comment\"\u003e# where to grab the CSRF token from, or empty if it\u0026#39;s the same as --target\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --http-csrf-regexp \u003cspan class=\"string\"\u003e\u0026#39;\u0026lt;input type=\u0026#34;hidden\u0026#34; name=\u0026#34;(token)\u0026#34; value=\u0026#34;([^\\\u0026#34;]+)\u0026#34;\u0026#39;\u003c/span\u003e \\ \u003cspan class=\"comment\"\u003e# regular expression to extract it\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --http-method POST \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --http-payload \u003cspan class=\"string\"\u003e\u0026#39;user={USERNAME}\u0026amp;pass={PASSWORD}\u0026#39;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003ch3 id=\"DNS-Subdomain-Enumeration\"\u003e\u003ca href=\"#DNS-Subdomain-Enumeration\" class=\"headerlink\" title=\"DNS Subdomain Enumeration\"\u003e\u003c/a\u003eDNS Subdomain Enumeration\u003c/h3\u003e\u003cp\u003eI wanted to write something faster and simpler than my \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/evilsocket/xray\"\u003eXRay\u003c/a\u003e, therefore:\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003elegba dns \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --payloads data/200k-dns.txt \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --target something.com \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --dns-resolvers \u003cspan class=\"string\"\u003e\u0026#34;1.1.1.1\u0026#34;\u003c/span\u003e \u003cspan class=\"comment\"\u003e# comma separated list of DNS resolvers, do not pass to use the system resolver\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003ch3 id=\"TCP-Port-Scanning\"\u003e\u003ca href=\"#TCP-Port-Scanning\" class=\"headerlink\" title=\"TCP Port Scanning\"\u003e\u003c/a\u003eTCP Port Scanning\u003c/h3\u003e\u003cp\u003eBecause why the hell not?! :D\u003c/p\u003e\n\u003cp\u003eScan all TCP ports with a 300ms timeout:\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003elegba tcp.ports \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --target something.com \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --timeout 300 \u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eScan a custom range of ports with a 300ms timeout:\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003elegba tcp.ports \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --target something.com \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --tcp-ports \u003cspan class=\"string\"\u003e\u0026#39;80-10000\u0026#39;\u003c/span\u003e \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --timeout 300 \u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eScan a custom list of ports with a 300ms timeout:\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003elegba tcp.ports \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --target something.com \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --tcp-ports \u003cspan class=\"string\"\u003e\u0026#39;21, 22, 80, 443, 8080\u0026#39;\u003c/span\u003e \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --timeout 300 \u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003ch3 id=\"Other-Protocols\"\u003e\u003ca href=\"#Other-Protocols\" class=\"headerlink\" title=\"Other Protocols\"\u003e\u003c/a\u003eOther Protocols\u003c/h3\u003e\u003cp\u003e\u003cstrong\u003eKerberos 5 Pre-Auth (users enumeration and password authentication).\u003c/strong\u003e\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003elegba kerberos \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --target dc.example.org \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --username admin \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --password wordlists/passwords.txt \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --kerberos-realm example.org\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003e\u003cstrong\u003eMicrosoft Remote Desktop\u003c/strong\u003e\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003elegba rdp \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --target localhost:3389 \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --username admin \\\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    --password data/passwords.txt\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eThe list goes on and on, at the time of writing (\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/evilsocket/legba/wiki\"\u003echeck the wiki for updates!\u003c/a\u003e) the list of supported features and protocols is: AMQP (ActiveMQ, RabbitMQ, Qpid, JORAM and Solace), Cassandra/ScyllaDB, DNS subdomain enumeration, FTP, HTTP (basic authentication, NTLMv1, NTLMv2, multipart form, custom requests with CSRF support and files/folders enumeration), IMAP, Kerberos pre-authentication and user enumeration, LDAP, MongoDB, Microsoft SQL, MySQL, Oracle, PostgreSQL, POP3, RDP, Redis, SSH / SFTP, SMTP, STOMP (ActiveMQ, RabbitMQ, HornetQ and OpenMQ), TCP port scanning, Telnet, VNC.\u003c/p\u003e\n\u003ch2 id=\"Fin\"\u003e\u003ca href=\"#Fin\" class=\"headerlink\" title=\"Fin\"\u003e\u003c/a\u003eFin\u003c/h2\u003e\u003cp\u003eAs usual, the tool is released under the GPL3 license and all contributions are more than welcome. Enjoy ^_^\u003c/p\u003e\n\u003c/div\u003e",
  "Date": "2023-11-02T16:46:32Z",
  "Author": "Simone Margaritelli"
}