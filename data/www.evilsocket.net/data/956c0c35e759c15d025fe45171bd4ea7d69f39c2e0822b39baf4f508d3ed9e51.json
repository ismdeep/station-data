{
  "Source": "www.evilsocket.net",
  "Title": "Libpe - a Fast PE32/PE32+ Parsing Library.",
  "Link": "https://www.evilsocket.net/2014/02/21/libpe-A-fast-PE32-PE32-parsing-library/",
  "Content": "\u003cdiv class=\"content\" itemprop=\"articleBody\"\u003e\n\u003cp\u003eIâ€™ve just published on \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/evilsocket/libpe\"\u003egithub\u003c/a\u003e \u003cstrong\u003elibpe\u003c/strong\u003e, a C/C++ library to parse Windows portable executables ( both PE32 and PE32+ ) written with \u003cstrong\u003espeed\u003c/strong\u003e and \u003cstrong\u003estability\u003c/strong\u003e in mind, released under the GPL 3 license.\u003cbr/\u003eCurrently the library is released as a Microsoft Visual Studio solution containing the library itself and an \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/evilsocket/libpe/blob/master/peview/peview.cpp\"\u003eexample project\u003c/a\u003e, I will make it cross platform in future releases.\u003c/p\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\u003cp\u003eThe output of the example program dumping itself is:\u003c/p\u003e\n\u003cfigure class=\"highlight plain\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e26\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e27\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e28\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e29\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e30\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e31\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e32\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e33\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e34\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e35\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e36\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e37\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e38\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e39\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e40\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e41\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e42\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e43\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e44\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e45\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e46\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e47\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e48\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e49\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e50\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e51\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e52\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e53\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e54\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e55\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e56\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e57\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e58\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e59\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e60\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e61\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e62\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e63\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e64\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e65\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e66\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e67\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e68\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e69\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e70\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e71\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e72\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e73\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e74\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e75\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e76\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e77\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e78\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e79\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e80\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e81\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e82\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e83\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e84\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e85\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e86\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e87\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e88\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e89\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e90\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e91\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e92\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e93\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e94\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e95\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e96\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e97\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e98\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e99\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e100\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eTYPE        : PE32\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eIMAGE BASE  : 00400000\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eENTRY POINT : 004111FE ( 000005FE )\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eSECTIONS ( 7 ):\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  .textbss        00401000 - 00401000 ( rsize=0, vsize=65536 )\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  .text           00411000 - 0041A200 ( rsize=37376, vsize=36879 )\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  .rdata          0041B000 - 0041D400 ( rsize=9216, vsize=9002 )\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  .data           0041E000 - 0041E200 ( rsize=512, vsize=1417 )\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  .idata          0041F000 - 0041FC00 ( rsize=3072, vsize=2913 )\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  .rsrc           00420000 - 00420600 ( rsize=1536, vsize=1084 )\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  .reloc          00421000 - 00421800 ( rsize=2048, vsize=1684 )\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eIMPORT TABLE ( 3 ) [0041F000]:\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  MSVCR110D.dll ( 48 )\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F328] __crtUnhandledException\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F32C] __crtTerminateProcess\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F330] ?terminate@@YAXXZ\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F334] __crtSetUnhandledExceptionFilter\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F338] _lock\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F33C] _unlock\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F340] _crt_debugger_hook\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F344] __dllonexit\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F348] _onexit\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F34C] _invoke_watson\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F350] _controlfp_s\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F354] wcscpy_s\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F358] _wmakepath_s\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F35C] _wsplitpath_s\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F360] _except_handler4_common\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F364] _commode\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F368] _fmode\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F36C] __initenv\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F370] _initterm\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F374] _initterm_e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F378] __setusermatherr\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F37C] _configthreadlocale\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F380] _cexit\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F384] _exit\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F388] _CrtSetCheckCount\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F38C] _CrtDbgReportW\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F390] __set_app_type\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F394] __getmainargs\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F398] _amsg_exit\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F39C] _XcptFilter\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F3A0] _CRT_RTC_INITW\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F3A4] tolower\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F3A8] strlen\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F3AC] malloc\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F3B0] vsprintf_s\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F3B4] free\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F3B8] calloc\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F3BC] _dupenv_s\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F3C0] strrchr\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F3C4] strncpy_s\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F3C8] _stricmp\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F3CC] strchr\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F3D0] strcmp\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F3D4] isprint\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F3D8] memset\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F3DC] printf\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F3E0] _calloc_dbg\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F3E4] exit\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  dbghelp.dll ( 1 )\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F438] UnDecorateSymbolName\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e  KERNEL32.dll ( 34 )\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F25C] VirtualQuery\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F260] GetProcessHeap\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F264] HeapFree\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F268] HeapAlloc\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F26C] DecodePointer\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F270] GetSystemTimeAsFileTime\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F274] GetCurrentThreadId\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F278] GetCurrentProcessId\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F27C] QueryPerformanceCounter\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F280] IsProcessorFeaturePresent\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F284] WideCharToMultiByte\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F288] MultiByteToWideChar\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F28C] LoadLibraryW\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F290] lstrlenA\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F294] LoadLibraryExW\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F298] GetProcAddress\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F29C] RaiseException\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F2A0] IsDebuggerPresent\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F2A4] EncodePointer\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F2A8] IsBadReadPtr\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F2AC] CreateFileMappingA\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F2B0] UnmapViewOfFile\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F2B4] MapViewOfFile\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F2B8] GetWindowsDirectoryA\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F2BC] GetSystemDirectoryA\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F2C0] GetLastError\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F2C4] CloseHandle\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F2C8] GetFullPathNameA\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F2CC] GetFileSize\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F2D0] GetFileAttributesA\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F2D4] CreateFileA\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F2D8] GetModuleFileNameW\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F2DC] GetModuleHandleW\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    [0041F2E0] FreeLibrary\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003c/div\u003e",
  "Date": "2014-02-21T17:19:57Z",
  "Author": "Simone Margaritelli"
}